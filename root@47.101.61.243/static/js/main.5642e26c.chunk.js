(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1029:function(e,t,a){},1030:function(e,t,a){},1031:function(e,t,a){},1033:function(e,t,a){},1045:function(e,t,a){},1046:function(e,t,a){},1047:function(e,t,a){},1048:function(e,t,a){},1049:function(e,t,a){},1050:function(e,t,a){},1051:function(e,t,a){},1052:function(e,t,a){},1053:function(e,t,a){},1054:function(e,t,a){},1055:function(e,t,a){},1056:function(e,t,a){},1061:function(e,t){},1062:function(e,t){},1063:function(e,t,a){},1064:function(e,t,a){},1077:function(e,t,a){},1078:function(e,t,a){},1079:function(e,t,a){},1080:function(e,t,a){},1081:function(e,t,a){},1082:function(e,t,a){},1083:function(e,t,a){},1084:function(e,t,a){},1088:function(e,t,a){},110:function(e,t,a){},1185:function(e,t,a){},1186:function(e,t,a){},1235:function(e,t,a){},1236:function(e,t,a){},1237:function(e,t,a){},1238:function(e,t,a){},1239:function(e,t,a){},1240:function(e,t,a){},1241:function(e,t,a){},1242:function(e,t,a){},1244:function(e,t,a){},1245:function(e,t,a){},1246:function(e,t,a){},1247:function(e,t,a){},1248:function(e,t,a){},1249:function(e,t,a){},1250:function(e,t,a){},1251:function(e,t,a){},1252:function(e,t,a){},1253:function(e,t,a){},1256:function(e,t,a){},1257:function(e,t,a){},1258:function(e,t,a){},1259:function(e,t,a){},1260:function(e,t,a){},1263:function(e,t,a){},1264:function(e,t,a){},1265:function(e,t,a){},1266:function(e,t,a){},1267:function(e,t,a){},1268:function(e,t,a){},1269:function(e,t,a){},1270:function(e,t,a){},1271:function(e,t,a){},1272:function(e,t,a){},1273:function(e,t,a){},1274:function(e,t,a){},1275:function(e,t,a){},1276:function(e,t,a){},1277:function(e,t,a){},1278:function(e,t,a){},1279:function(e,t,a){},1280:function(e,t,a){},1281:function(e,t,a){},1282:function(e,t,a){},1283:function(e,t,a){},1284:function(e,t,a){},1285:function(e,t,a){},1286:function(e,t,a){},1485:function(e,t,a){},1486:function(e,t,a){},1487:function(e,t,a){},1488:function(e,t,a){},1489:function(e,t,a){},1490:function(e,t,a){},1491:function(e,t,a){},1492:function(e,t,a){},1493:function(e,t,a){},1494:function(e,t,a){},1495:function(e,t,a){},1496:function(e,t,a){},1497:function(e,t,a){},1498:function(e,t,a){},1499:function(e,t,a){},1500:function(e,t,a){},1501:function(e,t,a){},1502:function(e,t,a){},1503:function(e,t,a){},1505:function(e,t,a){},1506:function(e,t,a){},1507:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(26),l=a.n(r),s=(a(650),a(2)),c=a(3),o=a(5),u=a(4),m=a(6),d=(a(651),a(206)),p=(a(410),a(653),a(654),a(38)),h=a(131),f=a(301),E=a.n(f),v=(a(1508),{nodeDevEnv:!1,apiUrl:"https://www.neptune.kingdomcloud.cn",apiPrefix:"",timeout:5e3,cookiesExpires:7,countDown:60,tokenKey:"ACCESS_TOKEN",orderTransformerKey:"ORDER_TRANSFORMER",storageUserKey:"USER_STORAGE",requestRetry:4,requestRetryDelay:800,shortLength:6}),_={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,a,n,i,r,l,s,c="",o=0;for(e=_._utf8_encode(e);o<e.length;)i=(t=e.charCodeAt(o++))>>2,r=(3&t)<<4|(a=e.charCodeAt(o++))>>4,l=(15&a)<<2|(n=e.charCodeAt(o++))>>6,s=63&n,isNaN(a)?l=s=64:isNaN(n)&&(s=64),c=c+this._keyStr.charAt(i)+this._keyStr.charAt(r)+this._keyStr.charAt(l)+this._keyStr.charAt(s);return c},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",a=0;a<e.length;a++){var n=e.charCodeAt(a);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}},g=[{curVal:"state",prevVal:"state_desc"},{curVal:"state_desc",prevVal:"state_desc"},{curVal:"products",prevVal:"items"},{curVal:"refund_apply_at",prevVal:"applied_at"},{curVal:"refund_state",prevVal:"refund_state_desc"},{curVal:"damagedProducts",prevVal:"damaged_items"},{curVal:"deficientProducts",prevVal:"deficient_items"}],b=a(15),y=a.n(b);function C(){return h.a.get(v.storageUserKey)}function k(){return E.a.get(v.tokenKey)}function S(){return E.a.remove(v.tokenKey)}function O(e){return/^1[3456789]\d{9}$/.test(e)}function N(e){return/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X|x)$/.test(e)}function w(e){return console.log(e,"----------data------------"),encodeURIComponent(_.encode(JSON.stringify(e)))}function x(){return parseInt(1e10*Math.random())}function I(e,t){for(var a=[],n=0,i=e.length;n<i;n++)for(var r=0,l=t.length;r<l;r++){var s=[];s.push(e[n],t[r]),a.push(s)}return a}function j(e,t){for(var a=e.length,n=t.length,i=0;i<a;i++)for(var r=0;r<n;r++)e.length>0&&e[i].stock_id===t[r].stock_id&&(e.splice(i,1),a--,console.log(t[r]));for(var l=0;l<t.length;l++)e.push(t[l]);return e}function T(e){var t,a,n=new Date;return n.setDate(n.getDate()+e),n.getFullYear()+"-"+((t=n.getMonth()+1)<10?"0"+t:t)+"-"+((a=n.getDate())<10?"0"+a:a)}function R(){var e,t,a=new Date;return a.setDate(a.getDate()),a.getFullYear()+"-"+((e=a.getMonth()+1)<10?"0"+e:e)+"-"+((t=a.getDate())<10?"0"+t:t)}function A(){var e=new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),t=new Date,a=new Date(t.getFullYear(),t.getMonth(),0).getDate(),n=new Date((new Date).getFullYear(),(new Date).getMonth()-1,a);return[D(e),D(n)]}function D(e){var t,a;return e.setDate(e.getDate()),e.getFullYear()+"-"+((t=e.getMonth()+1)<10?"0"+t:t)+"-"+((a=e.getDate())<10?"0"+a:a)}function P(){var e=new Date;return e.setDate(1),[D(e),R()]}function V(e){return y.a.map(e,function(t,a){y.a.map(g,function(n){t===n.prevVal&&e.splice(a,1,n.curVal)})}),e}function L(e){return y.a.map(g,function(t){e===t.curVal&&(e=t.prevVal)}),e}var M=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={userPermission:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){C()&&this.setState({userPermission:JSON.parse(C())})}},{key:"render",value:function(){var e=[];return this.state.userPermission.forEach(function(t){e.push(t.slug)}),i.a.createElement("div",{className:"nav"},i.a.createElement("div",{className:"main-content main"},i.a.createElement("div",{className:"logo"},i.a.createElement("h3",null," "),i.a.createElement("span",null,"PineHub")),i.a.createElement("ul",{className:"navUl"},[{text:"\u9996\u9875",path:"/home",exact:!1,name:"nav-index"},{text:"\u7528\u6237",path:"/user",exact:!1,name:"nav-user"},{text:"\u5e97\u94fa",path:"/shops",exact:!1,name:"nav-shop"},{text:"\u8ba2\u5355",path:"/order",exact:!1,name:"nav-order"},{text:"\u8425\u9500",path:"/marketing",exact:!1,name:"nav-marketing"},{text:"\u6d3b\u52a8",path:"/activities",exact:!1,name:"nav_activity"},{text:"\u5546\u54c1",path:"/goods",exact:!1,name:"nav-product"},{text:"\u5206\u9500",path:"/distribution",exact:!1,name:"nav-distribution"},{text:"\u8d22\u52a1",path:"/finance",exact:!1,name:"nav-finance"},{text:"\u8bbe\u7f6e",path:"/setting",exact:!0,name:"nav-setting"}].map(function(t,a){if(e.indexOf(t.name)>-1)return i.a.createElement("li",{name:t.name,key:a},i.a.createElement(p.c,{exact:t.exact,to:t.path},t.text))}))))}}]),t}(i.a.Component),U=a(72),F=(a(659),a(56),a(22)),G=(a(53),a(35)),B=(a(21),a(7)),z=a(36),H=a.n(z),K=(a(667),a(32)),J=a.n(K),W=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onStartChange=function(e,t){a.setState({startTime:e})},a.onEndChange=function(e,t){a.setState({endTime:e},function(){a.getCustomMonthData()})},a.disableTime=function(e){var t=a.state.startTime;return e<J()(t).subtract(30,"days")||e>J()(t).add(30,"days")},a.selectTime=function(e){switch(a.setState({time:e}),e){case"custom":break;case"yesterday":a.getYesterdayData();break;case"last7":a.getLast7Data();break;case"last30":a.getLast30Data();break;default:a.getAllData()}},a.getCustomMonthData=function(){var e=a.state.startTime,t=a.state.endTime;console.log(e,"===="),e?t?a.searchDate([e,t]):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u7ed3\u675f\u65f6\u95f4"):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u8d77\u59cb\u65f6\u95f4")},a.getLast30Data=function(){var e=J()(),t=J()().subtract("days",30);a.searchDate([t,e])},a.getLast7Data=function(){var e=J()(),t=J()().subtract("days",6);a.searchDate([t,e])},a.getYesterdayData=function(){var e=J()().subtract("days",1);a.searchDate([e,e])},a.getAllData=function(){a.props.handleData(["1970-01-01 00:00:00",J()().format("YYYY-MM-DD HH:mm:ss")])},a.searchDate=function(e){var t=J()(e[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),n=J()(e[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss");a.props.handleData([t,n])},a.state={time:"all",startTime:"",endTime:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.time;return i.a.createElement(n.Fragment,null,i.a.createElement("ul",{className:"selectTime_index"},[{key:"all",value:"\u5168\u90e8"},{key:"yesterday",value:"\u6628\u65e5"},{key:"last7",value:"\u8fd1\u4e03\u5929"},{key:"last30",value:"\u8fd1\u4e09\u5341\u5929"},{key:"custom",value:"\u81ea\u5b9a\u4e49",showTime:!0}].map(function(a){return i.a.createElement("li",{key:a.key,className:a.key===t?"active":"",onClick:function(){return e.selectTime(a.key)}},a.value)}),i.a.createElement("div",{style:{marginLeft:"20px"}},"custom"===t&&i.a.createElement(F.a,{locale:H.a},i.a.createElement("div",null,i.a.createElement(G.a,{onChange:this.onStartChange}),"---",i.a.createElement(G.a,{onChange:this.onEndChange,disabledDate:this.disableTime,onOpenChange:this.open}))))))}}]),t}(n.Component),Y=a(24),q=a(41),X=a.n(q),$=a(52),Q=(a(40),a(9)),Z=a(82),ee=a.n(Z),te=(a(466),a(473),a(477),a(478),a(620)),ae=a.n(te).a.create({baseURL:v.apiUrl+"/"+v.apiPrefix,headers:{Accept:"*/*"},timeout:v.timeout});ae.defaults.retry=v.requestRetry,ae.defaults.retryDelay=v.requestRetryDelay,ae.interceptors.request.use(function(e){return e.headers.Authorization=k(),e},function(e){Promise.reject(e)}),ae.interceptors.response.use(function(e){return e.data},function(e){if(void 0===e||"502"===e.code)return B.a.error("\u670d\u52a1\u5668\u8bf7\u6c42\u8d85\u65f6"),Promise.reject(e);var t=e.response;return console.log(t,"========"),t&&t.status?422===t.status&&t.data.errors&&t.data.errors.introducer_code?(B.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4ecb\u7ecd\u4eba\u7f16\u53f7"),Promise.reject(e)):(B.a.error(t.data.message),setTimeout(function(){401===t.status&&(B.a.error("\u767b\u5f55\u5931\u6548\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u767b\u5f55\u9875"),S(),window.location.href="./login")},2e3),B.a.error(t.data.message),Promise.reject(e)):void 0});var ne=ae;function ie(e){return ne({url:"/api/backend/statistics/data",method:"get",params:e})}var re=G.a.RangePicker,le=Q.a.Option,se=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getData=function(){var e=Object($.a)(X.a.mark(function e(t,n){var i,r,l;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({start:t,end:n});case 2:i=e.sent,r=i.data.channels,l=[],a.setState({chartData:{shop_count:[],user_count:[],order_count:[],shop_order_count:[],pick_order_count:[]}},function(){r.forEach(function(e){l.push(e.name),a.getAllChannelData(t,n,e.id)}),a.setState({channels:r,channelNames:l})});case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.getAllChannelData=function(){var e=Object($.a)(X.a.mark(function e(t,n,i){var r,l,s,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({start:t,end:n,channel_id:i});case 2:r=e.sent,l=a.state.chartData,e.t0=X.a.keys(r.data[i].chart_data);case 5:if((e.t1=e.t0()).done){e.next=14;break}if(s=e.t1.value,l[s]){e.next=9;break}return e.abrupt("continue",5);case 9:(c=r.data[i].chart_data[s]).channelId=i,l[s].push(c),e.next=5;break;case 14:a.setState(Object(Y.a)({},i,r.data[i].chart_data),function(){a.init(a.state.chartData)});case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.init=function(e){var t=ee.a.init(document.getElementById("myEChartsLeft")),n=e[a.state.activeItem],i=[];n.forEach(function(e){var t={name:e.channelId,type:"line",stack:"\u603b\u91cf",areaStyle:{},data:y.a.clone(a.state.yData)};y.a.map(e,function(e,n){if("channelId"!==n){var i=y.a.findIndex(a.state.xData,n);i>=0&&(t.data[i]=e)}}),i.push(t)}),console.log(i,"0000000000000000000"),t.setOption({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:a.state.channelNames},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:a.state.xData}],yAxis:[{type:"value"}],series:i})},a.handleYAxisChange=function(e){a.setState({activeItem:e},function(){a.init(a.state.chartData)})},a.onDateChange=function(e,t){var n=J()(e[0]).format("YYYY-MM-DD HH:mm:ss"),i=J()(e[1]).format("YYYY-MM-DD HH:mm:ss");a.setState({rangeDate:e},function(){a.handleXAxis(e),a.getData(n,i)})},a.handleXAxis=function(e){var t=e[1].diff(e[0],"d");a.setState({xData:[],yData:[]},function(){var n=e[0];a.state.xData.push(n.format("YYYY-MM-DD")),y.a.times(t,function(e){a.state.yData.push(0),a.state.xData.push(n.add(1,"days").format("YYYY-MM-DD"))}),console.log(a.state.xData,"xxxxxxxxxxxxxxxxxx")})},a.state={activeTab:"day",activeItem:"shop_count",rangeDate:[],channels:[],cards:[],startTime:J()().subtract("days",6).format("YYYY-MM-DD HH:mm:ss"),endTime:J()().format("YYYY-MM-DD HH:mm:ss"),chartData:{shop_count:[],user_count:[],order_count:[],shop_order_count:[],pick_order_count:[]},xData:[],yData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object($.a)(X.a.mark(function e(){var t,a;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData(this.state.startTime,this.state.endTime);case 2:t=J()(),a=J()().subtract("days",6),this.handleXAxis([a,t]);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement("div",{className:"e_charts"},i.a.createElement("div",{className:"echart_header"},i.a.createElement("div",{className:"yAxis"},"Y:",i.a.createElement(Q.a,{style:{width:"150px"},defaultValue:"shop_count",onChange:this.handleYAxisChange},[{name:"\u5e97\u94fa\u6570\u91cf",key:"shop_count"},{name:"\u5ba2\u6237\u6570\u91cf",key:"user_count"},{name:"\u8ba2\u5355\u603b\u6570",key:"order_count"},{name:"\u8ba2\u8d27\u5355\u6570\u91cf",key:"shop_order_count"},{name:"\u6d88\u8d39\u8005\u9884\u8ba2\u5355\u6570\u91cf",key:"pick_order_count"}].map(function(e){return i.a.createElement(le,{key:e.key},e.name)}))),i.a.createElement("div",{className:"right"},"X:",i.a.createElement(F.a,{locale:H.a},i.a.createElement(re,{onChange:this.onDateChange,value:this.state.rangeDate})))),i.a.createElement("div",{id:"myEChartsLeft",style:{width:"100%",height:"500px"}}," "))}}]),t}(n.Component),ce=G.a.RangePicker,oe=Q.a.Option,ue=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getData=function(){var e=Object($.a)(X.a.mark(function e(t,n){var i,r,l;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({start:t,end:n});case 2:i=e.sent,r=i.data.channels,l=[],a.setState({chartData:{shop_count:[],user_count:[],order_count:[],shop_order_count:[],pick_order_count:[]}},function(){r.forEach(function(e){l.push(e.name),a.getAllChannelData(t,n,e.id)}),a.setState({channels:r,channelNames:l})});case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.getAllChannelData=function(){var e=Object($.a)(X.a.mark(function e(t,n,i){var r,l,s,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({start:t,end:n,channel_id:i});case 2:r=e.sent,l=a.state.chartData,e.t0=X.a.keys(r.data[i].chart_data);case 5:if((e.t1=e.t0()).done){e.next=14;break}if(s=e.t1.value,l[s]){e.next=9;break}return e.abrupt("continue",5);case 9:(c=r.data[i].chart_data[s]).channelId=i,l[s].push(c),e.next=5;break;case 14:a.setState(Object(Y.a)({},i,r.data[i].chart_data),function(){a.init(a.state.chartData)});case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.init=function(e){var t=ee.a.init(document.getElementById("myEChartsRight")),n=e[a.state.activeItem],i=[];y.a.map(n,function(e){var t={name:e.channelId,type:"line",stack:"\u603b\u91cf",areaStyle:{},data:y.a.clone(a.state.yData)};y.a.map(e,function(e,n){if("channelId"!==n){var i=y.a.findIndex(a.state.xData,n);i>=0&&(t.data[i]=e)}}),i.push(t)}),console.log(i,"0000000000000000000"),t.setOption({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:a.state.channelNames},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:a.state.xData}],yAxis:[{type:"value"}],series:i})},a.handleYAxisChange=function(e){a.setState({activeItem:e},function(){a.init(a.state.chartData)})},a.onDateChange=function(e,t){var n=J()(e[0]).format("YYYY-MM-DD HH:mm:ss"),i=J()(e[1]).format("YYYY-MM-DD HH:mm:ss");a.setState({rangeDate:e},function(){a.handleXAxis(e),a.getData(n,i)})},a.handleXAxis=function(e){var t=e[1].diff(e[0],"d");a.setState({xData:[],yData:[]},function(){var n=e[0];a.state.xData.push(n.format("YYYY-MM-DD")),y.a.times(t,function(e){a.state.yData.push(0),a.state.xData.push(n.add(1,"days").format("YYYY-MM-DD"))}),console.log(a.state.xData,"xxxxxxxxxxxxxxxxxx")})},a.state={activeTab:"day",activeItem:"shop_order_total_fee",rangeDate:[],channels:[],cards:[],startTime:J()().subtract("days",6).format("YYYY-MM-DD HH:mm:ss"),endTime:J()().format("YYYY-MM-DD HH:mm:ss"),chartData:{shop_count:[],user_count:[],order_count:[],shop_order_count:[],pick_order_count:[]},xData:[],yData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object($.a)(X.a.mark(function e(){var t,a;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData(this.state.startTime,this.state.endTime);case 2:t=J()(),a=J()().subtract("days",6),this.handleXAxis([a,t]);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement("div",{className:"e_charts"},i.a.createElement("div",{className:"echart_header"},i.a.createElement("div",{className:"yAxis"},"Y:",i.a.createElement(Q.a,{style:{width:"150px"},defaultValue:"shop_order_total_fee",onChange:this.handleYAxisChange},[{name:"\u9500\u552e\u989d",key:"shop_order_total_fee"},{name:"\u8ba2\u8d27\u989d",key:"order_total_fee"},{name:"\u6d88\u8d39\u8005\u8ba2\u5355\u989d",key:"pick_order_total_fee"}].map(function(e){return i.a.createElement(oe,{key:e.key},e.name)}))),i.a.createElement("div",{className:"right"},"X:",i.a.createElement(F.a,{locale:H.a},i.a.createElement(ce,{onChange:this.onDateChange,value:this.state.rangeDate})))),i.a.createElement("div",{id:"myEChartsRight",style:{width:"100%",height:"500px"}}," "))}}]),t}(n.Component),me=(a(69),a(17)),de=me.a.createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1254386_bg6jzdfdsbf.js"}),pe=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={allData:[],cards:{order_count:0,order_total_fee:0,shop_count:0,user_count:0},channels:[]},a.handleData=function(e){ie({start:e[0],end:e[1]}).then(function(e){a.setState({channels:e.data.channels,cards:e.data[0].cards})}).catch(function(e){})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.handleData(["1970-01-01 00:00:00",J()().format("YYYY-MM-DD HH:mm:ss")])}},{key:"render",value:function(){var e={handleData:this.handleData},t=this.state.cards;return i.a.createElement("div",{className:"home_index"},i.a.createElement("div",{className:"home_index_header"},i.a.createElement(W,e)),i.a.createElement("ul",{className:"home_index_statistics"},i.a.createElement("li",null,i.a.createElement("div",{className:"icon1"},i.a.createElement(de,{type:"icon-ziyuan"})),i.a.createElement("div",{className:"right"},i.a.createElement("h3",{style:{color:"#4f9863"}},t.shop_count||0),i.a.createElement("span",{style:{color:"#4f9863"}},"\u5e97\u94fa\u6570"))),i.a.createElement("li",null,i.a.createElement("div",{className:"icon2"},i.a.createElement(de,{type:"icon-kehuguanli"})),i.a.createElement("div",{className:"right"},i.a.createElement("h3",{style:{color:"#F3B083"}},t.user_count||0),i.a.createElement("span",{style:{color:"#F3B083"}},"\u5ba2\u6237\u6570"))),i.a.createElement("li",null,i.a.createElement("div",{className:"icon3"},i.a.createElement(de,{type:"icon-dingdan"})),i.a.createElement("div",{className:"right"},i.a.createElement("h3",{style:{color:"#5FBED6"}},t.order_count||0),i.a.createElement("span",{style:{color:"#5FBED6"}},"\u8ba2\u5355\u6570"))),i.a.createElement("li",null,i.a.createElement("div",{className:"icon4"},i.a.createElement(de,{type:"icon-kehuguanli"})),i.a.createElement("div",{className:"right"},i.a.createElement("h3",{style:{color:"#F1BD55"}},t.order_total_fee||0),i.a.createElement("span",{style:{color:"#F1BD55"}},"\u9500\u552e\u989d")))),i.a.createElement("div",{className:"charts_container"},i.a.createElement(se,null),i.a.createElement(ue,null)))}}]),t}(i.a.Component),he=Object(U.g)(pe),fe=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,"Data")}}]),t}(i.a.Component),Ee=Object(U.g)(fe),ve=(a(29),a(14)),_e=(a(20),a(8)),ge=(a(16),a(10)),be=a(13),ye=(a(846),[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u59d3\u540d",value:"wx_name",type:"emptyCompare"},{label:"\u624b\u673a\u53f7\u7801",value:"mobile",type:"emptyCompare"},{label:"\u6027\u522b",value:"gender",type:"genderCompare"},{label:"\u7701",value:"province",type:"cityCompare"},{label:"\u5e02",value:"city",type:"cityCompare"},{label:"\u533a",value:"area",type:"cityCompare"},{label:"\u6ce8\u518c\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u4f1a\u5458\u7b49\u7ea7",value:"membership_level",type:"equalCompare"},{label:"\u4e0a\u7ebf",value:"introducer",type:"emptyCompare"},{label:"\u6210\u4e3a\u6b64\u4eba\u4e0b\u7ebf\u7684\u65f6\u95f4",value:"introduced_at",type:"timeCompare"},{label:"\u6210\u4e3a\u4e0b\u7ebf\u7684\u65f6\u95f4",value:"first_introduced_at",type:"timeCompare"}]},{value:"purchase_information",label:"\u8d2d\u4e70\u4fe1\u606f",children:[{label:"\u4e0a\u6b21\u8d2d\u4e70\u65f6\u95f4",value:"last_purchased_at",type:"timeCompare"},{label:"\u4e0a\u6b21\u8d2d\u4e70\u8ddd\u79bb\u4eca\u5929\u7684\u5929\u6570",value:"last_purchased_from_today",type:"numCompare"},{label:"\u7b2c\u4e00\u6b21\u8d2d\u4e70\u65f6\u95f4",value:"first_purchased_at",type:"timeCompare"},{label:"\u8d2d\u4e70\u603b\u989d",value:"total_purchase_amount",type:"numCompare"},{label:"\u626b\u7801\u4ed8\u91d1\u989d",value:"code_payment_amount",type:"numCompare"},{label:"\u9884\u8ba2\u5355\u91d1\u989d",value:"preorder_amount",type:"numCompare"},{label:"\u8ba2\u5355\u5e73\u5747\u91d1\u989d",value:"orders_average_fee",type:"numCompare"},{label:"\u626b\u7801\u4ed8\u5e73\u5747\u91d1\u989d",value:"code_payment_average_fee",type:"numCompare"},{label:"\u9884\u8ba2\u5355\u5e73\u5747\u91d1\u989d",value:"preorder_average_fee",type:"numCompare"},{label:"\u8d2d\u4e70\u6b21\u6570",value:"purchased_count",type:"numCompare"},{label:"\u626b\u7801\u4ed8\u6b21\u6570",value:"code_payment_count",type:"numCompare"},{label:"\u9884\u8ba2\u5355\u6b21\u6570",value:"preorder_count",type:"numCompare"}]},{value:"user_attributes",label:"\u7528\u6237\u5c5e\u6027",children:[{label:"\u6807\u7b7e",value:"tags",type:"contain"},{label:"\u7fa4\u7ec4",value:"groups",type:"group"},{label:"\u6765\u6e90",value:"source",type:"equalCompare"}]},{value:"account_information",label:"\u8d26\u6237\u4fe1\u606f",children:[{label:"\u50a8\u503c\u603b\u989d",value:"charge_amount",type:"numCompare"},{label:"\u50a8\u503c\u6b21\u6570",value:"charge_count",type:"numCompare"},{label:"\u8d60\u9001\u603b\u989d",value:"gift_amount",type:"numCompare"},{label:"\u8d26\u6237\u4f59\u989d",value:"account_balance",type:"numCompare"},{label:"\u603b\u79ef\u5206",value:"integral_amount",type:"numCompare"},{label:"\u5f53\u524d\u79ef\u5206",value:"current_integral",type:"numCompare"},{label:"\u5df2\u4f7f\u7528\u79ef\u5206",value:"integral_used",type:"numCompare"},{label:"\u79ef\u5206\u5151\u6362\u6b21\u6570",value:"integral_exchanged_count",type:"numCompare"},{label:"\u73b0\u6709\u4f18\u60e0\u5238\u6570",value:"current_coupon_count",type:"numCompare"},{label:"\u5931\u6548\u4f18\u60e0\u5238\u6570",value:"invaild_coupon_count",type:"numCompare"},{label:"\u4f7f\u7528\u4f18\u60e0\u5238\u6570",value:"used_coupon_count",type:"numCompare"}]}]),Ce={timeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"timestamp"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"timestamp"},{label:"\u665a\u4e8e",value:">",type:"timestamp"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"timestamp"},{label:"\u65e9\u4e8e",value:"<",type:"timestamp"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"timestamp"},{label:"\u533a\u95f4",value:"between",type:"period"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}],genderCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedBoxGender"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"selectedBoxGender"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}],cityCompare:[{label:"\u7b49\u4e8e",value:"=",type:"cityOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"cityBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4efb\u610f",value:"not in",type:"cityBox"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},ke=(a(84),a(49)),Se=a(67),Oe=(a(184),a(93)),Ne=(a(251),a(33),a(11));a(136);function we(e){return ne({url:"/api/backend/permissions",method:"get",params:e})}function xe(e){return ne({url:"/api/backend/regions",method:"get",params:e})}function Ie(e){return ne({url:"/api/backend/system/setting/set",method:"post",data:e})}function je(e){return ne({url:"/api/backend/system/setting/collection",method:"get",params:e})}var Te=[{name:"\u5168\u90e8",key:"ALL"},{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u5f85\u81ea\u63d0",key:"WAIT_CUSTOMER_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"},{name:"\u5df2\u9000\u6b3e",key:"REFUNDED"},{name:"\u5df2\u53d6\u6d88",key:"CANCELED"},{name:"\u8ba2\u5355\u5f02\u5e38",key:"EXCEPTION"},{name:"\u7533\u8bf7\u552e\u540e",key:"AFTER_SALE"},{name:"\u62d2\u7edd\u9000\u6b3e",key:"REFUSE_REFUND"},{name:"\u5f85\u6210\u56e2",key:"WAIT_FORM_GROUP"}],Re=[{name:"\u5546\u57ce\u8ba2\u5355",key:"SELF_PICK"},{name:"\u56e2\u8d2d\u8ba2\u5355",key:"GROUP_SHOPPING"}],Ae=[{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"},{name:"\u5546\u54c1\u5f02\u5e38",key:"GOODS_UNQUALIFIED_WAIT_PROCESS"},{name:"\u5904\u7406\u4e2d",key:"GOODS_UNQUALIFIED_WAIT_VERIFY"},{name:"\u5df2\u9000\u6b3e",key:"GOODS_UNQUALIFIED_REFUNDED"}],De=[{name:"\u914d\u9001\u5230\u5bb6",key:"HOME_DELIVERY"},{name:"\u5230\u5e97\u81ea\u63d0",key:"SELF_PICK"}],Pe=[{name:"\u53d1\u8d77\u63d0\u73b0",key:1},{name:"\u8d22\u52a1\u5904\u7406\u4e2d",key:2},{name:"\u5df2\u53d1\u653e",key:3},{name:"\u53d1\u653e\u5931\u8d25",key:4}],Ve=[{name:"\u5546\u57ce\u8ba2\u5355",key:"SELF_PICK_SUMMARY"},{name:"\u62fc\u56e2\u8ba2\u5355",key:"GROUP_SHOPPING"}],Le=[{name:"\u5f53\u65e5",key:"TODAY"},{name:"\u6b21\u65e5",key:"TODAY_PLUS_1"},{name:"\u67d0\u65e5\u671f\u524d\u4e0d\u9650",key:"BEFORE_FIXED_DATE"},{name:"\u56fa\u5b9a\u65e5\u671f",key:"FIXED_DATE"}],Me=[{name:"\u5f53\u65e5",key:"TODAY"},{name:"\u6b21\u65e5",key:"TODAY_PLUS_1"},{name:"\u9694\u65e5",key:"TODAY_PLUS_2"},{name:"\u56fa\u5b9a\u65e5\u671f",key:"FIXED_DATE"}],Ue=[{name:"\u672a\u5f00\u59cb",key:0},{name:"\u8fdb\u884c\u4e2d",key:1},{name:"\u5df2\u7ed3\u675f",key:2}],Fe=[{name:"\u5f85\u6210\u56e2",key:0},{name:"\u672a\u6210\u56e2",key:1},{name:"\u5df2\u6210\u56e2",key:2},{name:"\u5df2\u5b8c\u6210",key:3}],Ge=[{name:"\u5f85\u6210\u56e2",key:"PAY_COMPLETED"},{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u672a\u6210\u56e2",key:"CANCEL_AUTO"},{name:"\u5f85\u81ea\u63d0",key:"WAIT_CUSTOMER_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"}];function Be(e){return ne({url:"/api/backend/categories/product",method:"post",data:e})}function ze(e){return ne({url:"/api/backend/categories/product",method:"get",params:e})}function He(e){return ne({url:"/api/backend/categories/product?recursion=true",method:"get",params:e})}function Ke(e,t){return ne({url:"/api/backend/categories/".concat(t),method:"delete",params:e})}function Je(e,t){return ne({url:"/api/backend/categories/".concat(t),method:"put",data:e})}function We(e){return ne({url:"/api/backend/group_shopping/shopping_groups",method:"get",params:e})}function Ye(e){return ne({url:"/api/backend/group_shopping/shop_shopping_groups",method:"get",params:e})}function qe(e){return ne({url:"/api/backend/group_shopping/orders",method:"get",params:e})}function Xe(e){return ne({url:"/api/backend/group_shopping/products",method:"get",params:e})}function $e(e){return ne({url:"/api/backend/shops/applications",method:"get",params:e})}function Qe(e){return ne({url:"/api/backend/shops/delivery_routes/all",method:"get",params:e})}function Ze(e,t){return ne({url:"/api/backend/shops/applications/".concat(t,"/refuse"),method:"put",data:e})}function et(e){return ne({url:"/api/backend/shops",method:"get",params:e})}function tt(e,t){return ne({url:"/api/backend/shops/".concat(t),method:"put",data:e})}function at(e,t){return ne({url:"/api/backend/shops/".concat(t),method:"get",params:e})}function nt(e,t){return ne({url:"/api/backend/shops/".concat(t,"/detach/group"),method:"put",data:e})}function it(e,t){return ne({url:"/api/backend/shops/".concat(t,"/introduced_shops"),method:"get",params:e})}function rt(e,t){return ne({url:"/api/backend/shops/".concat(t,"/show"),method:"get",params:e})}function lt(e,t){return ne({url:"/api/backend/shops/".concat(t,"/subordinates"),method:"get",params:e})}function st(e){return ne({url:"/api/backend/shops/balance/operate",method:"put",data:e})}var ct=G.a.RangePicker,ot=Q.a.Option,ut=["Apples","Nails","Bananas","Helicopters"],mt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getTagList=function(e){a.props.api.tags({limit:10,page:e}).then(function(e){e.data.length&&a.setState({selectedTagItems:a.state.selectedTagItems})})},a.onTimestampChange=function(e,t){a.setState({timestamp:t}),a.props.onValueChange(t)},a.onPeriodChange=function(e,t){a.setState({period:t}),a.props.onValueChange(t)},a.handleChange=function(e){a.setState({selectedItems:e}),a.props.onValueChange(e)},a.tagScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getTagList(n)}},a.handleGenderChange=function(e){a.setState({gender:e}),a.props.onValueChange(e)},a.handleGoodFilterChange=function(e,t){a.setState(Object(Y.a)({},e,t)),a.props.onValueChange(t)},a.handleCityChange=function(e){a.setState({city:e}),a.props.onValueChange(e)},a.handleCityData=function(){return"province"==a.state.value?a.state.provinceData:"city"==a.state.value?a.state.cityData:a.state.areaData},a.onDetailAddressChange=function(e){console.log(e),a.props.onValueChange(e)},a.handleGrouponOptions=function(e){"shopping_group_id"!==(e=e||"shopping_group_id")&&"shop_shopping_group_id"!==e&&"initiator_id"!==e&&"pickup_shop_id"!==e||a.getGrouponData(a.handleGrouponApi(e),1)},a.handleGrouponApi=function(e){var t="";switch(e){case"shopping_group_id":t=We;break;case"shop_shopping_group_id":t=Ye;break;default:t=et}return t},a.getGrouponData=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i={limit:10,page:t};n&&a.props.advanceSearchKey&&(i[a.props.advanceSearchKey]=n),e(i).then(function(e){e.data.length&&(1===e.meta.pagination.current_page?a.setState({grouponData:e.data}):a.setState({grouponData:a.state.grouponData.concat(e.data)}))})},a.tagGrouponScroll=function(e){var t=a.state.value||"shopping_group_id",n=a.handleGrouponApi(t);e.persist();var i=e.target;if(i.scrollTop+i.offsetHeight===i.scrollHeight){var r=a.state.scrollPage+1;a.setState({scrollPage:r}),a.getGrouponData(n,r)}},a.searchData=function(e){var t=a.state.value||"shopping_group_id",n=a.handleGrouponApi(t);a.setState({scrollPage:1}),a.getGrouponData(n,1,e)},a.renderTree=function(){var e=a.state.selectedItems;switch(a.state.type){case"consumerOrder":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Te.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"deadlineType":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Le.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"deliveryTime":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Me.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"grouponStatus":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Ue.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"grouponOrderStatus":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Ge.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"grouponListStatus":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Fe.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"consumerTypeEqual":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Re.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"consumerOrderEqual":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Te.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"withdrawState":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Pe.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"withdrawStateEqual":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Pe.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"summaryOrderType":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Ve.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"deliveryTypeEqual":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},De.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"merchantOrder":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Ae.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"merchantOrderEqual":return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Ae.map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.key},e.name)}));case"times":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:a.onTimestampChange,placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",showToday:!1,format:"YYYY-MM-DD"})));case"dateRange":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(ct,{onChange:a.onPeriodChange,format:"YYYY-MM-DD"})));case"detailTime":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:a.onTimestampChange,placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4",showToday:!1,showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"})));case"periodDetailTime":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(ct,{onChange:a.onPeriodChange,showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"})));case"timestamp":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:a.onTimestampChange,placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",showToday:!1,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"})));case"period":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(ct,{onChange:a.onPeriodChange,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"})));case"noTimePeriod":return i.a.createElement("span",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(ct,{onChange:a.onPeriodChange,format:"YYYY-MM-DD"})));case"input":return i.a.createElement("span",null,i.a.createElement(Ne.a,{placeholder:"Basic usage",className:"optionInput",value:a.state.inputValue,onChange:function(e){a.setState({inputValue:e.target.value})},onBlur:function(){a.props.onValueChange(a.state.inputValue)}}));case"inputRange":return i.a.createElement("span",{className:"inputRange"},i.a.createElement(Ne.a,{placeholder:"Basic usage",className:"optionInput",value:a.state.inputRangeOne,onChange:function(e){a.setState({inputRangeOne:e.target.value})}}),i.a.createElement("span",null,"-"),i.a.createElement(Ne.a,{placeholder:"Basic usage",className:"optionInput",value:a.state.inputRangeTwo,onChange:function(e){a.setState({inputRangeTwo:e.target.value})},onBlur:function(){a.props.onValueChange([a.state.inputRangeOne,a.state.inputRangeTwo])}}));case"selectedBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},ut.map(function(e){return i.a.createElement(Q.a.Option,{key:e,label:e,value:e},e)})));case"selectedOneBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox",onChange:a.handleChange,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.selectedChannelItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e,label:e,value:e},e)})));case"selectedGrouponBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"multiple",value:e,className:"selectedBox",onChange:a.handleChange,onPopupScroll:a.tagGrouponScroll,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.grouponData.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name||e.display_name,value:e.id+""},e.name||e.display_name)})));case"selectedOneGrouponBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{showSearch:!0,defaultActiveFirstOption:!1,value:e,className:"selectedBox",onPopupScroll:a.tagGrouponScroll,onChange:a.handleChange,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",onSearch:a.searchData,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.grouponData.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,label:e.name||e.display_name,value:e.id},e.name||e.display_name)})));case"selectedChannelOneBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox tagBox",onChange:a.handleChange,optionLabelProp:"label",allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.selectedChannelItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,label:e.name,value:e.id},e.name)})));case"selectedChannelBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox tagBox",onChange:a.handleChange,optionLabelProp:"label",allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.selectedChannelItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})));case"selectedTagBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox tagBox",onChange:a.handleChange,onPopupScroll:a.tagScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.selectedTagItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})));case"selectedGroupBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,className:"selectedBox tagBox",onChange:a.handleChange,optionLabelProp:"label",allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.state.selectedGroupItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})));case"cityBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"multiple",value:a.state.city,className:"selectedBox tagBox",onChange:a.handleCityChange,optionLabelProp:"label",showSearch:!0,optionFilterProp:"children",allowClear:!0,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.handleCityData().map(function(e){return i.a.createElement(Q.a.Option,{key:e.region_code+"",label:e.name,value:e.region_code+""},e.name)})));case"cityOneBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:a.state.city,className:"selectedBox tagBox",onChange:a.handleCityChange,optionLabelProp:"label",showSearch:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},a.handleCityData().map(function(e){return i.a.createElement(Q.a.Option,{key:e.region_code+"",label:e.name,value:e.region_code+""},e.name)})));case"orderDetailAddress":return i.a.createElement("span",null,i.a.createElement(Oe.a,{options:a.state.provinceData,onChange:a.onDetailAddressChange,placeholder:"\u8bf7\u9009\u62e9\u7701\u5e02\u533a",fieldNames:{label:"name",value:"name",children:"children"}}),",");case"detailAddress":return i.a.createElement("span",null,i.a.createElement(Oe.a,{options:a.state.provinceData,onChange:a.onDetailAddressChange,placeholder:"\u8bf7\u9009\u62e9\u7701\u5e02\u533a",fieldNames:{label:"name",value:"region_code",children:"children"}}),",");case"selectedBoxGender":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u6027\u522b",style:{width:120},onChange:a.handleGenderChange},i.a.createElement(ot,{value:"1"},"\u7537"),i.a.createElement(ot,{value:"2"},"\u5973"),i.a.createElement(ot,{value:"0"},"\u65e0")));case"boolean":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u662f\u5426",style:{width:120},onChange:a.handleChange},i.a.createElement(ot,{value:!0},"\u662f"),i.a.createElement(ot,{value:!1},"\u5426")));case"batchBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u914d\u9001\u6279\u6b21",style:{width:120},onChange:function(e){return a.handleGoodFilterChange("delivery_batch",e)}},i.a.createElement(ot,{value:"5:30"},"5:30"),i.a.createElement(ot,{value:"11:30"},"11:30"),i.a.createElement(ot,{value:"16:30"},"16:30")));case"saveTypeBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u4fdd\u5b58\u65b9\u5f0f",style:{width:120},onChange:function(e){return a.handleGoodFilterChange("keep_mode",e)}},i.a.createElement(ot,{value:"FROZEN"},"\u51b7\u51bb"),i.a.createElement(ot,{value:"HOMOIOTHERMY"},"\u5e38\u6e29"),i.a.createElement(ot,{value:"REFRIGERATION"},"\u51b7\u85cf"),i.a.createElement(ot,{value:"HEATING"},"\u70ed\u98df")));case"statusBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u5e97\u94fa\u72b6\u6001",style:{width:120},onChange:function(e){return a.handleGoodFilterChange("status",e)}},i.a.createElement(ot,{value:200},"\u6253\u70ca"),i.a.createElement(ot,{value:100},"\u5f00\u4e1a")));default:return null}},a.state={type:"input",value:"",selectedItems:[],inputValue:"",inputRangeOne:"",inputRangeTwo:"",gender:"",period:"",timestamp:"",city:[],provinceData:[],cityData:[],areaData:[],selectedTagItems:[],selectedGroupItems:[],scrollPage:1,selectedChannelItems:[],delivery_batch:"",keep_mode:"",grouponData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;void 0!==e.type&&this.setState({type:e.type+"",value:e.activeKey.value},function(){a.handleGrouponOptions(e.activeKey.value)})}},{key:"componentDidMount",value:function(){var e=this;xe({}).then(function(t){var a=[];t.forEach(function(e){a=a.concat(e.children),e.children.forEach(function(e){e.children.unshift({region_code:null,name:"\u5168\u90e8",children:[]})}),e.children.unshift({region_code:null,name:"\u5168\u90e8",children:[]})});var n=[];a.forEach(function(e){n=n.concat(e.children)}),e.setState({provinceData:t,cityData:a,areaData:n})}).catch(function(e){}),this.props.api&&(this.props.api.getStatic?(this.props.api.getStatic({}).then(function(t){e.setState({selectedGroupItems:t.data})}),this.props.api.tags({limit:10,page:1}).then(function(t){e.setState({selectedTagItems:t.data})})):this.props.api.getChannels?(this.props.api.getChannels({}).then(function(t){e.setState({selectedChannelItems:t.data})}),this.props.api.groups({}).then(function(t){e.setState({selectedGroupItems:t.data})})):this.props.api.SonClassification?(this.props.api.groups({}).then(function(t){e.setState({selectedGroupItems:t.data})}),this.props.api.SonClassification({limit:10,page:1}).then(function(t){e.setState({selectedTagItems:t})})):this.props.api.goodsOrder&&this.props.api.groups({}).then(function(t){e.setState({selectedGroupItems:t.data})}))}},{key:"render",value:function(){return i.a.createElement("span",null,this.renderTree())}}]),t}(i.a.Component),dt=Q.a.Option,pt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onKeyChange=function(e){a.setState({activeValue:""});var t=a.props.value.filter(function(t){return t.value==e[0]})[0].children.filter(function(t){return t.value==e[e.length-1]});console.log(t,"=============");var n=a.props.operation[t[0].type][0].type;a.setState({activeKey:t[0],activeOptions:a.props.operation[t[0].type][0].value,type:n})},a.displayRender=function(e){return e[0]+"-"+e[e.length-1]},a.onOperationChange=function(e){var t;t=a.state.activeKey.type?a.props.operation[a.state.activeKey.type].filter(function(t){return t.value==e})[0].type:a.props.operation[a.props.value[0].children[0].type].filter(function(t){return t.value==e})[0].type,a.setState({type:t}),a.setState({activeOptions:e},function(){if(a.state.activeValue){var t={key:"".concat(a.props.slug,"_").concat(a.state.activeKey.value),operation:e,value:a.state.activeValue,cid:a.cid};a.setState({singleLineData:t},function(){a.props.onData(t)})}else if("is null"==e||"is not null"==e){var n=a.state.activeKey.value?a.state.activeKey.value:a.props.value[0].children[0].key,i={key:"".concat(a.props.slug,"_").concat(n)||"".concat(a.props.slug,"_").concat(n),operation:e,value:"",cid:a.cid};a.setState({singleLineData:i},function(){a.props.onData(i)})}})},a.transformOrderData=function(e){var t=e,n=y.a.findIndex(e.value,function(e){return"\u5168\u90e8"===e});n>-1?1===n?(t.key="order_province",t.value=e.value[n-1],a.props.onData(t)):2===n&&(t.key="order_city",t.value=e.value[n-1],a.props.onData(t)):(t.key="order_area",t.value=e.value[e.value.length-1],a.props.onData(t))},a.transformShopData=function(e){var t=e,n=y.a.findIndex(e.value,function(e){return!e});n>-1?1===n?(t.key="shop_province_code",t.value=e.value[n-1],a.props.onData(t)):2===n&&(t.key="shop_city_code",t.value=e.value[n-1],a.props.onData(t)):(t.key="shop_area_code",t.value=e.value[e.value.length-1],a.props.onData(t))},a.valueChange=function(e){var t=a.state.activeKey.value?a.state.activeKey.value:a.props.value[0].children[0].value,n={key:"".concat(a.props.slug,"_").concat(t)||"".concat(a.props.slug,"_").concat(t),operation:a.state.activeOptions,value:e,cid:a.cid};a.setState({singleLineData:n,activeValue:e}),console.log(n,"========================================="),"order_region"===n.key?a.transformOrderData(n):"shop_region"===n.key?a.transformShopData(n):a.props.onData(n)},a.itemData=e.item,a.cid=a.itemData.cid,a.state={singleLineData:{},activeKey:{},activeOptions:a.props.operation[a.props.value[0].children[0].type][0].value,activeValue:"",type:a.props.operation[a.props.value[0].children[0].type][0].type},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"singleBox"},i.a.createElement("div",{style:{width:"100%"},className:"selectChild"},i.a.createElement(Oe.a,{options:this.props.value,className:"cascader",defaultValue:[this.props.value[0].value,this.props.value[0].children[0].value],expandTrigger:"hover",displayRender:this.displayRender,onChange:this.onKeyChange,allowClear:!1}),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:120,marginLeft:5},onChange:this.onOperationChange,value:this.state.activeOptions},this.state.activeKey&&this.state.activeKey.type?this.props.operation[this.state.activeKey.type].map(function(e){return i.a.createElement(dt,{key:e.value},e.label)}):this.props.operation[this.props.value[0].children[0].type].map(function(e){return i.a.createElement(dt,{key:e.value},e.label)})),i.a.createElement(mt,{activeKey:this.state.activeKey,api:this.props.api,advanceSearchKey:this.props.advanceSearchKey,type:this.state.type,onValueChange:this.valueChange})),this.props.lineNeedRemove?i.a.createElement("i",{className:"iconfont",style:{display:this.props.lineNeedRemove?"block":"none"},onClick:this.props.deleteSingle},"\ue82a"):"")}}]),t}(i.a.Component),ht=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).clearFilter=function(){a.setState({singleAry:[{key:"",value:"",operation:"",cid:x()}]})},a.cloneSingLine=function(){var e={key:"",value:"",operation:"",cid:x()};a.setState({singleAry:[].concat(Object(Se.a)(a.state.singleAry),[e])})},a.deleteSingle=function(e){var t=a.state.singleAry.filter(function(t){return t.cid!==e});t.length||a.props.watch(a.gid),a.setState({singleAry:t})},a.saveData=function(e){var t=a.state.singleAry.find(function(t){return t.cid==e.cid});if(t){var n=a.state.singleAry;n.forEach(function(a,i){a.cid==t.cid&&(n[i]=e)}),a.setState({singleAry:n})}else a.setState({singleAry:[].concat(Object(Se.a)(a.state.singleAry),[e])});a.props.onSaveData()},a.switchChange=function(e){e?a.setState({logic:"and"}):a.setState({logic:"or"})},a.item=e.item,a.gid=a.item.gid,a.state={singleAry:[{key:"",value:"",operation:"",cid:x()}],logic:"and"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.singleAry.length>1||this.props.groupNeedRemove;return i.a.createElement("div",{className:"groupBox"},i.a.createElement("div",{className:this.state.singleAry.length>1?"lines":""},this.state.singleAry.map(function(a,n){return i.a.createElement(pt,{key:n+"-"+a.cid,item:a,lineNeedRemove:t,deleteSingle:function(){return e.deleteSingle(a.cid)},onData:e.saveData,value:e.props.value,operation:e.props.operation,advanceSearchKey:e.props.advanceSearchKey,api:e.props.api,slug:e.props.slug})}),i.a.createElement("div",{className:"switch"},this.state.singleAry.length>1?i.a.createElement(ke.a,{checkedChildren:"\u4e14",unCheckedChildren:"\u6216",onChange:this.switchChange,defaultChecked:!0}):"")),i.a.createElement("div",{className:"addNew"},i.a.createElement("div",{onClick:function(){return e.cloneSingLine()},style:{width:"100px",cursor:"pointer"}},i.a.createElement("i",{className:"iconfont"},"\ue822"),i.a.createElement("span",null,"\u65b0\u52a0\u4e00\u4e2a\u6761\u4ef6"))))}}]),t}(i.a.Component),ft=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).clearFilter=function(){a.setState({groupAry:[{gid:x(),conditions:[],logic:"and"}]}),a.child.current.clearFilter()},a.cloneGroupLine=function(){a.props.renderChild&&a.props.renderChild(!0);var e={gid:x(),conditions:[],logic:"and"};a.setState({groupAry:[].concat(Object(Se.a)(a.state.groupAry),[e])})},a.watch=function(e){a.props.renderChild&&(a.state.groupAry.length>2?a.props.renderChild(!0):a.props.renderChild(!1));var t=a.state.groupAry.filter(function(t){return t.gid!==e});a.setState({groupAry:t})},a.switchChange=function(e){e?a.setState({logic:"and"}):a.setState({logic:"or"})},a.saveData=function(){var e=a.state.groupAry.find(function(e){return e.gid==a.child.current.item.gid});if(e){var t=a.child.current.state.singleAry,n=a.state.groupAry;n.forEach(function(n){n.gid==e.gid&&(n.conditions=t,n.logic=a.child.current.state.logic)}),a.setState({groupAry:n})}else a.setState({groupAry:[].concat(Object(Se.a)(a.state.groupAry),[a.child.current.state.singleAry])});var i={conditions:a.state.groupAry,logic:a.state.logic};a.setState({data:i})},a.state={groupAry:[{gid:x(),conditions:[],logic:"and"}],logic:"and"},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.groupAry.length>1;return i.a.createElement("div",null,i.a.createElement("div",{className:t?"groups":""},this.state.groupAry.map(function(a){return i.a.createElement(ht,{key:a.gid,ref:e.child,item:a,watch:e.watch,onSaveData:e.saveData,groupNeedRemove:t,value:e.props.value,operation:e.props.operation,api:e.props.api,advanceSearchKey:e.props.advanceSearchKey,slug:e.props.slug})}),i.a.createElement("div",{className:"switch"},this.state.groupAry.length>1?i.a.createElement(ke.a,{checkedChildren:"\u4e14",unCheckedChildren:"\u6216",onChange:this.switchChange,defaultChecked:!0}):"")),i.a.createElement("div",{className:t?"addNewGroup addNewGroupTwo":"addNewGroup",onClick:this.cloneGroupLine},i.a.createElement("i",{className:"iconfont"},"\ue822"),i.a.createElement("span",null,"\u65b0\u52a0\u4e00\u4e2a\u6761\u4ef6")))}}]),t}(i.a.Component),Et=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5546\u54c1\u540d\u79f0",value:"name",type:"absoluteCompare"},{label:"\u5546\u54c1\u6761\u7801",value:"barcode",type:"absoluteCompare"},{label:"PV\u503c",value:"pv",type:"numCompare"},{label:"\u96f6\u552e\u4ef7",value:"retail_price",type:"numCompare"},{label:"\u5e02\u573a\u4ef7",value:"market_price",type:"numCompare"},{label:"\u6210\u672c\u4ef7",value:"cost_price",type:"numCompare"}]},{value:"good_attributes",label:"\u5546\u54c1\u5c5e\u6027",children:[{label:"\u914d\u9001\u6279\u6b21",value:"delivery_batch",type:"batch"},{label:"\u4fdd\u5b58\u65b9\u5f0f",value:"keep_mode",type:"saveType"},{label:"\u5c5e\u6027",value:"property",type:"absoluteCompare"},{label:"\u5546\u54c1\u5206\u7c7b",value:"category",type:"contain"},{label:"\u5546\u54c1\u7ec4",value:"group",type:"group"}]},{value:"sale",label:"\u9500\u552e\u6570\u636e",children:[{label:"\u603b\u9500\u91cf",value:"total_sales",type:"numCompare"},{label:"\u8ba2\u8d27\u603b\u91cf",value:"total_order_product_sales",type:"numCompare"},{label:"\u9884\u5b9a\u603b\u91cf",value:"total_preorder_sales",type:"numCompare"}]}],vt={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],saveType:[{label:"\u7b49\u4e8e",value:"=",type:"saveTypeBox"}],batch:[{label:"\u7b49\u4e8e",value:"=",type:"batchBox"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]};function _t(e){return ne({url:"/api/backend/groups/product/static",method:"post",data:e})}function gt(e){return ne({url:"/api/backend/groups/product/static",method:"get",params:e})}function bt(e,t){return ne({url:"/api/backend/groups/".concat(t,"/add"),method:"post",data:e})}function yt(e,t){return ne({url:"/api/backend/groups/".concat(t,"/models"),method:"get",params:e})}var Ct=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt,api:{SonClassification:He,groups:gt},slug:"product"})))}}]),t}(i.a.Component),kt=(a(854),Ne.a.Search),St=function(e){function t(e){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(kt,{className:"searchInput",placeholder:this.props.text,onSearch:function(t){t=t.replace(/^\s*|\s*$/g,""),e.props.getDatas(t)},onFocus:function(e){e.target.nextSibling.childNodes[0].setAttribute("style","background-color:#4f9863!important;color:#FFF!important;border-color: #58A86E!important;box-shadow: 0  0 3px rgba(88,168,110,0.5)!important")},onBlur:function(e){e.target.nextSibling.childNodes[0].setAttribute("style","background-color:#fff!important;color:#666!important;border-color: #D9D9D9!important;box-shadow: none!important")},enterButton:!0})}}]),t}(i.a.Component),Ot=(a(335),a(200));a(856);var Nt=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).filterOption=function(e,t){return t.label.indexOf(e)>-1},a.handleChange=function(e){var t=e;if(-1===t.indexOf(a.props.firstItem)&&t.unshift(a.props.firstItem),console.log(t),t.indexOf("promotion_qr_code")<0){if(t.indexOf("state_desc")<0){if(t.length>8)return void B.a.error("\u6700\u591a\u9009\u62e9\u4e03\u5217")}else if(t.length>9)return void B.a.error("\u6700\u591a\u9009\u62e9\u4e03\u5217")}else if(t.length>10)return void B.a.error("\u6700\u591a\u9009\u62e9\u4e03\u5217");!function(e,t){var a=e.indexOf(t);e.splice(a,1),e.unshift(t)}(t,a.props.firstItem),a.setState({targetKeys:t}),a.props.handleCustom(t)},a.onSelectChange=function(e,t){-1===t.indexOf(a.props.firstItem)&&t.push(a.props.firstItem);var n=[];n=n.concat(e).concat(t),a.setState({selectedKeys:n})};var n=[],i=[];return i.push(e.firstItem),e.data.forEach(function(e){e.children.forEach(function(e){"groups"!==e.value&&(!function(e){switch(e.value){case"province_code":e.value="province";break;case"city_code":e.value="city";break;case"area_code":e.value="area"}}(e),n.push(e))})}),a.state={dataList:n,targetKeys:e.targetKeys,selectedKeys:i},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.selectedKeys,a=e.targetKeys;return i.a.createElement("div",null,i.a.createElement(Ot.a,{className:"transfer",dataSource:this.state.dataList,showSearch:!0,lazy:!1,titles:["\u5c5e\u6027","\u5217\u540d\uff08\u6700\u591a7\u5217\uff09"],filterOption:this.filterOption,targetKeys:a,selectedKeys:t,onChange:this.handleChange,onSelectChange:this.onSelectChange,showSelectAll:!1,render:function(e){return e.label},rowKey:function(e){return e.value},locale:{itemUnit:"\u9879",itemsUnit:"\u9879",notFoundContent:"\u5217\u8868\u4e3a\u7a7a",searchPlaceholder:"\u641c\u7d22"}}))}}]),t}(i.a.Component),wt=(a(333),a(199)),xt=(a(488),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).pagination=function(e){if(a.props.api){var t=a.props.params||{};t.limit=10,t.page=e,a.props.id?a.props.api(t,a.props.id).then(function(e){a.props.valChange(e.data),a.setState({total:e.meta.pagination.total})}):a.props.api(t).then(function(e){a.props.valChange(e.data),a.setState({total:e.meta.pagination.total})})}},a.showTotal=function(e,t){return"\u5171 ".concat(e).concat(a.state.text,"\uff0c\u7b2c").concat(t[0],"-").concat(t[1]," \u6761\u6570\u636e")},a.onChange=function(e){a.pagination(e),a.setState({current:e})},a.state={total:0,current:1,text:e.text||"\u4e2a\u7528\u6237"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.current||1;console.log(t),this.setState({current:t},function(){e.pagination(t)})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(F.a,{locale:H.a},i.a.createElement(wt.a,{total:this.state.total,showTotal:this.showTotal,showQuickJumper:!0,current:this.state.current,defaultCurrent:1,pageSize:10,onChange:this.onChange})))}}]),t}(i.a.Component));function It(e){return ne({url:"/api/backend/products/stock/provides",method:"get",params:e})}function jt(e){return ne({url:"/api/backend/products/stock/put_on_shelves",method:"post",data:e})}function Tt(e){return ne({url:"/api/backend/products/stock/get_off_shelves",method:"post",data:e})}function Rt(e,t){return ne({url:"/api/backend/products/stock/".concat(t,"/set_warning_stock"),method:"put",data:e})}function At(e,t){return ne({url:"/api/backend/products/stock/".concat(t,"/set_virtual_sales"),method:"put",data:e})}function Dt(e){return ne({url:"/api/backend/products",method:"get",params:e})}function Pt(e){return ne({url:"/api/backend/products",method:"post",data:e})}function Vt(e){return ne({url:"/api/backend/products/stock/stockable",method:"get",params:e})}function Lt(e,t){return ne({url:"/api/backend/products/stock/".concat(t,"/set_sale_scope"),method:"put",data:e})}function Mt(e,t){return ne({url:"/api/backend/products/stock/".concat(t,"/reset_sale_scope"),method:"put",data:e})}function Ut(e,t){return ne({url:"/api/backend/products/".concat(t),method:"put",data:e})}function Ft(e,t){return ne({url:"/api/backend/products/stock/batch/".concat(t),method:"get",params:e})}a(122);var Gt=a(68),Bt=(a(252),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.onSubmit=function(){var e=a.props.conditionsData||{};if("create"==a.state.type){if(!a.state.name)return void B.a.error("\u8bf7\u586b\u5199\u7fa4\u7ec4\u540d\u79f0");if(!a.state.remark)return void B.a.error("\u8bf7\u586b\u5199\u5907\u6ce8");_t({name:a.state.name,remark:a.state.remark}).then(function(t){bt({ids:a.props.checkedAry,logic_conditions:e},t.data.id).then(function(e){B.a.success("\u7fa4\u7ec4\u6dfb\u52a0\u6210\u529f"),a.setState({name:"",remark:""}),a.handleCancel()})})}else{if(!a.state.selectedGroups.length)return void B.a.error("\u8bf7\u5148\u9009\u62e9\u5206\u7ec4");bt({ids:a.props.checkedAry,logic_conditions:e},a.state.selectedGroups[0]).then(function(e){B.a.success("\u7fa4\u7ec4\u6dfb\u52a0\u6210\u529f"),a.handleCancel()})}},a.state={type:"create",name:"",remark:"",groupList:[],selectedGroups:[],groupId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;gt({}).then(function(t){e.setState({groupList:t.data})})}},{key:"handleChange",value:function(e){var t=[];t.push(e.id),this.setState({selectedGroups:t}),console.log(t)}},{key:"render",value:function(){var e=this,t=Gt.a.CheckableTag;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"create"==this.state.type?"\u65b0\u5efa\u5546\u54c1\u7ec4":"\u52a0\u5165\u5546\u54c1\u7ec4",className:"user_add",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.onSubmit,cancelButtonProps:this.handleCancel,cancelText:"\u53d6\u6d88",okText:"\u4fdd\u5b58",maskClosable:!1,zIndex:1001},i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"inline-flex":"none"},onClick:function(){e.setState({type:"join"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u52a0\u5165\u5546\u54c1\u7ec4"),i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"none":"inline-flex"},onClick:function(){e.setState({type:"create"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u5546\u54c1\u7ec4"),i.a.createElement("ul",{className:"mainUl t_body"},i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"block":"none"}},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"block":"none"}},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}})),i.a.createElement("li",{className:"tags t_group",style:{display:"create"==this.state.type?"none":"inline-block"}},this.state.groupList.length>0?this.state.groupList.map(function(a){return i.a.createElement(t,{key:a.id,checked:e.state.selectedGroups.indexOf(a.id)>-1,onChange:function(t){return e.handleChange(a,t)}},a.name)}):"\u8be5\u5206\u7ec4\u4e0b\u6682\u65e0\u7fa4\u7ec4"))))}}]),t}(i.a.Component));a(253);function zt(e){return ne({url:"/api/backend/products/specification/all",method:"get",params:e})}function Ht(e){return ne({url:"/api/backend/products/specification/list",method:"get",params:e})}function Kt(e){return ne({url:"/api/backend/products/specification",method:"post",data:e})}var Jt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.recordSpecId&&(a={},n=e.recordSpecId,ne({url:"/api/backend/products/".concat(n,"/entities"),method:"get",params:a})).then(function(e){i.setState({data:e.data})})}},{key:"render",value:function(){return i.a.createElement("div",{className:"selectGoods"},i.a.createElement(ge.a,{title:"\u89c4\u683c",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:!1},i.a.createElement("div",{className:"selectGoodsChart"},i.a.createElement(ve.a,{columns:[{title:"\u89c4\u683c",dataIndex:"spec_desc"},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u9500\u91cf",dataIndex:"total_sales"}],rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data}))))}}]),t}(i.a.Component),Wt=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category_desc"},{title:"\u89c4\u683c",dataIndex:"spec",render:function(e,t){return t.open_specification?i.a.createElement("div",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.recordSpec(t)}},"\u67e5\u770b\u89c4\u683c"):"\u65e0"}},{title:"\u5355\u4f4d",dataIndex:"unit"},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u603b\u9500\u91cf",dataIndex:"total_sales"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("product_management_edit")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.editShop(t)}},"\u7f16\u8f91"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({status:!0})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/goods/goodDetails",state:{id:e.product_id,path:"/goods",current:a.child.current.state.current}})},a.recordSpec=function(e){a.setState({recordSpecId:e.product_id,recordSpecVisible:!0})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.editShop=function(e){a.props.history.push({pathname:"/goods/releaseGoods",state:{id:e.product_id}})},a.search=function(e){a.setState({api:Dt,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Dt,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){Et.forEach(function(a){a.children.forEach(function(a){if(e==a.value){var n={};n.title=a.label,n.dataIndex=e,t.push(n)}})})}),e.indexOf("product_id")<0&&e.push("product_id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){console.log(e),a.setState({data:e})},a.showRelease=function(){a.props.history.push({pathname:"/goods/releaseGoods"})},a.unSale=function(){var e=a.refresh,t=a.state.checkedAry,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a;(a={product_ids:t},ne({url:"/api/backend/products/get_off_shelves",method:"post",data:a})).then(function(t){e()}).catch(function(e){})}})},a.closeAddGroup=function(){a.setState({groupVisible:!1})},a.onSubmitGroup=function(){a.setState({groupVisible:!1})},a.showAddGroup=function(e){a.setState({groupVisible:!0,conditions_data:e})},a.child=i.a.createRef(),a.state={api:Dt,id:"",filterVisible:!1,customVisible:!1,data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",searchJson:w({status:!0})},columns:n,groupVisible:!1,recordSpecVisible:!1,recordSpecId:"",defaultItem:["name","category_desc","spec","unit","retail_price","total_sales","product_id"],current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom),this.props.location.query&&this.props.location.query.groupId&&this.setState({id:this.props.location.query.groupId,api:yt})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(Jt,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,recordSpecId:this.state.recordSpecId}),i.a.createElement(Ct,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(Bt,{visible:this.state.groupVisible,onClose:this.closeAddGroup,onSubmit:this.onSubmitGroup,checkedAry:this.state.checkedAry}),i.a.createElement("div",{className:"goods_manage_header"},window.hasPermission("product_management_create")&&i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showRelease},"\u53d1\u5e03\u5546\u54c1"),i.a.createElement(_e.a,{size:"small"},i.a.createElement(de,{type:"icon-download"}),"\u6279\u91cf\u5bfc\u5165")),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("product_management_add_group")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.showAddGroup},"\u52a0\u5165\u5546\u54c1\u7ec4"),window.hasPermission("product_management_get_off_shelves")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0b\u67b6")),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879")),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:Et,firstItem:"name",targetKeys:this.state.defaultItem,handleCustom:this.handleCustom})),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current,text:"\u6761\u6570\u636e"})))}}]),t}(i.a.Component),Yt=Object(U.g)(Wt),qt=(a(956),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt})))}}]),t}(i.a.Component)),Xt=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category_desc"},{title:"\u89c4\u683c",dataIndex:"spec",render:function(e,t){return t.open_specification?i.a.createElement("div",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.recordSpec(t)}},"\u67e5\u770b\u89c4\u683c"):"\u65e0"}},{title:"\u5355\u4f4d",dataIndex:"unit"},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u603b\u9500\u91cf",dataIndex:"total_sales"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("product_off_shelves_edit")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.editShop(t)}},"\u7f16\u8f91"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({status:!1})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.editShop=function(e){a.props.history.push({pathname:"/goods/releaseGoods",state:{id:e.product_id}})},a.search=function(e){a.setState({api:Dt,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!1})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Dt,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!1})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.recordSpec=function(e){a.setState({recordSpecId:e.product_id,recordSpecVisible:!0})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.unSale=function(){var e=a.state.checkedAry,t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0a\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a;(a={product_ids:e},ne({url:"/api/backend/products/put_on_shelves",method:"post",data:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})}})},a.delete=function(){var e=a.state.checkedAry,t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a;(a={product_ids:e},ne({url:"/api/backend/products/delete",method:"post",data:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})}})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){ye.forEach(function(a){a.children.forEach(function(a){if(e==a.value){var n={};n.title=a.label,n.dataIndex=e,t.push(n)}})})}),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t})},a.child=i.a.createRef(),a.state={api:Dt,filterVisible:!1,warningStockVisible:!1,shelfGoodsVisible:!1,product_id:"",user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",searchJson:w({status:!1})},columns:n,recordSpecVisible:!1,recordSpecId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){console.log(t),e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(qt,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(Jt,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,recordSpecId:this.state.recordSpecId}),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("product_off_shelves_put_on")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0a\u67b6"),window.hasPermission("product_off_shelves_delete")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.delete},"\u5220\u9664"),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange})))}}]),t}(i.a.Component),$t=Object(U.g)(Xt),Qt=(a(150),a(78)),Zt=(a(958),a(959),a(282),a(153));a(963);function ea(e,t){var a=new FileReader;a.addEventListener("load",function(){return t(a.result)}),a.readAsDataURL(e)}var ta=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object($.a)(X.a.mark(function e(t){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,ea(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.beforeUpload=function(e){var t="image/jpeg"===e.type||"image/png"===e.type;return t||B.a.error("\u4ec5\u652f\u6301\u4e0a\u4f20JPG,PNG\u683c\u5f0f\u7684\u56fe\u7247!"),t},a.handleChange=function(e){"uploading"!==e.file.status?"done"===e.file.status&&(B.a.success("\u4e0a\u4f20\u6210\u529f"),a.props.type&&"activity"===a.props.type&&a.props.success(e.file.response.data.url,a.props.conponentType),a.setState({imgUrl:e.file.response.data.url,imageUrl:e.file.response.data.url},function(){"editProduct"===a.props.status&&a.props.upload(e.file.response.data.url),console.log(a.state,"ssasaasasasasassaassaassaasasasasasasasassa")}),ea(e.file.originFileObj,function(e){a.setState({imageUrl:e,loading:!1})})):a.setState({loading:!0})},a.text=e.text,a.state={loading:!1,imgUrl:"",previewVisible:!1,previewImage:"",imageUrl:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){console.log(e,"=====================================>"),e.defaultImg&&("edit"===e.status&&this.state.imgUrl?console.log("\u5df2\u7ecf\u4e0a\u4f20\u8fc7\u56fe\u7247\u5566"):this.setState({imageUrl:e.defaultImg}))}},{key:"render",value:function(){var e=i.a.createElement("div",null,i.a.createElement(me.a,{type:this.state.loading?"loading":"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},this.text)),t=this.state.imageUrl;return i.a.createElement("div",{className:"clearfix"},i.a.createElement(Zt.a,{name:"file",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"".concat(v.apiUrl,"/api/common/image/upload"),headers:{Authorization:"".concat(k())},beforeUpload:this.beforeUpload,onChange:this.handleChange,onPreview:this.handlePreview},t?i.a.createElement("img",{src:t,alt:"avatar"}):e),i.a.createElement(ge.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})))}}]),t}(i.a.Component),aa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({value:"",disabled:!1}),a.props.onCancel()},a.handleSubmit=function(){var e=a.child.current.state.imgUrl||a.child.current.state.imageUrl;a.props.onSubmit(a.state.value,e,a.state.sort)},a.state={value:"",disabled:!1,defaultImg:"",status:"create",sort:0},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.name?this.setState({value:e.name,defaultImg:e.icon,disabled:!0,classificationId:e.classificationId,status:"edit",sort:e.sort}):this.setState({classificationId:e.classificationId})}},{key:"render",value:function(){var e=this,t=this.props.icon&&this.props.icon.image||this.state.defaultImg;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:this.state.disabled?"\u4fee\u6539\u5206\u7c7b\u540d\u79f0":"\u65b0\u589e\u5206\u7c7b",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"newClassification warningStock"},"\u5206\u7c7b\u540d\u79f0",i.a.createElement(Ne.a,{value:this.state.value,onChange:function(t){e.setState({value:t.target.value})}})),i.a.createElement("div",{className:"newClassification"},i.a.createElement("span",null,"\u5206\u7c7b\u56fe\u6807"),i.a.createElement(ta,{ref:this.child,defaultImg:t,status:this.state.status})),i.a.createElement("div",{className:"newClassification warningStock sort"},"\u5206\u7c7b\u6392\u5e8f",i.a.createElement(Ne.a,{type:"number",value:this.state.sort,onChange:function(t){e.setState({sort:t.target.value})}}))))}}]),t}(i.a.Component),na=(a(1029),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({value:"",disabled:!1}),a.props.onCancel()},a.handleSubmit=function(){a.props.onSubmit(a.state.value,a.state.sort)},a.state={value:"",disabled:!1,sort:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.name&&this.setState({value:e.name,disabled:!0,sort:e.sort})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:this.state.disabled?"\u4fee\u6539\u5206\u7c7b\u540d\u79f0":"\u6dfb\u52a0\u5b50\u5206\u7c7b",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"warningStock"},"\u5206\u7c7b\u540d\u79f0",i.a.createElement(Ne.a,{value:this.state.value,onChange:function(t){e.setState({value:t.target.value})}})),i.a.createElement("div",{className:"newClassification warningStock sort"},"\u5206\u7c7b\u6392\u5e8f",i.a.createElement(Ne.a,{type:"number",value:this.state.sort,onChange:function(t){e.setState({sort:t.target.value})}}))))}}]),t}(i.a.Component)),ia=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){He({}).then(function(e){a.setState({data:e})})},a.addNew=function(){a.setState({classificationId:""},function(){a.showAddNewClassification()})},a.addNewSon=function(e){a.showAddNewSonClassification(e)},a.showAddNewClassification=function(){a.setState({addNewVisible:!0})},a.hideAddNewClassification=function(){a.setState({addNewVisible:!1,classificationName:""})},a.submitAddNewClassification=function(e,t,n){(a.child.current.state.classificationId?Je:Be)({name:e,icon:t,sort:n},a.child.current.state.classificationId).then(function(e){a.hideAddNewClassification(),a.refresh(),B.a.success(e.message||"\u65b0\u5efa\u6210\u529f")})},a.showAddNewSonClassification=function(e){a.setState({addNewSonVisible:!0,parentId:e})},a.hideAddNewSonClassification=function(){a.setState({addNewSonVisible:!1,sonClassificationName:""})},a.submitAddNewSonClassification=function(e,t){Be({name:e,parent_id:a.state.parentId,sort:t}).then(function(e){a.hideAddNewSonClassification(),a.refresh(),B.a.success(e.message||"\u65b0\u5efa\u6210\u529f")})},a.showDetail=function(e){a.setState({classificationName:e.name,icon:e.icon,sort:e.sort,classificationId:e.id},function(){a.showAddNewClassification()})},a.editSonClassification=function(e){a.setState({sonClassificationName:e.name,sonSort:e.sort},function(){a.showAddNewSonClassification()})},a.delete=function(e){},a.state={data:[],addNewVisible:!1,addNewSonVisible:!1,classificationName:"",sonClassificationName:"",parentId:"",classificationId:"",icon:"",sort:"",sonSort:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this.state.data,t=this;return i.a.createElement("div",null,i.a.createElement(aa,{visible:this.state.addNewVisible,onCancel:this.hideAddNewClassification,onSubmit:this.submitAddNewClassification,name:this.state.classificationName,icon:this.state.icon,sort:this.state.sort,classificationId:this.state.classificationId,ref:this.child}),i.a.createElement(na,{visible:this.state.addNewSonVisible,onCancel:this.hideAddNewSonClassification,onSubmit:this.submitAddNewSonClassification,name:this.state.sonClassificationName,sort:this.state.sonSort}),i.a.createElement("div",{className:"chart classification"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNew},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589e\u5206\u7c7b"),function(){var a=[{title:"\u5206\u7c7b",dataIndex:"name",key:"name",render:function(e,a){return i.a.createElement("span",{className:"goodsNames"},i.a.createElement("span",null,e),i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",cursor:"pointer"},className:"iconfont",onClick:function(){return t.showDetail(a)}},"\ue7a0"))}},{title:"\u64cd\u4f5c",dataIndex:"",key:"x",render:function(e,a){return i.a.createElement("div",{className:"operation"},i.a.createElement("span",{onClick:function(){return t.addNewSon(a.id)}},"\u6dfb\u52a0\u5b50\u5206\u7c7b"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5206\u7c7b\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){Ke({},a.id).then(function(e){t.refresh()})}},i.a.createElement("span",null,"\u5220\u9664")))}}];return i.a.createElement(ve.a,{className:"components-table-demo-nested",columns:a,rowKey:function(e){return e.id},expandedRowRender:function(e){var a=[{title:"cName",dataIndex:"name",key:"id",render:function(e,t){return t.name}},{title:"Status",key:"state",render:function(e){return i.a.createElement("div",{className:"operation"},i.a.createElement("span",{onClick:function(){return t.editSonClassification(e)}},"\u7f16\u8f91"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5206\u7c7b\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){Ke({},e.id).then(function(e){t.refresh()})}},i.a.createElement("span",null,"\u5220\u9664")))}}];return i.a.createElement(ve.a,{className:"innerTable",columns:a,rowKey:function(e){return e.id},dataSource:e.children,pagination:!1,showHeader:!1})},dataSource:e,pagination:!1})}()))}}]),t}(i.a.Component),ra=Object(U.g)(ia),la=(a(1030),a(1031),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.nameValue&&a.state.remarkValue?_t({name:a.state.nameValue,remark:a.state.remarkValue}).then(function(e){B.a.success("\u65b0\u589e\u5546\u54c1\u7ec4\u6210\u529f"),a.props.refresh(),a.props.onCancel(),a.setState({nameValue:"",remarkValue:""})}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u76f8\u5173\u4fe1\u606f")},a.state={nameValue:"",remarkValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u5546\u54c1\u7ec4",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u54c1\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.nameValue,onChange:function(t){e.setState({nameValue:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.remarkValue,onChange:function(t){e.setState({remarkValue:t.target.value})}})))))}}]),t}(i.a.Component)),sa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({groupData:{}},function(){a.props.onCancel()})},a.state={nameValue:"",remarkValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.groupId&&(a={},n=e.groupId,ne({url:"/api/backend/groups/".concat(n),method:"get",params:a})).then(function(e){i.setState({groupData:e.data})}).catch(function(e){})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u67e5\u770b\u5546\u54c1\u7ec4",maskClosable:!1,className:"disabled-filter",width:520,visible:this.props.visible,onCancel:this.handleCancel,centered:!0,footer:null},this.state.groupData&&this.state.groupData.name?i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.name})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.remark}))):""))}}]),t}(i.a.Component),ca=ve.a.Column,oa=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={data:[],createVisible:!1,detailVisible:!1,detailId:""},a.refresh=function(){gt({}).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.addNew=function(){a.setState({createVisible:!0})},a.closeNew=function(){a.setState({createVisible:!1})},a.showDetail=function(e){a.setState({detailVisible:!0,detailId:e.id})},a.hideDetail=function(){a.setState({detailVisible:!1,detailId:""})},a.goGroupManage=function(e){a.props.history.push({pathname:"/goods",query:{groupId:e.id}})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(la,{visible:this.state.createVisible,onCancel:this.closeNew,refresh:this.refresh}),i.a.createElement(sa,{visible:this.state.detailVisible,onCancel:this.hideDetail,groupId:this.state.detailId}),i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNew},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589e\u5546\u54c1\u7ec4"),i.a.createElement(ve.a,{dataSource:this.state.data,rowKey:function(e){return e.id},rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}},i.a.createElement(ca,{className:"column_group",title:"\u5546\u54c1\u7ec4",dataIndex:"name",key:"name",render:function(t,a){return i.a.createElement("span",{className:"editIcon"},i.a.createElement("span",null,t),i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},className:"iconfont",onClick:function(){return e.showDetail(a)}},"\ue7ab"))}}),i.a.createElement(ca,{className:"column_group primary",title:"\u5546\u54c1\u6570\u91cf",dataIndex:"model_count",key:"model_count"}),i.a.createElement(ca,{title:"\u64cd\u4f5c",key:"action",className:"column_group groupOperation",render:function(t,a){return i.a.createElement("span",null,i.a.createElement("span",{className:"operation",onClick:function(){return e.goGroupManage(a)}},"\u8be6\u60c5"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5546\u54c1\u7ec4\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){var t,n;(t={},n=a.id,ne({url:"/api/backend/groups/".concat(n),method:"delete",params:t})).then(function(t){B.a.success("\u5220\u9664\u5546\u54c1\u7ec4\u6210\u529f"),e.refresh()})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664")))}}))))}}]),t}(i.a.Component),ua=Object(U.g)(oa),ma=(a(151),a(83));a(530),a(267);function da(e){return ne({url:"/api/backend/groups/shop/static",method:"post",data:e})}function pa(e,t){return ne({url:"/api/backend/groups/".concat(t,"/add"),method:"post",data:e})}function ha(e){return ne({url:"/api/backend/groups/shop/static",method:"get",params:e})}function fa(e,t){return ne({url:"/api/backend/groups/".concat(t,"/models"),method:"get",params:e})}for(var Ea=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onShopGroupChange=function(e){a.setState({where:[]});("shop"==e?et:ha)({}).then(function(t){a.setState({type:e,data:t.data})})},a.onShopChange=function(e){a.setState({where:e})},a.onTypeChange=function(e){a.setState({opt:e})},a.handleCancel=function(){a.setState({type:void 0,opt:void 0,where:void 0},function(){a.props.onCancel()})},a.handleSubmit=function(){a.state.where.length?a.state.opt?Lt({type:a.state.type,opt:a.state.opt,where:a.state.where},a.props.rangeId).then(function(e){B.a.success(e.message),a.props.refresh(),a.handleCancel()}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u7c7b\u578b"):B.a.error("\u8bf7\u9009\u62e9\u5e97\u94fa\u6216\u5e97\u94fa\u7ec4")},a.clearRange=function(){Mt({},a.props.rangeId).then(function(e){B.a.success(e.message),a.handleCancel()})},a.state={data:[],selectedItems:[],selectedGroupItems:[],selectedGroupShopsItems:[],activeShopGroup:"",type:void 0,opt:void 0,where:void 0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;if(this.setState({type:void 0,opt:void 0,where:void 0}),!y.a.isEmpty(e.scope)){var n=e.scope.hasOwnProperty("shop"),i=e.scope.hasOwnProperty("group"),r=null;n&&(r="shop"),i&&(r="group");("shop"==r?et:ha)({}).then(function(e){a.setState({type:r,data:e.data})}),this.setState({type:r,opt:e.scope[r].opt,where:e.scope[r].where})}}},{key:"componentDidMount",value:function(){var e=this;ha({}).then(function(t){e.setState({selectedGroupItems:t.data})})}},{key:"render",value:function(){return i.a.createElement("div",{className:"saleRange"},i.a.createElement(ge.a,{title:"\u552e\u5356\u8303\u56f4",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"clearRangeBox"},i.a.createElement(_e.a,{size:"small",className:"clearRange",onClick:this.clearRange}," \u6e05\u7a7a\u552e\u5356\u8303\u56f4")),i.a.createElement("div",{className:"saleRangeBox"},i.a.createElement(Q.a,{placeholder:"\u8bf7\u9009\u62e9\u5e97\u94fa\u6216\u5e97\u94fa\u7ec4",defaultActiveFirstOption:!1,style:{width:300},onChange:this.onShopGroupChange,value:this.state.type},i.a.createElement(Q.a.Option,{value:"shop"},"\u5e97\u94fa"),i.a.createElement(Q.a.Option,{value:"group"},"\u5e97\u94fa\u7ec4")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:82,marginLeft:5},onChange:this.onTypeChange,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u65b9\u5f0f",value:this.state.opt},i.a.createElement(Q.a.Option,{value:"in"},"\u53ea\u552e\u4e8e"),i.a.createElement(Q.a.Option,{value:"not in"},"\u4e0d\u552e\u4e8e")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u8303\u56f4",mode:"tags",value:this.state.where,className:"selectedBox tagBox",onChange:this.onShopChange,allowClear:!0,optionFilterProp:"children",optionLabelProp:"label",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.data.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})))))}}]),t}(i.a.Component),va=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt})))}}]),t}(i.a.Component),_a=(a(1033),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:""},a.handleCancel=function(){a.setState({value:""}),a.props.onCancel()},a.handleSubmit=function(){a.props.onSubmit(a.state.value,a.props.id)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u8b66\u6212\u5e93\u5b58",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"warningStock"},"\u8bbe\u7f6e\u8b66\u6212\u5e93\u5b58",i.a.createElement(ma.a,{value:this.state.value,onChange:function(t){e.setState({value:t})}}))))}}]),t}(i.a.Component)),ga=a(202),ba=a(203),ya=a.n(ba),Ca=(a(532),function(e){var t=e.leftColumns,a=e.rightColumns,n=(e.onScroll,Object(ga.a)(e,["leftColumns","rightColumns","onScroll"]));return i.a.createElement(Ot.a,n,function(e){var n=e.direction,r=e.filteredItems,l=e.onItemSelectAll,s=e.onItemSelect,c=e.selectedKeys,o=e.disabled,u=(e.locale,e.titles,"left"===n?t:a),m="left"===n,d={onSelectAll:function(e,t){var a=t.filter(function(e){return!e.disabled}).map(function(e){return e.product_id}),n=e?ya()(a,c):ya()(c,a);l(n,e)},onSelect:function(e,t){s(e.product_id,t)},selectedRowKeys:c};return"left"===n?i.a.createElement("div",null,i.a.createElement(ve.a,{rowSelection:d,rowKey:function(e){return e.product_id},columns:u,showHeader:m,dataSource:r,size:"small",pagination:!1,onRow:function(e){var t=e.key;e.disabled;return{onClick:function(){s(t,!c.includes(t))}}}})):i.a.createElement(ve.a,{rowSelection:d,columns:u,rowKey:function(e){return e.product_id},showHeader:m,dataSource:r,size:"small",pagination:!1,style:{pointerEvents:o?"none":null},onRow:function(e){var t=e.key,a=e.disabled;return{onClick:function(){a||o||s(t,!c.includes(t))}}}})})}),ka=[],Sa=0;Sa<20;Sa++)ka.push({key:Sa.toString(),title:"content".concat(Sa+1)});var Oa=[{dataIndex:"name",title:"\u5546\u54c1\u540d\u79f0"}],Na=[{dataIndex:"name",title:"Name"},{dataIndex:"\u64cd\u4f5c",title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("span",{className:"shelfSwitch"},"\u662f\u5426\u53ef\u7528: ",i.a.createElement(ke.a,{onChange:function(e){return function(e,t){t.checked=e}(e,t)}}))}}],wa=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={targetKeys:[],data:[],totalPage:1,currentPage:0,dataSource:[]},a.onChange=function(e){a.setState({targetKeys:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){if(a.state.targetKeys.length){var e=a.state.data,t=a.state.targetKeys,n=[];y.a.map(e,function(e){y.a.map(t,function(t){e.product_id===t&&n.push({product_id:t,is_visible:e.checked||!1})})}),a.props.onSubmit(n)}else B.a.error("\u8bf7\u9009\u62e9\u4e0a\u67b6\u5546\u54c1")},a.handleScroll=function(e){return console.log("------------ throttle scroll ------------",e),Object(b.throttle)(function(){var t=Object($.a)(X.a.mark(function t(n){var i,r,l;return X.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("left"!==e){t.next=7;break}return console.log("------------ throttle scroll ------------",n),i=a.state,r=i.currentPage,l=i.totalPage,t.next=5,a.nextPage(r,l);case 5:t.sent;case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),1500)},a.onSearch=function(){return Object(b.throttle)(function(){var e=Object($.a)(X.a.mark(function e(t,a){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"left"===t&&console.log(a,"-------------- search throttle -------------");case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),1500)},a.nextPage=function(){var e=Object($.a)(X.a.mark(function e(t,n){var i,r,l,s,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<n)){e.next=13;break}return i=t+1,e.next=4,Dt({limit:100,page:i,searchJson:w({status:!0})});case 4:return r=e.sent,l=a.state.dataSource,s=r.data,c=r.meta,s.forEach(function(e){0===l.filter(function(t){return t.product_id===e.product_id}).length&&l.push(e)}),n=c.pagination.total_pages,e.next=12,new Promise(function(e){a.setState({data:l,currentPage:i,totalPage:n},function(){e(!0)})});case 12:return e.abrupt("return",e.sent);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=!1,a=setInterval(Object($.a)(X.a.mark(function n(){var i,r,l;return X.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return");case 2:return i=e.state,r=i.currentPage,l=i.totalPage,r===l&&clearInterval(a),t=!0,console.log("------------ 000000 ------------",r),n.next=8,e.nextPage(r,l);case 8:if(!n.sent){n.next=11;break}console.log("------------ 1111111 ------------",r),t=!1;case 11:case"end":return n.stop()}},n)})),1500)}},{key:"render",value:function(){var e=this.state,t=e.targetKeys,a=e.data;return i.a.createElement("div",{className:"shelfGoods"},i.a.createElement(ge.a,{title:"\u4e0a\u67b6\u5546\u54c1",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement(Ca,{dataSource:a,targetKeys:t,showSearch:!0,rowKey:function(e){return e.product_id},onChange:this.onChange,locale:{itemUnit:"\u9879",itemsUnit:"\u9879",notFoundContent:"\u5217\u8868\u4e3a\u7a7a",searchPlaceholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"},leftColumns:Oa,rightColumns:Na,titles:["\u53ef\u9009\u5546\u54c1","\u5df2\u9009\u5546\u54c1"],filterOption:function(e,t){return-1!==t.name.indexOf(e)}})))}}]),t}(i.a.Component),xa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.provide_id&&(a={},n=e.provide_id,ne({url:"/api/backend/products/stock/provides/".concat(n,"/stocks"),method:"get",params:a})).then(function(e){i.setState({data:e.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=[{title:"\u89c4\u683c",dataIndex:"spec"},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u5e93\u5b58",dataIndex:"stock",render:function(e,t){return i.a.createElement("div",{className:"warning"},e,i.a.createElement("span",{style:{display:t.stock_alert?"block":"none",marginLeft:"20px"}},i.a.createElement(de,{type:"icon-info-circle-fill"}),"\u8b66\u6212"))}},{title:"\u9500\u91cf",dataIndex:"total_sales"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return e.props.onSubmit(a)}},"\u8b66\u6212\u5e93\u5b58"))}}];return i.a.createElement("div",{className:"selectGoods"},i.a.createElement(ge.a,{title:"\u89c4\u683c",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:!1},i.a.createElement("div",{className:"selectGoodsChart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data}))))}}]),t}(i.a.Component),Ia=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category"},{title:"\u89c4\u683c",render:function(e,t){return t.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.setState({recordSpecVisible:!0,provide_id:t.provide_id})}},"\u67e5\u770b\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u5e93\u5b58",dataIndex:"stock",render:function(e,t){return i.a.createElement("div",{className:"warning"},e,i.a.createElement("span",{style:{display:t.stock_alert?"block":"none"}},i.a.createElement(de,{type:"icon-info-circle-fill"}),"\u8b66\u6212"))}},{title:"\u5b9e\u9645\u9500\u91cf",dataIndex:"total_sales"},{title:"\u865a\u62df\u9500\u91cf",dataIndex:"virtual_sales",render:function(e,t){return window.hasPermission("product_breakfast_book_set_virtual_sale")?i.a.createElement(ma.a,{className:"virtualSales",defaultValue:e,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||At({virtual_sales:e.target.value},t.provide_id).then(function(e){B.a.success(e.message)}).catch(function(e){})}}):i.a.createElement("span",null,e)}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("product_breakfast_book_set_sale_scope")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showSaleRange(t)}},"\u552e\u5356\u8303\u56f4"),window.hasPermission("product_breakfast_book_set_stock_alert")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showWarningStock(t)}},"\u8b66\u6212\u5e93\u5b58"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",channel:a.channel}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/goods/goodDetails",state:{id:e.product_id,path:"/goods/breakfastOrder",current:a.child.current.state.current}})},a.showSaleRange=function(e){a.setState({saleRange:!0,rangeId:e.provide_id,scope:e.sale_scope})},a.hideSaleRange=function(){a.setState({saleRange:!1})},a.search=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.setWarning=function(e){a.showWarningStock(e)},a.unSale=function(){var e=a.state.checkedAry,t=a.channel,n=a.refresh,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Tt({channel:t,product_ids:e}).then(function(e){B.a.success(e.message),n()}).catch(function(e){})}})},a.showWarningStock=function(e){e.open_specification?a.setState({recordSpecVisible:!0,provide_id:e.provide_id}):a.setState({warningStockVisible:!0,stock_id:e.stock_id})},a.hideWarningStock=function(){a.setState({warningStockVisible:!1})},a.onSubmitWarningStock=function(e,t){Rt({warning_stock:e},t).then(function(e){B.a.success(e.message),a.hideWarningStock(),a.refresh()}).catch(function(e){})},a.showShelfGoods=function(){a.setState({shelfGoodsVisible:!0})},a.hideShelfGoods=function(){a.setState({shelfGoodsVisible:!1})},a.onSubmitShelfGoods=function(e){jt({channel:a.channel,product_params:e}).then(function(e){B.a.success(e.message),a.hideShelfGoods(),a.refresh()}).catch(function(e){})},a.inStock=function(){a.props.history.push({pathname:"/goods/inStock",state:{channel:a.channel}})},a.outStock=function(){a.props.history.push({pathname:"/goods/outStock",state:{channel:a.channel}})},a.child=i.a.createRef(),a.channel="BREAKFAST_CAR",a.state={api:It,filterVisible:!1,warningStockVisible:!1,shelfGoodsVisible:!1,stock_id:"",provide_id:"",user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",channel:a.channel,searchJson:w({status:!0})},columns:n,recordSpecVisible:!1,rangeId:"",current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){console.log(t),e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(va,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(xa,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,onSubmit:this.setWarning,provide_id:this.state.provide_id}),i.a.createElement(_a,{visible:this.state.warningStockVisible,onCancel:this.hideWarningStock,onSubmit:this.onSubmitWarningStock,id:this.state.stock_id}),i.a.createElement(wa,{visible:this.state.shelfGoodsVisible,onCancel:this.hideShelfGoods,onSubmit:this.onSubmitShelfGoods}),i.a.createElement(Ea,{visible:this.state.saleRange,onCancel:this.hideSaleRange,rangeId:this.state.rangeId,scope:this.state.scope,refresh:this.refresh}),i.a.createElement("div",{className:"breakfast_header"},window.hasPermission("product_breakfast_book_put_on")&&i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showShelfGoods},"\u4e0a\u67b6\u5546\u54c1"),window.hasPermission("product_breakfast_book_add_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.inStock},i.a.createElement(de,{type:"icon-download"}),"\u5546\u54c1\u5165\u5e93"),window.hasPermission("product_breakfast_book_add_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.outStock},i.a.createElement(de,{type:"icon-upload"}),"\u5546\u54c1\u51fa\u5e93")),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("product_breakfast_book_get_off")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0b\u67b6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),ja=Object(U.g)(Ia),Ta=(a(1045),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onShopGroupChange=function(e){a.setState({where:[]});("shop"==e?et:ha)({}).then(function(t){a.setState({type:e,data:t.data})})},a.onShopChange=function(e){a.setState({where:e})},a.onTypeChange=function(e){a.setState({opt:e})},a.handleCancel=function(){a.setState({type:void 0,opt:void 0,where:void 0},function(){a.props.onCancel()})},a.handleSubmit=function(){a.state.where.length?a.state.opt?Lt({type:a.state.type,opt:a.state.opt,where:a.state.where},a.props.rangeId).then(function(e){B.a.success(e.message),a.props.refresh(),a.handleCancel()}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u7c7b\u578b"):B.a.error("\u8bf7\u9009\u62e9\u5e97\u94fa\u6216\u5e97\u94fa\u7ec4")},a.clearRange=function(){Mt({},a.props.rangeId).then(function(e){B.a.success(e.message),a.handleCancel()})},a.state={data:[],selectedItems:[],selectedGroupItems:[],selectedGroupShopsItems:[],activeShopGroup:"",type:void 0,opt:void 0,where:void 0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;if(this.setState({type:void 0,opt:void 0,where:void 0}),!y.a.isEmpty(e.scope)){var n=e.scope.hasOwnProperty("shop"),i=e.scope.hasOwnProperty("group"),r=null;n&&(r="shop"),i&&(r="group");("shop"==r?et:ha)({}).then(function(e){a.setState({type:r,data:e.data})}),this.setState({type:r,opt:e.scope[r].opt,where:e.scope[r].where})}}},{key:"componentDidMount",value:function(){var e=this;ha({}).then(function(t){e.setState({selectedGroupItems:t.data})})}},{key:"render",value:function(){return i.a.createElement("div",{className:"saleRange"},i.a.createElement(ge.a,{title:"\u552e\u5356\u8303\u56f4",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"clearRangeBox"},i.a.createElement(_e.a,{size:"small",className:"clearRange",onClick:this.clearRange}," \u6e05\u7a7a\u552e\u5356\u8303\u56f4")),i.a.createElement("div",{className:"saleRangeBox"},i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:300},onChange:this.onShopGroupChange,value:this.state.type,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u8303\u56f4"},i.a.createElement(Q.a.Option,{value:"shop"},"\u5e97\u94fa"),i.a.createElement(Q.a.Option,{value:"group"},"\u5e97\u94fa\u7ec4")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:82,marginLeft:5},onChange:this.onTypeChange,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u65b9\u5f0f",value:this.state.opt},i.a.createElement(Q.a.Option,{value:"in"},"\u53ea\u552e\u4e8e"),i.a.createElement(Q.a.Option,{value:"not in"},"\u4e0d\u552e\u4e8e")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:this.state.where,placeholder:"\u8bf7\u9009\u62e9\u8303\u56f4",className:"selectedBox tagBox",onChange:this.onShopChange,allowClear:!0,optionFilterProp:"children",optionLabelProp:"label",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.data.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})))))}}]),t}(i.a.Component)),Ra=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt})))}}]),t}(i.a.Component),Aa=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category"},{title:"\u89c4\u683c",render:function(e,t){return t.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.setState({recordSpecVisible:!0,provide_id:t.provide_id})}},"\u67e5\u770b\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u5e93\u5b58",dataIndex:"stock",render:function(e,t){return i.a.createElement("div",{className:"warning"},e,i.a.createElement("span",{style:{display:t.stock_alert?"block":"none"}},i.a.createElement(de,{type:"icon-info-circle-fill"}),"\u8b66\u6212"))}},{title:"\u5b9e\u9645\u9500\u91cf",dataIndex:"total_sales"},{title:"\u865a\u62df\u9500\u91cf",dataIndex:"virtual_sales",render:function(e,t){return window.hasPermission("product_merchant_book_set_virtual_sale")?i.a.createElement(ma.a,{className:"virtualSales",defaultValue:e,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||At({virtual_sales:e.target.value},t.provide_id).then(function(e){B.a.success(e.message)}).catch(function(e){})}}):i.a.createElement("span",null,e)}},{title:"\u662f\u5426\u53ef\u7528",dataIndex:"is_visible",render:function(e,t){return t.is_visible?"\u662f":"\u5426"}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("product_merchant_book_set_sale_scope")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showSaleRange(t)}},"\u552e\u5356\u8303\u56f4"),window.hasPermission("product_merchant_book_set_stock_alert")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showWarningStock(t)}},"\u8b66\u6212\u5e93\u5b58"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",channel:a.channel}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/goods/goodDetails",state:{id:e.product_id,path:"/goods/clientOrder",current:a.child.current.state.current}})},a.showSaleRange=function(e){a.setState({saleRange:!0,rangeId:e.provide_id,scope:e.sale_scope})},a.hideSaleRange=function(){a.setState({saleRange:!1})},a.search=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.setWarning=function(e){a.showWarningStock(e)},a.unSale=function(){var e=a.state.checkedAry,t=a.channel,n=a.refresh,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Tt({channel:t,product_ids:e}).then(function(e){B.a.success(e.message),n()}).catch(function(e){})}})},a.showWarningStock=function(e){e.open_specification?a.setState({recordSpecVisible:!0,provide_id:e.provide_id}):a.setState({warningStockVisible:!0,stock_id:e.stock_id})},a.hideWarningStock=function(){a.setState({warningStockVisible:!1})},a.onSubmitWarningStock=function(e,t){Rt({warning_stock:e},t).then(function(e){B.a.success(e.message),a.hideWarningStock(),a.refresh()}).catch(function(e){})},a.showShelfGoods=function(){a.setState({shelfGoodsVisible:!0})},a.hideShelfGoods=function(){a.setState({shelfGoodsVisible:!1})},a.onSubmitShelfGoods=function(e){jt({channel:a.channel,product_params:e}).then(function(e){B.a.success(e.message),a.hideShelfGoods(),a.refresh()}).catch(function(e){})},a.inStock=function(){a.props.history.push({pathname:"/goods/inStock",state:{channel:a.channel}})},a.outStock=function(){a.props.history.push({pathname:"/goods/outStock",state:{channel:a.channel}})},a.child=i.a.createRef(),a.channel="SHOP_KEEPER",a.state={api:It,filterVisible:!1,warningStockVisible:!1,shelfGoodsVisible:!1,stock_id:"",provide_id:"",user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",channel:a.channel},columns:n,recordSpecVisible:!1,rangeId:"",current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){console.log(t),e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(Ra,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(xa,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,onSubmit:this.setWarning,provide_id:this.state.provide_id}),i.a.createElement(_a,{visible:this.state.warningStockVisible,onCancel:this.hideWarningStock,onSubmit:this.onSubmitWarningStock,id:this.state.stock_id}),i.a.createElement(wa,{visible:this.state.shelfGoodsVisible,onCancel:this.hideShelfGoods,onSubmit:this.onSubmitShelfGoods}),i.a.createElement(Ta,{visible:this.state.saleRange,onCancel:this.hideSaleRange,rangeId:this.state.rangeId,scope:this.state.scope,refresh:this.refresh}),i.a.createElement("div",{className:"breakfast_header"},window.hasPermission("product_merchant_book_put_on")&&i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showShelfGoods},"\u4e0a\u67b6\u5546\u54c1"),window.hasPermission("product_merchant_book_add_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.inStock},i.a.createElement(de,{type:"icon-download"}),"\u5546\u54c1\u5165\u5e93"),window.hasPermission("product_merchant_book_out_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.outStock},i.a.createElement(de,{type:"icon-upload"}),"\u5546\u54c1\u51fa\u5e93")),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("product_merchant_book_get_off")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0b\u67b6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),Da=Object(U.g)(Aa),Pa=(a(1046),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onShopGroupChange=function(e){a.setState({where:[]});("shop"==e?et:ha)({}).then(function(t){a.setState({type:e,data:t.data})})},a.onShopChange=function(e){a.setState({where:e})},a.onTypeChange=function(e){a.setState({opt:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.where.length?a.state.opt?Lt({type:a.state.type,opt:a.state.opt,where:a.state.where},a.props.rangeId).then(function(e){B.a.success(e.message),a.handleCancel()}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u7c7b\u578b"):B.a.error("\u8bf7\u9009\u62e9\u5e97\u94fa\u6216\u5e97\u94fa\u7ec4")},a.state={data:[],selectedItems:[],selectedGroupItems:[],selectedGroupShopsItems:[],activeShopGroup:"",type:void 0,opt:void 0,where:void 0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;ha({}).then(function(t){e.setState({selectedGroupItems:t.data})})}},{key:"render",value:function(){return i.a.createElement("div",{className:"saleRange"},i.a.createElement(ge.a,{title:"\u552e\u5356\u8303\u56f4",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"saleRangeBox"},i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:300},onChange:this.onShopGroupChange,value:this.state.type,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u8303\u56f4"},i.a.createElement(Q.a.Option,{value:"shop"},"\u5e97\u94fa"),i.a.createElement(Q.a.Option,{value:"group"},"\u5e97\u94fa\u7ec4")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:82,marginLeft:5},onChange:this.onTypeChange,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u65b9\u5f0f"},i.a.createElement(Q.a.Option,{value:"in"},"\u53ea\u552e\u4e8e"),i.a.createElement(Q.a.Option,{value:"not in"},"\u4e0d\u552e\u4e8e")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:this.state.where,placeholder:"\u8bf7\u9009\u62e9\u8303\u56f4",className:"selectedBox tagBox",onChange:this.onShopChange,allowClear:!0,optionFilterProp:"children",optionLabelProp:"label",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.data.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})))))}}]),t}(i.a.Component)),Va=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt})))}}]),t}(i.a.Component),La=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category"},{title:"\u89c4\u683c",render:function(e,t){return t.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.setState({recordSpecVisible:!0,provide_id:t.provide_id})}},"\u67e5\u770b\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u5e93\u5b58",dataIndex:"stock",render:function(e,t){return i.a.createElement("div",{className:"warning"},e,i.a.createElement("span",{style:{display:t.stock_alert?"block":"none"}},i.a.createElement(de,{type:"icon-info-circle-fill"}),"\u8b66\u6212"))}},{title:"\u5b9e\u9645\u9500\u91cf",dataIndex:"total_sales"},{title:"\u865a\u62df\u9500\u91cf",dataIndex:"virtual_sales",render:function(e,t){return window.hasPermission("product_activity_book_set_virtual_sale")?i.a.createElement(ma.a,{className:"virtualSales",defaultValue:e,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||At({virtual_sales:e.target.value},t.provide_id).then(function(e){B.a.success(e.message)}).catch(function(e){})}}):i.a.createElement("span",null,e)}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("product_activity_book_set_sale_scope")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showSaleRange(t.provide_id)}},"\u552e\u5356\u8303\u56f4"),window.hasPermission("product_activity_book_set_stock_alert")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showWarningStock(t)}},"\u8b66\u6212\u5e93\u5b58"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",channel:a.channel}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/goods/goodDetails",state:{id:e.product_id,path:"/goods/activities",current:a.child.current.state.current}})},a.showSaleRange=function(e){a.setState({saleRange:!0,rangeId:e})},a.hideSaleRange=function(){a.setState({saleRange:!1})},a.search=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.setWarning=function(e){a.showWarningStock(e)},a.unSale=function(){var e=a.state.checkedAry,t=a.channel,n=a.refresh,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Tt({channel:t,product_ids:e}).then(function(e){B.a.success(e.message),n()}).catch(function(e){})}})},a.showWarningStock=function(e){e.open_specification?a.setState({recordSpecVisible:!0,provide_id:e.provide_id}):a.setState({warningStockVisible:!0,stock_id:e.stock_id})},a.hideWarningStock=function(){a.setState({warningStockVisible:!1})},a.onSubmitWarningStock=function(e,t){Rt({warning_stock:e},t).then(function(e){B.a.success(e.message),a.hideWarningStock(),a.refresh()}).catch(function(e){})},a.showShelfGoods=function(){a.setState({shelfGoodsVisible:!0})},a.hideShelfGoods=function(){a.setState({shelfGoodsVisible:!1})},a.onSubmitShelfGoods=function(e){jt({channel:a.channel,product_ids:e}).then(function(e){B.a.success(e.message),a.hideShelfGoods(),a.refresh()}).catch(function(e){})},a.inStock=function(){a.props.history.push({pathname:"/goods/inStock",state:{channel:a.channel}})},a.outStock=function(){a.props.history.push({pathname:"/goods/outStock",state:{channel:a.channel}})},a.child=i.a.createRef(),a.channel="BREAKFAST_PREORDER",a.state={api:It,filterVisible:!1,warningStockVisible:!1,shelfGoodsVisible:!1,stock_id:"",provide_id:"",user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",channel:a.channel},columns:n,recordSpecVisible:!1,rangeId:"",current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){console.log(t),e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(Va,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(xa,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,onSubmit:this.setWarning,provide_id:this.state.provide_id}),i.a.createElement(_a,{visible:this.state.warningStockVisible,onCancel:this.hideWarningStock,onSubmit:this.onSubmitWarningStock,id:this.state.stock_id}),i.a.createElement(wa,{visible:this.state.shelfGoodsVisible,onCancel:this.hideShelfGoods,onSubmit:this.onSubmitShelfGoods}),i.a.createElement(Pa,{visible:this.state.saleRange,onCancel:this.hideSaleRange,rangeId:this.state.rangeId}),i.a.createElement("div",{className:"breakfast_header"},window.hasPermission("product_activity_book_put_on")&&i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showShelfGoods},"\u4e0a\u67b6\u5546\u54c1"),window.hasPermission("product_activity_book_add_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.inStock},i.a.createElement(de,{type:"icon-download"}),"\u5546\u54c1\u5165\u5e93"),window.hasPermission("product_activity_book_out_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.outStock},i.a.createElement(de,{type:"icon-upload"}),"\u5546\u54c1\u51fa\u5e93")),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("product_activity_book_get_off")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0b\u67b6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),Ma=Object(U.g)(La),Ua=(a(1047),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onShopGroupChange=function(e){a.setState({where:[]});("shop"==e?et:ha)({}).then(function(t){a.setState({type:e,data:t.data})})},a.onShopChange=function(e){a.setState({where:e})},a.onTypeChange=function(e){a.setState({opt:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.where.length?a.state.opt?Lt({type:a.state.type,opt:a.state.opt,where:a.state.where},a.props.rangeId).then(function(e){B.a.success(e.message),a.handleCancel()}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u7c7b\u578b"):B.a.error("\u8bf7\u9009\u62e9\u5e97\u94fa\u6216\u5e97\u94fa\u7ec4")},a.state={data:[],selectedItems:[],selectedGroupItems:[],selectedGroupShopsItems:[],activeShopGroup:"",type:void 0,opt:void 0,where:void 0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;ha({}).then(function(t){e.setState({selectedGroupItems:t.data})})}},{key:"render",value:function(){return i.a.createElement("div",{className:"saleRange"},i.a.createElement(ge.a,{title:"\u552e\u5356\u8303\u56f4",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"saleRangeBox"},i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:300},onChange:this.onShopGroupChange,value:this.state.type,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u8303\u56f4"},i.a.createElement(Q.a.Option,{value:"shop"},"\u5e97\u94fa"),i.a.createElement(Q.a.Option,{value:"group"},"\u5e97\u94fa\u7ec4")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:82,marginLeft:5},onChange:this.onTypeChange,placeholder:"\u8bf7\u9009\u62e9\u552e\u5356\u65b9\u5f0f"},i.a.createElement(Q.a.Option,{value:"in"},"\u53ea\u552e\u4e8e"),i.a.createElement(Q.a.Option,{value:"not in"},"\u4e0d\u552e\u4e8e")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:this.state.where,placeholder:"\u8bf7\u9009\u62e9\u8303\u56f4",className:"selectedBox tagBox",onChange:this.onShopChange,allowClear:!0,optionFilterProp:"children",optionLabelProp:"label",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.data.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)})))))}}]),t}(i.a.Component)),Fa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt})))}}]),t}(i.a.Component),Ga=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category"},{title:"\u89c4\u683c",render:function(e,t){return t.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.setState({recordSpecVisible:!0,provide_id:t.provide_id})}},"\u67e5\u770b\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u5e93\u5b58",dataIndex:"stock",render:function(e,t){return i.a.createElement("div",{className:"warning"},e,i.a.createElement("span",{style:{display:t.stock_alert?"block":"none"}},i.a.createElement(de,{type:"icon-info-circle-fill"}),"\u8b66\u6212"))}},{title:"\u5b9e\u9645\u9500\u91cf",dataIndex:"total_sales"},{title:"\u865a\u62df\u9500\u91cf",dataIndex:"virtual_sales",render:function(e,t){return window.hasPermission("product_distribution_mall_book_set_virtual_sale")?i.a.createElement(ma.a,{className:"virtualSales",defaultValue:e,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||At({virtual_sales:e.target.value},t.provide_id).then(function(e){B.a.success(e.message)}).catch(function(e){})}}):i.a.createElement("span",null,e)}},{title:"\u662f\u5426\u53ef\u7528",dataIndex:"is_visible",render:function(e,t){return t.is_visible?"\u662f":"\u5426"}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("product_distribution_mall_book_set_sale_scope")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showSaleRange(t.provide_id)}},"\u552e\u5356\u8303\u56f4"),window.hasPermission("product_distribution_mall_book_set_stock_alert")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showWarningStock(t)}},"\u8b66\u6212\u5e93\u5b58"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",channel:a.channel}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/goods/goodDetails",state:{id:e.product_id,path:"/goods/distributionMall",current:a.child.current.state.current}})},a.showSaleRange=function(e){a.setState({saleRange:!0,rangeId:e})},a.hideSaleRange=function(){a.setState({saleRange:!1})},a.search=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.setWarning=function(e){a.showWarningStock(e)},a.unSale=function(){var e=a.state.checkedAry,t=a.channel,n=a.refresh,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Tt({channel:t,product_ids:e}).then(function(e){B.a.success(e.message),n()}).catch(function(e){})}})},a.showWarningStock=function(e){e.open_specification?a.setState({recordSpecVisible:!0,provide_id:e.provide_id}):a.setState({warningStockVisible:!0,stock_id:e.stock_id})},a.hideWarningStock=function(){a.setState({warningStockVisible:!1})},a.onSubmitWarningStock=function(e,t){Rt({warning_stock:e},t).then(function(e){B.a.success(e.message),a.hideWarningStock(),a.refresh()}).catch(function(e){})},a.showShelfGoods=function(){a.setState({shelfGoodsVisible:!0})},a.hideShelfGoods=function(){a.setState({shelfGoodsVisible:!1})},a.onSubmitShelfGoods=function(e){jt({channel:a.channel,product_params:e}).then(function(e){B.a.success(e.message),a.hideShelfGoods(),a.refresh()}).catch(function(e){})},a.inStock=function(){a.props.history.push({pathname:"/goods/inStock",state:{channel:a.channel}})},a.outStock=function(){a.props.history.push({pathname:"/goods/outStock",state:{channel:a.channel}})},a.child=i.a.createRef(),a.channel="DISTRIBUTION_MALL",a.state={api:It,filterVisible:!1,warningStockVisible:!1,shelfGoodsVisible:!1,stock_id:"",provide_id:"",user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",channel:a.channel},columns:n,recordSpecVisible:!1,rangeId:"",current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){console.log(t),e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(Fa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(xa,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,onSubmit:this.setWarning,provide_id:this.state.provide_id}),i.a.createElement(_a,{visible:this.state.warningStockVisible,onCancel:this.hideWarningStock,onSubmit:this.onSubmitWarningStock,id:this.state.stock_id}),i.a.createElement(wa,{visible:this.state.shelfGoodsVisible,onCancel:this.hideShelfGoods,onSubmit:this.onSubmitShelfGoods}),i.a.createElement(Ua,{visible:this.state.saleRange,onCancel:this.hideSaleRange,rangeId:this.state.rangeId}),i.a.createElement("div",{className:"breakfast_header"},window.hasPermission("product_distribution_mall_book_put_on")&&i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showShelfGoods},"\u4e0a\u67b6\u5546\u54c1"),window.hasPermission("product_distribution_mall_book_add_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.inStock},i.a.createElement(de,{type:"icon-download"}),"\u5546\u54c1\u5165\u5e93"),window.hasPermission("product_distribution_mall_book_out_stock")&&i.a.createElement(_e.a,{size:"small",onClick:this.outStock},i.a.createElement(de,{type:"icon-upload"}),"\u5546\u54c1\u51fa\u5e93")),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("product_distribution_mall_book_get_off")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0b\u67b6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),Ba=Object(U.g)(Ga),za=(a(1048),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={data:{}},a.goBack=function(){a.props.history.push({pathname:a.props.location.state.path,state:{current:a.props.location.state.current}})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e={searchJson:w({product_id:this.props.location.state.id})},ne({url:"/api/backend/products/show",method:"get",params:e})).then(function(e){if(e.batch.length){var a="";e.batch.forEach(function(t,n){n!==e.batch.length-1?a+="".concat(t,","):a+="".concat(t)}),e.batch=a}t.setState({data:e})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",null,i.a.createElement("div",{className:"u_top"},i.a.createElement("div",{className:"u_header"},i.a.createElement("span",null,"\u5546\u54c1\u8be6\u60c5"),i.a.createElement(_e.a,{type:"default",size:"small",onClick:this.goBack},"\u8fd4\u56de\u5546\u54c1\u5217\u8868")),i.a.createElement("div",{className:"u_body_one"},i.a.createElement("ul",{className:"u_body_top"},i.a.createElement("li",{className:"firstChild"},i.a.createElement("img",{src:t.thumbnail,alt:""})),i.a.createElement("li",null,i.a.createElement("p",null,"\u5546\u54c1\u540d\u79f0\uff1a",t.name),i.a.createElement("p",null,"\u5546\u54c1\u6761\u7801\uff1a",t.barcode),i.a.createElement("p",null,"\u5546\u54c1\u5c5e\u6027\uff1a",t.property_desc),i.a.createElement("p",null,"\u5546\u54c1\u5206\u7c7b\uff1a",t.category_desc)),i.a.createElement("li",null,i.a.createElement("p",null,"\u96f6\u552e\u4ef7\uff1a",t.retail_price),i.a.createElement("p",null,"\u5e02\u573a\u4ef7\uff1a",t.market_price),i.a.createElement("p",null,"\u6210\u672c\u4ef7\uff1a",t.cost_price)),i.a.createElement("li",null,i.a.createElement("p",null,"\u751f\u4ea7\u529b\u6307\u6570\uff1a",t.pv),i.a.createElement("p",null,"\u914d\u9001\u6279\u6b21\uff1a",t.batch),i.a.createElement("p",null,"\u4fdd\u5b58\u65b9\u5f0f\uff1a",t.keep_mode_desc),i.a.createElement("p",null,"\u5546\u54c1\u72b6\u6001\uff1a111")),i.a.createElement("li",{className:"goodDesp"},i.a.createElement("p",null,i.a.createElement("span",null,"\u5546\u54c1\u7b80\u4ecb\uff1a"),i.a.createElement("span",null,t.intro)),i.a.createElement("p",null,i.a.createElement("span",null,"\u5546\u54c1\u63cf\u8ff0\uff1a"),i.a.createElement("span",null,t.desc)),i.a.createElement("p",null,i.a.createElement("span",null,"\u5206\u4eab\u63cf\u8ff0\uff1a"),i.a.createElement("span",null,t.share_desc)))))),i.a.createElement("div",{className:"u_body_three"},i.a.createElement("ul",{className:"u_body_three_list"},i.a.createElement("li",null,i.a.createElement("div",{className:"li_header"},"\u9500\u91cf"),i.a.createElement("div",{className:"li_body"},i.a.createElement("ul",null,i.a.createElement("li",{className:"ranking"},i.a.createElement("h4",null,"\u603b\u9500\u91cf:",i.a.createElement("span",null,t.total_sales))),i.a.createElement("li",{className:"ranking"},i.a.createElement("h4",null,"\u8ba2\u8d27\u5355\u9500\u91cf:",i.a.createElement("span",null,t.total_order_product_sales))),i.a.createElement("li",{className:"ranking"},i.a.createElement("h4",null,"\u9884\u8ba2\u5355\u9500\u91cf:",i.a.createElement("span",null,t.total_preorder_sales)))))),i.a.createElement("li",null,i.a.createElement("div",{className:"li_header"},"\u6392\u540d"),i.a.createElement("div",{className:"li_body"},i.a.createElement("ul",null,i.a.createElement("li",{className:"ranking"},i.a.createElement("h4",null,"\u6392\u540d:",i.a.createElement("span",null,t.ranking))),i.a.createElement("li",{className:"ranking"},i.a.createElement("h4",null,"\u5206\u7c7b\u4e2d\u6392\u884c:",i.a.createElement("span",null,t.category_ranking)))))))),i.a.createElement("div",{className:"u_body_groups"},i.a.createElement("div",{className:"group_header"},"\u5e97\u94fa\u7ec4"),i.a.createElement("div",{className:"group_tags"},t.groups&&t.groups.length?this.state.data.groups.map(function(t){return i.a.createElement(Gt.a,{closable:!0,key:t.id,onClose:function(){return e.removeGroup(t.id)}},t.name)}):"")))}}]),t}(i.a.Component)),Ha=Object(U.g)(za),Ka=(a(1049),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).id=e.location.state.id,a.state={data:{},tableData:[],remark:"1",type:"2",time:"3"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Ft({},this.id).then(function(t){e.setState({data:t.data,tableData:t.data.stockLogs.data}),console.log(t)}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",{className:"inStockDetail"},i.a.createElement("div",{className:"header"},"\u5165\u5e93\u8be6\u60c5",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement("span",{className:"title"},"\u57fa\u672c\u4fe1\u606f"),i.a.createElement("div",{className:"filter"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",{className:"needMargin"},"\u5165\u5e93\u7c7b\u578b\uff1a",t.stock_type),i.a.createElement("li",{className:"needMargin"},"\u5165\u5e93\u65f6\u95f4\uff1a",t.batch_date),i.a.createElement("li",null,"\u5907\u6ce8\uff1a",t.remark))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement("span",{className:"title"},"\u5165\u5e93\u5546\u54c1"),t.statistic?i.a.createElement("p",null,"\u5171",t.statistic.products_type_count,"\u4e2asku\uff0c\u5165\u5e93\u6570\u91cf",t.statistic.products_count,"\uff0c\u5408\u8ba1\u91d1\u989d",t.statistic.money_count,"\u5143"):"",i.a.createElement(ve.a,{columns:[{title:"\u5546\u54c1",dataIndex:"stock.data.productEntity.data.name"},{title:"\u89c4\u683c",dataIndex:"stock.data.spec"},{title:"\u5206\u7c7b",dataIndex:"stock.data.productEntity.data.category_desc"},{title:"\u5165\u5e93\u6570\u91cf",dataIndex:"quantity"},{title:"\u6210\u672c\u4ef7",dataIndex:"stock.data.productEntity.data.cost_price"},{title:"\u5c0f\u8ba1",dataIndex:"amount"}],rowKey:function(e){return e.stock_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.tableData}))))}}]),t}(i.a.Component)),Ja=a(48),Wa=(a(533),[{value:"money_attributes",label:"\u91d1\u989d\u5c5e\u6027",children:[{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee",type:"numCompare"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee",type:"numCompare"},{label:"\u6210\u672c\u603b\u989d",value:"cost_amount",type:"numCompare"},{label:"\u4f18\u60e0\u91d1\u989d",value:"total_preferential_fee",type:"numCompare"},{label:"\u9000\u6b3e\u91d1\u989d",value:"refund_fee",type:"numCompare"},{label:"\u4ed8\u6b3e\u65b9\u5f0f",value:"payment_type",type:"equalCompare"}]},{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u53f7",value:"trade_no",type:"absoluteCompare"},{label:"\u7528\u6237\u6635\u79f0",value:"user_nickname",type:"emptyCompare"},{label:"\u7528\u6237\u624b\u673a\u53f7",value:"user_mobile",type:"emptyCompare"},{label:"\u652f\u4ed8\u6d41\u6c34\u53f7",value:"transaction_id",type:"absoluteCompare"}]},{value:"order_attribution",label:"\u8ba2\u5355\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u72b6\u6001",value:"state",type:"consumerOrder"},{label:"\u914d\u9001\u7c7b\u578b",value:"delivery_type",type:"deliveryType"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at",type:"timeCompare"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u6838\u9500\u65f6\u95f4",value:"verified_at",type:"timeCompare"},{label:"\u9884\u671f\u6536\u8d27\u65f6\u95f4",value:"expect_receive_date",type:"times"},{label:"\u5546\u54c1",value:"product_name",type:"equalCompare"},{label:"\u81ea\u63d0\u5e97\u94fa\u540d\u79f0",value:"shop_name",type:"equalCompare"},{label:"\u81ea\u63d0\u5e97\u94fa\u7f16\u53f7",value:"shop_code",type:"equalCompare"},{label:"\u8ba2\u5355\u7c7b\u578b",value:"order_type",type:"consumerType"},{label:"\u6536\u8d27\u5730\u533a",value:"region",type:"detailAddress"},{label:"\u9500\u552e\u8d21\u732e\u989d\u5ea6",value:"sales_amount",type:"numCompare"}]}]),Ya={dataCompare:[{label:"\u7b49\u4e8e",value:"=",type:"times"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"times"},{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"dateRange"}],summaryOrderType:[{label:"\u7b49\u4e8e",value:"=",type:"summaryOrderType"}],absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],detailAddress:[{label:"\u7b49\u4e8e",value:"like",type:"orderDetailAddress"}],timeDetailCompare:[{label:"\u7b49\u4e8e",value:"=",type:"detailTime"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"detailTime"},{label:"\u665a\u4e8e",value:">",type:"detailTime"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"detailTime"},{label:"\u65e9\u4e8e",value:"<",type:"detailTime"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"detailTime"},{label:"\u533a\u95f4",value:"between",type:"periodDetailTime"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],consumerType:[{label:"\u7b49\u4e8e",value:"=",type:"consumerTypeEqual"}],consumerOrder:[{label:"\u7b49\u4e8e",value:"=",type:"consumerOrderEqual"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u4e2d",value:"all",type:"consumerOrder"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"consumerOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"consumerOrder"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTypeEqual"}],merchantOrder:[{label:"\u7b49\u4e8e",value:"in",type:"merchantOrderEqual"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"all",type:"merchantOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"merchantOrder"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],times:[{label:"\u7b49\u4e8e",value:"=",type:"times"}],timeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"timestamp"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"timestamp"},{label:"\u665a\u4e8e",value:">",type:"timestamp"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"timestamp"},{label:"\u65e9\u4e8e",value:"<",type:"timestamp"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"timestamp"},{label:"\u533a\u95f4",value:"between",type:"period"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},qa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.export=function(){a.props.export(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.slug?this.props.slug:"order";return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,window.hasPermission("order_management_export")&&i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.export},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:this.props.data,operation:Ya,slug:e,api:{groups:ha,goodsOrder:!0}})))}}]),t}(i.a.Component),Xa=(a(534),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={items:[],text:"\u5546\u54c1"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.items)if(e.items&&e.items.length){var a=e.items;a.forEach(function(e){var t=[];for(var a in e.product_spec_value)t.push(e.product_spec_value[a]);e.spec_desc=t.join(",")}),this.setState({items:a,text:e.text})}else{if(!e.items||!e.items.data||!e.items.data.length)return;var n=e.items.data;n.forEach(function(e){var t=[];for(var a in e.spec_value)t.push(e.spec_value[a]);e.spec_desc=t.join(",")}),this.setState({items:n,text:e.text})}}},{key:"render",value:function(){var e=this.state.items;return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u5546\u54c1",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"reviews"},e&&e.length&&e.map(function(e){return i.a.createElement("li",{key:e.item_id},i.a.createElement("img",{src:e.thumbnail,alt:"",className:"left"}),i.a.createElement("div",{className:"right"},i.a.createElement("span",null,"\u5546\u54c1\u540d:",e.name||e.product_name),i.a.createElement("span",null,"\u89c4\u683c:",e.spec_desc||"\u65e0"),i.a.createElement("span",null,"\u6570\u91cf:",e.quantity),i.a.createElement("span",null,"\u96f6\u552e\u4ef7:",e.price+"\u5143"),i.a.createElement("span",null,"\u5907\u6ce8:",e.remark||"\u65e0")))}))))}}]),t}(i.a.Component));function $a(e,t){return ne({url:"/api/backend/orders/".concat(t,"/to_complete"),method:"post",data:e})}function Qa(e){return ne({url:"/api/backend/orders/users",method:"get",params:e})}function Za(e){return ne({url:"/api/backend/orders/users/refunds",method:"get",params:e})}function en(e){return ne({url:"/api/backend/orders/agents",method:"get",params:e})}function tn(e,t){return ne({url:"/api/backend/orders/refunds/".concat(t,"/confirm_refund"),method:"post",data:e})}function an(e,t){return ne({url:"/api/backend/orders/refunds/".concat(t,"/refuse_refund"),method:"post",data:e})}function nn(e){return ne({url:"/api/backend/orders/agents/summary_orders",method:"get",params:e})}function rn(e){return ne({url:"/api/backend/orders/to_complete",method:"post",data:e})}function ln(e){return ne({url:"/api/backend/orders/to_complete",method:"POST",data:{order_ids:e}})}for(var sn=[{value:"money_attributes",label:"\u91d1\u989d\u5c5e\u6027",children:[{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee",type:"numCompare"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee",type:"numCompare"},{label:"\u6210\u672c\u603b\u989d",value:"cost_amount",type:"numCompare"},{label:"\u4f18\u60e0\u91d1\u989d",value:"total_preferential_fee",type:"numCompare"},{label:"\u9000\u6b3e\u91d1\u989d",value:"refund_fee",type:"numCompare"},{label:"\u4ed8\u6b3e\u65b9\u5f0f",value:"payment_type",type:"equalCompare"}]},{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u53f7",value:"trade_no",type:"absoluteCompare"},{label:"\u7528\u6237\u6635\u79f0",value:"user_nickname",type:"emptyCompare"},{label:"\u7528\u6237\u624b\u673a\u53f7",value:"user_mobile",type:"emptyCompare"},{label:"\u652f\u4ed8\u6d41\u6c34\u53f7",value:"transaction_id",type:"absoluteCompare"},{label:"\u6536\u8d27\u4eba\u4fe1\u606f",value:"shipping_info",type:"absoluteCompare"},{label:"\u81ea\u63d0\u70b9\u540d\u79f0",value:"shop_name",type:"absoluteCompare"}]},{value:"order_attribution",label:"\u8ba2\u5355\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u72b6\u6001",value:"state",type:"consumerOrder"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at",type:"timeCompare"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u9884\u671f\u6536\u8d27\u65f6\u95f4",value:"expect_receive_date",type:"times"},{label:"\u5546\u54c1",value:"products",type:"equalCompare"},{label:"\u8ba2\u5355\u7c7b\u578b",value:"order_type",type:"consumerOrder"},{label:"\u81ea\u63d0\u5e97\u94fa\u7f16\u53f7",value:"shop_code",type:"equalCompare"},{label:"\u4e0a\u7ebf\u5e97\u94fa",value:"superior_shop_name",type:"equalCompare"},{label:"\u4e0a\u7ebf\u5e97\u94fa\u7f16\u53f7",value:"superior_shop_code",type:"equalCompare"}]}],cn=[{value:"money_attributes",label:"\u91d1\u989d\u5c5e\u6027",children:[{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee",type:"numCompare"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee",type:"numCompare"},{label:"\u6210\u672c\u603b\u989d",value:"cost_amount",type:"numCompare"},{label:"\u4f18\u60e0\u91d1\u989d",value:"total_preferential_fee",type:"numCompare"},{label:"\u9000\u6b3e\u91d1\u989d",value:"refund_fee",type:"numCompare"},{label:"\u4ed8\u6b3e\u65b9\u5f0f",value:"payment_type",type:"equalCompare"}]},{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u53f7",value:"trade_no",type:"absoluteCompare"},{label:"\u7528\u6237\u6635\u79f0",value:"user_nickname",type:"emptyCompare"},{label:"\u7528\u6237\u624b\u673a\u53f7",value:"user_mobile",type:"emptyCompare"},{label:"\u652f\u4ed8\u6d41\u6c34\u53f7",value:"transaction_id",type:"absoluteCompare"}]},{value:"order_attribution",label:"\u8ba2\u5355\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u72b6\u6001",value:"state",type:"consumerOrder"},{label:"\u914d\u9001\u7c7b\u578b",value:"delivery_type",type:"deliveryType"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at",type:"timeCompare"},{label:"\u9884\u671f\u6536\u8d27\u65f6\u95f4",value:"expect_receive_date",type:"times"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u5546\u54c1",value:"product_name",type:"equalCompare"},{label:"\u81ea\u63d0\u5e97\u94fa\u540d\u79f0",value:"shop_name",type:"equalCompare"},{label:"\u81ea\u63d0\u5e97\u94fa\u7f16\u53f7",value:"shop_code",type:"equalCompare"},{label:"\u8ba2\u5355\u7c7b\u578b",value:"order_type",type:"consumerOrder"},{label:"\u6536\u8d27\u5730\u533a",value:"region",type:"detailAddress"},{label:"\u9500\u552e\u8d21\u732e\u989d\u5ea6",value:"sales_amount",type:"numCompare"}]}],on=(a(1050),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e=[];for(var t in a.state)console.log(t,"..."),-1!==t.indexOf("value")&&e.push(a.state[t]);var n=[];y.a.map(e,function(e){-1!==e.indexOf(" ")?n=n.concat(e.split(" ")):-1!==e.indexOf(",")?n=n.concat(e.split(",")):-1!==e.indexOf("\uff0c")?n=n.concat(e.split("\uff0c")):n.push(e)}),a.props.onSubmit(n)},a.createInput=function(e){var t=a.state.inputAmount;t.push(t.length+1);var n="value".concat(t.length);a.setState(Object(Y.a)({inputAmount:t},n,""))},a.delete=function(e){var t=a.state.inputAmount;t.splice(e,1),a.setState({inputAmount:t})},a.inputChange=function(e,t){var n="value"+t;a.setState(Object(Y.a)({},n,e.target.value))},a.state={inputAmount:[1],value1:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){}},{key:"render",value:function(){var e=this,t=this.state.inputAmount;return i.a.createElement("div",null,i.a.createElement("div",{className:"changeOrderStatus"},i.a.createElement(ge.a,{title:"\u6838\u5b9e\u8ba2\u5355",width:520,type:"number",visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},t.map(function(t,a){return i.a.createElement("div",{key:a},i.a.createElement(Ne.a,{className:"changeorder",placeholder:"\u8bf7\u8f93\u5165\u8ba2\u5355\u7f16\u53f7",onPressEnter:e.createInput,value:e.state["value"+t],onChange:function(a){return e.inputChange(a,t)}}),a>0&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return e.delete(a)}},"\u5220\u9664"))}))))}}]),t}(n.Component)),un=(a(149),a(59)),mn=(a(77),a(18)),dn=(a(1051),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).setOrderItems=function(){if(a.props.values&&a.props.values.length){var e=[],t=a.props.values.concat();y.a.map(t,function(t){y.a.map(t.children,function(t){e.push(t)})}),a.setState({orderItems:e})}},a.handleCancel=function(){a.props.onCancel()},a.onRadioChange=function(e){console.log("radio checked",e.target.value),a.setState({value:e.target.value,showSelector:!e.target.showSelector||e.target.showSelector},function(){console.log(a.state.value,"+++++++++++++++")})},a.handleChange=function(e){a.setState({selectedItems:e})},a.handleSubmit=function(){"USER_ORDER_CUSTOMIZE"!==a.state.value||a.state.selectedItems.length?a.props.isToday?(console.log("isToday"),a.props.exportToday(a.state.value,a.state.selectedItems)):(console.log("is not today"),a.props.export(a.state.value,a.state.selectedItems,a.props.conditions)):B.a.error("\u8bf7\u5148\u9009\u62e9\u81ea\u5b9a\u4e49\u663e\u793a\u9879")},a.onCheckboxChange=function(e){var t=e.target.checked,n=[];y.a.map(a.state.orderItems,function(e){n.push(a.props.slug+e.value)}),t?a.setState({selectedItems:n}):a.setState({selectedItems:[]})},a.state={value:e.strategy[0].key,showSelector:!0,selectedItems:[],orderItems:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setOrderItems()}},{key:"render",value:function(){var e=this,t=this.state.selectedItems;return i.a.createElement("div",{className:"export"},i.a.createElement(ge.a,{title:"\u9009\u62e9\u5bfc\u51fa\u65b9\u5f0f",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,maskClosable:!1},i.a.createElement(mn.a.Group,{className:"exportContent",onChange:this.onRadioChange,value:this.state.value},this.props.strategy.map(function(e){return i.a.createElement(mn.a,{value:e.key,key:e.key},e.value)})),this.state.showSelector&&i.a.createElement("div",{className:"selectItems"},i.a.createElement("span",null,"\u9009\u62e9\u663e\u793a\u9879"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"multiple",value:t,className:"exportItems",onChange:this.handleChange,optionLabelProp:"label",allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.orderItems.map(function(t){return i.a.createElement(Q.a.Option,{key:e.props.slug+t.value,label:t.label,value:e.props.slug+t.value},t.label)})),i.a.createElement(un.a,{onChange:this.onCheckboxChange},"\u5168\u9009"))))}}]),t}(n.Component)),pn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){for(var e=a.state.order,t=[],n=0;n<e.items.data.length;n++){var i=e.items.data[n];if(i.damaged_quantity>i.quantity)return void B.a.error("\u7834\u635f\u6570\u91cf\u4e0d\u53ef\u5927\u4e8e\u8be5\u5546\u54c1\u603b\u6570");if(i.deficient_quantity>i.quantity)return void B.a.error("\u7f3a\u5c11\u6570\u91cf\u4e0d\u53ef\u5927\u4e8e\u8be5\u5546\u54c1\u603b\u6570");if(Number(i.damaged_quantity)+Number(i.deficient_quantity)>i.quantity)return void B.a.error("\u7f3a\u635f\u6570\u91cf\u4e0d\u53ef\u5927\u4e8e\u8be5\u5546\u54c1\u603b\u6570");var r={};r.id=i.item_id,r.damaged=Number(i.damaged_quantity),r.deficient=Number(i.deficient_quantity),t.push(r)}a.props.onSubmit(e.id,t,!0)},a.handleInput=function(e,t,n){n[t]=e;var i=a.state.order;y.a.map(i.items.data,function(e){e["item.id"]===n["item.id"]&&(e=n)}),a.setState({order:i})},a.state={order:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.problemOrder.id&&this.setState({order:e.problemOrder})}},{key:"render",value:function(){var e=this,t=this.state.order,a=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u6570\u91cf",dataIndex:"quantity"},{title:"\u7f3a\u8d27",dataIndex:"deficient_quantity",render:function(t,a){return i.a.createElement(ma.a,{className:"inputs",defaultValue:t||0,onBlur:function(t){t.target.value=t.target.value<0?0:t.target.value,t.target.value<=0||e.handleInput(t.target.value,"deficient_quantity",a)}})}},{title:"\u7834\u635f",dataIndex:"damaged_quantity",render:function(t,a){return i.a.createElement(ma.a,{className:"inputs",defaultValue:t||0,onBlur:function(t){t.target.value=t.target.value<0?0:t.target.value,t.target.value<=0||e.handleInput(t.target.value,"damaged_quantity",a)}})}}];return i.a.createElement("div",null,i.a.createElement("div",{className:"checkOrder"},i.a.createElement(ge.a,{title:"\u5546\u54c1\u5f02\u5e38",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},t.id&&t.items.data&&t.items.data.length&&i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:a,rowKey:function(e){return e.item_id},pagination:!1,dataSource:t.items.data})))))}}]),t}(n.Component),hn=(a(535),Q.a.Option),fn=[],En=[],vn=24,_n=0;_n<vn;_n++)fn.push({label:"".concat(_n,"\u70b9"),value:_n}),En.push({label:"".concat(_n+1,"\u70b9"),value:_n+1});var gn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={regions:[],position:[],deliveryDate:J()(),deliveryStartTime:0,deliveryEndTime:24},a.onPositionChange=function(e){a.setState({position:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e=a.state.position,t=y.a.findIndex(e,function(e){return"deliveryOrders"===a.props.type?"\u5168\u90e8"===e:!e}),n={};t>-1?1===t&&e[t-1]?(n.key="deliveryOrders"===a.props.type?"province":"shop_province_code",n.value=e[t-1]):2===t&&e[t-1]&&(n.key="deliveryOrders"===a.props.type?"city":"shop_city_code",n.value=e[t-1]):e[e.length-1]&&(n.key="deliveryOrders"===a.props.type?"area":"shop_area_code",n.value=e[e.length-1]);var i=null,r=null;a.props.deliveryDateShow&&(i=a.state.deliveryDate.format("YYYY-MM-DD")),a.props.deliveryTimeShow&&(r=["".concat(a.state.deliveryStartTime,":00:00"),"".concat(a.state.deliveryEndTime<vn?a.state.deliveryEndTime+":00:00":"23:59:59")]),a.props.submit(n,i,r),a.handleCancel()},a.selectDate=function(e){console.log(e,"---------------"),a.setState({deliveryDate:e})},a.selectStartTime=function(e){a.setState({deliveryStartTime:e})},a.selectEndTime=function(e){a.setState({deliveryEndTime:e})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;xe({}).then(function(t){t.forEach(function(e){e.children.forEach(function(e){e.children.unshift({region_code:null,name:"\u5168\u90e8",children:[]})}),e.children.unshift({region_code:null,name:"\u5168\u90e8",children:[]})}),e.setState({regions:t})}).catch(function(e){})}},{key:"render",value:function(){var e=this;this.state.selectedItems;return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u67e5\u8be2\u6761\u4ef6",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},this.props.deliveryDateShow?i.a.createElement("li",null,i.a.createElement("span",null,"\u914d\u9001\u65e5\u671f:"),i.a.createElement(G.a,{defaultValue:this.state.deliveryDate,onChange:this.selectDate})):"",this.props.deliveryTimeShow?i.a.createElement("li",null,i.a.createElement("span",null,"\u914d\u9001\u65f6\u95f4:"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(Q.a,{style:{width:120},defaultValue:this.state.deliveryStartTime,onChange:this.selectStartTime},fn.map(function(t,a){return e.state.deliveryEndTime<=t.value?"":i.a.createElement(hn,{key:a,value:t.value},t.label)})),i.a.createElement("span",{style:{margin:"6px"}},"\u5230"),i.a.createElement(Q.a,{style:{width:120},defaultValue:this.state.deliveryEndTime,onChange:this.selectEndTime},En.map(function(t,a){return e.state.deliveryStartTime>=t.value?"":i.a.createElement(hn,{key:a,value:t.value},t.label)})))):"",i.a.createElement("li",null,i.a.createElement("span",null,"\u5730\u533a:")," ","deliveryOrders"===this.props.type?i.a.createElement(Oe.a,{options:this.state.regions,onChange:this.onPositionChange,placeholder:"\u8bf7\u9009\u62e9\u7701\u5e02\u533a",fieldNames:{label:"name",value:"name",children:"children"},className:"positionCascader"}):i.a.createElement(Oe.a,{options:this.state.regions,onChange:this.onPositionChange,placeholder:"\u8bf7\u9009\u62e9\u7701\u5e02\u533a",className:"positionCascader",fieldNames:{label:"name",value:"region_code",children:"children"}})))))}}]),t}(i.a.Component),bn=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5546\u54c1",dataIndex:"category_desc",render:function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"user_nickname"},{title:"\u914d\u9001\u7c7b\u578b",dataIndex:"delivery_type"},{title:"\u652f\u4ed8\u65f6\u95f4",dataIndex:"paid_at"},{title:"\u8ba2\u5355\u72b6\u6001",dataIndex:"state_desc",render:function(e,t){return t.shop_name||"WAIT_CUSTOMER_VERIFY"!==t.state?e:"\u5f85\u6536\u8d27"}}],r=[{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5546\u54c1",dataIndex:"category_desc",render:function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"user_nickname"},{title:"\u914d\u9001\u7c7b\u578b",dataIndex:"delivery_type"},{title:"\u652f\u4ed8\u65f6\u95f4",dataIndex:"paid_at"},{title:"\u8ba2\u5355\u72b6\u6001",dataIndex:"state_desc",render:function(e,t){return t.shop_name||"WAIT_CUSTOMER_VERIFY"!==t.state?e:"\u5f85\u6536\u8d27"}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("span",{style:{color:"#4f9863",cursor:"pointer"},onClick:function(){return a.checkOrder(t)}},"\u624b\u52a8\u6838\u9500")}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ALL";a.setState({filterVisible:!1,checkedAry:[],paginationParams:{logic_conditions:[],searchJson:w({state_constant:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/order/orderDetail",state:{id:e.id,path:"/order",current:a.child.current.state.current}})},a.search=function(e){a.setState({api:Qa,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,state_constant:a.state.activeTab})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Qa,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];console.log(e),e.forEach(function(e){cn.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({data:e})},a.onChangeTab=function(e){console.log(e,"........"),"WAIT_CUSTOMER_VERIFY_HOME"!==e.key?"WAIT_CUSTOMER_VERIFY"!==e.key?(a.setState({activeTab:e.key}),a.refresh(e.key)):a.setState({api:Qa,activeTab:e.key,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({delivery_type:"SELF_PICK",state_constant:"WAIT_CUSTOMER_VERIFY"})})},function(){a.child.current.pagination(a.child.current.state.current)}):a.setState({api:Qa,activeTab:e.key,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({delivery_type:"HOME_DELIVERY",state_constant:"WAIT_CUSTOMER_VERIFY"})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.confirmPopover=function(e,t){var n=a.refresh,r=Object(Ja.a)(a),l=a.state.checkedAry,s=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){s.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",t,"\u8be5\u8ba2\u5355\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){e({order_ids:l}).then(function(e){B.a.success("".concat(t,"\u8ba2\u5355\u6210\u529f\uff01")),r.setState({checkedAry:[]}),n("WAIT_PLATFORM_VERIFY")})},onCancel:function(){}})},a.showCheckinNormal=function(e){a.setState({checkVisible:!0,problemOrder:e})},a.hideCheckNormal=function(){a.setState({checkVisible:!1})},a.checkInNormalOrder=function(e,t,n){$a({is_exception:n,items:t},e).then(function(e){B.a.success("\u624b\u52a8\u6838\u9500\u8ba2\u5355\u6210\u529f\uff01"),a.hideCheckNormal(),a.refresh("WAIT_CUSTOMER_VERIFY")})},a.checkOrder=function(e){var t=a.refresh,n=a.showCheckinNormal,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u624b\u52a8\u6838\u9500\u8be5\u8ba2\u5355\u4e48\uff1f"),cancelText:"\u5546\u54c1\u5f02\u5e38",okText:"\u76f4\u63a5\u6838\u9500",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){$a({is_exception:!1},e.id).then(function(e){B.a.success("\u624b\u52a8\u6838\u9500\u8ba2\u5355\u6210\u529f\uff01"),t("WAIT_CUSTOMER_VERIFY")})},onCancel:function(){n(e)}})},a.reviewGoods=function(e,t){a.setState({reviewGoodsVisible:!0,items:e,text:t})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.setMessage=function(){a.props.history.push({pathname:"/order/setUserMessage",state:{mode:"user"}})},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0,isToday:!1},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){console.log(e,"--- type---"),console.log(a,">>>>>>>>>>>>>>>>>>>>>>>>>>");var n=w({strategy:e,customize_columns:t,logic_conditions:a});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.print=function(){var e=a.state,t=e.checkedAry,n=e.data,i=[];y.a.map(n,function(e){y.a.indexOf(t,e.id)>-1&&i.push(e)}),a.props.history.push({pathname:"/printSheet",state:{orders:i,title:"\u987e\u5ba2\u8ba2\u5355"}})},a.conditions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=a.state.position,n=[{key:"order_order_type",operation:"in",value:e||["SELF_PICK","GROUP_SHOPPING"]},{key:"order_delivery_type",operation:"=",value:e?"HOME_DELIVERY":"SELF_PICK"},{key:"order_state",operation:"in",value:["WAIT_AGENT_VERIFY","WAIT_CUSTOMER_VERIFY"]}];if(t&&t.key){var i={key:"order_".concat(t.key),operation:"like",value:t.value};n.push(i)}if(a.state.deliveryDate){var r={key:"order_delivery_date",operation:"=",value:a.state.deliveryDate};n.push(r)}if(a.state.deliveryTime){var l={key:"order_delivery_time_period",operation:"between",value:a.state.deliveryTime};n.push(l)}return{conditions:n,logic:"and"}},a.todayOrders=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a.setState({api:Qa,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:a.conditions(e)})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.conditionSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(){a.setState({positionVisible:!0,orderTypes:t,exportTable:e})}},a.hidePosition=function(){a.setState({positionVisible:!1})},a.submitCondition=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;a.setState({deliveryTime:n,deliveryDate:t,position:e},function(){a.state.exportTable?a.exportTodayOrders():a.todayOrders(a.state.orderTypes)})},a.exportTodayOrders=function(){a.setState({exportVisible:!0,isToday:!0})},a.exportToday=function(e,t){console.log(a.state.orderTypes);var n=w({strategy:e,customize_columns:t,logic_conditions:a.conditions(a.state.orderTypes)});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.changeOrderStatus=function(){a.setState({changeOrderStatusVisible:!0})},a.submitChangeOrderStatus=function(e){var t;console.log(e,"|||"),(t={orders:e},ne({url:"/api/backend/orders/force/make/paid",method:"put",data:t})).then(function(e){B.a.success(e.data.message),a.hideChangeOrderStatus(),a.refresh()})},a.hideChangeOrderStatus=function(){a.setState({changeOrderStatusVisible:!1})},a.checkManyOrders=function(){var e=Object(Ja.a)(a),t=a.state.checkedAry,n=a.state.activeTab,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u6279\u91cf\u6838\u9500\u8be5\u8ba2\u5355\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){rn({order_ids:t}).then(function(t){B.a.success("\u6279\u91cf\u6838\u9500\u8ba2\u5355\u6210\u529f\uff01"),e.setState({api:Qa,activeTab:n,paginationParams:Object(be.a)({},e.state.paginationParams,{searchJson:w({delivery_type:"SELF_PICK",state_constant:"WAIT_CUSTOMER_VERIFY"})})},function(){e.child.current.pagination(1)})})},onCancel:function(){}})},a.child=i.a.createRef(),a.state={api:Qa,filterVisible:!1,customVisible:!1,reviewGoodsVisible:!1,exportVisible:!1,columns:n,sColumns:r,defaultItem:["user_nickname","trade_no","products","settlement_total_fee","delivery_type","created_at","state_desc"],data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:""},activeTab:"ALL",items:[],conditions:{},current:1,problemOrder:{},isToday:!1,changeOrderStatusVisible:!1,positionVisible:!1,position:null,orderTypes:null,deliveryDate:null,deliveryTime:null,exportTable:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom),this.conditions()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){var n=[];a.forEach(function(e){n.push(e.id)}),e.setState({checkedAry:n})}},a={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"USER_ORDER_CUSTOMIZE",value:"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"},{key:"USER_ORDER_PRODUCT",value:"\u5546\u54c1\u7ef4\u5ea6"},{key:"USER_ORDER_SHOP",value:"\u5e97\u94fa\u7ef4\u5ea6"},{key:"USER_ORDER_4",value:"\u7528\u6237\u7ef4\u5ea6"},{key:"USER_ORDER_5",value:"\u7269\u6d41\u8ba2\u5355\u6a21\u677f"}],values:sn,conditions:this.state.conditions,isToday:this.state.isToday,exportToday:this.exportToday,slug:"order_"},n={visible:this.state.checkVisible,onCancel:this.hideCheckNormal,refresh:function(){return e.refresh("WAIT_CUSTOMER_VERIFY")},onSubmit:this.checkInNormalOrder,problemOrder:this.state.problemOrder},r={visible:this.state.changeOrderStatusVisible,onCancel:this.hideChangeOrderStatus,onSubmit:this.submitChangeOrderStatus},l={visible:this.state.positionVisible,onCancel:this.hidePosition,submit:this.submitCondition,type:"deliveryOrders",deliveryDateShow:!0,deliveryTimeShow:!0};return i.a.createElement("div",{className:"order"},i.a.createElement(gn,l),i.a.createElement(dn,a),i.a.createElement(pn,n),i.a.createElement(on,r),i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,export:this.showExport,data:Wa}),i.a.createElement(Xa,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items}),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u59d3\u540d\u6216\u624b\u673a\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("order_management_bind_template")&&i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.setMessage},"\u8bbe\u7f6e\u9ed8\u8ba4\u6a21\u677f\u6d88\u606f"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.print,disabled:!this.state.checkedAry.length},"\u6253\u5370\u8ba2\u5355"),i.a.createElement(_e.a,{size:"small",onClick:this.conditionSelector(!1)},"\u6279\u91cf\u67e5\u770b\u81ea\u63d0\u5355"),i.a.createElement(_e.a,{size:"small",onClick:this.conditionSelector(!0)},"\u6279\u91cf\u5bfc\u51fa\u81ea\u63d0\u5355"),i.a.createElement(_e.a,{size:"small",onClick:this.conditionSelector(!1,["SELF_PICK"])},"\u6279\u91cf\u67e5\u770b\u914d\u9001\u5355"),i.a.createElement(_e.a,{size:"small",onClick:this.conditionSelector(!0,["SELF_PICK"])},"\u6279\u91cf\u5bfc\u51fa\u914d\u9001\u5355"),i.a.createElement(_e.a,{size:"small",onClick:this.changeOrderStatus},"\u6838\u5b9e\u8ba2\u5355"))),i.a.createElement("div",{className:"s_body",style:{marginTop:"20px"}},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(_e.a,{size:"small",onClick:this.checkManyOrders,disabled:!this.state.checkedAry.length||"WAIT_CUSTOMER_VERIFY"!==this.state.activeTab&&"WAIT_CUSTOMER_VERIFY_HOME"!==this.state.activeTab},"\u6279\u91cf\u6838\u9500\u8ba2\u5355"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:"ALL"},{name:"\u5f85\u6536\u8d27(\u81ea\u63d0\u5355)",key:"WAIT_AGENT_VERIFY"},{name:"\u5f85\u81ea\u63d0",key:"WAIT_CUSTOMER_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"},{name:"\u5df2\u9000\u6b3e",key:"REFUNDED"},{name:"\u5df2\u53d6\u6d88",key:"CANCELED"},{name:"\u8ba2\u5355\u5f02\u5e38",key:"EXCEPTION"},{name:"\u7533\u8bf7\u552e\u540e",key:"AFTER_SALE"},{name:"\u62d2\u7edd\u9000\u6b3e",key:"REFUSE_REFUND"},{name:"\u5f85\u6536\u8d27(\u914d\u9001\u5355)",key:"WAIT_CUSTOMER_VERIFY_HOME"},{name:"\u5f85\u6210\u56e2",key:"WAIT_FORM_GROUP"}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),this.state.data.length?i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:cn,handleCustom:this.handleCustom,targetKeys:V(this.state.defaultItem),firstItem:"trade_no"}))):""),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:"WAIT_CUSTOMER_VERIFY"===this.state.activeTab||"WAIT_CUSTOMER_VERIFY_HOME"===this.state.activeTab?this.state.sColumns:this.state.columns,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,text:"\u6761\u8ba2\u5355",ref:this.child,params:this.state.paginationParams,id:this.state.id,current:this.state.current,valChange:this.paginationChange})))}}]),t}(i.a.Component),yn=Object(U.g)(bn),Cn=(a(1052),[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at",type:"timeDetailCompare"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at",type:"timeDetailCompare"},{label:"\u5e97\u94fa\u540d\u79f0",value:"shop_name",type:"equalCompare"},{label:"\u8ba2\u5355\u72b6\u6001",value:"state",type:"merchantOrder"}]}]),kn=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee"},{label:"\u4f18\u60e0\u91d1\u989d",value:"total_preferential_fee"},{label:"\u9000\u6b3e\u91d1\u989d",value:"refund_fee"},{label:"\u4ed8\u6b3e\u65b9\u5f0f",value:"payment_type"},{label:"\u8ba2\u5355\u53f7",value:"trade_no"},{label:"\u5e97\u94fa\u540d\u79f0",value:"shop_name"},{label:"\u5e97\u94fa\u4e3b\u59d3\u540d",value:"shop_keeper_name"},{label:"\u5e97\u94fa\u4e3b\u624b\u673a\u53f7",value:"shop_keeper_mobile"},{label:"\u5e97\u94fa\u4e3b\u8054\u7cfb\u7535\u8bdd",value:"shop_contact_phone_number"},{label:"\u652f\u4ed8\u6d41\u6c34\u53f7",value:"transaction_id"},{label:"\u8ba2\u5355\u72b6\u6001",value:"state"},{label:"\u5546\u54c1",value:"products"},{label:"\u7834\u635f\u5546\u54c1",value:"damagedProducts"},{label:"\u7f3a\u5c11\u5546\u54c1",value:"deficientProducts"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at"},{label:"\u6210\u672c\u603b\u989d",value:"cost_amount"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at"}]}],Sn=(a(360),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={item:{},value:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.value?a.state.value>a.state.item.refund_need_amount?B.a.error("\u9000\u6b3e\u91d1\u989d\u4e0d\u53ef\u5927\u4e8e\u5f02\u5e38\u5546\u54c1\u603b\u91d1\u989d"):tn({refund_amount:a.state.value},a.state.item.refund_id).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){}):B.a.error("\u8bf7\u8f93\u5165\u9000\u6b3e\u91d1\u989d")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.item&&(this.setState({item:e.item}),console.log(e.item))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u9000\u6b3e",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5f02\u5e38\u5546\u54c1\u603b\u91d1\u989d\uff1a"),i.a.createElement("h5",null,this.state.item.refund_need_amount)),i.a.createElement("li",null,i.a.createElement("span",null,"\u9000\u6b3e\u91d1\u989d"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.value,onChange:function(t){e.setState({value:t.target.value})}})))))}}]),t}(i.a.Component)),On=function(e){function t(e){var a;Object(s.a)(this,t);return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ALL",t=a.state.checkedAry;t[e]=[],a.setState({filterVisible:!1,checkedAry:t,paginationParams:{logic_conditions:[],search:"",searchJson:w({state_constant:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.search=function(e){a.setState({api:en,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,state_constant:a.state.activeTab})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:en,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){kn.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"damaged_items"===r.dataIndex&&(r.render=function(e,t){return t.damaged_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.damaged_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.damaged_items,"\u7834\u635f\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}),"deficient_items"===r.dataIndex&&(r.render=function(e,t){return t.deficient_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.deficient_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.deficient_items,"\u7f3a\u5c11\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"}},e)},a.merchantColumns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){console.log(e),a.setState({data:e})},a.reviewGoods=function(e,t){a.setState({reviewGoodsVisible:!0,items:e,text:t})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.showRefund=function(e){a.setState({refundVisible:!0,refundItem:e})},a.hideRefund=function(){a.setState({refundVisible:!1})},a.setMessage=function(){a.props.history.push({pathname:"/order/setUserMessage",state:{mode:"goods"}})},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){var n=w({strategy:e,customize_columns:t,logic_conditions:a});console.log(n),window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.onOrderChecked=Object($.a)(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.confirmPopover(ln);case 1:case"end":return e.stop()}},e)})),a.print=Object($.a)(X.a.mark(function e(){var t,n,i,r,l,s,c;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loadingOne:!0}),e.next=3,je({searchJson:w({type:"MERCHANT_ORDER"})});case 3:t=e.sent,console.log(t,"===>>>"),n=null,i=null,y.a.map(t.data,function(e){"MERCHANT_ORDER_PAID_TIME_THRESHOLD_HOUR"===e.key&&(n=e.value),"MERCHANT_ORDER_PAID_TIME_THRESHOLD_MINUTE"===e.key&&(i=e.value)}),r="".concat(n,":").concat(i),l=T(-1),s=T(0),c={conditions:[{conditions:[{key:"order_paid_at",operation:"between",value:["".concat(l," ").concat(r),"".concat(s," ").concat(r)]}],logic:"and"}],logic:"and"},a.getOrders(c,1);case 13:case"end":return e.stop()}},e)})),a.getOrders=function(){var e=Object($.a)(X.a.mark(function e(t,n){var i,r,l;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en({page:n,limit:10,searchJson:w({logic_conditions:t})});case 2:i=e.sent,r=i.data,l=i.meta,a.setState({todayOrders:a.state.todayOrders.concat(r)},function(){if(l.pagination.current_page<l.pagination.total_pages)a.getOrders(t,l.pagination.current_page+1);else{a.setState({loadingOne:!1});var e=a.state.todayOrders;e.length?a.props.history.push({pathname:"/printSummaryOrders",state:{orders:e,title:"\u4eca\u65e5\u8ba2\u5355"}}):B.a.error("\u4eca\u65e5\u6682\u65e0\u8ba2\u5355")}});case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.printOrders=function(){var e=a.state,t=e.checkedAry,n=e.data,i=[];y.a.map(n,function(e){t[a.state.activeTab]&&y.a.indexOf(t[a.state.activeTab],e.id)>-1&&i.push(e)}),a.props.history.push({pathname:"/printSummaryOrders",state:{orders:i,title:"\u5546\u6237\u8ba2\u8d27\u8ba2\u5355"}})},a.confirmPopover=function(e){var t=a.refresh,n=a.state.activeTab,r=a.state.checkedAry[n],l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u624b\u52a8\u6838\u9500\u8fd9\u4e9b\u8ba2\u5355\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){e(r).then(function(e){B.a.success(e.message),t(n)})},onCancel:function(){}})},a.child=i.a.createRef(),a.state={api:en,filterVisible:!1,customVisible:!1,exportVisible:!1,data:[],checkedAry:[],refundVisible:!1,paginationParams:{logic_conditions:[],search:""},activeTab:"ALL",refundItem:{},defaultItem:["shop_name","trade_no","products","deficientProducts","damagedProducts","created_at","state_desc","settlement_total_fee"],todayOrders:[],loadingOne:!1},a.merchantColumns=[{title:"\u5546\u6237\u540d",dataIndex:"name"},{title:"\u5546\u54c1",render:function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items,"\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u7f3a\u5c11\u5546\u54c1",render:function(e,t){return t.deficient_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.deficient_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.deficient_items,"\u7f3a\u5c11\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u7834\u635f\u5546\u54c1",render:function(e,t){return t.damaged_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.damaged_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.damaged_items,"\u7834\u635f\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u4e0b\u5355\u65f6\u95f4",dataIndex:"created_at"},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"GOODS_UNQUALIFIED_WAIT_PROCESS"==a.state.activeTab?"\u64cd\u4f5c":"\u72b6\u6001",dataIndex:"state_desc",render:function(e,t){return"GOODS_UNQUALIFIED_WAIT_PROCESS"==a.state.activeTab?i.a.createElement("div",null,window.hasPermission("order_agent_confirm_refund")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showRefund(t)}},"\u9000\u6b3e")):i.a.createElement("span",null,e)}}],a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={onChange:function(t){var a=e.state.checkedAry;a[e.state.activeTab]=t,e.setState({checkedAry:a})}},a={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"MERCHANT_ORDER_PRODUCT_ORDER_CUSTOMIZE",value:"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"},{key:"MERCHANT_ORDER_PRODUCT_ORDER_PRODUCT",value:"\u5546\u54c1\u7ef4\u5ea6"},{key:"MERCHANT_ORDER_PRODUCT_ORDER_SHOP",value:"\u5e97\u94fa\u7ef4\u5ea6"},{key:"MERCHANT_ORDER_PRODUCT_ORDER_DELIVERY_TEMPLATE",value:"\u7269\u6d41\u8ba2\u5355\u6a21\u677f"},{key:"MERCHANT_ORDER_DIVIDE_PRODUCT_ORDER_SHOP",value:"\u7269\u6d41\u5206\u8d27\u6a21\u677f"}],values:kn,conditions:this.state.conditions,slug:"order_"};return console.log("undefined"!==typeof this.state.checkedAry[this.state.activeTab]),i.a.createElement("div",{className:"goodsOrder"},i.a.createElement(dn,a),i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:Cn,export:this.showExport}),i.a.createElement(Sn,{visible:this.state.refundVisible,onCancel:this.hideRefund,item:this.state.refundItem,refresh:function(){e.refresh("GOODS_UNQUALIFIED_WAIT_PROCESS")}}),i.a.createElement(Xa,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items,text:this.state.text}),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u59d3\u540d\u6216\u624b\u673a\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.print,loading:this.state.loadingOne},"\u6253\u5370\u4eca\u65e5\u8ba2\u5355"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.printOrders,disabled:"undefined"===typeof this.state.checkedAry[this.state.activeTab]||!this.state.checkedAry[this.state.activeTab].length},"\u6253\u5370\u8ba2\u5355"),window.hasPermission("order_agent_bind_template")&&i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.setMessage},"\u8bbe\u7f6e\u9ed8\u8ba4\u6a21\u677f\u6d88\u606f"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.onOrderChecked,disabled:"undefined"===typeof this.state.checkedAry[this.state.activeTab]||!this.state.checkedAry[this.state.activeTab].length},"\u6838\u9500\u8ba2\u8d27\u5355"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:"ALL"},{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"},{name:"\u5546\u54c1\u5f02\u5e38",key:"GOODS_UNQUALIFIED_WAIT_PROCESS"},{name:"\u5904\u7406\u4e2d",key:"GOODS_UNQUALIFIED_WAIT_VERIFY"},{name:"\u5df2\u9000\u6b3e",key:"GOODS_UNQUALIFIED_REFUNDED"}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:kn,targetKeys:V(this.state.defaultItem),firstItem:"shop_name",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.merchantColumns,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u6761\u8ba2\u5355",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange})))}}]),t}(i.a.Component),Nn=Object(U.g)(On),wn=(a(1053),[{value:"money_attributes",label:"\u9000\u6b3e\u5c5e\u6027",children:[{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee",type:"numCompare"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee",type:"numCompare"},{label:"\u9000\u6b3e\u91d1\u989d",value:"refund_fee",type:"numCompare"},{label:"\u6210\u672c\u603b\u989d",value:"cost_amount",type:"numCompare"},{label:"\u9000\u6b3e\u72b6\u6001",value:"refund_state",type:"equalCompare"},{label:"\u9000\u6b3e\u7c7b\u578b",value:"refund_type",type:"equalCompare"},{label:"\u9000\u6b3e\u7533\u8bf7\u65f6\u95f4",value:"refund_apply_at",type:"timeCompare"},{label:"\u5230\u8d26\u65f6\u95f4",value:"refund_handled_at",type:"timeCompare"}]},{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u8ba2\u5355\u53f7",value:"trade_no",type:"absoluteCompare"},{label:"\u7528\u6237\u624b\u673a\u53f7",value:"user_mobile",type:"emptyCompare"},{label:"\u7528\u6237\u6635\u79f0",value:"user_nickname",type:"emptyCompare"},{label:"\u9000\u6b3e\u5355\u53f7",value:"refund_no",type:"emptyCompare"}]},{value:"order_attribution",label:"\u8ba2\u5355\u5c5e\u6027",children:[{label:"\u652f\u4ed8\u72b6\u6001",value:"payment_state",type:"group"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u5546\u54c1",value:"products",type:"equalCompare"}]}]),xn=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={item:{},refund:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.refund?a.state.refund-2*a.state.item.refund_need_amount>0?B.a.error("\u9000\u6b3e\u91d1\u989d\u6700\u591a\u4e3a\u5546\u54c1\u91d1\u989d\u7684\u4e24\u500d"):tn({refund_amount:Number(a.state.refund)},a.props.item.refund_id).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){}):B.a.error("\u8bf7\u8f93\u5165\u9000\u6b3e\u91d1\u989d")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.item&&this.setState({item:e.item})}},{key:"render",value:function(){var e=this,t=this.state.item;return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u9000\u6b3e",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5f02\u5e38\u5546\u54c1\u603b\u91d1\u989d\uff1a"),i.a.createElement("h5",null,"\u7528\u6237\u7533\u8bf7\u552e\u540e"==t.refund_state_desc?"\u65e0":t.refund_need_amount)),i.a.createElement("li",null,i.a.createElement("span",null,"\u5b9e\u4ed8\u6b3e\uff1a"),i.a.createElement("h5",null,t.settlement_total_fee)),i.a.createElement("li",null,i.a.createElement("span",null,"\u9000\u6b3e\u91d1\u989d"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.refund,onChange:function(t){e.setState({refund:t.target.value})}})))))}}]),t}(i.a.Component),In=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:"\u5546\u54c1\u4e0d\u5168"},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){an({reason:a.state.value},a.props.item.refund_id).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.onChange=function(e){console.log("radio checked",e.target.value),a.setState({value:e.target.value})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u62d2\u7edd\u9000\u6b3e",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u62d2\u7edd\u7406\u7531\uff1a"),i.a.createElement(mn.a.Group,{value:this.state.value,onChange:this.onChange},i.a.createElement(mn.a,{value:"\u5546\u54c1\u4e0d\u5168"},"\u5546\u54c1\u4e0d\u5168"),i.a.createElement(mn.a,{value:"\u5546\u54c1\u4e22\u5931"},"\u5546\u54c1\u4e22\u5931"),i.a.createElement(mn.a,{value:"\u5546\u54c1\u8fc7\u671f"},"\u5546\u54c1\u8fc7\u671f"))))))}}]),t}(i.a.Component),jn=(a(361),function(e){function t(e){var a;Object(s.a)(this,t);return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({refund_state:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.reviewGoods=function(e,t){a.setState({reviewGoodsVisible:!0,items:e,text:t})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.jump=function(e){a.props.history.push({pathname:"/order/orderDetail",state:{id:e.order_id,path:"/order/refund",current:a.child.current.state.current}})},a.search=function(e){a.setState({api:Za,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Za,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){console.log(e,"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`");var t=[];e.forEach(function(e){wn.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"damaged_items"===r.dataIndex&&(r.render=function(e,t){return t.damaged_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.damaged_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.damaged_items,"\u7834\u635f\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items,"\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),"deficient_items"===r.dataIndex&&(r.render=function(e,t){return t.deficient_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.deficient_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.deficient_items,"\u7f3a\u5c11\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.refundColumns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){console.log(e),a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.showRefund=function(e){a.setState({refundVisible:!0,refundItem:e})},a.hideRefund=function(){a.setState({refundVisible:!1})},a.showRefuse=function(e){a.setState({refuseVisible:!0,refuseItem:e})},a.hideRefuse=function(){a.setState({refuseVisible:!1})},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){var n=w({strategy:e,customize_columns:t,logic_conditions:a});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.print=function(){var e=a.state,t=e.checkedAry,n=e.data,i=[];y.a.map(n,function(e){y.a.indexOf(t,e.order_id)>-1&&i.push(e)}),a.props.history.push({pathname:"/printSheet",state:{orders:i,title:"\u6d88\u8d39\u8005\u9000\u6b3e\u8ba2\u5355"}})},a.child=i.a.createRef(),a.state={api:Za,filterVisible:!1,customVisible:!1,exportVisible:!1,refundVisible:!1,refuseVisible:!1,data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:""},activeTab:-1,reviewGoodsVisible:!1,record:{},items:[],refundItem:{},refuseItem:{},defaultItem:["user_nickname","trade_no","products","settlement_total_fee","refund_type","refund_apply_at","refund_state"],conditions:{},current:1},a.refundColumns=[{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no",render:function(e,t){return i.a.createElement("span",{onClick:function(){return a.jump(t)},style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u5546\u54c1",render:function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"nickname"},{title:"\u9000\u6b3e\u7c7b\u578b",dataIndex:"refund_type"},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"applied_at"},{title:0===a.state.activeTab?"\u64cd\u4f5c":"\u9000\u6b3e\u72b6\u6001",dataIndex:"refund_state_desc",render:function(e,t){return 0===a.state.activeTab?i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"20px"},onClick:function(){return a.showRefund(t)}},"\u9000\u6b3e"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showRefuse(t)}},"\u62d2\u7edd\u9000\u6b3e")):i.a.createElement("span",null,e)}}],a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t=(this.state.activeTab,{onChange:function(t,a){e.setState({checkedAry:t})}}),a={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"USER_ORDER_CUSTOMIZE",value:"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"},{key:"USER_ORDER_PRODUCT",value:"\u5546\u54c1\u7ef4\u5ea6"},{key:"USER_ORDER_SHOP",value:"\u5e97\u94fa\u7ef4\u5ea6"}],values:wn,conditions:this.state.conditions,slug:"order_"};return i.a.createElement("div",{className:"refund"},i.a.createElement(dn,a),i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:wn,export:this.showExport}),i.a.createElement(Xa,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items,text:this.state.text}),i.a.createElement(xn,{visible:this.state.refundVisible,onCancel:this.hideRefund,item:this.state.refundItem,refresh:function(){return e.refresh(0)}}),i.a.createElement(In,{visible:this.state.refuseVisible,onCancel:this.hideRefuse,item:this.state.refuseItem,refresh:function(){return e.refresh(0)}}),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u59d3\u540d\u6216\u624b\u673a\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.print,disabled:!this.state.checkedAry.length},"\u6253\u5370\u8ba2\u5355"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:-1},{name:"\u5f85\u5904\u7406",key:0},{name:"\u5904\u7406\u4e2d",key:1},{name:"\u5df2\u9000\u6b3e",key:2},{name:"\u62d2\u7edd\u9000\u6b3e",key:3}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:wn,targetKeys:V(this.state.defaultItem),firstItem:"trade_no",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.refundColumns,rowKey:function(e){return e.order_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u6761\u8bb0\u5f55",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component)),Tn=Object(U.g)(jn),Rn=(a(1054),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).goBack=function(){a.props.history.push({pathname:a.props.location.state.path,state:{current:a.props.location.state.current}})},a.state={details:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t,a=this,n=this.props.location.state.id;(e={},t=n,ne({url:"/api/backend/orders/".concat(t,"/show"),method:"get",params:e})).then(function(e){a.setState({details:e.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this.state.details;return i.a.createElement("div",{className:"orderDetail"},i.a.createElement("div",{className:"u_top"},i.a.createElement("div",{className:"u_header"},i.a.createElement("span",null,"\u8ba2\u5355\u8be6\u60c5"),i.a.createElement(_e.a,{type:"default",size:"small",onClick:this.goBack},"\u8fd4\u56de\u8ba2\u5355\u5217\u8868")),i.a.createElement("div",{className:"u_body_one"},i.a.createElement("ul",{className:"u_body_top"},i.a.createElement("li",null,i.a.createElement("p",null,"\u8ba2\u5355\u53f7\uff1a",e.trade_no),i.a.createElement("p",null,"\u652f\u4ed8\u6d41\u6c34\uff1a",e.transaction_id),i.a.createElement("p",null,"\u8ba2\u5355\u7c7b\u578b\uff1a",e.order_type),i.a.createElement("p",null,"\u914d\u9001\u65b9\u5f0f\uff1a",e.delivery_type_desc),i.a.createElement("p",null,"\u4e0a\u7ebf\uff1a",e.introducer_code)),i.a.createElement("li",null,i.a.createElement("h3",null,"\u81ea\u63d0\u4fe1\u606f"),e.shop_info&&i.a.createElement(n.Fragment,null,i.a.createElement("p",null,"\u81ea\u63d0\u5e97\u94fa\u540d\u79f0\uff1a",e.shop_info.name),i.a.createElement("p",null,"\u81ea\u63d0\u5e97\u94fa\u7f16\u53f7\uff1a",e.shop_info.code),i.a.createElement("p",null,"\u81ea\u63d0\u5e97\u94fa\u4e3b\u59d3\u540d\uff1a",e.shop_info.keeper_name),i.a.createElement("p",null,"\u81ea\u63d0\u5e97\u94fa\u4e3b\u624b\u673a\u53f7\uff08\u6ce8\u518c\uff09\uff1a",e.shop_info.keeper_mobile))),i.a.createElement("li",null,i.a.createElement("h3",null,"\u914d\u9001\u4fe1\u606f"),e.shipping_info&&i.a.createElement(n.Fragment,null,i.a.createElement("p",null,"\u6536\u8d27\u4eba\u59d3\u540d\uff1a",e.shipping_info.consignee_name),i.a.createElement("p",null,"\u6536\u8d27\u4eba\u624b\u673a\u53f7\uff1a",e.shipping_info.consignee_mobile_phone),i.a.createElement("p",null,"\u6536\u8d27\u4eba\u5730\u5740\uff1a",e.shipping_info.province,e.shipping_info.city,e.shipping_info.area,e.shipping_info.detail_address)))))),i.a.createElement("ul",{className:"u_body_four"},i.a.createElement("li",null,i.a.createElement("div",{className:"u_body_four_header"},"\u4e2a\u4eba\u4fe1\u606f"),i.a.createElement("ul",{className:"u_body_four_body"},i.a.createElement("li",null,"\u7528\u6237\u6635\u79f0\uff1a",e.user_name),i.a.createElement("li",null,"\u7528\u6237\u624b\u673a\uff1a",e.user_mobile))),i.a.createElement("li",null,i.a.createElement("div",{className:"u_body_four_header"},"\u4ed8\u6b3e\u4fe1\u606f"),i.a.createElement("ul",{className:"u_body_four_body center_order "},i.a.createElement("li",null,"\u4ed8\u6b3e\u65b9\u5f0f\uff1a",e.payment_type),i.a.createElement("li",null,"\u5b9e\u4ed8\u6b3e\uff1a",e.settlement_total_fee+"\u5143"),i.a.createElement("li",null,"\u4f18\u60e0\u91d1\u989d\uff1a",e.preferential_total_fee+"\u5143"),i.a.createElement("li",null,"\u9000\u6b3e\u91d1\u989d\uff1a",e.refund_fee+"\u5143"),i.a.createElement("li",null,"\u9000\u6b3e\u7c7b\u578b\uff1a",e.refund_type),i.a.createElement("li",null,"\u6210\u672c\u603b\u989d: ",e.cost_amount+"\u5143"),i.a.createElement("li",null,"\u8ba2\u5355\u9500\u552e\u8d21\u732e\u989d: ",e.sales_amount+"\u5143"))),i.a.createElement("li",null,i.a.createElement("div",{className:"u_body_four_header"},"\u5546\u54c1"),e.items&&e.items.length?i.a.createElement("ul",{className:"u_body_four_body"},e.items.map(function(e){return i.a.createElement("li",null,e.name," X ",e.quantity)})):"\u65e0")))}}]),t}(i.a.Component));function An(e){return ne({url:"/api/backend/wechat/mp/template_messages/list",method:"get",params:e})}function Dn(e,t){return ne({url:"/api/backend/wechat/mp/template_messages/".concat(t,"/enable"),method:"put",data:e})}function Pn(e,t){return ne({url:"/api/backend/wechat/mp/template_messages/".concat(t,"/disable"),method:"put",data:e})}function Vn(e,t){return ne({url:"/api/backend/wechat/mp/template_messages/".concat(t,"/custom/list"),method:"get",params:e})}function Ln(e,t,a){return ne({url:"/api/backend/wechat/mp/template_messages/".concat(t,"/custom/").concat(a),method:"delete",params:e})}function Mn(e,t){return ne({url:"/api/backend/sms/templates/".concat(t,"/enable"),method:"put",data:e})}function Un(e,t){return ne({url:"/api/backend/sms/templates/".concat(t,"/disable"),method:"put",data:e})}function Fn(e,t){return ne({url:"/api/backend/sms/templates",method:"post",data:e})}function Gn(e){return ne({url:"/api/backend/sms/templates",method:"get",params:e})}function Bn(e){return ne({url:"/api/backend/sms/send/logs",method:"get",params:e})}function zn(e){return ne({url:"/api/backend/sms/send/statistics",method:"get",params:e})}function Hn(e){return ne({url:"/api/backend/template/bindings",method:"get",params:e})}function Kn(e){return ne({url:"/api/backend/template/bindings/bind",method:"post",data:e})}function Jn(e){return ne({url:"/api/backend/sms/templates/exist",method:"post",data:e})}a(1055),a(362);var Wn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){a.state.activeItem.id?(a.props.save(a.state.activeItem,a.props.type),a.handleCancel()):B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u6d88\u606f")},a.setActiveItem=function(e){a.setState({activeItem:e})},a.state={list:[],activeItem:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.list&&e.list.length&&this.setState({list:e.list})}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u9009\u62e9\u77ed\u4fe1\u6a21\u677f",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.submit,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",maskClosable:!1},i.a.createElement("ul",{className:"set_m_wechat"},this.state.list.length&&this.state.list.map(function(t){return i.a.createElement("li",{key:t.id,className:e.state.activeItem.id===t.id?"active m_message_li":"m_message_li",onClick:function(){return e.setActiveItem(t)}},i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",t.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",t.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",t.biz_type))})))}}]),t}(n.Component),Yn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){a.state.activeItem.template_id?(a.props.save(a.state.activeItem,a.props.type),a.handleCancel()):B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u6d88\u606f")},a.setActiveItem=function(e){a.props.save(e,a.props.type),a.handleCancel()},a.state={list:[],activeItem:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.list&&e.list.length&&this.setState({list:e.list})}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u9009\u62e9\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u6a21\u677f",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"set_m_wechat"},this.state.list.length?this.state.list.map(function(t){return i.a.createElement("li",{key:t.template_id,className:e.state.activeItem.template_id===t.template_id?"m_wechat_li active":"m_wechat_li",onClick:function(){return e.setActiveItem(t)}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,t.title)),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,t.inner_title),i.a.createElement("ul",null,t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))}):"\u6682\u65e0\u6a21\u677f\uff0c\u5148\u53bb\u8bbe\u7f6e\u6a21\u677f\u5427\uff5e"))}}]),t}(n.Component),qn={order_success_m:"USER_ORDER_PAY_SUCCESS",order_got_m:"USER_ORDER_WAIT_PICK_UP",order_wrong_m:"USER_ORDER_EXCEPTION",order_cancel_m:"USER_ORDER_PLATFORM_CANCEL",order_refund_m:"USER_ORDER_EXCEPTION_REFUND",order_success_w:"USER_ORDER_PAY_SUCCESS",order_got_w:"USER_ORDER_WAIT_PICK_UP",order_wrong_w:"USER_ORDER_EXCEPTION",order_cancel_w:"USER_ORDER_PLATFORM_CANCEL",order_refund_w:"USER_ORDER_EXCEPTION_REFUND",goods_wrong_m:"MERCHANT_ORDER_GOODS_UNQUALIFIED_REFUNDED",goods_wrong_w:"MERCHANT_ORDER_GOODS_UNQUALIFIED_REFUNDED",coupon_fade_w:"USER_COUPON_SOON_TO_EXPIRE",coupon_fade_m:"USER_COUPON_SOON_TO_EXPIRE",coupon_got_w:"USER_COUPON_RECEIVED",coupon_got_m:"USER_COUPON_RECEIVED",merchant_fade_m:"MERCHANT_COUPON_SOON_TO_EXPIRE",merchant_fade_w:"MERCHANT_COUPON_SOON_TO_EXPIRE",merchant_got_m:"MERCHANT_COUPON_RECEIVED",merchant_got_w:"MERCHANT_COUPON_RECEIVED"},Xn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose(),a.props.showWeChat(a.props.type)},a.submit=function(){a.state.activeItem.id?(a.props.save(a.state.activeItem,a.props.type),a.props.onClose()):B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u6d88\u606f")},a.setActiveItem=function(e){a.setState({activeItem:e})},a.state={list:[],activeItem:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;e.templateId&&Vn({},e.templateId).then(function(e){a.setState({list:e.data})})}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u9009\u62e9\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u6a21\u677f",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.submit,maskClosable:!1},i.a.createElement("ul",{className:"set_m_wechat"},this.state.list.length?this.state.list.map(function(t){return i.a.createElement("li",{key:t.template_id,className:e.state.activeItem.id===t.id?"m_wechat_li active":"m_wechat_li",onClick:function(){return e.setActiveItem(t)}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,t.title)),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,t.inner_title),i.a.createElement("ul",null,t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))}):"\u8be5\u6a21\u677f\u4e0b\u6682\u65e0\u81ea\u5b9a\u4e49\u6a21\u677f\u54e6\uff0c\u5148\u53bb\u8bbe\u7f6e\u6a21\u677f\u5427\uff5e"))}}]),t}(n.Component),$n=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={orders:[],coupons:[]},a.init=function(){Hn({searchJson:w({type:"ORDER"})}).then(function(e){a.setState({orders:e.data})}),Hn({searchJson:w({type:"COUPON"})}).then(function(e){a.setState({coupons:e.data})})},a.unbind=function(e){e.preventDefault(),e.stopPropagation();var t=a.state,n=t.orders,i=t.coupons,r=n.concat(i);y.a.map(r,function(e){e.template.id===a.props.id&&e.trigger===a.props.type&&a.handleUnbind(e.binding_id)})},a.handleUnbind=function(e){(function(e,t){return ne({url:"/api/backend/template/bindings/".concat(t),method:"delete",params:e})})({},e).then(function(e){B.a.success(e.message+",\u5373\u5c06\u81ea\u52a8\u5237\u65b0"),a.props.refresh()})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){return i.a.createElement("div",{className:"deleteMessage",onClick:this.unbind},i.a.createElement(de,{type:"icon-delete-fill"}))}}]),t}(n.Component),Qn=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).init=function(){setTimeout(function(){window.location.reload()},1500)},a.showWeChat=function(e){a.setState({weChatVisible:!0,type:e})},a.hideWeChat=function(){a.setState({weChatVisible:!1})},a.showSmsMessage=function(e){a.setState({messageVisible:!0,type:e})},a.hideSmsMessage=function(){a.setState({messageVisible:!1})},a.showCustomMessage=function(e){a.setState({customMessageVisible:!0,templateId:e})},a.hideCustomMessage=function(){a.setState({customMessageVisible:!1})},a.saveParentWechat=function(e,t){a.setState(Object(Y.a)({},t,e),function(){a.showCustomMessage(e.id)})},a.saveWeChat=function(e,t){console.log(t);var n="user"===a.props.location.state.mode?"ORDER":"COUPON";console.log(qn[t],"+++++++++++"),Kn({type:n,template_type:"WX_TEMPLATE_MESSAGE",template_id:e.id,trigger:qn[t]}).then(function(n){B.a.success(n.message),a.setState(Object(Y.a)({},t,e))})},a.saveSMS=function(e,t){Kn({type:"user"===a.props.location.state.mode?"ORDER":"COUPON",template_type:"SMS",template_id:e.id,trigger:qn[t]}).then(function(n){B.a.success(n.message),a.setState(Object(Y.a)({},t,e))})},a.state={weChatList:[],messageList:[],weChatVisible:!1,messageVisible:!1,customMessageVisible:!1,type:"",templateId:"",order_success_w:{},order_success_m:{},order_got_w:{},order_got_m:{},order_wrong_w:{},order_wrong_m:{},order_cancel_w:{},order_cancel_m:{},order_refund_w:{},order_refund_m:{},goods_wrong_m:{},coupon_fade_w:{},coupon_fade_m:{},coupon_got_w:{},coupon_got_m:{},merchant_fade_m:{},merchant_got_m:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.state.mode,a="user"===t?"ORDER":"COUPON",n="user"===t?"USER":"MERCHANT";An({}).then(function(t){e.setState({weChatList:t.data})}).catch(function(e){}),Gn({searchJson:w({obj_type:n})}).then(function(t){e.setState({messageList:t.data})}).catch(function(e){}),Hn({searchJson:w({type:a})}).then(function(t){t.data.forEach(function(t){switch(t.template_type){case"SMS":switch(t.trigger){case"USER_ORDER_PAY_SUCCESS":e.setState({order_success_m:t.template});break;case"USER_ORDER_WAIT_PICK_UP":e.setState({order_got_m:t.template});break;case"USER_ORDER_EXCEPTION":e.setState({order_wrong_m:t.template});break;case"USER_ORDER_PLATFORM_CANCEL":e.setState({order_cancel_m:t.template});break;case"USER_ORDER_EXCEPTION_REFUND":e.setState({order_refund_m:t.template})}break;default:switch(t.trigger){case"USER_ORDER_PAY_SUCCESS":e.setState({order_success_w:t.template},function(){console.log(e.state.order_success_w,"{}{}}{}")});break;case"USER_ORDER_WAIT_PICK_UP":e.setState({order_got_w:t.template});break;case"USER_ORDER_EXCEPTION":e.setState({order_wrong_w:t.template});break;case"USER_ORDER_PLATFORM_CANCEL":e.setState({order_cancel_w:t.template});break;case"USER_ORDER_EXCEPTION_REFUND":e.setState({order_refund_w:t.template})}}})})}},{key:"render",value:function(){var e=this,t=this.props.location.state.mode,a={visible:this.state.messageVisible,list:this.state.messageList,onClose:this.hideSmsMessage,save:this.saveSMS,type:this.state.type},r={visible:this.state.weChatVisible,list:this.state.weChatList,onClose:this.hideWeChat,save:this.saveParentWechat,type:this.state.type},l={visible:this.state.customMessageVisible,onClose:this.hideCustomMessage,type:this.state.type,templateId:this.state.templateId,showWeChat:this.showWeChat,save:this.saveWeChat};return i.a.createElement(n.Fragment,null,i.a.createElement(Wn,a),i.a.createElement(Yn,r),i.a.createElement(Xn,l),"user"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u4e0b\u5355\u6210\u529f"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_success_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_success_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_success_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_success_w.name),i.a.createElement($n,{refresh:this.init,type:qn.order_success_w,id:this.state.order_success_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_success_w.inner_title),i.a.createElement("ul",null,this.state.order_success_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_success_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_success_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_success_m")}},i.a.createElement($n,{refresh:this.init,type:qn.order_success_m,id:this.state.order_success_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_success_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_success_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_success_m.biz_type)))),i.a.createElement("h3",null,"\u5546\u54c1\u5df2\u5230\u81ea\u63d0\u70b9"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_got_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_got_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_got_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_got_w.name),i.a.createElement($n,{refresh:this.init,type:qn.order_got_w,id:this.state.order_got_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_got_w.inner_title),i.a.createElement("ul",null,this.state.order_got_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_got_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_got_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_got_m")}},i.a.createElement($n,{refresh:this.init,type:qn.order_got_m,id:this.state.order_got_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_got_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_got_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_got_m.biz_type)))),i.a.createElement("h3",null,"\u8ba2\u5355\u5f02\u5e38(\u65e9\u9910\u9884\u5b9a)"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_wrong_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_wrong_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_wrong_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_wrong_w.name),i.a.createElement($n,{refresh:this.init,type:qn.order_wrong_w,id:this.state.order_wrong_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_wrong_w.inner_title),i.a.createElement("ul",null,this.state.order_wrong_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_wrong_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_wrong_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_wrong_m")}},i.a.createElement($n,{refresh:this.init,type:qn.order_wrong_m,id:this.state.order_wrong_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_wrong_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_wrong_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_wrong_m.biz_type)))),i.a.createElement("h3",null,"\u9884\u5b9a\u5355\u5546\u54c1\u4e0d\u9f50\u9000\u6b3e"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_refund_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_refund_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_refund_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_refund_w.name),i.a.createElement($n,{refresh:this.init,type:qn.order_refund_w,id:this.state.order_refund_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_refund_w.inner_title),i.a.createElement("ul",null,this.state.order_refund_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_refund_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_refund_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_refund_m")}},i.a.createElement($n,{refresh:this.init,type:qn.order_refund_m,id:this.state.order_refund_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_refund_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_refund_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_refund_m.biz_type))))),"goods"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u5546\u54c1\u5f02\u5e38\u9000\u6b3e"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("goods_wrong_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.goods_wrong_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("goods_wrong_m")}},i.a.createElement($n,{refresh:this.init,type:qn.goods_wrong_m,id:this.state.goods_wrong_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.goods_wrong_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.goods_wrong_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.goods_wrong_m.biz_type))))),"couponConsumer"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u4f18\u60e0\u5238\u5373\u5c06\u8fc7\u671f"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("coupon_fade_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.coupon_fade_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("coupon_fade_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.coupon_fade_w.name),i.a.createElement($n,{refresh:this.init,type:qn.coupon_fade_w,id:this.state.coupon_fade_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.coupon_fade_w.inner_title),i.a.createElement("ul",null,this.state.coupon_fade_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("coupon_fade_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.coupon_fade_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("coupon_fade_m")}},i.a.createElement($n,{refresh:this.init,type:qn.coupon_fade_m,id:this.state.coupon_fade_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.coupon_fade_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.coupon_fade_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.coupon_fade_m.biz_type)))),i.a.createElement("h3",null,"\u83b7\u5f97\u4f18\u60e0\u5238"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("coupon_got_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.coupon_got_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("coupon_got_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.coupon_got_w.name),i.a.createElement($n,{refresh:this.init,type:qn.coupon_got_w,id:this.state.coupon_got_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.coupon_got_w.inner_title),i.a.createElement("ul",null,this.state.coupon_got_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("coupon_got_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.coupon_got_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("coupon_got_m")}},i.a.createElement($n,{refresh:this.init,type:qn.coupon_got_m,id:this.state.coupon_got_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.coupon_got_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.coupon_got_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.coupon_got_m.biz_type))))),"couponMerchant"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u4f18\u60e0\u5238\u5373\u5c06\u8fc7\u671f"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("merchant_fade_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.merchant_fade_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("merchant_fade_m")}},i.a.createElement($n,{refresh:this.init,type:qn.merchant_fade_m,id:this.state.merchant_fade_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.merchant_fade_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.merchant_fade_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.merchant_fade_m.biz_type)))),i.a.createElement("h3",null,"\u83b7\u5f97\u4f18\u60e0\u5238"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("merchant_got_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.merchant_got_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("merchant_got_m")}},i.a.createElement($n,{refresh:this.init,type:qn.merchant_got_m,id:this.state.merchant_got_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.merchant_got_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.merchant_got_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.merchant_got_m.biz_type))))))}}]),t}(n.Component),Zn=(a(1056),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={data:[]},a.valueChange=function(e,t){"USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR"===e&&t>24||"USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_MINUTE"===e&&t>59||(t="USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR"===e||"USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_MINUTE"===e?parseInt(t):parseFloat(t),a.setState(Object(Y.a)({},e,t)))},a.submitSetting=function(e){Ie({type:"ORDER",key:e,value:a.state[e]}).then(function(e){B.a.success(e.message)})},a.enableSetting=function(e){var t;(t={type:"ORDER",key:e},ne({url:"/api/backend/system/setting/enable",method:"put",data:t})).then(function(e){console.log(e,"able")}).catch(function(e){})},a.disableSetting=function(e){var t;(t={type:"ORDER",key:e},ne({url:"/api/backend/system/setting/disable",method:"put",data:t})).then(function(e){console.log(e,"disable")}).catch(function(e){})},a.getFlag=function(e){return a.state.data.filter(function(t){return t.key===e})[0]},a.handleChecked=function(e,t){var n=a.state.data;y.a.map(n,function(a){a.key===e&&(a.flag=t)}),a.setState({data:n})},a.handleChange=function(e,t){var n=a.state.data;console.log(t),y.a.map(n,function(a){a.key===e&&(a.flag=t)}),"USER_ORDER_MANUAL_CANCEL_TIME_LIMIT"===e?t?(console.log("\u524d\u771f"),a.enableSetting("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT"),a.disableSetting("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR"),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT",!0),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR",!1)):(console.log("\u524djia"),a.disableSetting("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT"),a.enableSetting("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR"),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT",!1),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR",!0)):t?(console.log("hou\u771f"),a.disableSetting("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT"),a.enableSetting("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR"),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT",!1),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR",!0)):(console.log("houjia"),a.enableSetting("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT"),a.disableSetting("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR"),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_LIMIT",!0),a.handleChecked("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR",!1))},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;je({searchJson:w({type:"ORDER"})}).then(function(t){t.data.forEach(function(t){e.setState(Object(Y.a)({},t.key,t.value))}),e.setState({data:t.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state;return i.a.createElement("div",{className:"order_setting"},i.a.createElement("div",{className:"setting_header"},"\u6d88\u8d39\u8005\u53d6\u6d88\u8ba2\u5355\u65f6\u95f4"),i.a.createElement("div",{className:"setting_body"},t.data.length&&i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",{className:"cancelSpan"},"\u6bcf\u5929  ",i.a.createElement(Ne.a,{type:"number",value:t.USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR,onChange:function(t){return e.valueChange("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR",t.target.value)},onBlur:function(){return e.submitSetting("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_HOUR")}})," \u65f6 ",i.a.createElement(Ne.a,{type:"number",value:t.USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_MINUTE,onChange:function(t){return e.valueChange("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_MINUTE",t.target.value)},onBlur:function(){return e.submitSetting("USER_ORDER_MANUAL_CANCEL_TIME_DEADLINE_MINUTE")}})," \u5206\u4e4b\u524d"))),i.a.createElement("div",{className:"setting_header"},"\u6d88\u8d39\u8005\u7533\u8bf7\u552e\u540e\u7684\u65f6\u95f4"),i.a.createElement("div",{className:"setting_body"},i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",null,"\u8ba2\u5355\u652f\u4ed8\u5b8c\u6210\u540e ",i.a.createElement(Ne.a,{type:"number",value:t.USER_ORDER_LAUNCH_AFTER_SALE_TIME_LIMIT,onChange:function(t){return e.valueChange("USER_ORDER_LAUNCH_AFTER_SALE_TIME_LIMIT",t.target.value)},onBlur:function(){return e.submitSetting("USER_ORDER_LAUNCH_AFTER_SALE_TIME_LIMIT")}})," \u5c0f\u65f6\u4e4b\u5185"))),i.a.createElement("div",{className:"setting_header"},"\u6d88\u8d39\u8005\u672a\u4ed8\u6b3e\u81ea\u52a8\u53d6\u6d88\u7684\u65f6\u95f4"),i.a.createElement("div",{className:"setting_body"},i.a.createElement("div",{className:"setting_item"},"\u751f\u6210\u8ba2\u5355\u540e ",i.a.createElement(Ne.a,{type:"number",value:t.USER_ORDER_AUTO_CANCEL_TIME_LIMIT,onChange:function(t){return e.valueChange("USER_ORDER_AUTO_CANCEL_TIME_LIMIT",t.target.value)},onBlur:function(){return e.submitSetting("USER_ORDER_AUTO_CANCEL_TIME_LIMIT")}})," \u5c0f\u65f6\u4e4b\u5185")),i.a.createElement("div",{className:"setting_header"},"\u6d88\u8d39\u8005\u540c\u57ce\u914d\u9001\u8d77\u9001\u91d1\u989d"),i.a.createElement("div",{className:"setting_body"},i.a.createElement("div",{className:"setting_item"},"\u6ee1 ",i.a.createElement(Ne.a,{type:"number",value:t.USER_ORDER_DELIVERY_THRESHOLD,onChange:function(t){return e.valueChange("USER_ORDER_DELIVERY_THRESHOLD",t.target.value)},onBlur:function(){return e.submitSetting("USER_ORDER_DELIVERY_THRESHOLD")}})," \u5143\u8d77\u9001")))}}]),t}(n.Component)),ei=a(302),ti=a.n(ei),ai=[{cn:"\u59d3\u540d",en:"name"},{cn:"\u8ba2\u5355\u53f7",en:"trade_no"},{cn:"\u4e0b\u5355\u65f6\u95f4",en:"paid_at"},{cn:"\u5546\u54c1\u540d\u79f0",en:"product_name"},{cn:"\u5546\u54c1\u91d1\u989d",en:"price"},{cn:"\u89c4\u683c",en:"unit"},{cn:"\u6570\u91cf",en:"quantity"},{cn:"\u8ba2\u5355\u603b\u91d1\u989d",en:"total_fee"},{cn:"\u6536\u8d27\u4eba",en:"name"},{cn:"\u8054\u7cfb\u7535\u8bdd",en:"phone"},{cn:"\u5fae\u4fe1\u540d\u79f0",en:"nickname"},{cn:"\u623f\u53f7",en:"homeAddress"},{cn:"\u56ed\u533a",en:"area"}];function ni(e){var t=[];return y.a.map(e,function(e){var a={},n=function(t){y.a.map(ai,function(n){t===n.cn&&(a[n.en]=e[t])})};for(var i in e)n(i);t.push(a)}),function(e){console.log(e);var t=[];return y.a.map(e,function(e){var a=y.a.findIndex(t,function(t){return t.trade_no===e.trade_no});a>-1?(console.log(e,"1111"),t[a].products.push({product_name:e.product_name,quantity:e.quantity,unit:e.unit,total:e.price,price:e.price/e.quantity})):(t.push(e),t[t.length-1].products=[],t[t.length-1].products.push({product_name:e.product_name,quantity:e.quantity,unit:e.unit,total:e.price,price:e.price/e.quantity}))}),t}(t)}var ii=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){console.log(a.state.formData,".......");var e=Object(Ja.a)(a).state;if(e.village)if(e.address)if(e.name)if(e.mobile)if(e.formData.length){var t={mobile:e.mobile,name:e.name,address:e.address,village:e.village,order:e.formData};a.props.onSubmit(t),a.setState({name:"",mobile:"",address:"",village:"",formData:[]},function(){a.handleCancel()})}else B.a.error("\u8bf7\u5148\u4e0a\u4f20\u8868\u683c");else B.a.error("\u8bf7\u5148\u586b\u5199\u6536\u8d27\u4eba\u624b\u673a\u53f7\u7801");else B.a.error("\u8bf7\u5148\u586b\u5199\u6536\u8d27\u4eba\u59d3\u540d");else B.a.error("\u8bf7\u5148\u586b\u5199\u5730\u5740");else B.a.error("\u8bf7\u5148\u586b\u5199\u5c0f\u533a")},a.importExcal=function(e){e.persist();var t,n=Object(Ja.a)(a),i=e.target.files,r=new FileReader;r.readAsBinaryString(i[0]),r.onload=function(e){var a=e.target.result;t=ti.a.read(a,{type:"binary"}),n.handleData(ti.a.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]))}},a.fixdata=function(e){for(var t="",a=0,n=10240;a<e.byteLength/n;++a)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*n,a*n+n)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*n)))},a.inputChange=function(e,t){a.setState(Object(Y.a)({},e,t.target.value))},a.handleData=function(e){a.setState({formData:ni(e)})},a.state={name:"",mobile:"",address:"",village:"",formData:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("ul",{className:"mainUl shops-input"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5c0f\u533a"),i.a.createElement(Ne.a,{value:t.village,onChange:function(t){return e.inputChange("village",t)}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5730\u5740"),i.a.createElement(Ne.a,{value:t.address,onChange:function(t){return e.inputChange("address",t)}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6536\u8d27\u4eba"),i.a.createElement(Ne.a,{value:t.name,onChange:function(t){return e.inputChange("name",t)}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8054\u7cfb\u7535\u8bdd"),i.a.createElement(Ne.a,{type:"number",value:t.mobile,onChange:function(t){return e.inputChange("mobile",t)}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8868\u683c"),i.a.createElement("input",{type:"file",onChange:function(t){return e.importExcal(t)}})))))}}]),t}(n.Component),ri=(a(1063),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).createNewForm=function(){a.setState({visible:!0})},a.hideNewForm=function(){a.setState({visible:!1})},a.submitForm=function(e){var t=a.state.data;console.log(e),t.push(e),a.setState({data:t});var n=(new Date).getTime();h.a.set(v.orderTransformerKey,JSON.stringify({data:t,time:n}))},a.printSummary=function(){a.props.history.push({pathname:"/printCustomSummaryOrders",state:{orders:a.state.data}})},a.printOrders=function(){a.props.history.push({pathname:"/printCustomOrders",state:{orders:a.state.data}})},a.deleteLine=function(e,t){var n=a.state.data.filter(function(t){return t.village!==e.village&&t.address!==e.address});a.setState({data:n})},a.state={visible:!1,data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=h.a.get(v.orderTransformerKey);e&&(e=JSON.parse(e),(new Date).getTime()-e.time>72e5?this.setState({data:[]}):this.setState({data:e.data}))}},{key:"render",value:function(){var e=this,t={visible:this.state.visible,onClose:this.hideNewForm,onSubmit:this.submitForm},a=[{title:"\u5c0f\u533a",dataIndex:"village"},{title:"\u5730\u5740",dataIndex:"address"},{title:"\u6536\u8d27\u4eba",dataIndex:"name"},{title:"\u8054\u7cfb\u7535\u8bdd",dataIndex:"mobile"},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(t,a){return i.a.createElement("span",{style:{color:"#4f9863",cursor:"pointer"},onClick:function(t){return e.deleteLine(a,t)}},"\u5220\u9664")}}];return i.a.createElement("div",{className:"orderTransformer"},i.a.createElement(ii,t),i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",onClick:this.createNewForm},"\u4e0a\u4f20\u6587\u4ef6"),i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.printSummary,disabled:!this.state.data.length},"\u6253\u5370\u6c47\u603b\u5355"),i.a.createElement(_e.a,{size:"small",style:{marginLeft:"20px"},onClick:this.printOrders,disabled:!this.state.data.length},"\u6253\u5370\u8ba2\u5355"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:a,rowKey:function(e){return Math.random()},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})))}}]),t}(n.Component)),li=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5e97\u94fa\u540d\u79f0",value:"name",type:"equal"},{label:"\u5e97\u94fa\u7f16\u53f7",value:"code",type:"equal"},{label:"\u5546\u6237\u4e3b\u59d3\u540d",value:"keeper_name",type:"equal"},{label:"\u5546\u6237\u4e3b\u8eab\u4efd\u8bc1\u53f7\u7801",value:"keeper_id_card_no",type:"equal"},{label:"\u5546\u6237\u4e3b\u624b\u673a",value:"keeper_mobile",type:"equal"},{label:"\u7701",value:"province_code",type:"cityCompare"},{label:"\u5e02",value:"city_code",type:"cityCompare"},{label:"\u533a",value:"area_code",type:"cityCompare"},{label:"\u5f00\u4e1a\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u4ecb\u7ecd\u4eba\u7f16\u53f7",value:"introducer_code",type:"equal"},{label:"\u4ecb\u7ecd\u4eba\u59d3\u540d",value:"introducer_name",type:"equal"},{label:"\u4ed6\u4ecb\u7ecd\u7684\u5e97\u94fa\u6570\u91cf",value:"introduce_shop_count",type:"numCompare"}]},{value:"account_data",label:"\u8d26\u6237\u6570\u636e",children:[{label:"\u4f59\u989d",value:"balance",type:"numCompare"},{label:"\u5145\u503c\u603b\u989d",value:"total_recharge",type:"numCompare"},{label:"\u63d0\u73b0\u603b\u989d",value:"total_withdrawal",type:"timeCompare"},{label:"\u8fd4\u73b0\u603b\u989d",value:"total_cashback",type:"numCompare"},{label:"\u81ea\u63d0\u8fd4\u73b0\u603b\u989d",value:"total_self_pick_cashback",type:"numCompare"},{label:"\u81ea\u63d0\u4f63\u91d1\u603b\u989d",value:"total_self_pick_commission",type:"numCompare"},{label:"\u81ea\u63d0\u8865\u8d34\u603b\u989d",value:"total_self_pick_allowance",type:"numCompare"},{label:"\u9500\u552e\u8fd4\u73b0\u603b\u989d",value:"total_sale_cashback",type:"numCompare"},{label:"\u9500\u552e\u4f63\u91d1\u603b\u989d",value:"total_sale_commission",type:"numCompare"},{label:"\u9500\u552e\u8865\u8d34\u603b\u989d",value:"total_sale_allowance",type:"numCompare"}]},{value:"shop_attributes",label:"\u5e97\u94fa\u5c5e\u6027",children:[{label:"\u72b6\u6001",value:"status",type:"equal"},{label:"\u6e20\u9053",value:"channel",type:"channel"},{label:"\u5546\u6237\u7ec4",value:"groups",type:"group"}]},{value:"sell_data",label:"\u9500\u552e\u6570\u636e",children:[{label:"\u626b\u7801\u4ed8\u603b\u989d",value:"total_code_scan_amount",type:"numCompare"},{label:"\u652f\u4ed8\u5b9d\u603b\u989d",value:"total_ali_amount",type:"numCompare"},{label:"\u5fae\u4fe1\u652f\u4ed8\u603b\u989d",value:"total_wx_amount",type:"timeCompare"},{label:"\u4f59\u989d\u652f\u4ed8\u603b\u989d",value:"total_balance_amount",type:"numCompare"},{label:"\u62db\u884c\u4e00\u7f51\u901a\u652f\u4ed8\u603b\u989d",value:"total_cmb_amount",type:"numCompare"},{label:"\u8ba2\u8d27\u603b\u989d",value:"total_order_product_amount",type:"numCompare"}]},{value:"self_pick_data",label:"\u81ea\u63d0\u6570\u636e",children:[{label:"\u9884\u8ba2\u5355\u603b\u8ba2\u5355\u6570",value:"total_self_pick_orders_count",type:"numCompare"},{label:"\u9884\u8ba2\u5355\u603b\u989d",value:"total_self_pick_amount",type:"numCompare"}]}],si=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5e97\u94fa\u540d\u79f0",value:"name",type:"timeCompare"},{label:"\u5e97\u94fa\u7f16\u53f7",value:"code",type:"equal"},{label:"\u5e97\u94fa\u4e3b\u59d3\u540d",value:"keeper_name",type:"equal"},{label:"\u5e97\u94fa\u4e3b\u624b\u673a\u53f7",value:"keeper_mobile",type:"numCompare"},{label:"\u5e97\u94fa\u5730\u533a",value:"region",type:"detailAddress"},{label:"\u5e97\u94fa\u5730\u5740",value:"address",type:"detailAddress"},{label:"\u4ecb\u7ecd\u4eba\u7f16\u53f7",value:"introducer_code",type:"equal"},{label:"\u4ecb\u7ecd\u4eba\u5e97\u94fa\u540d\u79f0",value:"introducer_name",type:"equal"},{label:"\u5e97\u94fa\u521b\u5efa\u65f6\u95f4",value:"created_time",type:"timeCompare"},{label:"\u5e97\u94fa\u6700\u65b0\u5f00\u4e1a\u65f6\u95f4",value:"last_open_time",type:"timeCompare"}]}],ci=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5f00\u4e1a\u65f6\u95f4",value:"created_at",type:"timeCompare"},{label:"\u4ecb\u7ecd\u4eba\u7f16\u53f7",value:"introducer_code",type:"equal"},{label:"\u4ecb\u7ecd\u4eba\u5e97\u94fa\u540d\u79f0",value:"introducer_name",type:"equal"},{label:"\u4ed6\u4ecb\u7ecd\u7684\u5e97\u94fa\u6570\u91cf",value:"introduce_shop_count",type:"numCompare"},{label:"\u5e97\u94fa\u5730\u533a",value:"region",type:"detailAddress"}]},{value:"account_data",label:"\u8d26\u6237\u6570\u636e",children:[{label:"\u4f59\u989d",value:"balance",type:"numCompare"},{label:"\u5145\u503c\u603b\u989d",value:"total_recharge",type:"numCompare"},{label:"\u63d0\u73b0\u603b\u989d",value:"total_withdrawal",type:"timeCompare"},{label:"\u8fd4\u73b0\u603b\u989d",value:"total_cashback",type:"numCompare"},{label:"\u81ea\u63d0\u8fd4\u73b0\u603b\u989d",value:"total_self_pick_cashback",type:"numCompare"},{label:"\u81ea\u63d0\u4f63\u91d1\u603b\u989d",value:"total_self_pick_commission",type:"numCompare"},{label:"\u81ea\u63d0\u8865\u8d34\u603b\u989d",value:"total_self_pick_allowance",type:"numCompare"},{label:"\u9500\u552e\u8fd4\u73b0\u603b\u989d",value:"total_sale_cashback",type:"numCompare"},{label:"\u9500\u552e\u4f63\u91d1\u603b\u989d",value:"total_sale_commission",type:"numCompare"},{label:"\u9500\u552e\u8865\u8d34\u603b\u989d",value:"total_sale_allowance",type:"numCompare"}]},{value:"shop_attributes",label:"\u5e97\u94fa\u5c5e\u6027",children:[{label:"\u72b6\u6001",value:"status",type:"status"},{label:"\u6e20\u9053",value:"channel_id",type:"channel"},{label:"\u5546\u6237\u7ec4",value:"groups",type:"group"}]},{value:"sell_data",label:"\u9500\u552e\u6570\u636e",children:[{label:"\u626b\u7801\u4ed8\u603b\u989d",value:"total_code_scan_amount",type:"numCompare"},{label:"\u652f\u4ed8\u5b9d\u603b\u989d",value:"total_ali_amount",type:"numCompare"},{label:"\u5fae\u4fe1\u652f\u4ed8\u603b\u989d",value:"total_wx_amount",type:"timeCompare"},{label:"\u4f59\u989d\u652f\u4ed8\u603b\u989d",value:"total_balance_amount",type:"numCompare"},{label:"\u62db\u884c\u4e00\u7f51\u901a\u652f\u4ed8\u603b\u989d",value:"total_cmb_amount",type:"numCompare"},{label:"\u8ba2\u8d27\u603b\u989d",value:"total_order_product_amount",type:"numCompare"}]},{value:"self_pick_data",label:"\u81ea\u63d0\u6570\u636e",children:[{label:"\u81ea\u63d0\u8ba2\u5355\u603b\u6570",value:"total_self_pick_orders_count",type:"numCompare"},{label:"\u81ea\u63d0\u8ba2\u5355\u603b\u989d",value:"total_self_pick_amount",type:"numCompare"}]}],oi={detailAddress:[{label:"\u7b49\u4e8e",value:"=",type:"detailAddress"}],equal:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],status:[{label:"\u7b49\u4e8e",value:"=",type:"statusBox"}],timeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"timestamp"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"timestamp"},{label:"\u665a\u4e8e",value:">",type:"timestamp"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"timestamp"},{label:"\u65e9\u4e8e",value:"<",type:"timestamp"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"timestamp"},{label:"\u533a\u95f4",value:"between",type:"period"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],channel:[{label:"\u7b49\u4e8e",value:"=",type:"selectedChannelOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedChannelBox"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not_in",type:"selectedChannelBox"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not_in",type:"selectedGroupBox"},{label:"\u4e3a\u7a7a",value:"is_null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is_not_null",type:""}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not_in",type:"selectedBox"}],cityCompare:[{label:"\u7b49\u4e8e",value:"=",type:"cityOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"cityBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4efb\u610f",value:"not_in",type:"cityBox"}]};function ui(e){return ne({url:"/api/backend/shops/channels",method:"get",params:e})}function mi(e){return ne({url:"/api/backend/shops/channels/tops",method:"get",params:e})}var di=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.showAddGroup=function(){a.props.showAddGroup(a.child.current.state.data)},a.closeAdd=function(){a.props.closeAddGroup()},a.export=function(){console.log(a.props),a.props.export(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.showAddGroup},"\u52a0\u7fa4\u7ec4"),window.hasPermission("shop_management_export")&&i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.export},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:ci,operation:oi,api:{groups:ha,getChannels:ui},slug:"shop"})))}}]),t}(i.a.Component),pi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.onSubmit=function(){a.props.conditionsData;if("create"==a.state.type){if(!a.state.name)return void B.a.error("\u8bf7\u586b\u5199\u5e97\u94fa\u7ec4\u540d\u79f0");if(!a.state.remark)return void B.a.error("\u8bf7\u586b\u5199\u5907\u6ce8");da({name:a.state.name,remark:a.state.remark}).then(function(e){pa({ids:a.props.checkedAry},e.data.id).then(function(e){B.a.success("\u5e97\u94fa\u7ec4\u6dfb\u52a0\u6210\u529f"),a.setState({name:"",remark:""}),a.handleCancel()})})}else{if(!a.state.selectedGroups.length)return void B.a.error("\u8bf7\u5148\u9009\u62e9\u5e97\u94fa\u7ec4");pa({ids:a.props.checkedAry},a.state.selectedGroups[0]).then(function(e){B.a.success("\u5e97\u94fa\u7ec4\u6dfb\u52a0\u6210\u529f"),a.handleCancel()})}},a.state={type:"create",name:"",remark:"",groupList:[],selectedGroups:[],groupId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;ha({}).then(function(t){e.setState({groupList:t.data})})}},{key:"handleChange",value:function(e){var t=[];t.push(e.id),this.setState({selectedGroups:t}),console.log(t)}},{key:"render",value:function(){var e=this,t=Gt.a.CheckableTag;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"create"==this.state.type?"\u65b0\u5efa\u5e97\u94fa\u7ec4":"\u52a0\u5165\u5e97\u94fa\u7ec4",className:"user_add",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.onSubmit,cancelButtonProps:this.handleCancel,cancelText:"\u53d6\u6d88",okText:"\u4fdd\u5b58",maskClosable:!1,zIndex:1001},i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"inline-flex":"none"},onClick:function(){e.setState({type:"join"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u52a0\u5165\u5e97\u94fa\u7ec4"),i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"none":"inline-flex"},onClick:function(){e.setState({type:"create"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u5e97\u94fa\u7ec4"),i.a.createElement("ul",{className:"mainUl t_body"},i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"block":"none"}},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"block":"none"}},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}})),i.a.createElement("li",{className:"tags t_group",style:{display:"create"==this.state.type?"none":"inline-block"}},this.state.groupList.length>0?this.state.groupList.map(function(a){return i.a.createElement(t,{key:a.id,checked:e.state.selectedGroups.indexOf(a.id)>-1,onChange:function(t){return e.handleChange(a,t)}},a.name)}):"\u8be5\u5206\u7ec4\u4e0b\u6682\u65e0\u6807\u7b7e"))))}}]),t}(i.a.Component),hi=(a(538),a(189),a(1064),Q.a.Option),fi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleProvinceChange=function(e){var t=a.state.province.filter(function(t){return t.region_code==e});t[0].children.length?a.setState({activeProvince:t[0].region_code,cities:t[0].children,activeCity:t[0].children[0].region_code,activeArea:t[0].children[0].children[0].region_code,area:t[0].children[0].children}):a.setState({activeProvince:t[0].region_code,cities:[],area:[]})},a.onSecondCityChange=function(e){var t=a.state.cities.filter(function(t){return t.region_code==e});t[0].children.length?a.setState({activeCity:t[0].region_code,area:t[0].children,activeArea:t[0].children[0].region_code}):a.setState({activeProvince:t[0].region_code,cities:[],area:[]})},a.onAreaChange=function(e){var t=a.state.area.filter(function(t){return t.region_code==e});a.setState({activeArea:t[0].region_code})},a.state={province:[],activeProvince:"",cities:[],activeCity:"",area:[],activeArea:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;if(e.defaultData.area_code!==this.props.defaultData.area_code||!this.state.activeArea){var n=e.defaultData,i=y.a.isEmpty(n),r=[];y.a.map(n,function(e){r.push(parseInt(e))}),xe({}).then(function(e){a.setState({province:e,cities:e[0].children,area:e[0].children[0].children,activeProvince:e[0].region_code,activeCity:e[0].children[0].region_code,activeArea:e[0].children[0].children[0].region_code}),i||(a.handleProvinceChange(r[0]),a.onSecondCityChange(r[1]),a.onAreaChange(r[2]))}).catch(function(e){})}}},{key:"componentWillMount",value:function(){}},{key:"render",value:function(){this.state.cities;return i.a.createElement("div",{className:"selectedAddress"},this.state.province&&this.state.province.length?i.a.createElement("div",{className:"select_addr"},i.a.createElement(Q.a,{value:this.state.activeProvince,style:{width:80,marginLeft:0},onChange:this.handleProvinceChange,defaultActiveFirstOption:!1},this.state.province.map(function(e){return i.a.createElement(hi,{key:e.region_code,value:e.region_code},e.name)})),i.a.createElement(Q.a,{style:{width:80,display:this.state.cities.length?"inline-block":"none"},value:this.state.activeCity,onChange:this.onSecondCityChange,defaultActiveFirstOption:!1},this.state.cities.map(function(e){return i.a.createElement(hi,{key:e.region_code,value:e.region_code},e.name)})),i.a.createElement(Q.a,{style:{width:80,display:this.state.area.length?"inline-block":"none"},value:this.state.activeArea,onChange:this.onAreaChange,defaultActiveFirstOption:!1},this.state.area.map(function(e){return i.a.createElement(hi,{key:e.region_code,value:e.region_code},e.name)}))):"\u6682\u65e0\u6570\u636e")}}]),t}(i.a.Component),Ei=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e=a.state.listData;if(console.log(e),e.address)if(e.introducer_code||a.props.recordId)if(e.keeper_name)if(O(e.keeper_mobile))if(N(e.keeper_id_card_no)){var t={front:a.front.current.state.imgUrl||a.front.current.state.imageUrl,backend:a.backend.current.state.imgUrl||a.backend.current.state.imageUrl,holding:a.holding.current.state.imgUrl||a.holding.current.state.imageUrl};for(var n in t)if(!t[n])return void B.a.error("\u8bf7\u4e0a\u4f20\u8eab\u4efd\u8bc1\u76f8\u5173\u7167\u7247");var i,r={application_id:e.id||"",channel_id:a.props.id||"",channel_slug:"DISTRIBUTOR",province_code:a.child.current.state.activeProvince+"",city_code:a.child.current.state.activeCity+"",area_code:a.child.current.state.activeArea+"",address:e.address,keeper_name:e.keeper_name,keeper_mobile:e.keeper_mobile,keeper_id_card_no:e.keeper_id_card_no,status:a.state.status,introducer_code:e.introducer_code,id_card_images:t};a.props.recordId?tt(r,a.props.recordId).then(function(e){B.a.success("\u7f16\u8f91\u5e97\u94fa\u6210\u529f"),a.handleCancel()}).catch(function(e){}):(i=r,ne({url:"/api/backend/shops/distributor",method:"post",data:i})).then(function(e){B.a.success("\u65b0\u589e\u5e97\u94fa\u6210\u529f"),a.handleCancel()})}else B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u8eab\u4efd\u8bc1\u53f7");else B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7");else B.a.error("\u8bf7\u586b\u5199\u59d3\u540d");else B.a.error("\u8bf7\u586b\u5199\u4ecb\u7ecd\u4eba\u7f16\u53f7");else B.a.error("\u8bf7\u586b\u5199\u5730\u5740")},a.state={listData:{},status:100,value:"",positionData:{province_code:"340000",city_code:"340100",area_code:"340102"},statusD:"create"},a.child=i.a.createRef(),a.front=i.a.createRef(),a.backend=i.a.createRef(),a.holding=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.props.data!=e.data&&this.setState({listData:e.data}),this.props.recordId!=e.recordId?at({},e.recordId).then(function(e){var t={};t.province_code=e.data.province_code,t.city_code=e.data.city_code,t.area_code=e.data.area_code,a.setState({listData:e.data,positionData:t,statusD:"edit"})}):this.setState({statusD:"create"})}},{key:"render",value:function(){var e=this,t=this.state,a=t.listData,n=t.positionData;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("ul",{className:"mainUl shops-input"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u6e20\u9053\uff1a"),this.props.recordId?i.a.createElement("span",null,this.props.channelDesc):i.a.createElement("span",null,"\u5206\u9500\u5458")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4ecb\u7ecd\u4eba\u7f16\u53f7"),this.props.recordId?i.a.createElement("span",null,a.introducer_code||"\u6682\u65e0"):i.a.createElement(Ne.a,{className:"liInput",value:a.introducer_code,onChange:function(t){e.setState({listData:Object(be.a)({},a,{introducer_code:t.target.value})})}})),!y.a.isEmpty(n)&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u5730\u5740"),i.a.createElement(fi,{ref:this.child,defaultData:n})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8be6\u7ec6\u5730\u5740"),i.a.createElement(Ne.a,{className:"liInput",value:a.address,onChange:function(t){e.setState({listData:Object(be.a)({},a,{address:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5206\u9500\u5458\u59d3\u540d"),i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_name,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_name:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5206\u9500\u5458\u7535\u8bdd"),i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_mobile,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_mobile:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5206\u9500\u5458\u8eab\u4efd\u8bc1\u53f7\u7801"),this.props.recordId?i.a.createElement("span",null,a.keeper_id_card_no):i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_id_card_no,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_id_card_no:t.target.value})})}})),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8eab\u4efd\u8bc1\u7167\u7247"),i.a.createElement("div",{className:"imgs"},i.a.createElement(ta,{ref:this.front,defaultImg:a.id_card_images?a.id_card_images.front:"",text:"\u6b63\u9762",status:this.state.statusD}),i.a.createElement(ta,{ref:this.backend,defaultImg:a.id_card_images?a.id_card_images.backend:"",text:"\u53cd\u9762",status:this.state.statusD}),i.a.createElement(ta,{ref:this.holding,defaultImg:a.id_card_images?a.id_card_images.holding:"",text:"\u624b\u6301",status:this.state.statusD}))))))}}]),t}(i.a.Component),vi=ge.a.confirm,_i=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.refuse=function(){var e=a.state.data,t=Object(Ja.a)(a),n=vi({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u62d2\u7edd\u8be5\u7533\u8bf7\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Ze({},e.id).then(function(e){t.handleCancel(),t.props.onShowApp()})}})},a.handleSubmit=function(){a.handleCancel(),a.setState({distributorVisible:!0,newData:a.state.data})},a.hideDistributor=function(){a.setState({distributorVisible:!1})},a.state={data:{},distributorVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.data.channel_name&&this.setState({data:e.data})}},{key:"render",value:function(){var e=this.state.data;return i.a.createElement("div",null,i.a.createElement(Ei,{visible:this.state.distributorVisible,data:this.state.newData,onClose:this.hideDistributor}),i.a.createElement(ge.a,{title:"\u5ba1\u6838",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.refuse},"\u62d2\u7edd"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u540c\u610f\u5e76\u65b0\u589e"))},this.state.data.channel_name?i.a.createElement("ul",{className:"mainUl "},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u6e20\u9053\uff1a"),i.a.createElement("span",null,e.channel_name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4ecb\u7ecd\u4eba\u7f16\u53f7"),i.a.createElement("span",null,e.introducer_no)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7701"),i.a.createElement("span",null,e.province)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e02"),i.a.createElement("span",null,e.city||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u533a"),i.a.createElement("span",null,e.area||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8be6\u7ec6\u5730\u5740"),i.a.createElement("span",null,e.address)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5206\u9500\u5458\u59d3\u540d"),i.a.createElement("span",null,e.applicant_name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u624b\u673a\u53f7\u7801"),i.a.createElement("span",null,e.mobile)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8eab\u4efd\u8bc1\u53f7\u7801"),i.a.createElement("span",null,e.id_card_no)),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8eab\u4efd\u8bc1\u7167\u7247"),e.id_card_images&&e.id_card_images.length?i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:e.id_card_images[0],alt:""}),i.a.createElement("img",{src:e.id_card_images[1],alt:""}),i.a.createElement("img",{src:e.id_card_images[2],alt:""})):"")):"\u6682\u65e0\u6570\u636e"))}}]),t}(i.a.Component),gi=a(407),bi=(a(1077),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).placeSearch=function(e){a.setState({searchContent:e})},a.handleCancel=function(){a.props.hideMap()},a.handleSubmit=function(){a.props.disabled?a.handleCancel():(a.props.handleLocation(a.state.searchContent,a.state.markerPosition),a.handleCancel())},a.mapPlugins=["ToolBar","MapType"],a.state={markerPosition:{longitude:117.227355,latitude:31.820621},searchContent:"\u5b89\u5fbd\u7701\u5408\u80a5\u5e02\u653f\u5e9c"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.position&&this.setState({markerPosition:Object(be.a)({},this.state.markerPosition,{longitude:e.position.lng,latitude:e.position.lat}),searchContent:""},function(){console.log("\u66f4\u65b0\u5730\u56fe\u6570\u636e")})}},{key:"render",value:function(){var e=this,t={created:function(t){var a,n;window.AMap.plugin("AMap.Autocomplete",function(){a=new window.AMap.Autocomplete({input:"SearchInput"})}),window.AMap.plugin(["AMap.Geocoder"],function(){n=new window.AMap.Geocoder({radius:1e3,extensions:"all"})}),window.AMap.plugin("AMap.PlaceSearch",function(){var t=new window.AMap.PlaceSearch({}),i=e;window.AMap.event.addListener(a,"select",function(e){t.search(e.poi.name),n.getAddress(e.poi.position,function(t,a){if("complete"===t&&a.regeocode){var n=a.regeocode.aois[0].name,r=a.regeocode.addressComponent;r.township,r.street,r.streetNumber;i.setState({markerPosition:Object(be.a)({},i.state.markerPosition,{longitude:e.poi.location.lng,latitude:e.poi.location.lat}),searchContent:n})}})})})},click:function(t){var a,n=e;window.AMap.plugin(["AMap.Geocoder"],function(){a=new window.AMap.Geocoder({radius:1e3,extensions:"all"})}),a.getAddress(t.lnglat,function(e,a){if(console.log(e,a),"complete"===e&&a.regeocode){var i=a.regeocode.formattedAddress,r=a.regeocode.addressComponent;r.township,r.street,r.streetNumber;n.setState({markerPosition:Object(be.a)({},n.state.markerPosition,{longitude:t.lnglat.lng,latitude:t.lnglat.lat}),searchContent:i})}}),e.setState({markerPosition:Object(be.a)({},e.state.markerPosition,{longitude:t.lnglat.lng,latitude:t.lnglat.lat}),searchContent:""})}};return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9009\u62e9\u4f4d\u7f6e",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"map_position"},i.a.createElement(Ne.a,{id:"SearchInput",placeholder:"\u8bf7\u8f93\u5165\u5730\u540d\u641c\u7d22",value:this.state.searchContent,onKeyDown:function(t){return e.searchPlace(t)},onChange:function(t){e.placeSearch(t.target.value)}}),i.a.createElement("div",{className:"position_data"},i.a.createElement("div",null,"\u7ecf\u5ea6",i.a.createElement(Ne.a,{value:this.state.markerPosition.longitude,onChange:function(t){t.target.value.length&&e.setState({markerPosition:Object(be.a)({},e.state.markerPosition,{longitude:t.target.value})})}})),i.a.createElement("div",null,"\u7eac\u5ea6",i.a.createElement(Ne.a,{value:this.state.markerPosition.latitude,onChange:function(t){t.target.value.length&&e.setState({markerPosition:Object(be.a)({},e.state.markerPosition,{latitude:t.target.value})})}})))),i.a.createElement("div",{id:"app"},i.a.createElement(gi.Map,{amapkey:"fd248e6677dd92df77bf4a9a1a502d57",plugins:this.mapPlugins,events:t,center:[this.state.markerPosition.longitude,this.state.markerPosition.latitude]},i.a.createElement(gi.Marker,{position:this.state.markerPosition,title:this.state.searchContent})))))}}]),t}(i.a.Component)),yi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({lngLat:{latitude:"",longitude:""}}),a.props.onClose()},a.handleSubmit=function(){var e=a.state.listData;if(e.address)if(e.keeper_name)if(e.introducer_code)if(e.uni_code)if(e.name)if(O(e.keeper_mobile))if(a.props.recordId||N(e.keeper_id_card_no))if(a.props.recordId||a.state.activeChannel)if(a.props.recordId||a.state.activeRoute){var t={front:a.front.current.state.imgUrl||a.front.current.state.imageUrl,backend:a.backend.current.state.imgUrl||a.backend.current.state.imageUrl,holding:a.holding.current.state.imgUrl||a.holding.current.state.imageUrl};for(var n in t)if(!t[n])return void B.a.error("\u8bf7\u4e0a\u4f20\u8eab\u4efd\u8bc1\u76f8\u5173\u7167\u7247");var i={front:a.bFront.current.state.imgUrl||a.bFront.current.state.imageUrl};for(var r in i)if(!i[r])return void B.a.error("\u8bf7\u4e0a\u4f20\u8425\u4e1a\u6267\u7167");var l={cashier:a.cashier.current.state.imgUrl||a.cashier.current.state.imageUrl,doorway:a.doorway.current.state.imgUrl||a.doorway.current.state.imageUrl,environment:a.environment.current.state.imgUrl||a.environment.current.state.imageUrl};for(var s in l)if(!l[s])return void B.a.error("\u8bf7\u4e0a\u4f20\u5e97\u94fa\u76f8\u5173\u7167\u7247");var c,o={application_id:e.id||"",channel_id:a.state.activeChannel,channel_slug:"SHOP_KEEPER",province_code:a.childAdd.current.state.activeProvince,city_code:a.childAdd.current.state.activeCity,area_code:a.childAdd.current.state.activeArea,address:e.address,uni_code:e.uni_code,delivery_route_id:a.state.activeRoute,keeper_name:e.keeper_name,keeper_mobile:e.keeper_mobile,keeper_id_card_no:e.keeper_id_card_no,status:a.state.status,introducer_code:e.introducer_code,name:e.name,lat:a.state.lngLat.latitude||e.position.lat,lng:a.state.lngLat.longitude||e.position.lng,id_card_images:t,business_license_images:i,shop_images:l};a.props.recordId?tt(o,a.props.recordId).then(function(e){B.a.success("\u7f16\u8f91\u5e97\u94fa\u6210\u529f"),a.props.refresh(),a.handleCancel()}).catch(function(e){}):(c=o,ne({url:"/api/backend/shops/shop_keeper",method:"post",data:c})).then(function(e){B.a.success("\u65b0\u589e\u5e97\u94fa\u6210\u529f"),a.props.refresh(),a.handleCancel()})}else B.a.error("\u8bf7\u5148\u9009\u62e9\u7269\u6d41\u8def\u7ebf");else B.a.error("\u8bf7\u5148\u9009\u62e9\u5b50\u6e20\u9053");else B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u8eab\u4efd\u8bc1\u53f7");else B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7");else B.a.error("\u8bf7\u586b\u5199\u5e97\u94fa\u540d");else B.a.error("\u8bf7\u586b\u5199\u5e97\u94fa\u7f16\u53f7");else B.a.error("\u8bf7\u586b\u5199\u4ecb\u7ecd\u4eba\u7f16\u53f7");else B.a.error("\u8bf7\u586b\u5199\u5546\u6237\u59d3\u540d");else B.a.error("\u8bf7\u586b\u5199\u5730\u5740")},a.showMap=function(e){a.handleCancel(),a.state.lngLat.latitude?a.setState({visible:!0,position:Object(be.a)({},a.state.position,{lng:a.state.lngLat.longitude,lat:a.state.lngLat.latitude})}):a.setState({visible:!0,position:e})},a.hideMap=function(){a.props.onShow(),a.setState({visible:!1})},a.handleLocation=function(e,t){a.setState({address:e,lngLat:t,position:Object(be.a)({},a.state.position,{lng:t.longitude,lat:t.latitude})})},a.handleChannelChange=function(e){a.setState({activeChannel:e})},a.handleRouteChange=function(e){a.setState({activeRoute:e})},a.state={visible:!1,positionData:{province_code:"340000",city_code:"340100",area_code:"340102"},address:"\u8bbe\u7f6e\u5730\u56fe\u5750\u6807",listData:{},status:100,channels:[],routes:[],activeChannel:"",activeRoute:"",lngLat:{},statusD:"create"},a.childMap=i.a.createRef(),a.childAdd=i.a.createRef(),a.front=i.a.createRef(),a.backend=i.a.createRef(),a.holding=i.a.createRef(),a.bFront=i.a.createRef(),a.cashier=i.a.createRef(),a.doorway=i.a.createRef(),a.environment=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.props.data!=e.data&&this.setState({listData:e.data}),this.props.recordId!=e.recordId?at({},e.recordId).then(function(e){var t={};t.province_code=e.data.province_code,t.city_code=e.data.city_code,t.area_code=e.data.area_code,a.setState({listData:e.data,positionData:t,activeRoute:e.data.delivery_route_id,statusD:"edit",address:"\u8bbe\u7f6e\u5730\u56fe\u5750\u6807"})}):this.setState({statusD:"create"})}},{key:"componentDidMount",value:function(){var e,t=this;(e={slug:"SHOP_KEEPER"},ne({url:"/api/backend/shops/channels/subordinate",method:"get",params:e})).then(function(e){t.setState({channels:e.data})}),Qe({}).then(function(e){t.setState({routes:e.data})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.listData,n=t.positionData;return i.a.createElement("div",null,i.a.createElement(bi,{visible:this.state.visible,hideMap:this.hideMap,handleLocation:this.handleLocation,position:this.state.position,ref:this.childMap}),i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("ul",{className:"mainUl shops-input"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u6e20\u9053\uff1a"),this.props.recordId?i.a.createElement("span",null,this.props.channelDesc):i.a.createElement("span",null,"\u5546\u6237")),i.a.createElement("li",{className:"extraHeight"},i.a.createElement("span",{className:"left"},"\u5b50\u6e20\u9053"),this.props.recordId?i.a.createElement("span",null,a.channel_name||"\u6682\u65e0"):i.a.createElement(Q.a,{value:this.state.activeChannel,style:{width:"320px"},onChange:this.handleChannelChange,defaultActiveFirstOption:!1},this.state.channels.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id},e.name)}))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4ecb\u7ecd\u4eba\u7f16\u53f7"),this.props.recordId?i.a.createElement("span",null,a.introducer_code||"\u6682\u65e0"):i.a.createElement(Ne.a,{className:"liInput",value:a.introducer_code,onChange:function(t){e.setState({listData:Object(be.a)({},a,{introducer_code:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u91d1\u8776\u7f16\u53f7"),i.a.createElement(Ne.a,{className:"liInput",value:a.uni_code,onChange:function(t){e.setState({listData:Object(be.a)({},a,{uni_code:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:a.name,onChange:function(t){e.setState({listData:Object(be.a)({},a,{name:t.target.value})})}})),i.a.createElement("li",{className:"extraHeight"},i.a.createElement("span",{className:"left"},"\u7269\u6d41\u8def\u7ebf"),i.a.createElement(Q.a,{value:this.state.activeRoute,style:{width:"320px"},onChange:this.handleRouteChange,defaultActiveFirstOption:!1},this.state.routes.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id},e.name)}))),!y.a.isEmpty(n)&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u5730\u5740"),i.a.createElement(fi,{ref:this.childAdd,defaultData:n})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8be6\u7ec6\u5730\u5740"),i.a.createElement(Ne.a,{className:"liInput",value:a.address,onChange:function(t){e.setState({listData:Object(be.a)({},a,{address:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5730\u56fe\u4f4d\u7f6e"),i.a.createElement("span",{onClick:function(){return e.showMap(a.position)},style:{cursor:"pointer",width:"320px"}},i.a.createElement("i",{className:"iconfont",style:{fontSize:"14px",color:"#4F9863",marginRight:"3px"}},"\ue7b0"),this.state.address)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u6237\u59d3\u540d"),i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_name,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_name:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u6237\u7535\u8bdd"),i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_mobile,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_mobile:t.target.value})}),e.setState({listData:Object(be.a)({},a,{keeper_mobile:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u6237\u8eab\u4efd\u8bc1\u53f7\u7801"),this.props.recordId?i.a.createElement("span",null,a.keeper_id_card_no):i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_id_card_no,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_id_card_no:t.target.value})})}})),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8eab\u4efd\u8bc1\u7167\u7247\uff1a"),i.a.createElement("div",{className:"imgs"},i.a.createElement(ta,{ref:this.front,text:"\u6b63\u9762",defaultImg:a.id_card_images?a.id_card_images.front:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.backend,text:"\u53cd\u9762",defaultImg:a.id_card_images?a.id_card_images.backend:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.holding,text:"\u624b\u6301",defaultImg:a.id_card_images?a.id_card_images.holding:"",status:this.state.statusD}))),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8425\u4e1a\u6267\u7167\uff1a"),i.a.createElement("div",{className:"imgs"},i.a.createElement(ta,{ref:this.bFront,text:"\u4e0a\u4f20",defaultImg:a.business_license_images?a.business_license_images.front:"",status:this.state.statusD}))),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u5e97\u94fa\u7167\u7247\uff1a"),i.a.createElement("div",{className:"imgs"},i.a.createElement(ta,{ref:this.cashier,text:"\u4e0a\u4f20",defaultImg:a.shop_images?a.shop_images.cashier:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.doorway,text:"\u4e0a\u4f20",defaultImg:a.shop_images?a.shop_images.doorway:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.environment,text:"\u4e0a\u4f20",defaultImg:a.shop_images?a.shop_images.environment:"",status:this.state.statusD}))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u72b6\u6001"),i.a.createElement(mn.a.Group,{value:this.state.status,onChange:function(t){e.setState({status:t.target.value})}},i.a.createElement(mn.a,{value:100},"\u5f00\u4e1a"),i.a.createElement(mn.a,{value:200},"\u6253\u70ca"))))))}}]),t}(i.a.Component),Ci=ge.a.confirm,ki=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){a.handleCancel(),a.setState({shopKeeperVisible:!0,confirmData:a.state.data})},a.refuse=function(){var e=a.state.data,t=Object(Ja.a)(a),n=Ci({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u62d2\u7edd\u8be5\u7533\u8bf7\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Ze({},e.id).then(function(e){t.handleCancel(),t.props.onShowApp()})}})},a.showMap=function(e){a.handleCancel(),a.setState({visible:!0,position:e})},a.hideMap=function(){a.props.onShow(),a.setState({visible:!1})},a.handleLocation=function(e,t){console.log(e),console.log(t),a.setState({address:e})},a.hideShopKeeper=function(){a.setState({shopKeeperVisible:!1})},a.showShopKeeper=function(){a.setState({shopKeeperVisible:!0,confirmData:a.state.data})},a.state={visible:!1,positionData:{},address:"\u8bbe\u7f6e\u5730\u56fe\u5750\u6807",data:{},shopKeeperVisible:!1,confirmData:{}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.data.channel_name&&this.setState({data:e.data})}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",null,i.a.createElement(bi,{visible:this.state.visible,hideMap:this.hideMap,handleLocation:this.handleLocation,position:this.state.position}),i.a.createElement(yi,{visible:this.state.shopKeeperVisible,data:this.state.confirmData,onClose:this.hideShopKeeper,onShow:this.showShopKeeper}),i.a.createElement(ge.a,{title:"\u5ba1\u6838",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.refuse},"\u62d2\u7edd"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u540c\u610f\u5e76\u65b0\u589e"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u6e20\u9053\uff1a"),i.a.createElement("span",null,"\u5546\u6237")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5b50\u6e20\u9053"),i.a.createElement("span",null,t.channel_name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u540d\u79f0"),i.a.createElement("span",null,t.name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7701"),i.a.createElement("span",null,t.province||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e02"),i.a.createElement("span",null,t.city||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u533a"),i.a.createElement("span",null,t.area||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8be6\u7ec6\u5730\u5740"),i.a.createElement("span",null,t.address)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5730\u56fe\u4f4d\u7f6e"),i.a.createElement("span",{onClick:function(){return e.showMap(t.position)},style:{cursor:"pointer"}},i.a.createElement("i",{className:"iconfont",style:{fontSize:"14px",color:"#4F9863",marginRight:"3px"}},"\ue7b0"),this.state.address)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u6237\u59d3\u540d"),i.a.createElement("span",null,t.keeper_name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u6237\u7535\u8bdd"),i.a.createElement("span",null,t.keeper_mobile)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u6237\u8eab\u4efd\u8bc1\u53f7\u7801"),i.a.createElement("span",null,t.keeper_id_card_no)),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8eab\u4efd\u8bc1\u7167\u7247\uff1a"),t.id_card_images&&t.id_card_images.length?i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:t.id_card_images[0],alt:""}),i.a.createElement("img",{src:t.id_card_images[1],alt:""}),i.a.createElement("img",{src:t.id_card_images[2],alt:""})):""),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8425\u4e1a\u6267\u7167\uff1a"),i.a.createElement("div",{className:"id_images"},t.business_license_images&&t.business_license_images.length?i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:t.business_license_images[0],alt:""})):"")),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u5e97\u94fa\u7167\u7247\uff1a"),i.a.createElement("div",{className:"id_images"},t.shop_images&&t.shop_images.length?i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:t.shop_images[0],alt:""}),i.a.createElement("img",{src:t.shop_images[1],alt:""}),i.a.createElement("img",{src:t.shop_images[2],alt:""})):"")))))}}]),t}(i.a.Component),Si=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleShow=function(){a.props.onShow(),a.child.current.pagination(a.child.current.state.current)},a.paginationChange=function(e){a.setState({data:e})},a.startWork=function(e){var t,n;a.handleCancel(),(t={},n=e.id,ne({url:"/api/backend/shops/applications/".concat(n),method:"get",params:t})).then(function(t){switch(e.channel_slug){case"DISTRIBUTOR":return void a.setState({d_visible:!0,shop_data:t.data});case"SHOP_KEEPER":return void a.setState({s_visible:!0,shop_data:t.data});default:return}})},a.closeD=function(){a.setState({d_visible:!1})},a.showD=function(){a.setState({d_visible:!0})},a.closeS=function(){a.setState({s_visible:!1})},a.showS=function(){a.setState({s_visible:!0})},a.state={api:$e,params:{status:0},data:[],shop_data:{},d_visible:!1,s_visible:!1},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u59d3\u540d",dataIndex:"applicant_name",render:function(t,a){return i.a.createElement("span",{onClick:function(){return e.jump(a)}},t)}},{title:"\u5e97\u94fa\u6e20\u9053",dataIndex:"channel_name"},{title:"\u64cd\u4f5c",dataIndex:"balance",render:function(t,a){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.startWork(a)}},"\u5ba1\u6838")}}];return i.a.createElement("div",null,i.a.createElement(_i,{visible:this.state.d_visible,onClose:this.closeD,onShow:this.showD,data:this.state.shop_data,onShowApp:this.handleShow}),i.a.createElement(ki,{visible:this.state.s_visible,onClose:this.closeS,onShow:this.showS,data:this.state.shop_data,onShowApp:this.handleShow}),i.a.createElement(ge.a,{title:"\u7533\u8bf7\u5217\u8868",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,valChange:this.paginationChange,params:this.state.params}))))}}]),t}(i.a.Component),Oi=(a(1078),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e=a.state.listData;if(e.address)if(e.keeper_name)if(a.props.recordId||e.uni_code)if(e.name)if(O(e.keeper_mobile))if(a.props.recordId||N(e.keeper_id_card_no))if(a.props.recordId||a.state.activeRoute){var t={front:a.front.current.state.imgUrl||a.front.current.state.imageUrl,backend:a.backend.current.state.imgUrl||a.backend.current.state.imageUrl,holding:a.holding.current.state.imgUrl||a.holding.current.state.imageUrl};for(var n in t)if(!t[n])return void B.a.error("\u8bf7\u4e0a\u4f20\u8eab\u4efd\u8bc1\u76f8\u5173\u7167\u7247");var i={cashier:a.cashier.current.state.imgUrl||a.cashier.current.state.imageUrl,doorway:a.doorway.current.state.imgUrl||a.doorway.current.state.imageUrl,environment:a.environment.current.state.imgUrl||a.environment.current.state.imageUrl};for(var r in i)if(!i[r])return void B.a.error("\u8bf7\u4e0a\u4f20\u5e97\u94fa\u76f8\u5173\u7167\u7247");var l,s={application_id:e.id||"",channel_id:a.props.id,channel_slug:"BREAKFAST_CAR",province_code:a.childAdd.current.state.activeProvince,city_code:a.childAdd.current.state.activeCity,area_code:a.childAdd.current.state.activeArea,address:e.address,keeper_name:e.keeper_name,keeper_mobile:e.keeper_mobile,keeper_id_card_no:e.keeper_id_card_no,uni_code:e.uni_code,delivery_route_id:a.state.activeRoute,status:a.state.status,breakfast_car_code:e.breakfast_car_code||e.breakfast_code,name:e.name,lat:a.state.lngLat.latitude||e.position.lat,lng:a.state.lngLat.longitude||e.position.lng,id_card_images:t,shop_images:i};console.log(e),console.log(s),a.props.recordId?tt(s,a.props.recordId).then(function(e){B.a.success("\u7f16\u8f91\u5e97\u94fa\u6210\u529f"),a.handleCancel()}).catch(function(e){}):(l=s,ne({url:"/api/backend/shops/breakfast_car",method:"post",data:l})).then(function(e){B.a.success("\u65b0\u589e\u5e97\u94fa\u6210\u529f"),a.handleCancel()})}else B.a.error("\u8bf7\u5148\u9009\u62e9\u7269\u6d41\u8def\u7ebf");else B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u8eab\u4efd\u8bc1\u53f7");else B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7");else B.a.error("\u8bf7\u586b\u5199\u5e97\u94fa\u540d");else B.a.error("\u8bf7\u586b\u5199\u5e97\u94fa\u7f16\u53f7");else B.a.error("\u8bf7\u586b\u5199\u8f66\u4e3b\u59d3\u540d");else B.a.error("\u8bf7\u586b\u5199\u5730\u5740")},a.showMap=function(e){console.log(e),console.log(a.state.lngLat.latitude),a.handleCancel(),a.state.lngLat.latitude?a.setState({visible:!0,position:Object(be.a)({},a.state.position,{lng:a.state.lngLat.longitude,lat:a.state.lngLat.latitude})}):a.setState({visible:!0,position:e})},a.hideMap=function(){a.props.onShow(),a.setState({visible:!1})},a.handleLocation=function(e,t){a.setState({address:e,lngLat:t,position:Object(be.a)({},a.state.position,{lng:t.longitude,lat:t.latitude})})},a.handleRouteChange=function(e){a.setState({activeRoute:e})},a.state={visible:!1,positionData:{province_code:"340000",city_code:"340100",area_code:"340102"},address:"\u8bbe\u7f6e\u5730\u56fe\u5750\u6807",listData:{},status:100,activeRoute:"",routes:[],lngLat:{},statusD:"create"},a.childMap=i.a.createRef(),a.childAdd=i.a.createRef(),a.front=i.a.createRef(),a.backend=i.a.createRef(),a.holding=i.a.createRef(),a.cashier=i.a.createRef(),a.doorway=i.a.createRef(),a.environment=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.props.recordId!=e.recordId?at({},e.recordId).then(function(e){var t={};t.province_code=e.data.province_code,t.city_code=e.data.city_code,t.area_code=e.data.area_code,a.setState({listData:e.data,positionData:t,activeRoute:e.data.delivery_route_id,statusD:"edit"})}):this.setState({statusD:"create"})}},{key:"componentDidMount",value:function(){var e=this;Qe({}).then(function(t){e.setState({routes:t.data})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.listData,n=t.positionData;return i.a.createElement("div",null,i.a.createElement(bi,{visible:this.state.visible,hideMap:this.hideMap,handleLocation:this.handleLocation,ref:this.childMap,position:this.state.position}),i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("ul",{className:"mainUl shops-input"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u6e20\u9053"),this.props.recordId?i.a.createElement("span",null,this.props.channelDesc):i.a.createElement("span",null,"\u65e9\u9910\u8f66")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u7f16\u53f7"),i.a.createElement(Ne.a,{className:"liInput",value:a.uni_code,onChange:function(t){e.setState({listData:Object(be.a)({},a,{uni_code:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:a.name,onChange:function(t){e.setState({listData:Object(be.a)({},a,{name:t.target.value})})}})),i.a.createElement("li",{className:"extraHeight"},i.a.createElement("span",{className:"left"},"\u7269\u6d41\u8def\u7ebf"),i.a.createElement(Q.a,{value:this.state.activeRoute,style:{width:"320px"},onChange:this.handleRouteChange,defaultActiveFirstOption:!1},this.state.routes.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id},e.name)}))),!y.a.isEmpty(n)&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u5730\u5740"),i.a.createElement(fi,{ref:this.childAdd,defaultData:n})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8be6\u7ec6\u5730\u5740"),i.a.createElement(Ne.a,{className:"liInput",value:a.address,onChange:function(t){e.setState({listData:Object(be.a)({},a,{address:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5730\u56fe\u4f4d\u7f6e"),i.a.createElement("span",{onClick:function(){return e.showMap(a.position)},style:{cursor:"pointer",width:"320px"}},i.a.createElement("i",{className:"iconfont",style:{fontSize:"14px",color:"#4F9863",marginRight:"3px"}},"\ue7b0"),this.state.address)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8f66\u4e3b\u59d3\u540d"),i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_name,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_name:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8f66\u4e3b\u7535\u8bdd"),i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_mobile,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_mobile:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8f66\u4e3b\u8eab\u4efd\u8bc1\u53f7\u7801"),this.props.recordId?i.a.createElement("span",null,a.keeper_id_card_no):i.a.createElement(Ne.a,{className:"liInput",value:a.keeper_id_card_no,onChange:function(t){e.setState({listData:Object(be.a)({},a,{keeper_id_card_no:t.target.value})})}})),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u8eab\u4efd\u8bc1\u7167\u7247\uff1a"),i.a.createElement("div",{className:"imgs"},i.a.createElement(ta,{ref:this.front,text:"\u6b63\u9762",defaultImg:a.id_card_images?a.id_card_images.front:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.backend,text:"\u53cd\u9762",defaultImg:a.id_card_images?a.id_card_images.backend:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.holding,text:"\u624b\u6301",defaultImg:a.id_card_images?a.id_card_images.holding:"",status:this.state.statusD}))),i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u4e0a\u4f20\u5e97\u94fa\u7167\u7247\uff1a"),i.a.createElement("div",{className:"imgs"},i.a.createElement(ta,{ref:this.cashier,text:"\u4e0a\u4f20",defaultImg:a.shop_images?a.shop_images.cashier:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.doorway,text:"\u4e0a\u4f20",defaultImg:a.shop_images?a.shop_images.doorway:"",status:this.state.statusD}),i.a.createElement(ta,{ref:this.environment,text:"\u4e0a\u4f20",defaultImg:a.shop_images?a.shop_images.environment:"",status:this.state.statusD}))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u72b6\u6001"),i.a.createElement(mn.a.Group,{value:this.state.status,onChange:function(t){e.setState({status:t.target.value})}},i.a.createElement(mn.a,{value:100},"\u5f00\u4e1a"),i.a.createElement(mn.a,{value:200},"\u6253\u70ca"))))))}}]),t}(i.a.Component)),Ni=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=a.state.channels.filter(function(t){return t.id==e.target.value});a.setState({radio:e.target.value,radioName:t[0].name})},a.handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){switch(a.handleCancel(),a.state.radioName){case"\u65e9\u9910\u8f66":return void a.showBreakfast();case"\u5546\u6237":return void a.showShopKeeper();default:a.showDistributor()}},a.showBreakfast=function(){a.setState({breakfast:!0})},a.hideBreakfast=function(){a.setState({breakfast:!1})},a.showDistributor=function(){a.setState({distributor:!0})},a.hideDistributor=function(){a.setState({distributor:!1})},a.showShopKeeper=function(){a.setState({shopKeeper:!0})},a.hideShopKeeper=function(){a.setState({shopKeeper:!1})},a.state={radio:"",breakfast:!1,shopKeeper:!1,distributor:!1,channels:[],radioName:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;mi({}).then(function(t){e.setState({channels:t.data,radio:t.data[0].id,radioName:t.data[0].name})})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(Oi,{visible:this.state.breakfast,onClose:this.hideBreakfast,onShow:this.showBreakfast,id:this.state.radio}),i.a.createElement(Ei,{visible:this.state.distributor,onClose:this.hideDistributor,onShow:this.showDistributor,id:this.state.radio}),i.a.createElement(yi,{visible:this.state.shopKeeper,onClose:this.hideShopKeeper,onShow:this.showShopKeeper,id:this.state.radio}),i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"s_channel"},i.a.createElement("span",{className:"left"},"\u9009\u62e9\u5e97\u94fa\u6e20\u9053"),i.a.createElement(mn.a.Group,{onChange:this.onChange,value:this.state.radio},this.state.channels.map(function(e){return i.a.createElement(mn.a,{value:e.id,key:e.id},e.name)})))))}}]),t}(i.a.Component),wi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.confirm=function(){a.state.isShow?a.handleSubmit():a.showNotice()},a.showNotice=function(){var e=a.handleSubmit,t=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){t.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u4e0d\u652f\u6301\u4fee\u6539\u5e97\u94fa\u6e20\u9053\u4e3a\u5206\u9500\u5458\u5e97\u94fa\u72b6\u6001,\u662f\u5426\u7ee7\u7eed\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u7ee7\u7eed",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){e()}})},a.handleSubmit=function(){var e;(e={status:a.state.status,shop_ids:a.props.checkedAry},ne({url:"/api/backend/shops/switch/status",method:"put",data:e})).then(function(e){B.a.success("\u4fee\u6539\u5e97\u94fa\u72b6\u6001\u6210\u529f"),a.props.refresh(),a.handleCancel(),a.setState({status:""})})},a.state={status:"",isShow:!0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.selectedRows.length){var a=e.selectedRows.find(function(e){return"\u5206\u9500\u5458"===e.channel});this.setState({isShow:!a})}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u4fee\u6539\u5e97\u94fa\u72b6\u6001",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.confirm},i.a.createElement("div",{className:"s_channel"},i.a.createElement("span",{className:"left"},"\u9009\u62e9\u5e97\u94fa\u72b6\u6001:"),i.a.createElement(mn.a.Group,{value:this.state.status,onChange:function(t){e.setState({status:t.target.value})}},i.a.createElement(mn.a,{value:100,style:{display:this.state.isShow?"inline-block":"none"}},"\u5f00\u4e1a"),i.a.createElement(mn.a,{value:200,style:{display:this.state.isShow?"inline-block":"none"}},"\u6253\u70ca"),i.a.createElement(mn.a,{value:0},"\u51bb\u7ed3")))))}}]),t}(i.a.Component),xi=(a(1079),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={payment:"",promotion:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.item.id&&this.setState({payment:e.item.payment_qr_code,promotion:e.item.promotion_qr_code})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u95e8\u5e97\u7801",className:"shop_code",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.onSubmit,cancelButtonProps:this.handleCancel,cancelText:"\u53d6\u6d88",okText:"\u4fdd\u5b58",maskClosable:!1,zIndex:1001},i.a.createElement("div",{className:"item_box"},i.a.createElement("div",{className:"item"},i.a.createElement("span",null,"\u63a8\u5e7f\u7801"),i.a.createElement("img",{src:this.state.promotion,alt:""})),i.a.createElement("div",{className:"item"},i.a.createElement("span",null,"\u4ed8\u6b3e\u7801"),i.a.createElement("img",{src:this.state.payment,alt:""})))))}}]),t}(n.Component)),Ii=G.a.RangePicker,ji=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.onSubmit=function(){a.props.onSubmit(a.state.date),a.handleCancel()},a.dateChange=function(e,t){a.setState({date:t})},a.state={date:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9009\u62e9\u65e5\u671f",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.onSubmit,cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a"},i.a.createElement(F.a,{locale:H.a},i.a.createElement(Ii,{onChange:this.dateChange}))))}}]),t}(n.Component),Ti=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5e97\u94fa\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5546\u6237\u4e3b",dataIndex:"keeper_name"},{title:"\u5e97\u94fa\u7f16\u53f7",dataIndex:"code"},{title:"\u9500\u552e\u603b\u989d",dataIndex:"total_code_scan_amount"},{title:"\u5e97\u94fa\u6e20\u9053",dataIndex:"channel"},{title:"\u5e97\u94fa\u72b6\u6001",dataIndex:"status"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("shop_management_edit")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.editShop(t)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showCode(t)}},"\u95e8\u5e97\u7801"))}}],r=["name","keeper_name","code","total_code_scan_amount","channel","status","id","promotion_qr_code","payment_qr_code"];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).editShop=function(e){switch(a.setState({recordId:e.id,channel_desc:e.channel}),e.channel){case"\u65e9\u9910\u8f66":return void a.showBreakfast();case"\u5206\u9500\u5458":return void a.showDistributor();default:a.showShopKeeper()}},a.refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",only:a.state.defaultItem.join(",")},checkedAry:[]},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){window.hasPermission("shop_management_display")?a.props.history.push({pathname:"/shops/shopDetails",state:{id:e.id,path:"/shops",current:a.child.current.state.current}}):B.a.error("\u6682\u65e0\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458")},a.showApplication=function(){a.setState({applicationVisible:!0})},a.closeApplication=function(){a.setState({applicationVisible:!1})},a.showAdd=function(){a.setState({addVisible:!0})},a.closeAdd=function(){a.setState({addVisible:!1})},a.closeAddGroup=function(){a.setState({groupVisible:!1})},a.onSubmitGroup=function(){a.setState({groupVisible:!1})},a.showAddGroup=function(e){a.setState({groupVisible:!0,conditions_data:e})},a.search=function(e){a.setState({api:et,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:et,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showBreakfast=function(){a.setState({breakfast:!0})},a.hideBreakfast=function(){a.setState({breakfast:!1},function(){a.refresh()})},a.showDistributor=function(){a.setState({distributor:!0})},a.hideDistributor=function(){a.setState({distributor:!1},function(){a.refresh()})},a.showShopKeeper=function(){a.setState({shopKeeper:!0})},a.hideShopKeeper=function(){a.setState({shopKeeper:!1},function(){a.refresh()})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.showChangeStatus=function(){a.setState({statusVisible:!0})},a.closeChangeStatus=function(){a.setState({statusVisible:!1})},a.handleCode=function(e,t,a){switch(t){case"province_code":e.splice(a,1,"province");break;case"city_code":e.splice(a,1,"city");break;case"area_code":e.splice(a,1,"area")}},a.handleCodeIndex=function(e){var t="";switch(e){case"province_code":t="province";break;case"city_code":t="city";break;case"area_code":t="area";break;default:t=e}return t},a.handleCustom=function(e){var t=[];e.forEach(function(n,i){a.handleCode(e,n,i),li.forEach(function(e){e.children.forEach(function(e){if(n==e.value){var i={};i.title=e.label,i.dataIndex=a.handleCodeIndex(n),t.push(i)}})})});var n=e.indexOf("id"),r=e.indexOf("promotion_qr_code"),l=e.indexOf("payment_qr_code");n<0&&e.push("id"),r<0&&e.push("promotion_qr_code"),l<0&&e.push("payment_qr_code"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},t.push({title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("shop_management_edit")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.editShop(t)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showCode(t)}},"\u95e8\u5e97\u7801"))}}),a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.showCode=function(e){a.setState({codeVisible:!0,shopCodeId:e})},a.hideCode=function(){a.setState({codeVisible:!1})},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){var n=w({strategy:e,customize_columns:t,logic_conditions:a});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.shopExport=function(e,t){if(t)a.setState({selectDate:!0,strategy:e});else{var n=w({strategy:e,customize_columns:[],logic_conditions:[],shop_id:a.state.checkedAry[0]});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())}},a.hideSelectDate=function(){a.setState({selectDate:!1})},a.submitSelectDate=function(e){var t="";"MERCHANT_CURRENT_MONTH_BV"===a.state.strategy?t=w({strategy:a.state.strategy,customize_columns:[],logic_conditions:[],start_date:e[0],end_date:e[1]}):"MERCHANT_PARTNERS_CURRENT_MONTH_BV"===a.state.strategy&&(t=w({strategy:a.state.strategy,customize_columns:[],logic_conditions:[],shop_id:a.state.checkedAry[0],start_date:e[0],end_date:e[1]})),window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(t,"&Authorization=").concat(k())},a.child=i.a.createRef(),a.state={api:et,id:"",filterVisible:!1,customVisible:!1,applicationVisible:!1,codeVisible:!1,groupVisible:!1,statusVisible:!1,distributor:!1,breakfast:!1,shopKeeper:!1,user_data:[],applications_count:0,checkedAry:[],paginationParams:{logic_conditions:[],search:"",only:r.join(",")},recordId:"",columns:n,defaultItem:r,selectedRows:[],channel_desc:"",shopCodeId:"",current:1,exportVisible:!1,selectDate:!1,strategy:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e,t=this;this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom),this.props.location.query&&this.props.location.query.groupId&&this.setState({id:this.props.location.query.groupId,api:fa}),(e={},ne({url:"/api/backend/shops/applications/count",method:"get",params:e})).then(function(e){t.setState({applications_count:e.data.applications_count})})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({checkedAry:t,selectedRows:a})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}},a={visible:this.state.codeVisible,onCancel:this.hideCode,item:this.state.shopCodeId},n={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"SHOP_CUSTOMIZE",value:"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"}],values:si,conditions:this.state.conditions,slug:"shop_"},r={visible:this.state.selectDate,onClose:this.hideSelectDate,onSubmit:this.submitSelectDate};return i.a.createElement("div",null,i.a.createElement(ji,r),i.a.createElement(dn,n),i.a.createElement(di,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,showAddGroup:this.showAddGroup,export:this.showExport,closeAddGroup:this.closeAddGroup}),i.a.createElement(xi,a),i.a.createElement(pi,{visible:this.state.groupVisible,onClose:this.closeAddGroup,onSubmit:this.onSubmitGroup,checkedAry:this.state.checkedAry,conditionsData:this.state.conditions_data}),i.a.createElement(Oi,{visible:this.state.breakfast,onClose:this.hideBreakfast,onShow:this.showBreakfast,recordId:this.state.recordId,channelDesc:this.state.channel_desc}),i.a.createElement(Ei,{visible:this.state.distributor,onClose:this.hideDistributor,onShow:this.showDistributor,recordId:this.state.recordId,channelDesc:this.state.channel_desc}),i.a.createElement(yi,{visible:this.state.shopKeeper,onClose:this.hideShopKeeper,onShow:this.showShopKeeper,recordId:this.state.recordId,channelDesc:this.state.channel_desc,refresh:this.refresh}),i.a.createElement(Si,{visible:this.state.applicationVisible,onClose:this.closeApplication,onShow:this.showApplication}),i.a.createElement(Ni,{visible:this.state.addVisible,onClose:this.closeAdd}),i.a.createElement(wi,{visible:this.state.statusVisible,onClose:this.closeChangeStatus,checkedAry:this.state.checkedAry,refresh:this.refresh,selectedRows:this.state.selectedRows}),i.a.createElement("div",{className:"s_header"},window.hasPermission("shop_management_application")&&i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.showApplication},"\u5e97\u94fa\u7533\u8bf7(",this.state.applications_count,")"),window.hasPermission("shop_management_add_shop")&&i.a.createElement(_e.a,{size:"small",onClick:this.showAdd},"\u65b0\u589e\u5e97\u94fa")),i.a.createElement("div",{className:"s_header",style:{marginTop:"16px"}},i.a.createElement(_e.a,{size:"small",onClick:function(){return e.shopExport("MERCHANT_CURRENT_MONTH_PV",!1)}},"\u5bfc\u51fa\u6240\u6709\u5e97\u94fa\u5f53\u6708pv"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.shopExport("MERCHANT_CURRENT_MONTH_BV",!0)}},"\u5bfc\u51fa\u6240\u6709\u5e97\u94fa\u5f53\u6708bv"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length||this.state.checkedAry.length>1,onClick:function(){return e.shopExport("MERCHANT_PARTNERS_CURRENT_MONTH_PV",!1)}},"\u5bfc\u51fa\u6307\u5b9a\u5e97\u94fa\u6240\u6709\u4e0b\u7ebf\u5f53\u6708pv"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length||this.state.checkedAry.length>1,onClick:function(){return e.shopExport("MERCHANT_PARTNERS_CURRENT_MONTH_BV",!0)}},"\u5bfc\u51fa\u6307\u5b9a\u5e97\u94fa\u6240\u6709\u4e0b\u7ebf\u5f53\u6708bv")),i.a.createElement("div",{className:"s_body",style:{paddingTop:"16px"}},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("shop_management_switch_state")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.showChangeStatus},"\u4fee\u6539\u5e97\u94fa\u72b6\u6001"),window.hasPermission("shop_management_add_group")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.showAddGroup},"\u52a0\u5165\u7fa4\u7ec4")),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879")),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:li,targetKeys:this.state.defaultItem,firstItem:"name",handleCustom:this.handleCustom})),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),Ri=Object(U.g)(Ti);function Ai(e){return ne({url:"/api/backend/shops/delivery_routes",method:"post",data:e})}function Di(e,t){return ne({url:"/api/backend/shops/delivery_routes/".concat(t),method:"put",data:e})}function Pi(e){return ne({url:"/api/backend/shops/delivery_routes",method:"get",params:e})}var Vi=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e="create"===a.state.type?Ai:Di,t="create"===a.state.type?"":a.props.record.id;a.state.name?e({name:a.state.name},t).then(function(e){B.a.success(e.message),a.setState({name:""},function(){a.handleCancel(),a.props.refresh()})}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u8def\u7ebf\u540d\u79f0")},a.state={name:"",type:"create"},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.record&&e.record.id?this.setState({type:"edit",name:e.record.name}):this.setState({type:"create",name:""})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"create"===this.state.type?"\u65b0\u5efa":"\u7f16\u8f91",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8def\u7ebf\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})))))}}]),t}(n.Component),Li=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.addNew=function(){a.setState({createVisible:!0,record:{}})},a.closeNew=function(){a.setState({createVisible:!1})},a.editRoute=function(e){a.setState({createVisible:!0,record:e})},a.deleteRoute=function(e){var t,n;(t={},n=e.id,ne({url:"/api/backend/shops/delivery_routes/".concat(n),method:"delete",params:t})).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.state={api:Pi,data:[],createVisible:!1,routeId:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"20px"},onClick:function(){return e.editRoute(a)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.deleteRoute(a)}},"\u5220\u9664"))}}];return i.a.createElement("div",null,i.a.createElement(Vi,{visible:this.state.createVisible,onCancel:this.closeNew,refresh:this.refresh,record:this.state.record}),i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNew},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589e\u8def\u7ebf"),i.a.createElement(ve.a,{dataSource:this.state.data,rowKey:function(e){return e.id},pagination:!1,columns:t,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,valChange:this.paginationChange})))}}]),t}(n.Component),Mi=(a(1080),a(1081),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.nameValue&&a.state.remarkValue?da({name:a.state.nameValue,remark:a.state.remarkValue}).then(function(e){a.props.refresh(),a.props.onCancel(),a.setState({nameValue:"",remarkValue:""})}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u76f8\u5173\u4fe1\u606f")},a.state={nameValue:"",remarkValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa\u7ec4",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.nameValue,onChange:function(t){e.setState({nameValue:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.remarkValue,onChange:function(t){e.setState({remarkValue:t.target.value})}})))))}}]),t}(i.a.Component)),Ui=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({groupData:{}},function(){a.props.onCancel()})},a.state={nameValue:"",remarkValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.groupId&&(a={},n=e.groupId,ne({url:"/api/backend/groups/".concat(n),method:"get",params:a})).then(function(e){i.setState({groupData:e.data})}).catch(function(e){})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u67e5\u770b\u5e97\u94fa\u7ec4",maskClosable:!1,className:"disabled-filter",width:520,visible:this.props.visible,onCancel:this.handleCancel,centered:!0,footer:null},this.state.groupData&&this.state.groupData.name?i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.name})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.remark}))):""))}}]),t}(i.a.Component),Fi=ve.a.Column,Gi=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={data:[],createVisible:!1,detailVisible:!1,detailId:""},a.refresh=function(){ha({}).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.addNew=function(){a.setState({createVisible:!0})},a.closeNew=function(){a.setState({createVisible:!1})},a.showDetail=function(e){a.setState({detailVisible:!0,detailId:e.id})},a.hideDetail=function(){a.setState({detailVisible:!1,detailId:""})},a.goGroupManage=function(e){a.props.history.push({pathname:"/shops",query:{groupId:e.id}})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(Mi,{visible:this.state.createVisible,onCancel:this.closeNew,refresh:this.refresh}),i.a.createElement(Ui,{visible:this.state.detailVisible,onCancel:this.hideDetail,groupId:this.state.detailId}),i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNew},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589e\u5e97\u94fa\u7ec4"),i.a.createElement(ve.a,{dataSource:this.state.data,rowKey:function(e){return e.id},rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}},i.a.createElement(Fi,{className:"column_group",title:"\u5e97\u94fa\u7ec4",dataIndex:"name",key:"name",render:function(t,a){return i.a.createElement("span",{className:"editIcon"},i.a.createElement("span",null,t),i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},className:"iconfont",onClick:function(){return e.showDetail(a)}},"\ue7ab"))}}),i.a.createElement(Fi,{className:"column_group primary",title:"\u5e97\u94fa\u6570\u91cf",dataIndex:"model_count",key:"model_count"}),i.a.createElement(Fi,{title:"\u64cd\u4f5c",key:"action",className:"column_group groupOperation",render:function(t,a){return i.a.createElement("span",null,i.a.createElement("span",{className:"operation",onClick:function(){return e.goGroupManage(a)}},"\u8be6\u60c5"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5e97\u94fa\u7ec4\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){var t,n;(t={},n=a.id,ne({url:"/api/backend/groups/".concat(n),method:"delete",params:t})).then(function(t){e.refresh()})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664")))}}))))}}]),t}(i.a.Component),Bi=Object(U.g)(Gi);function zi(e){return ne({url:"/api/backend/shops/frozen",method:"get",params:e})}function Hi(e,t){return ne({url:"/api/backend/shops/".concat(t),method:"delete",params:e})}function Ki(e,t){return ne({url:"/api/backend/shops/".concat(t,"/unfreeze"),method:"put",data:e})}function Ji(e){return ne({url:"/api/backend/groups/user/static",method:"get",params:e})}function Wi(e,t){return ne({url:"/api/backend/groups/".concat(t),method:"delete",params:e})}function Yi(e,t){return ne({url:"/api/backend/groups/user/".concat(t),method:"post",data:e})}function qi(e,t){return ne({url:"/api/backend/groups/".concat(t,"/add"),method:"post",data:e})}function Xi(e){return ne({url:"/api/backend/tags",method:"get",params:e})}function $i(e){return ne({url:"/api/backend/tag_groups",method:"get",params:e})}function Qi(e,t){return ne({url:"/api/backend/tag_groups/".concat(t,"/tags"),method:"get",params:e})}function Zi(e){return ne({url:"/api/backend/tags",method:"post",data:e})}function er(e,t){return ne({url:"/api/backend/tags/".concat(t,"/users/add"),method:"post",data:e})}function tr(e){return ne({url:"/api/backend/users",method:"get",params:e})}function ar(e,t){return ne({url:"/api/backend/groups/".concat(t,"/models"),method:"get",params:e})}function nr(e,t){return ne({url:"/api/backend/tags/".concat(t,"/users"),method:"get",params:e})}function ir(e){return ne({url:"/api/backend/score_rules",method:"get",params:e})}function rr(e){return ne({url:"/api/backend/users/member_grades",method:"get",params:e})}function lr(e,t){return ne({url:"/api/backend/users/member_grades/".concat(t),method:"put",data:e})}function sr(e,t){return ne({url:"/api/backend/users/member_grades",method:"post",data:e})}function cr(e,t){return ne({url:"/api/backend/users/".concat(t,"/detach/group"),method:"put",data:e})}function or(e,t){return ne({url:"/api/backend/users/".concat(t,"/detach/tag"),method:"put",data:e})}function ur(e){return ne({url:"/api/backend/users/balance/operate",method:"put",data:e})}function mr(e,t){return ne({url:"/api/backend/users/".concat(t,"/coupon_owned_records"),method:"get",params:e})}function dr(e,t){return ne({url:"/api/backend/users/".concat(t,"/integral_update_logs"),method:"get",params:e})}var pr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){console.log(JSON.stringify(a.child.current.state.data)),a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.showAddGroup=function(){a.props.showAddGroup(a.child.current.state.data)},a.closeAdd=function(){a.props.closeAddGroup(),a.props.closeAddTags()},a.showAddTags=function(){a.props.showAddTags(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn"},"\u53d1\u6d88\u606f"),window.hasPermission("user_management_add_group")&&i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.showAddGroup},"\u52a0\u7fa4\u7ec4"),window.hasPermission("user_management_add_tag")&&i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.showAddTags},"\u52a0\u6807\u7b7e"),window.hasPermission("user_management_export")&&i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn"},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:ye,operation:Ce,api:{getStatic:Ji,tags:Xi},slug:"user"})))}}]),t}(i.a.Component),hr=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5e97\u94fa\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5546\u6237\u4e3b",dataIndex:"keeper_name"},{title:"\u5e97\u94fa\u7f16\u53f7",dataIndex:"code"},{title:"\u9500\u552e\u603b\u989d",dataIndex:"total_sale"},{title:"\u5e97\u94fa\u6e20\u9053",dataIndex:"channel"},{title:"\u5e97\u94fa\u72b6\u6001",dataIndex:"status"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,window.hasPermission("shop_frozen_unfreeze")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.unfreeze(t)}},"\u89e3\u51bb"),window.hasPermission("shop_frozen_delete")&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.deleteShop(t)}},"\u5220\u9664"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"}},"\u95e8\u5e97\u7801"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:""}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){window.hasPermission("shop_frozen_display")?a.props.history.push({pathname:"/shops/shopDetails",state:{id:e.id}}):B.a.error("\u6682\u65e0\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458")},a.unfreeze=function(e){a.showConfirm("\u89e3\u51bb",e.id,Ki)},a.deleteShop=function(e){a.showConfirm("\u5220\u9664",e.id,Hi)},a.showConfirm=function(e,t,n){var r=a.refresh,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",e,"\u8be5\u5e97\u94fa\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){n({},t).then(function(t){B.a.success("".concat(e,"\u6210\u529f!")),r()})}})},a.search=function(e){a.setState({api:zi,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:zi,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){ye.forEach(function(a){a.children.forEach(function(a){if(e==a.value){var n={};n.title=a.label,n.dataIndex=e,t.push(n)}})})}),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t})},a.paginationChange=function(e){console.log(e),a.setState({user_data:e})},a.child=i.a.createRef(),a.state={api:zi,id:"",filterVisible:!1,customVisible:!1,user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:""},columns:n},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(pr,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,showAddGroup:this.showAddGroup,closeAddGroup:this.closeAddGroup,showAddTags:this.showAddTags,closeAddTags:this.closeAddTags}),i.a.createElement("div",{className:"s_body frozen_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("shop_frozen_export")&&i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length},"\u5bfc\u51fa")),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879")),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:ye,handleCustom:this.handleCustom})),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange})))}}]),t}(i.a.Component),fr=Object(U.g)(hr),Er=(a(1082),a(1083),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){if(a.state.nameValue){var e,t={name:a.state.nameValue};(e=t,ne({url:"/api/backend/shops/channels",method:"post",data:e})).then(function(e){a.props.onCancel(),a.props.refresh()})}else B.a.error("\u8bf7\u586b\u5199\u76f8\u5173\u4fe1\u606f")},a.onChange=function(e){console.log("radio checked",e.target.value),a.setState({radio:e.target.value})},a.state={nameValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u5e97\u94fa\u7ec4",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6e20\u9053\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.nameValue,onChange:function(t){e.setState({nameValue:t.target.value})}})))))}}]),t}(i.a.Component)),vr=(ve.a.Column,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.addNew=function(){a.setState({createVisible:!0})},a.closeNew=function(){a.setState({createVisible:!1})},a.deleteChannel=function(e){var t;(t={channel_id:e.id},ne({url:"/api/backend/shops/channels/delete",method:"delete",params:t})).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.state={api:ui,data:[],createVisible:!1,detailVisible:!1,detailId:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u6e20\u9053",dataIndex:"name"},{title:"\u5e97\u94fa\u6570\u91cf",dataIndex:"model_count"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.deleteChannel(a)}},"\u5220\u9664"))}}];return i.a.createElement("div",null,i.a.createElement(Er,{visible:this.state.createVisible,onCancel:this.closeNew,refresh:this.refresh}),i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNew},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589e\u6e20\u9053"),i.a.createElement(ve.a,{dataSource:this.state.data,rowKey:function(e){return e.id},pagination:!1,columns:t,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,valChange:this.paginationChange})))}}]),t}(i.a.Component)),_r=Object(U.g)(vr),gr=(a(1084),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){},a.state={data:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){y.a.size(e.images)>0&&this.setState({data:e.images})}},{key:"render",value:function(){var e=this.state.data;return console.log(e),i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u5e97\u94fa\u8d44\u6599",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},e?i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u94f6\u884c\u5361\u53f7\uff1a"),i.a.createElement("span",null,e.bank_card_code)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5f00\u6237\u884c\uff1a"),i.a.createElement("span",null,e.opening_bank)),e.id_card_images?i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u8eab\u4efd\u8bc1\u7167\u7247\uff1a"),i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:e.id_card_images.front,alt:""}),i.a.createElement("img",{src:e.id_card_images.backend,alt:""}),i.a.createElement("img",{src:e.id_card_images.holding,alt:""}))):"",e.business_license_images?i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u8425\u4e1a\u6267\u7167\uff1a"),i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:e.business_license_images.front,alt:""}))):"",e.shop_images?i.a.createElement("li",{className:"li"},i.a.createElement("span",{className:"left"},"\u5e97\u94fa\u7167\u7247\uff1a"),i.a.createElement("div",{className:"id_images"},i.a.createElement("img",{src:e.shop_images.cashier,alt:""}),i.a.createElement("img",{src:e.shop_images.doorway,alt:""}),i.a.createElement("img",{src:e.shop_images.environment,alt:""}))):""):""))}}]),t}(i.a.Component)),br=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){console.log(e),a.setState({data:e})},a.handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){},a.state={api:it,paginationParams:{},id:"",data:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.shopId&&this.setState({id:e.shopId})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u4ed6\u4ecb\u7ecd\u7684\u5e97",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},i.a.createElement("div",{className:"chart introduction_chart"},i.a.createElement(ve.a,{columns:[{title:"\u5e97\u94fa\u540d\u79f0",dataIndex:"name"},{title:"\u5e97\u94fa\u6e20\u9053",dataIndex:"channel"},{title:"\u5e97\u94fa\u4e3b",dataIndex:"keeper_name"},{title:"\u5f00\u5e97\u65f6\u95f4",dataIndex:"created_at"},{title:"\u603b\u5206\u9500\u989d",dataIndex:"total_distribute_amount"},{title:"\u672c\u6708\u5206\u9500\u989d",dataIndex:"monthly_distribute_amount"}],rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,id:this.state.id,text:"\u6761\u6570\u636e",params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(i.a.Component),yr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){console.log(e),a.setState({data:e})},a.handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){},a.state={api:lt,paginationParams:{},id:"",data:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.shopId&&this.setState({id:e.shopId})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u5ba2\u6237",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},i.a.createElement("div",{className:"chart introduction_chart"},i.a.createElement(ve.a,{columns:[{title:"\u59d3\u540d",dataIndex:"nickname"},{title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile"},{title:"\u5f00\u5e97\u65f6\u95f4",dataIndex:"created_at"},{title:"\u603b\u8d2d\u4e70\u989d\uff08\u672c\u6708\u8d2d\u4e70\u989d\uff09",dataIndex:"total_purchase_amount",render:function(e,t){return"".concat(e,"(").concat(t.current_month_purchase_amount/100,")")}},{title:"\u603b\u8ba2\u5355\u6570\uff08\u672c\u6708\u8ba2\u5355\u6570\uff09",dataIndex:"purchased_count",render:function(e,t){return"".concat(e,"(").concat(t.current_month_purchased_count,")")}}],rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,id:this.state.id,text:"\u6761\u6570\u636e",params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(i.a.Component),Cr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){},a.state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u626b\u7801\u4ed8\u91d1\u989d",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},"\u8fd9\u662f\u4e00\u4e2aTable"))}}]),t}(i.a.Component),kr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={overdraft:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e,t=a.props.id;!a.state.overdraft||a.state.balanceValue<0?B.a.error("\u900f\u652f\u989d\u5ea6\u4e0d\u5408\u6cd5"):(e={shop_id:t,overdraft:a.state.overdraft},ne({url:"/api/backend/shops/set_overdraft",method:"put",data:e})).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh(),a.setState({overdraft:0})}).catch(function(e){})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.overdraft&&this.setState({overdraft:e.overdraft})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u900f\u652f\u989d\u5ea6\u8c03\u6574",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"operateBalance"},i.a.createElement("span",null,"\u8bbe\u7f6e\u900f\u652f\u989d\u5ea6"),i.a.createElement(Ne.a,{value:this.state.overdraft,type:"number",onChange:function(t){t.target.value<0?B.a.error("\u900f\u652f\u989d\u5ea6\u4e0d\u53ef\u5c0f\u4e8e0"):e.setState({overdraft:t.target.value})}}))))}}]),t}(n.Component),Sr=(a(365),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:"add",remark:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e;console.log(a.props);var t="user"===a.props.type?ur:st,n="user"===a.props.type?"user_id":"shop_id",i=a.props.id;!a.state.balanceValue||a.state.balanceValue<0?B.a.error("\u4f59\u989d\u503c\u4e0d\u5408\u6cd5"):t((e={amount:a.state.balanceValue,operation:a.state.value},Object(Y.a)(e,n,i),Object(Y.a)(e,"remark",a.state.remark),e)).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh(),a.setState({balanceValue:0,remark:""})}).catch(function(e){})},a.onChange=function(e){a.setState({value:e.target.value})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u4f59\u989d\u8c03\u6574",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"operateBalance"},i.a.createElement(mn.a.Group,{onChange:this.onChange,value:this.state.value},i.a.createElement(mn.a,{value:"add"},"\u589e\u52a0"),i.a.createElement(mn.a,{value:"sub"},"\u51cf\u5c11")),i.a.createElement(Ne.a,{value:this.state.balanceValue,type:"number",onChange:function(t){t.target.value<0?B.a.error("\u4f59\u989d\u53d8\u52a8\u4e0d\u53ef\u5c0f\u4e8e0"):e.setState({balanceValue:t.target.value})}})),i.a.createElement("div",{className:"operateBalanceRemark"},i.a.createElement("span",null,"\u5907\u6ce8:"),i.a.createElement(Ne.a,{value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}}))))}}]),t}(n.Component)),Or=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){rt({},a.id).then(function(e){a.setState({data:e})}).catch(function(e){})},a.showShopInformation=function(){a.setState({shopInformationVisible:!0})},a.hideShopInformation=function(){a.setState({shopInformationVisible:!1})},a.showIntroduction=function(){a.setState({introductionVisible:!0})},a.hideIntroduction=function(){a.setState({introductionVisible:!1})},a.showIntroductionPerson=function(){a.setState({introductionPersonVisible:!0})},a.hideIntroductionPerson=function(){a.setState({introductionPersonVisible:!1})},a.showCodePayment=function(){a.setState({codePaymentVisible:!0})},a.hideCodePayment=function(){a.setState({codePaymentVisible:!1})},a.removeTag=function(e){a.showConfirm(e,nt)},a.showConfirm=function(e,t){var n=a.refresh,r=a.id,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u89e3\u9664\u6b64\u5e97\u94fa\u4e0e\u8be5\u7fa4\u7ec4\u7684\u5173\u8054\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){t({group_id:e},r).then(function(e){n()}).catch(function(e){})},onCancel:function(){}})},a.showMap=function(e){a.setState({mapVisible:!0,position:e})},a.hideMap=function(){a.setState({mapVisible:!1})},a.handleLocation=function(){},a.showBalance=function(){a.setState({balanceVisible:!0})},a.hideBalance=function(){a.setState({balanceVisible:!1})},a.showOverdraft=function(){a.setState({overdraft:!0})},a.hideOverdraft=function(){a.setState({overdraft:!1})},a.goBack=function(){a.props.history.push({pathname:a.props.location.state.path,state:{current:a.props.location.state.current}})},a.goIntroducer=function(e){rt({},e).then(function(e){e?a.setState({data:e}):B.a.error("\u8be5\u5e97\u94fa\u5df2\u4e0d\u5b58\u5728")}).catch(function(e){})},a.id=e.location.state.id,a.state={shopInformationVisible:!1,introductionVisible:!1,introductionPersonVisible:!1,codePaymentVisible:!1,mapVisible:!1,data:{},position:{},images:{},overdraft:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=this.state.data,a={visible:this.state.balanceVisible,onCancel:this.hideBalance,refresh:this.refresh,type:"shop",id:this.state.data.id},n={visible:this.state.overdraft,onCancel:this.hideOverdraft,refresh:this.refresh,id:this.state.data.id,overdraft:this.state.data.overdraft||0};return i.a.createElement("div",{className:"shopDetail"},i.a.createElement(kr,n),i.a.createElement(Sr,a),i.a.createElement(gr,{visible:this.state.shopInformationVisible,onClose:this.hideShopInformation,images:this.state.images}),i.a.createElement(br,{visible:this.state.introductionVisible,onClose:this.hideIntroduction,shopId:this.id}),i.a.createElement(yr,{visible:this.state.introductionPersonVisible,onClose:this.hideIntroductionPerson,shopId:this.state.data.id}),i.a.createElement(Cr,{visible:this.state.codePaymentVisible,onClose:this.hideCodePayment}),i.a.createElement(bi,{visible:this.state.mapVisible,hideMap:this.hideMap,handleLocation:this.handleLocation,position:this.state.position,disabled:!0}),i.a.createElement("div",{className:"u_top"},i.a.createElement("div",{className:"u_header"},i.a.createElement("span",null,"\u5e97\u94fa\u8be6\u60c5"),i.a.createElement(_e.a,{type:"default",size:"small",onClick:this.goBack},"\u8fd4\u56de\u5e97\u94fa\u5217\u8868")),i.a.createElement("div",{className:"u_body_one"},i.a.createElement("ul",{className:"u_body_top"},i.a.createElement("li",null,i.a.createElement("p",null,"\u5e97\u94fa\u6e20\u9053\uff1a",t.channel),i.a.createElement("p",null,"\u65e9\u9910\u7f16\u53f7\uff1a",t.breakfast_car_code||"\u65e0"),i.a.createElement("p",null,"\u5e97\u94fa\u7f16\u53f7\uff1a",t.code)),i.a.createElement("li",null,i.a.createElement("p",null,"\u5730\u533a\uff1a",t.province," ",t.city," ",t.area),i.a.createElement("p",null,"\u5730\u5740\uff1a",t.address),i.a.createElement("p",null,"\u5730\u56fe\u4f4d\u7f6e\uff1a",i.a.createElement("span",{onClick:function(){return e.showMap(t.position)},style:{cursor:"pointer"}},i.a.createElement("i",{className:"iconfont",style:{fontSize:"14px",color:"#4F9863",marginRight:"3px"}},"\ue7b0"),"\u5730\u56fe"))),i.a.createElement("li",null,i.a.createElement("p",null,"\u5e97\u94fa\u540d\u79f0\uff1a",t.name),i.a.createElement("p",null,"\u5e97\u94fa\u4e3b\u59d3\u540d\uff1a",t.keeper_name),i.a.createElement("p",null,"\u5e97\u94fa\u4e3b\u7535\u8bdd\uff1a",t.keeper_mobile)),i.a.createElement("li",null,i.a.createElement("p",null,"\u5f00\u4e1a\u65f6\u95f4\uff1a",t.created_at),t.introducer&&i.a.createElement("p",null,"\u4ecb\u7ecd\u4eba\uff1a ",i.a.createElement("span",{onClick:function(){return e.goIntroducer(t.introducer.id)},style:{color:"#4f9863",cursor:"pointer"}},t.introducer.name||"\u65e0"))),i.a.createElement("li",{className:"btns"},i.a.createElement(_e.a,{size:"small",onClick:this.showShopInformation},"\u5e97\u94fa\u8d44\u6599"),i.a.createElement(_e.a,{size:"small",onClick:this.showIntroduction},"\u4ed6\u4ecb\u7ecd\u7684\u5e97"),i.a.createElement(_e.a,{size:"small",onClick:this.showIntroductionPerson},"\u5ba2\u6237"))))),i.a.createElement("div",{className:"u_body_two"},i.a.createElement("div",{className:"t_header"},i.a.createElement("h5",null,"\u8d44\u91d1\u8be6\u60c5"),i.a.createElement("h5",{className:"u_detail"},"\u660e\u7ec6")),i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("h3",null,"\u4f59\u989d"),i.a.createElement("div",{className:"adjust"},t.balance_with_overdraft,window.hasPermission("shop_management_display_balance_operate")&&i.a.createElement("span",{className:"adjustBalance",onClick:this.showBalance,style:{cursor:"pointer"}},"\u8c03\u6574"),window.hasPermission("shop_management_display_set_overdraft")&&i.a.createElement("div",{className:"overdraft"},"\u900f\u652f\u989d\u5ea6\uff1a ",t.overdraft,"\u5143",i.a.createElement("span",{className:"adjustOverdraft",onClick:this.showOverdraft},"\u8c03\u6574")))),i.a.createElement("li",null,i.a.createElement("h3",null,"\u5145\u503c\u603b\u989d"),i.a.createElement("div",null,t.total_recharge)),i.a.createElement("li",null,i.a.createElement("h3",null,"\u63d0\u73b0\u603b\u989d"),i.a.createElement("div",null,t.total_withdrawal)),i.a.createElement("li",null,i.a.createElement("h3",null,"\u8fd4\u73b0\u603b\u989d"),i.a.createElement("div",null,t.total_cashback)))),i.a.createElement("div",{className:"u_body_three"},i.a.createElement("ul",{className:"u_body_three_list"},i.a.createElement("li",null,i.a.createElement("div",{className:"li_header"},"\u626b\u7801\u4ed8\u91d1\u989d",i.a.createElement("span",{onClick:this.showCodePayment},"\u8be6\u60c5")),i.a.createElement("div",{className:"li_body"},t.code_scan?i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("h4",null,"\u603b\u91d1\u989d:",i.a.createElement("span",null,t.code_scan.total_amount)),i.a.createElement("div",{className:"d_detail"},i.a.createElement("span",null,"\u5fae\u4fe1\uff1a",t.code_scan.payment_mode_total_amount.wechat),i.a.createElement("span",null,"\u652f\u4ed8\u5b9d\uff1a",t.code_scan.payment_mode_total_amount.alipay),i.a.createElement("span",null,"\u4f59\u989d\uff1a",t.code_scan.payment_mode_total_amount.balance),i.a.createElement("span",null,"\u62db\u884c\u4e00\u7f51\u901a\uff1a",t.code_scan.payment_mode_total_amount.cmb))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u672c\u6708\u91d1\u989d:",i.a.createElement("span",null,t.code_scan.monthly_amount)),i.a.createElement("div",{className:"d_detail"},i.a.createElement("span",null,"\u5fae\u4fe1\uff1a",t.code_scan.payment_mode_monthly_amount.wechat),i.a.createElement("span",null,"\u652f\u4ed8\u5b9d\uff1a",t.code_scan.payment_mode_monthly_amount.alipay),i.a.createElement("span",null,"\u4f59\u989d\uff1a",t.code_scan.payment_mode_monthly_amount.balance),i.a.createElement("span",null,"\u62db\u884c\u4e00\u7f51\u901a\uff1a",t.code_scan.payment_mode_monthly_amount.cmb)))):"")),i.a.createElement("li",null,i.a.createElement("div",{className:"li_header"},"\u81ea\u63d0\u5355"),i.a.createElement("div",{className:"li_body"},t.self_pick?i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("h4",null,"\u603b\u91d1\u989d:",i.a.createElement("span",null,t.self_pick.total_amount)),i.a.createElement("span",null,"\u672c\u6708\u91d1\u989d\uff1a",t.self_pick.monthly_amount)),i.a.createElement("li",null,i.a.createElement("h4",null,"\u603b\u8ba2\u5355\u6570:",i.a.createElement("span",null,t.self_pick.total_orders)),i.a.createElement("span",null,"\u672c\u6708\u8ba2\u5355\u6570\uff1a",t.self_pick.monthly_orders)),i.a.createElement("li",null,i.a.createElement("h4",null,"\u603b\u7528\u6237\u6570:",i.a.createElement("span",null,t.self_pick.total_users)),i.a.createElement("span",null,"\u672c\u6708\u7528\u6237\u6570\uff1a",t.self_pick.total_users))):"")),i.a.createElement("li",null,i.a.createElement("div",{className:"li_header"},"\u626b\u7801\u4ed8\u8ba2\u5355"),i.a.createElement("div",{className:"li_body"},t.code_scan?i.a.createElement("ul",null,i.a.createElement("li",{className:"centerLi"},i.a.createElement("h4",null,"\u603b\u8ba2\u5355\u6570:",i.a.createElement("span",null,t.code_scan.total_orders))),i.a.createElement("li",{className:"centerLi"},i.a.createElement("h4",null,"\u672c\u6708\u8ba2\u5355\u6570:",i.a.createElement("span",null,t.code_scan.monthly_orders)))):"")),i.a.createElement("li",null,i.a.createElement("div",{className:"li_header"},"\u8ba2\u8d27\u989d"),i.a.createElement("div",{className:"li_body"},t.order_product?i.a.createElement("ul",null,i.a.createElement("li",{className:"centerLi"},i.a.createElement("h4",null,"\u603b\u8ba2\u8d27\u989d:",i.a.createElement("span",null,t.order_product.total_amount)),i.a.createElement("span",null,"\u8ba2\u8d27\u6279\u6b21\uff1a",t.order_product.total_batch)),i.a.createElement("li",{className:"centerLi"},i.a.createElement("h4",null,"\u672c\u6708\u8ba2\u8d27\u989d:",i.a.createElement("span",null,t.order_product.monthly_amount)),i.a.createElement("span",null,"\u8ba2\u8d27\u6279\u6b21\uff1a",t.order_product.monthly_batch))):"")))),i.a.createElement("ul",{className:"u_body_four"},t.share_click&&i.a.createElement("li",null,i.a.createElement("div",{className:"u_body_four_header"},"\u5206\u4eab"),i.a.createElement("ul",{className:"u_body_four_body"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5206\u4eab\u603b\u6b21\u6570"),i.a.createElement("h4",null,t.share_click.total_sharing),i.a.createElement("span",null,"\u672c\u6708\uff1a",t.share_click.monthly_sharing)),i.a.createElement("li",null,i.a.createElement("span",null,"\u88ab\u70b9\u51fb\u603b\u6b21\u6570"),i.a.createElement("h4",null,t.share_click.total_click),i.a.createElement("span",null,"\u672c\u6708\uff1a",t.share_click.monthly_click)),i.a.createElement("li",null,i.a.createElement("span",null,"\u88ab\u70b9\u51fb\u603b\u4eba\u6570"),i.a.createElement("h4",null,t.share_click.total_click_users),i.a.createElement("span",null,"\u672c\u6708\uff1a",t.share_click.monthly_click_users)))),t.distribute&&i.a.createElement("li",null,i.a.createElement("div",{className:"u_body_four_header"},"\u5206\u9500"),i.a.createElement("ul",{className:"u_body_four_body"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5206\u9500\u603b\u989d"),i.a.createElement("h4",null,t.distribute.total_amount),i.a.createElement("span",null,"\u672c\u6708\uff1a",t.distribute.monthly_amount)),i.a.createElement("li",null,i.a.createElement("span",null,"\u5206\u9500\u603b\u8ba2\u5355\u6570"),i.a.createElement("h4",null,t.distribute.total_orders),i.a.createElement("span",null,"\u672c\u6708\uff1a",t.distribute.monthly_amount)),i.a.createElement("li",null,i.a.createElement("span",null,"\u603b\u8d2d\u4e70\u4eba\u6570"),i.a.createElement("h4",null,t.distribute.total_users),i.a.createElement("span",null,"\u672c\u6708\uff1a",t.distribute.monthly_amount)))),t.cashback&&i.a.createElement("li",null,i.a.createElement("div",{className:"u_body_four_header"},"\u8fd4\u73b0"),i.a.createElement("ul",{className:"u_body_four_body"},i.a.createElement("li",{className:"u_body_four_body_s"},i.a.createElement("span",null,"\u8fd4\u73b0\u603b\u989d"),i.a.createElement("h4",null,t.cashback.total_amount),i.a.createElement("span",{style:{marginBottom:"10px"}},"\u81ea\u63d0\u8fd4\u73b0\u603b\u989d\uff1a",t.cashback.self_pick_amount),i.a.createElement("span",null,"\u9500\u552e\u8fd4\u73b0\u603b\u989d\uff1a",t.cashback.sale_amount)),i.a.createElement("li",{className:"u_body_four_body_s"},i.a.createElement("span",null,"\u672c\u6708\u8fd4\u73b0\u989d"),i.a.createElement("h4",null,t.cashback.monthly_amount),i.a.createElement("span",{style:{marginBottom:"10px"}},"\u672c\u6708\u81ea\u63d0\u8fd4\u73b0\uff1a",t.cashback.monthly_self_pick_amount),i.a.createElement("span",null,"\u672c\u6708\u9500\u552e\u8fd4\u73b0\uff1a",t.cashback.monthly_sale_amount))))),i.a.createElement("div",{className:"u_body_groups"},i.a.createElement("div",{className:"group_header"},"\u5e97\u94fa\u7ec4"),window.hasPermission("menu_shop_group")&&i.a.createElement("div",{className:"group_tags"},t.groups&&t.groups.length?t.groups.map(function(t){return i.a.createElement(Gt.a,{closable:!0,key:t.id,onClose:function(){return e.removeTag(t.id)}},t.name)}):"")))}}]),t}(i.a.Component),Nr=(a(401),a(57)),wr=(a(107),a(50)),xr=(a(1088),a(1089),a(236)),Ir=a.n(xr),jr=(a(1185),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState({editorState:e,outputHTML:e.toHTML()})},a.setEditorContentAsync=function(){a.isLivinig&&a.setState({editorState:Ir.a.createEditorState("")})},a.myUploadFn=function(e){var t="".concat(v.apiUrl,"/api/common/image/upload"),a=new XMLHttpRequest,n=new FormData,i=function(t){e.error({msg:"\u4e0a\u4f20\u5931\u8d25"})};console.log(a,"==========="),a.addEventListener("load",function(t){e.success({url:JSON.parse(a.responseText).data.url,meta:{id:"detailImage",title:"xxx",alt:"",loop:!0,autoPlay:!0,controls:!0}})},!1),a.addEventListener("error",i,!1),a.addEventListener("abort",i,!1),n.append("file",e.file),a.open("POST",t,!0),a.send(n)},a.state={editorState:Ir.a.createEditorState(""),outputHTML:e.default},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({editorState:Ir.a.createEditorState(this.props.default)}),this.isLivinig=!0}},{key:"componentWillUnmount",value:function(){this.isLivinig=!1}},{key:"render",value:function(){var e=this.state,t=e.editorState;e.outputHTML;return i.a.createElement("div",null,i.a.createElement("div",{className:"editor-wrapper"},i.a.createElement(Ir.a,{value:t,onChange:this.handleChange,media:{uploadFn:this.myUploadFn}})))}}]),t}(i.a.Component)),Tr=(a(1186),a(1187),a(641)),Rr=(a(568),Q.a.Option,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState({specName:e})},a.handleCancel=function(){a.setState({value:""}),a.props.onCancel()},a.handleSubmit=function(){var e=a.state.allNames,t=a.state.specName;e.indexOf(t)>-1?a.props.onSubmit(a.state.allSpecification.filter(function(e){return e.name==t})[0]):Kt({name:t}).then(function(e){a.props.onSubmit(e.data)}).catch(function(e){})},a.state={allSpecification:[],allNames:[],parent:{},specName:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[];zt({}).then(function(a){a.forEach(function(e){t.push(e.name)}),e.setState({allSpecification:a,allNames:t})}).catch(function(e){})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u89c4\u683c",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",destroyOnClose:!0,cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"newSpecification"},"\u9009\u62e9\u89c4\u683c",i.a.createElement(Tr.a,{defaultValue:"",style:{width:300},dataSource:this.state.allNames,onChange:this.handleChange,placeholder:"1",filterOption:function(e,t){return-1!==t.props.children.toUpperCase().indexOf(e.toUpperCase())}}))))}}]),t}(i.a.Component)),Ar=Q.a.Option,Dr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState({specValues:e})},a.handleCancel=function(){a.setState({value:""}),a.props.onCancel()},a.handleSubmit=function(){var e,t,n=a.state.allValues,i=a.state.specValues,r=[],l=i;n.forEach(function(e){i.indexOf(e.value)>-1&&r.push(e)}),r.length&&r.forEach(function(e){l=l.filter(function(t){return t!=e.value})}),console.log(r),console.log(l),l.length?(e={values:l},t=a.props.parent.id,ne({url:"/api/backend/products/specification/".concat(t,"/add_spec_value_array"),method:"put",data:e})).then(function(e){a.props.onSubmit(a.props.parent.id,e.data.concat(r)),a.props.onUpdate(e.data.concat(r))}).catch(function(e){}):a.props.onSubmit(a.props.parent.id,r)},a.state={specValues:[],allValues:[],values:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;if(e.parent.id)if(e.parent.spec_value)this.setState({allValues:e.parent.spec_value,values:[]});else{var n=[];zt({}).then(function(t){n=t.filter(function(t){return t.id==e.parent.id}),a.setState({allValues:n[0].spec_value})}).catch(function(e){});var i=[];e.parent.values&&e.parent.values.forEach(function(e){i.push(e.value)}),this.setState({values:i})}}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u89c4\u683c\u503c",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",destroyOnClose:!0,onOk:this.handleSubmit},i.a.createElement("div",{className:"newSpecification"},"\u9009\u62e9\u89c4\u683c\u503c",i.a.createElement(Q.a,{mode:"tags",onChange:this.handleChange,allowClear:!0,defaultValue:this.state.values},this.state.allValues.length?this.state.allValues.map(function(e){return i.a.createElement(Ar,{key:e.value},e.value)}):""))))}}]),t}(i.a.Component),Pr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).createNewSon=function(e,t){var n=a.state.specItemData;console.log(n,"1111111111111111111111"),console.log(e,"33333333333"),n[e]&&n[e].length?t.forEach(function(t){t.parentKey=e,-1===y.a.findIndex(n[e],function(e){return e.id==t.id})&&n[e].push(t)}):(n[e]=[],t.forEach(function(t){n[e].push(t)})),console.log(t,"2222222222"),a.setState({specItemData:n}),a.props.renderTable(),a.hideNewSon()},a.updateSelectedSpecification=function(e){a.props.onUpdate(e)},a.showNewSon=function(e){console.log(e),a.setState({newSonVisible:!0,parent:e})},a.hideNewSon=function(){a.setState({newSonVisible:!1})},a.closeName=function(e){var t=a.state.SelectedSpecification;t=t.filter(function(t){return t.id!=e}),a.setState({SelectedSpecification:t}),a.props.onSubmit(t)},a.closeValue=function(e,t){var n=a.state.specItemData;for(var i in n)i==e&&(n[i]=n[i].filter(function(e){return e.id!=t}));a.setState({specItemData:n}),a.props.renderTable()},a.state={newSonVisible:!1,SelectedSpecification:[],specItemData:{},parent:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.SelectedSpecification}},{key:"componentDidMount",value:function(){var e=this,t={};this.props.SelectedSpecification.forEach(function(e){t[e.id]=e.values}),this.setState({SelectedSpecification:this.props.SelectedSpecification,specItemData:t},function(){e.props.renderTable()})}},{key:"render",value:function(){var e=this,t=[];return t=this.props.SelectedSpecification?this.props.SelectedSpecification:this.state.SelectedSpecification,i.a.createElement("div",null,i.a.createElement(Dr,{visible:this.state.newSonVisible,onCancel:this.hideNewSon,onSubmit:this.createNewSon,parent:this.state.parent,onUpdate:this.updateSelectedSpecification}),i.a.createElement("div",{className:"s_tagBox"},t.length?t.map(function(t){return i.a.createElement("div",{className:"s_tags",key:t.id},i.a.createElement("div",{className:"top"},i.a.createElement(Gt.a,{closable:!e.props.isEdit,onClose:function(){return e.closeName(t.id)}},t.name),i.a.createElement("div",{className:"addNewSon",onClick:function(){return e.showNewSon(t)},style:{display:e.props.isEdit?"none":"block"}},i.a.createElement(de,{type:"icon-plus-circle-fill"}),"\u65b0\u589e\u89c4\u683c\u503c")),i.a.createElement("div",{className:"bottom",style:{marginTop:e.state.specItemData[t.id]?"20px":"0"}},e.state.specItemData[t.id]&&e.state.specItemData[t.id].map(function(a){return i.a.createElement(Gt.a,{closable:!e.props.isEdit,key:a.id,onClose:function(){return e.closeValue(t.id,a.id)}},a.value)})))}):""))}}]),t}(i.a.Component),Vr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).showNewSpecification=function(){a.setState({newSpecificationVisible:!0})},a.hideNewSpecification=function(){a.setState({newSpecificationVisible:!1})},a.createNewSpecification=function(e){var t=a.state.SelectedSpecification;t.length?t.forEach(function(t){t.id!=e.id&&a.setState({SelectedSpecification:[].concat(Object(Se.a)(a.state.SelectedSpecification),[e])})}):a.setState({SelectedSpecification:[].concat(Object(Se.a)(a.state.SelectedSpecification),[e])}),a.hideNewSpecification(),a.renderTable()},a.handleDeleteSpecification=function(e){a.setState({SelectedSpecification:e})},a.renderTable=function(){console.log("------------ start render -------------"),console.log(a.props.entities,"------------props-----------------");var e=[],t=[];if(console.log(a.specItemChild.current,"=================>"),a.props.entities.length){var n=a.props.entities;a.specItemChild.current&&y.a.map(n,function(e){var t=function(t){y.a.map(a.specItemChild.current.state.specItemData[t],function(a){a.id===e.spec[t]&&(console.log("2222222222222"),e["value".concat(t)]=a.name)})};for(var n in e.spec)t(n);console.log(e,"...........................")}),a.setState({data:n})}else{if(a.specItemChild.current){var i=a.specItemChild.current.state.specItemData,r=[],l=function(e){i[e].forEach(function(t){t.parentKey=e}),r.push(i[e])};for(var s in i)l(s);console.log(a.state.data,"+++++++++++++++="),console.log(r,"x[[[[[[[[[[[[[[[[[[[[[[["),e=function(){for(var e=arguments[0],t=1,a=arguments.length;t<a;t++)arguments[t].length&&(e=I(e,arguments[t]));return e||[]}.apply(Object(Ja.a)(a),r),console.log(e,"9090090"),e.forEach(function(e){if(e.value){console.log(e,"________________item___________________");var a={},n="value".concat(e.parentKey),i="id".concat(e.id);a[n]=e.value,a[i]=e.id,a.parentKey=e.parentKey,a.id=e.id,t.push(a)}else{console.log(e,"_______________ go _item___________________");var r={};e.forEach(function(e){var t="value".concat(e.parentKey),a="id".concat(e.id);r[t]=e.value,r[a]=e.id,r.id=e.id}),console.log(r),t.push(r)}}),console.log(t,"lllllllllllll")}a.setState({data:t})}},a.updateSelectedSpecification=function(e){console.log(a.state.SelectedSpecification,"old SelectedSpecification");var t=a.state.SelectedSpecification;console.log(e,"...... new sepc cvalue"),y.a.map(t,function(t){t.spec_value||(t.spec_value=[]),y.a.map(e,function(e){e.parentKey==t.id&&t.spec_value.push(e)})}),console.log(t),a.setState({SelectedSpecification:t})},a.deleteTableLine=function(e){var t=a.state.data;t.map(function(a,n){JSON.stringify(e)==JSON.stringify(a)&&t.splice(n,1)}),a.setState({data:t})},a.tableChange=function(e,t,n){console.log(e),console.log(n);var i=a.state.data;console.log(i),y.a.map(i,function(a){a.id===n.id&&(a[t]=e.target.value)}),a.setState({data:i})},a.renderRecordImage=function(e,t){var n=a.state.data;t.image=e,y.a.map(n,function(a){a.id===t.id&&(a.image=e)}),a.setState({data:n})},a.state={newSpecificationVisible:!1,tableChildren:[],SelectedSpecification:e.spec,sonData:[],data:[]},a.child=i.a.createRef(),a.specItemChild=i.a.createRef(),a.uploadChild=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({data:this.props.entities}),console.log(this.props.entities,"NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN")}},{key:"render",value:function(){var e=this,t=this.state.SelectedSpecification;console.log(t,".....S");var a=[];t.forEach(function(e){a.push({title:e.name,dataIndex:"value".concat(e.id),align:"center"})}),console.log(t,"this is the new specs"),console.log(this.state.data,")))))))))))))))))))))");var n=[{title:"\u5546\u54c1\u89c4\u683c",dataIndex:"111",align:"center",children:a},{title:"\u89c4\u683c\u56fe\u7247",className:"column-money",align:"center",render:function(t,a){return console.log(a,"^^^^^^^^^^^^^^^^6"),a.name?i.a.createElement(ta,{status:"editProduct",upload:function(t){return e.renderRecordImage(t,a)},ref:e.uploadChild,defaultImg:a.image,text:""}):i.a.createElement(ta,{status:"editProduct",ref:e.uploadChild,defaultImg:a.image,text:"",upload:function(t){return e.renderRecordImage(t,a)}})}},{title:"\u5546\u54c1\u7f16\u7801",dataIndex:"barcode",align:"center",render:function(t,a){return console.log(a,"^^^^^^^^^^^^7777777777"),a.name?i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u7f16\u7801",value:a.barcode,onChange:function(t){return e.tableChange(t,"barcode",a)}}):i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u7f16\u7801",onChange:function(e){a.barcode=e.target.value}})}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price",align:"center",render:function(t,a){return a.name?i.a.createElement(Ne.a,{type:"number",addonAfter:"\u5143",disabled:!0,value:a.retail_price,onChange:function(t){return e.tableChange(t,"retail_price",a)}}):i.a.createElement(Ne.a,{type:"number",disabled:!(!e.props.entities||!e.props.entities.length),addonAfter:"\u5143",onChange:function(e){a.retail_price=e.target.value}})}},{title:"\u6210\u672c\u4ef7",dataIndex:"cost_price",align:"center",render:function(t,a){return a.name?i.a.createElement(Ne.a,{type:"number",value:a.cost_price,addonAfter:"\u5143",onChange:function(t){return e.tableChange(t,"cost_price",a)}}):i.a.createElement(Ne.a,{type:"number",addonAfter:"\u5143",onChange:function(e){a.cost_price=e.target.value}})}},{title:"\u5e02\u573a\u4ef7",dataIndex:"market_price",align:"center",render:function(t,a){return a.name?i.a.createElement(Ne.a,{type:"number",value:a.market_price,addonAfter:"\u5143",onChange:function(t){return e.tableChange(t,"market_price",a)}}):i.a.createElement(Ne.a,{type:"number",addonAfter:"\u5143",onChange:function(e){a.market_price=e.target.value}})}},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement(de,{type:"icon-delete-fill",onClick:function(){return e.deleteTableLine(a)}})},align:"center"}];return this.props.entities&&this.props.entities.length&&n.pop(),i.a.createElement("div",{className:"specification"},i.a.createElement(Rr,{visible:this.state.newSpecificationVisible,onCancel:this.hideNewSpecification,onSubmit:this.createNewSpecification,ref:this.child,renderTable:this.state.renderTable}),i.a.createElement(Pr,{SelectedSpecification:this.state.SelectedSpecification,ref:this.specItemChild,renderTable:this.renderTable,onSubmit:this.handleDeleteSpecification,isEdit:this.props.isEdit,onUpdate:this.updateSelectedSpecification}),i.a.createElement("div",{className:"specification_header"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showNewSpecification,disabled:!(!this.props.entities||!this.props.entities.length)},"\u65b0\u589e\u89c4\u683c")),i.a.createElement("div",{className:"specification_body"},i.a.createElement(ve.a,{columns:n,dataSource:this.state.data,bordered:!0,pagination:!1,rowKey:function(e){return e.id}})))}}]),t}(i.a.Component);function Lr(e){return ne({url:"/api/backend/distribution/bonus/levels",method:"post",data:e})}function Mr(e){return ne({url:"/api/backend/distribution/cashback/settings",method:"get",params:e})}function Ur(e,t){return ne({url:"/api/backend/distribution/bonus/levels/".concat(t),method:"put",data:e})}function Fr(e){return new Promise(function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}})}var Gr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).beforeUpload=function(e){var t="image/jpeg"===e.type||"image/png"===e.type;if(t)return t;B.a.error("\u4ec5\u652f\u6301\u4e0a\u4f20JPG,PNG\u683c\u5f0f\u7684\u56fe\u7247!")},a.handleCancel=function(){a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object($.a)(X.a.mark(function e(t){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Fr(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){var t=e.fileList;a.setState({fileList:t})},a.text=e.text,a.state={previewVisible:!1,previewImage:"",fileList:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.defaultImg.length){var a=e.defaultImg;if("object"==typeof a){var n=[];a.forEach(function(e,t){var a={};a.uid=t,a.url=e,n.push(a)}),this.setState({fileList:n})}}}},{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,r=i.a.createElement("div",null,i.a.createElement(me.a,{type:"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text"},"\u4e0a\u4f20"));return i.a.createElement("div",{className:"clearfix"},i.a.createElement(Zt.a,{listType:"picture-card",fileList:n,onPreview:this.handlePreview,onChange:this.handleChange,action:"".concat(v.apiUrl,"/api/common/image/upload"),headers:{Authorization:"".concat(k())},beforeUpload:this.beforeUpload},n.length>=10?null:r),i.a.createElement(ge.a,{visible:t,footer:null,onCancel:this.handleCancel},i.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(i.a.Component),Br=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).cascaderChange=function(e){var t=a.state,n=t.allClassification,i=t.selectedItems,r=[];n.forEach(function(e){r.push(e),e.children.length&&e.children.forEach(function(t){t.parentId=e.id,r.push(t)})}),r.forEach(function(t){e.forEach(function(e){e===t.id&&(i.length?i.forEach(function(a){a.id===e?i=i.filter(function(t){return t.id!==e}):(t.parentId&&i.push(n.filter(function(e){return e.id===t.parentId})[0]),i.push(t))}):t.parentId&&i.push(n.filter(function(e){return e.id===t.parentId})[0]),i.push(t))})});var l={};i=i.reduce(function(e,t){return l[t.id]||(l[t.id]=!0,e.push(t)),e},[]),a.setState({selectedItems:i})},a.closeTag=function(e){var t=a.state.selectedItems;console.log(t),t=t.filter(function(t){return t.id!==e.id});var n=!1;e.parentId&&(t.forEach(function(t){t.parentId===e.parentId&&(n=!0)}),n||(t=t.filter(function(t){return t.id!==e.parentId}))),a.setState({selectedItems:t})},a.state={allClassification:[],selectedItems:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;He({}).then(function(t){e.setState({allClassification:t})})}},{key:"componentWillReceiveProps",value:function(e,t){if(e.def){var a=[];this.state.allClassification.forEach(function(t){e.def.forEach(function(e){t.id===e&&a.push(t)})}),this.setState({selectedItems:a})}}},{key:"render",value:function(){var e=this,t=this.state.selectedItems;return i.a.createElement("div",null,i.a.createElement(Oe.a,{value:this.state.value,fieldNames:{label:"name",value:"id"},expandTrigger:"hover",options:this.state.allClassification,onChange:this.cascaderChange,placeholder:"\u8bf7\u9009\u62e9\u5546\u54c1\u5206\u7c7b"}),t.map(function(t){return i.a.createElement(Gt.a,{closable:!t.children||!t.children.length,key:t.id,onClose:function(){return e.closeTag(t)}},t.name)}))}}]),t}(n.Component),zr=wr.a.TabPane,Hr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).tabChange=function(e){a.setState({activeKey:e})},a.devideIds=function(e,t){var a={};return t.forEach(function(t){(t.spec_value||t.values).forEach(function(n){n.id==e["id".concat(n.id)]&&(a[t.id]=n.id)})}),a},a.handleSubmit=function(e){var t,n;e.preventDefault(),t=a.props.location.state&&a.props.location.state.id?Ut:Pt,n=a.props.location.state&&a.props.location.state.id?"\u7f16\u8f91\u5546\u54c1\u6210\u529f":"\u53d1\u5e03\u5546\u54c1\u6210\u529f";var i=a.uploadChild.current.state.imgUrl||a.uploadChild.current.state.imageUrl;a.props.form.setFieldsValue({thumbnail:i});var r=[];a.classification.current.state.selectedItems.forEach(function(e){return r.push(e.id)}),a.props.form.setFieldsValue({category_ids:r}),console.log(t,"_+_+_+_+_+_+_+_+_+_+_+_+__"),a.props.form.validateFieldsAndScroll(function(e,i){i.banners=[],a.bannerChild.current.state.fileList.forEach(function(e){i.banners.push(e.url||e.response.data.url)});var r=i.retail_price||0,l=i.market_price||0;i.show_market_price;if(l&&(console.log(r,"|||"),console.log(l,"|||"),r-l>0))B.a.error("\u96f6\u552e\u4ef7\u4e0d\u53ef\u5927\u4e8e\u5e02\u573a\u4ef7");else if(!e)if(i.open_specification){i.open_specification=1;var s=[],c=a.child.current.state.SelectedSpecification,o=a.child.current.specItemChild.current.state.specItemData;c.forEach(function(e){var t={};t.id=e.id,t.name=e.name,t.values=[],o[e.id].forEach(function(e){e.name=e.value,t.values.push(e)}),s.push(t)});var u=a.child.current.state.data,m=!0;if(u.forEach(function(e){if(console.log(e,"+++++++++__)_+))_+)_+)_+)))_+)+)_+__"),!e.barcode)return B.a.error("\u8bf7\u8f93\u5165\u89c4\u683c\u5546\u54c1\u7f16\u7801"),void(m=!1);var t=a.devideIds(e,c);e.name=i.name,console.log(e,"========>"),e.spec=t}),!m)return;i.spec=s,i.entities=u,i.detail=a.editor.current?a.editor.current.state.outputHTML:i.detail,i.sort=Math.round(i.sort),t(i,a.props.location.state&&a.props.location.state.id).then(function(e){B.a.success(n),window.setTimeout(function(){a.props.history.push({pathname:"/goods"})},2e3)}).catch(function(e){})}else i.open_specification=0,i.market_price=i.market_price?i.market_price:0,i.sort=Math.round(i.sort),i.detail=a.editor.current?a.editor.current.state.outputHTML:i.detail,t(i,a.props.location.state&&a.props.location.state.id).then(function(e){B.a.success(n),window.setTimeout(function(){a.props.history.push({pathname:"/goods"})},2e3)}).catch(function(e){})})},a.state={activeKey:"1",confirmDirty:!1,autoCompleteResult:[],allClassification:[],name:"",barcode:"",thumbnail:"",banners:[],intro:"",share_desc:"",property:"",category_ids:[],specificationIsOpen:!1,spec:[],entities:[],detail:"",PI:0,status:"create"},a.child=i.a.createRef(),a.uploadChild=i.a.createRef(),a.bannerChild=i.a.createRef(),a.editor=i.a.createRef(),a.classification=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e,t,a=this;this.props.location.state&&this.props.location.state.id&&(e={},t=this.props.location.state.id,ne({url:"/api/backend/products/".concat(t),method:"get",params:e})).then(function(e){for(var t in console.log(e,"___________________________________________..........................."),e.data)a.props.form.setFieldsValue(Object(Y.a)({},t,e.data[t]));a.setState({specificationIsOpen:e.data.open_specification,spec:e.data.spec,entities:e.data.entities.data,detail:e.data.detail,category_ids:e.data.category_ids,status:"edit"})}).catch(function(e){}),Mr({}).then(function(e){a.setState({PI:e.data[0].value})})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return i.a.createElement("div",{className:"releaseGoods"},i.a.createElement("div",{className:"header"},this.props.location.state&&this.props.location.state.id?"\u7f16\u8f91\u5546\u54c1":"\u53d1\u5e03\u5546\u54c1",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"mainReleaseGood"},i.a.createElement(wr.a,{activeKey:this.state.activeKey,onChange:this.tabChange},i.a.createElement(zr,{tab:"1.\u7f16\u8f91\u57fa\u672c\u4fe1\u606f",key:"1",forceRender:!0},i.a.createElement("div",{className:"forms"},i.a.createElement(Nr.a,{onSubmit:this.handleSubmit,labelAlign:"left"},i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u540d\u79f0\uff1a"},t("name",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u65e0\uff1a",style:{display:"none"}},t("detail",{initialValue:"",rules:[{message:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u5c55\u793a\u540d\u79f0\uff1a"},t("display_name",{initialValue:"",rules:[{required:!1}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u7f16\u7801\uff1a",style:{marginBottom:0}},t("barcode",{initialValue:"",rules:[]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u7f29\u7565\u56fe\uff1a",className:"upload"},t("thumbnail",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5546\u54c1\u7f29\u7565\u56fe"}]})(i.a.createElement(ta,{defaultImg:this.props.form.getFieldValue("thumbnail"),ref:this.uploadChild,status:this.state.status,isProduct:!0,text:"\u4e0a\u4f20"}))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1banner\u56fe\uff1a",className:"upload banners"},t("banners",{initialValue:[],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5546\u54c1banner\u56fe"}]})(i.a.createElement("div",{className:"bannerImg"},i.a.createElement(Gr,{ref:this.bannerChild,defaultImg:this.props.form.getFieldValue("banners")}),i.a.createElement("span",{className:"suggest"},"\u5efa\u8bae\u5c3a\u5bf8\uff1a640 * 640\u50cf\u7d20\uff0c\u6700\u591a\u4e0a\u4f2010\u5f20\uff1b\u4f60\u53ef\u4ee5\u62d6\u62fd\u56fe\u7247\u8c03\u6574\u56fe\u7247\u987a\u5e8f\u3002")))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u7b80\u4ecb\uff1a",style:{marginTop:"90px"}},t("intro",{initialValue:"",rules:[{required:!1}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u6392\u5e8f\uff1a"},t("sort",{initialValue:0,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u6392\u5e8f"}]})(i.a.createElement(Ne.a,{type:"number"}))),i.a.createElement(Nr.a.Item,{label:"\u5206\u4eab\u63cf\u8ff0\uff1a"},t("share_desc",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5206\u4eab\u63cf\u8ff0"}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u5c5e\u6027\uff1a"},t("property",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5546\u54c1\u5c5e\u6027"}]})(i.a.createElement(Q.a,{onChange:function(t){e.props.form.setFieldsValue({property:t})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"SPECIAL_PREFERENTIAL"},"\u7279\u60e0\u5546\u54c1"),i.a.createElement(Q.a.Option,{value:"CASHBACK"},"\u8fd4\u5229\u5546\u54c1")))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u5206\u7c7b\uff1a",className:"classification"},t("category_ids",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5546\u54c1\u5206\u7c7b"}]})(i.a.createElement(Br,{ref:this.classification,def:this.props.form.getFieldValue("category_ids")}))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u5355\u4f4d\uff1a"},t("unit",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u5355\u4f4d"}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u662f\u5426\u663e\u793a\u5e02\u573a\u4ef7\uff1a"},t("show_market_price",{initialValue:!1})(i.a.createElement(ke.a,{checked:this.props.form.getFieldValue("show_market_price"),onChange:function(t){e.props.form.setFieldsValue({show_market_price:t})}}))),i.a.createElement(Nr.a.Item,{label:"\u5f00\u542f\u89c4\u683c\uff1a"},t("open_specification",{initialValue:!1})(i.a.createElement(ke.a,{disabled:!(!this.props.location.state||!this.props.location.state.id),checked:this.props.form.getFieldValue("open_specification"),onChange:function(t){e.props.form.setFieldsValue({open_specification:t}),e.setState({specificationIsOpen:t})}}))),this.state.specificationIsOpen?i.a.createElement(Vr,{ref:this.child,spec:this.state.spec,entities:this.state.entities,isEdit:this.props.location.state&&this.props.location.state.id}):i.a.createElement("div",null,i.a.createElement(Nr.a.Item,{label:"\u96f6\u552e\u4ef7\uff1a"},t("retail_price",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u96f6\u552e\u4ef7"}]})(i.a.createElement(Ne.a,{disabled:!(!this.props.location.state||!this.props.location.state.id)}))),i.a.createElement(Nr.a.Item,{label:"\u5e02\u573a\u4ef7\uff1a"},t("market_price",{initialValue:"",rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u5e02\u573a\u4ef7"}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u6210\u672c\u4ef7\uff1a"},t("cost_price",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6210\u672c\u4ef7"}]})(i.a.createElement(Ne.a,null)))),i.a.createElement(Nr.a.Item,{label:"\u751f\u4ea7\u529b\u6307\u6570\uff1a"},t("pv",{initialValue:this.state.PI,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u751f\u4ea7\u529b\u6307\u6570"}]})(i.a.createElement(Ne.a,null))),i.a.createElement(Nr.a.Item,{label:"\u9009\u62e9\u6279\u6b21\uff1a"},t("batch",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6279\u6b21"}]})(i.a.createElement(Q.a,{mode:"multiple",onChange:function(t){e.props.form.setFieldsValue({batch:t})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"5:30"},"5:30"),i.a.createElement(Q.a.Option,{value:"11:30"},"11:30"),i.a.createElement(Q.a.Option,{value:"16:30"},"16:30")))),i.a.createElement(Nr.a.Item,{label:"\u4fdd\u5b58\u65b9\u5f0f\uff1a"},t("keep_mode",{initialValue:"FROZEN",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4fdd\u5b58\u65b9\u5f0f"}]})(i.a.createElement(mn.a.Group,{onChange:function(t){e.props.form.setFieldsValue({keep_mode:t})}},i.a.createElement(mn.a,{value:"FROZEN"},"\u51b7\u51bb"),i.a.createElement(mn.a,{value:"HOMOIOTHERMY"},"\u5e38\u6e29"),i.a.createElement(mn.a,{value:"REFRIGERATION"},"\u51b7\u85cf"),i.a.createElement(mn.a,{value:"HEATING"},"\u70ed\u98df")))),i.a.createElement(Nr.a.Item,{label:"\u5546\u54c1\u72b6\u6001\uff1a"},t("status",{initialValue:!0,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5546\u54c1\u72b6\u6001"}]})(i.a.createElement(mn.a.Group,{onChange:function(t){e.props.form.setFieldsValue({status:t})}},i.a.createElement(mn.a,{value:!0},"\u4e0a\u67b6"),i.a.createElement(mn.a,{value:!1},"\u4e0b\u67b6"))))))),i.a.createElement(zr,{tab:"2.\u7f16\u8f91\u5546\u54c1\u8be6\u60c5",key:"2"},i.a.createElement(jr,{ref:this.editor,default:this.state.detail})))),i.a.createElement("div",{className:"footer"},i.a.createElement(_e.a,{size:"small",style:{marginRight:"10px",display:"2"==this.state.activeKey?"none":"block"},onClick:function(){e.setState({activeKey:"2"})}},"\u4e0b\u4e00\u6b65"),i.a.createElement(_e.a,{size:"small",style:{marginRight:"10px",display:"1"==this.state.activeKey?"none":"block"},onClick:function(){e.setState({activeKey:"1"})}},"\u4e0a\u4e00\u6b65"),i.a.createElement(_e.a,{size:"small",type:"primary",style:{marginLeft:"10px"},onClick:this.handleSubmit},"\u4fdd\u5b58")))}}]),t}(i.a.Component),Kr=Hr=Nr.a.create({})(Hr),Jr=(a(1235),a(380),Q.a.Option,function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",value:[]},a.handleChange=function(e){a.setState({value:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.name?Kt({name:a.state.name,values:a.state.value}).then(function(e){a.handleCancel(),a.props.refresh()}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u89c4\u683c\u540d\u79f0")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u89c4\u683c",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"createSpecification"},"\u89c4\u683c\u540d\u79f0",i.a.createElement(Ne.a,{value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("div",{className:"createSpecification"},"\u89c4\u683c\u503c",i.a.createElement(Q.a,{mode:"tags",placeholder:"\u8bf7\u8f93\u5165\u89c4\u683c\u503c",onChange:this.handleChange},[]))))}}]),t}(i.a.Component)),Wr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={id:"",name:"",value:[]},a.handleChange=function(e){a.setState({value:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e=a.state.id;a.state.value?function(e,t){return ne({url:"/api/backend/products/specification/".concat(t,"/add_spec_value"),method:"put",data:e})}({value:a.state.value},e).then(function(e){a.setState({value:""}),a.handleCancel(),a.props.refresh()}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u89c4\u683c\u540d\u79f0")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.id&&(console.log(e),this.setState({id:e.id}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u89c4\u683c\u503c",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"createSpecification"},"\u89c4\u683c\u503c",i.a.createElement(Ne.a,{value:this.state.value,onChange:function(t){e.setState({value:t.target.value})}}))))}}]),t}(i.a.Component),Yr=Q.a.Option,qr=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",value:[],ary:[]},a.handleChange=function(e){a.setState({ary:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e,t;a.state.name?(e={values:a.state.ary},t=a.props.id,ne({url:"/api/backend/products/specification/".concat(t),method:"put",data:e})).then(function(e){a.handleCancel(),a.props.refresh()}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u89c4\u683c\u540d\u79f0")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.id&&(a={},n=e.id,ne({url:"/api/backend/products/specification/".concat(n),method:"get",params:a})).then(function(e){var t=[];e.spec_value.forEach(function(e){return t.push(e.value)}),i.setState({name:e.name,ary:t,value:e.spec_value})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=[];return this.state.value.length&&this.state.value.forEach(function(e){t.push(i.a.createElement(Yr,{key:e.value},e.value))}),i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7f16\u8f91\u89c4\u683c",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("div",{className:"createSpecification"},"\u89c4\u683c\u540d\u79f0",i.a.createElement(Ne.a,{value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("div",{className:"createSpecification"},"\u89c4\u683c\u503c",i.a.createElement(Q.a,{mode:"tags",placeholder:"\u8bf7\u8f93\u5165\u89c4\u683c\u503c",value:this.state.ary,onChange:this.handleChange},t))))}}]),t}(i.a.Component),Xr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.paginationChange=function(e){a.setState({data:e})},a.deleteSpec=function(e){var t=a.refresh,n=[e],r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u89c4\u683c\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var e;(e={ids:n},ne({url:"/api/backend/products/specification/destroy",method:"delete",data:e})).then(function(e){t()}).catch(function(e){})}})},a.showCreateSpecification=function(){a.setState({createSpecification:!0})},a.hideCreateSpecification=function(){a.setState({createSpecification:!1})},a.showCreateSpecificationValue=function(e){a.setState({createSpecificationValue:!0,specificationId:e})},a.hideCreateSpecificationValue=function(){a.setState({createSpecificationValue:!1})},a.showEditSpecification=function(e){a.setState({editSpecification:!0,id:e})},a.hideEditSpecification=function(){a.setState({editSpecification:!1})},a.state={api:Ht,data:[],id:"",createSpecification:!1,editSpecification:!1,createSpecificationValue:!1,specificationId:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u89c4\u683c\u540d\u79f0",dataIndex:"name"},{title:"\u89c4\u683c\u503c",dataIndex:"spec_value"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.showCreateSpecificationValue(a.id)}},"\u65b0\u589e\u89c4\u683c\u503c"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){e.showEditSpecification(a.id)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return e.deleteSpec(a.id)}},"\u5220\u9664"))}}];return i.a.createElement("div",{className:"specification"},i.a.createElement(Jr,{visible:this.state.createSpecification,onCancel:this.hideCreateSpecification,refresh:this.refresh}),i.a.createElement(qr,{visible:this.state.editSpecification,onCancel:this.hideEditSpecification,refresh:this.refresh,id:this.state.id}),i.a.createElement(Wr,{visible:this.state.createSpecificationValue,onCancel:this.hideCreateSpecificationValue,refresh:this.refresh,id:this.state.specificationId}),i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",onClick:this.showCreateSpecification},i.a.createElement(de,{type:"icon-plus-circle"}),"\u65b0\u589e\u89c4\u683c")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,valChange:this.paginationChange})))}}]),t}(i.a.Component),$r=(a(1236),G.a.RangePicker),Qr=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onDateChange=function(e,t){console.log(e,t)},a.refresh=function(){var e;(e={channel:a.channel,activity_id:a.actId},ne({url:"/api/backend/products/stock/in_stock/flows",method:"get",params:e})).then(function(e){a.setState({data:e.data})})},a.listDetail=function(e){console.log(e),a.props.history.push({pathname:"/goods/inStockDetail",state:{id:e.stock_batch_id}})},a.goInStockNew=function(){a.props.history.push({pathname:"/goods/inStockNew",state:{channel:a.channel,actId:a.actId}})},a.channel=e.location.state.channel,a.actId=e.location.state.actId||"",a.state={data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u5165\u5e93\u7f16\u53f7",dataIndex:"batch_code"},{title:"\u5165\u5e93\u7c7b\u578b",dataIndex:"stock_type"},{title:"\u5165\u5e93\u65f6\u95f4",dataIndex:"batch_date"},{title:"\u5907\u6ce8",dataIndex:"remark"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.listDetail(a)}},"\u8be6\u60c5"))}}];return i.a.createElement("div",{className:"inStock"},i.a.createElement("div",{className:"header"},"\u5546\u54c1\u5165\u5e93",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.goInStockNew},"\u65b0\u5efa\u5165\u5e93"),i.a.createElement("div",{className:"filter"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",{className:"needMargin"},"\u5546\u54c1\u7b5b\u9009\uff1a",i.a.createElement(Ne.a,null)),i.a.createElement("li",{className:"needMargin"},"\u5165\u5e93\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement($r,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u5165\u5e93\u7f16\u53f7\uff1a",i.a.createElement(Ne.a,null)),i.a.createElement("li",null,"\u5165\u5e93\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{onChange:function(t){e.setState({type:t})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"PRODUCE"},"\u751f\u4ea7\u5165\u5e93"),i.a.createElement(Q.a.Option,{value:"PURCHASE"},"\u8d2d\u4e70\u5165\u5e93"),i.a.createElement(Q.a.Option,{value:"RETURN"},"\u9000\u8d27\u5165\u5e93"),i.a.createElement(Q.a.Option,{value:"CHECK"},"\u76d8\u70b9\u5165\u5e93")))),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{size:"small",type:"primary",className:"button"},"\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa"),i.a.createElement("span",{className:"clear"},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data}))))}}]),t}(i.a.Component),Zr=(a(1237),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(){a.handleCancel(),a.props.onSubmit(a.state.selectedRows,a.props.record)},a.handleCancel=function(){a.props.onCancel()},a.state={data:[],selectedRowKeys:[],selectedRows:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.recordStocks&&this.setState({data:e.recordStocks.data})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})}};return i.a.createElement("div",{className:"selectSpec"},i.a.createElement(ge.a,{title:"\u9009\u62e9\u89c4\u683c",width:526,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:!1,mask:!1},i.a.createElement("div",{className:"selectGoodsChart"},i.a.createElement(ve.a,{rowSelection:t,columns:[{title:"\u89c4\u683c",dataIndex:"spec"},{title:"\u5546\u54c1\u6761\u7801",dataIndex:"productEntity.data.barcode"}],rowKey:function(e){return e.stock_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"selectSpecFooter"},i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel},"\u53d6\u6d88"),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.handleSubmit},"\u786e\u5b9a"))))}}]),t}(i.a.Component)),el=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getGoods=function(e){Vt({channel:a.props.channel,limit:10,is_in_stock:!0,page:e,activity_id:a.props.actId}).then(function(e){if(e.data.length){var t=a.state.data;a.setState({data:t.concat(e.data)})}}).catch(function(e){})},a.handleScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getGoods(n)}},a.closeSpec=function(){a.setState({specVisible:!1})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.props.onSubmit(a.state.checkedAry)},a.handleCheckChange=function(e,t){var n=a.state.checkedAry;e.checked=t.target.checked,e.open_specification?a.setState({specVisible:!0,recordStocks:e.stocks}):t.target.checked?n.push(e):n=n.filter(function(t){return t.product_id!=e.product_id}),a.setState({checkedAry:n})},a.selectSpec=function(e){a.setState({specVisible:!0,recordStocks:e.stocks,record:e})},a.submitSpec=function(e,t){var n=a.state.data,i=0;n.forEach(function(a){a.product_id==t.product_id&&(a.selectedSpec=e.length)}),n.forEach(function(e){e.selectedSpec&&i++}),a.setState({data:n,count:i,checkedAry:j(a.state.checkedAry,e)})},a.cateChange=function(e){a.setState({cateId:e})},a.inputChange=function(e){a.setState({goodName:e.target.value})},a.search=function(){Vt({channel:a.props.channel,limit:100,is_in_stock:!0,page:1,searchJson:w({"product.name":a.state.goodName,"product.categories.id":a.state.cateId})}).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.clear=function(){a.setState({goodName:"",cateId:""},function(){a.getGoods(1)})},a.state={data:[],scrollPage:1,checkedAry:[],specVisible:!1,recordStocks:{},record:{},count:0,goodName:"",cates:[],cateId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getGoods(),ze({limit:100,page:1}).then(function(t){e.setState({cates:t.data})})}},{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1",dataIndex:"name"},{title:"\u89c4\u683c",render:function(t,a){return a.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.selectSpec(a)}},a.selectedSpec?"\u9009\u62e9\u89c4\u683c(".concat(a.selectedSpec,")"):"\u9009\u62e9\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u5546\u54c1\u5206\u7c7b",dataIndex:"category"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",{className:"checkBox"},i.a.createElement(un.a,{checked:a.checked||!1,onChange:function(t){return e.handleCheckChange(a,t)}}," "))}}];return i.a.createElement("div",{className:"selectGoods"},i.a.createElement(Zr,{visible:this.state.specVisible,onCancel:this.closeSpec,onSubmit:this.submitSpec,recordStocks:this.state.recordStocks,record:this.state.record}),i.a.createElement(ge.a,{title:"\u9009\u62e9\u5165\u5e93\u5546\u54c1",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:!1,className:"stockModal"},i.a.createElement("div",{className:"selectGoodsHeader"},i.a.createElement("span",null,"\u5546\u54c1\u5206\u7c7b\uff1a"),i.a.createElement(Q.a,{placeholder:"\u8bf7\u9009\u62e9\u5546\u54c1\u5206\u7c7b",onChange:this.cateChange,value:this.state.cateId},this.state.cates.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id},e.name)})),i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0",value:this.state.goodName,onChange:this.inputChange}),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.search},"\u641c\u7d22"),i.a.createElement(_e.a,{size:"small",className:"button",onClick:this.clear},"\u5237\u65b0")),i.a.createElement("div",{className:"selectGoodsChart",onScrollCapture:this.handleScroll},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"selectGoodFooter"},i.a.createElement("div",{className:"text"},"\u5df2\u9009",i.a.createElement("span",null,this.state.count),"\u4e2a\u4ea7\u54c1"),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.handleSubmit},"\u786e\u5b9a"))))}}]),t}(i.a.Component),tl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onDateChange=function(e,t){console.log(e,t)},a.selectGoods=function(){a.state.type?a.setState({visible:!0}):B.a.error("\u8bf7\u5148\u9009\u62e9\u5165\u5e93\u7c7b\u578b")},a.hideSelectGoods=function(){a.setState({visible:!1})},a.selectedGoods=function(e){a.hideSelectGoods(),e.forEach(function(e){e.count=0}),a.setState({data:e})},a.confirmInStock=function(){if(a.state.remark){var e=[];if(a.state.data.forEach(function(t){var a={};console.log(t),t.productEntity?a.entity_id=t.productEntity.data.id:a.entity_id=t.stocks.data[0].productEntity.data.id,t.quantity&&(a.quantity=t.quantity,e.push(a))}),console.log(e,"0000000"),e.length<a.state.data.length)B.a.error("\u8bf7\u586b\u5199\u5165\u5e93\u6570\u91cf");else(function(e){return ne({url:"/api/backend/products/stock/in_stock/add",method:"post",data:e})})({channel:a.channel,stock_type:a.state.type,stock_info:e,remark:a.state.remark,activity_id:a.actId}).then(function(e){B.a.success(e.message),a.props.history.go(-1)}).catch(function(e){})}else B.a.error("\u8bf7\u5148\u586b\u5199\u5907\u6ce8")},a.deleteItems=function(e){var t=a.state.data;t=t.filter(function(t){return t.stock_id!=e.stock_id}),a.setState({data:t})},console.log(e,"||||||||||||||||||||||"),a.channel=e.location.state.channel,a.actId=e.location.state.actId||"",a.state={remark:"",data:[],visible:!1,type:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1\u540d\u79f0",render:function(e,t){return console.log(t),i.a.createElement("span",null,t.name?t.name:t.productEntity.data.name)}},{title:"\u89c4\u683c",dataIndex:"keeper_name",render:function(e,t){return i.a.createElement("span",null,t.spec?t.spec:"\u65e0")}},{title:"\u5355\u4f4d",dataIndex:"stocks.data[0].unit"},{title:"\u5165\u5e93\u6570\u91cf",render:function(e,t){return i.a.createElement("div",null,i.a.createElement(Ne.a,{className:"inStockNum",defaultValue:0,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||(t.quantity=e.target.value,t.count=t.quantity*t.retail_price,console.log(t))}}))}},{title:"\u6210\u672c\u4ef7",dataIndex:"retail_price"},{title:"\u5c0f\u8ba1",dataIndex:"count"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.deleteItems(a)}},"\u5220\u9664"))}}];return i.a.createElement("div",{className:"inStockNewNew"},i.a.createElement(el,{visible:this.state.visible,onCancel:this.hideSelectGoods,onSubmit:this.selectedGoods,channel:this.props.location.state.channel,ref:this.child,actId:this.actId}),i.a.createElement("div",{className:"header"},"\u65b0\u5efa\u5165\u5e93",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement("div",{className:"filter"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",null,"\u5165\u5e93\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{onChange:function(t){e.setState({type:t})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"PRODUCE"},"\u751f\u4ea7\u5165\u5e93"),i.a.createElement(Q.a.Option,{value:"PURCHASE"},"\u8d2d\u4e70\u5165\u5e93"),i.a.createElement(Q.a.Option,{value:"RETURN"},"\u9000\u8d27\u5165\u5e93"),i.a.createElement(Q.a.Option,{value:"CHECK"},"\u76d8\u70b9\u5165\u5e93"))),i.a.createElement("li",null,"\u5907\u6ce8\uff1a",i.a.createElement(Ne.a,{maxLength:50,value:this.state.remark,suffix:i.a.createElement("span",{className:"limit"},this.state.remark.length,"/50"),onChange:function(t){e.setState({remark:t.target.value})}})),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.selectGoods},"\u9009\u62e9\u5165\u5e93\u5546\u54c1")))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.stock_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.confirmInStock},"\u786e\u8ba4\u5165\u5e93")))}}]),t}(i.a.Component),al=(a(1238),G.a.RangePicker),nl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onDateChange=function(e,t){console.log(e,t)},a.refresh=function(){var e;(e={channel:a.channel,activity_id:a.actId},ne({url:"/api/backend/products/stock/out_stock/flows",method:"get",params:e})).then(function(e){a.setState({data:e.data})})},a.listDetail=function(e){a.props.history.push({pathname:"/goods/outStockDetail",state:{id:e.stock_batch_id}})},a.goInStockNew=function(){a.props.history.push({pathname:"/goods/outStockNew",state:{channel:a.channel,actId:a.actId}})},a.channel=e.location.state.channel,a.actId=e.location.state.actId||"",a.state={data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u51fa\u5e93\u7f16\u53f7",dataIndex:"batch_code"},{title:"\u51fa\u5e93\u7c7b\u578b",dataIndex:"stock_type"},{title:"\u51fa\u5e93\u65f6\u95f4",dataIndex:"batch_date"},{title:"\u5907\u6ce8",dataIndex:"remark"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){e.listDetail(a)}},"\u8be6\u60c5"))}}];return i.a.createElement("div",{className:"inStock"},i.a.createElement("div",{className:"header"},"\u5546\u54c1\u51fa\u5e93",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.goInStockNew},"\u65b0\u5efa\u51fa\u5e93"),i.a.createElement("div",{className:"filter"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",{className:"needMargin"},"\u5546\u54c1\u7b5b\u9009\uff1a",i.a.createElement(Ne.a,null)),i.a.createElement("li",{className:"needMargin"},"\u51fa\u5e93\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(al,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u51fa\u5e93\u7f16\u53f7\uff1a",i.a.createElement(Ne.a,null)),i.a.createElement("li",null,"\u51fa\u5e93\u7c7b\u578b\uff1a",i.a.createElement(Ne.a,null))),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{size:"small",type:"primary",className:"button"},"\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa"),i.a.createElement("span",{className:"clear"},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data}))))}}]),t}(i.a.Component),il=(a(1239),a(575),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(){a.handleCancel(),a.props.onSubmit(a.state.selectedRows,a.props.record)},a.handleCancel=function(){a.props.onCancel()},a.state={data:[],selectedRowKeys:[],selectedRows:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.recordStocks&&this.setState({data:e.recordStocks.data})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})}};return i.a.createElement("div",{className:"selectSpec"},i.a.createElement(ge.a,{title:"\u9009\u62e9\u89c4\u683c",width:526,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:!1,mask:!1},i.a.createElement("div",{className:"selectGoodsChart"},i.a.createElement(ve.a,{rowSelection:t,columns:[{title:"\u89c4\u683c",dataIndex:"spec"},{title:"\u5546\u54c1\u6761\u7801",dataIndex:"productEntity.data.barcode"}],rowKey:function(e){return e.stock_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"selectSpecFooter"},i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel},"\u53d6\u6d88"),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.handleSubmit},"\u786e\u5b9a"))))}}]),t}(i.a.Component)),rl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getGoods=function(e){Vt({channel:a.props.channel,limit:10,is_in_stock:0,page:e,activity_id:a.props.actId}).then(function(e){if(e.data.length){var t=a.state.data;a.setState({data:t.concat(e.data)})}}).catch(function(e){})},a.handleScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getGoods(n)}},a.closeSpec=function(){a.setState({specVisible:!1})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.props.onSubmit(a.state.checkedAry)},a.handleCheckChange=function(e,t){var n=a.state.checkedAry;e.checked=t.target.checked,e.open_specification?a.setState({specVisible:!0,recordStocks:e.stocks}):t.target.checked?n.push(e):n=n.filter(function(t){return t.product_id!=e.product_id}),a.setState({checkedAry:n})},a.selectSpec=function(e){a.setState({specVisible:!0,recordStocks:e.stocks,record:e})},a.submitSpec=function(e,t){var n=a.state.data,i=0;n.forEach(function(a){a.product_id==t.product_id&&(a.selectedSpec=e.length)}),n.forEach(function(e){e.selectedSpec&&i++}),a.setState({data:n,count:i,checkedAry:j(a.state.checkedAry,e)})},a.cateChange=function(e){a.setState({cateId:e})},a.inputChange=function(e){a.setState({goodName:e.target.value})},a.search=function(){Vt({channel:a.props.channel,limit:100,is_in_stock:!1,page:1,searchJson:w({"product.name":a.state.goodName,"product.categories.id":a.state.cateId})}).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.clear=function(){a.setState({goodName:"",cateId:""},function(){a.getGoods(1)})},a.state={data:[],scrollPage:1,checkedAry:[],specVisible:!1,recordStocks:{},record:{},count:0,goodName:"",cates:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getGoods(),ze({limit:100,page:1}).then(function(t){e.setState({cates:t.data})})}},{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1",dataIndex:"name"},{title:"\u89c4\u683c",render:function(t,a){return a.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.selectSpec(a)}},a.selectedSpec?"\u9009\u62e9\u89c4\u683c(".concat(a.selectedSpec,")"):"\u9009\u62e9\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u5546\u54c1\u5206\u7c7b",dataIndex:"category"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",{className:"checkBox"},i.a.createElement(un.a,{checked:a.checked||!1,onChange:function(t){return e.handleCheckChange(a,t)}}," "))}}];return i.a.createElement("div",{className:"selectGoods"},i.a.createElement(il,{visible:this.state.specVisible,onCancel:this.closeSpec,onSubmit:this.submitSpec,recordStocks:this.state.recordStocks,record:this.state.record}),i.a.createElement(ge.a,{title:"\u9009\u62e9\u51fa\u5e93\u5546\u54c1",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:!1,className:"stockModal",bodyStyle:{height:"795px !important"}},i.a.createElement("div",{className:"selectGoodsHeader"},i.a.createElement("span",null,"\u5546\u54c1\u5206\u7c7b\uff1a"),i.a.createElement(Q.a,{placeholder:"\u8bf7\u9009\u62e9\u5546\u54c1\u5206\u7c7b",onChange:this.cateChange,value:this.state.cateId},this.state.cates.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id},e.name)})),i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0",value:this.state.goodName,onChange:this.inputChange}),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.search},"\u641c\u7d22"),i.a.createElement(_e.a,{size:"small",className:"button",onClick:this.clear},"\u5237\u65b0")),i.a.createElement("div",{className:"selectGoodsChart",onScrollCapture:this.handleScroll},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"selectGoodFooter"},i.a.createElement("div",{className:"text"},"\u5df2\u9009",i.a.createElement("span",null,this.state.count),"\u4e2a\u4ea7\u54c1"),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.handleSubmit},"\u786e\u5b9a"))))}}]),t}(i.a.Component),ll=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onDateChange=function(e,t){a.setState({time:t})},a.selectGoods=function(){a.state.type?a.setState({visible:!0}):B.a.error("\u8bf7\u5148\u9009\u62e9\u51fa\u5e93\u7c7b\u578b")},a.hideSelectGoods=function(){a.setState({visible:!1})},a.selectedGoods=function(e){a.hideSelectGoods(),e.forEach(function(e){e.count=0}),console.log(e),a.setState({data:e})},a.confirmInStock=function(){if(a.state.remark){var e=[];if(a.state.data.forEach(function(t){var a={};t.productEntity?a.entity_id=t.productEntity.data.id:a.entity_id=t.stocks.data[0].productEntity.data.id,t.quantity&&(a.quantity=t.quantity,e.push(a))}),e.length<a.state.data.length)B.a.error("\u8bf7\u586b\u5199\u51fa\u5e93\u6570\u91cf");else(function(e){return ne({url:"/api/backend/products/stock/out_stock/add",method:"post",data:e})})({channel:a.channel,stock_type:a.state.type,stock_info:e,remark:a.state.remark,activity_id:a.actId}).then(function(e){B.a.success(e.message),a.props.history.go(-1)}).catch(function(e){})}else B.a.error("\u8bf7\u5148\u586b\u5199\u5907\u6ce8")},a.deleteItems=function(e){var t=a.state.data;t=t.filter(function(t){return t.stock_id!=e.stock_id}),a.setState({data:t})},a.channel=e.location.state.channel,a.actId=e.location.state.actId||"",a.state={remark:"",data:[],visible:!1,type:"",time:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1\u540d\u79f0",render:function(e,t){return console.log(t),i.a.createElement("span",null,t.name?t.name:t.productEntity.data.name)}},{title:"\u89c4\u683c",dataIndex:"keeper_name",render:function(e,t){return i.a.createElement("span",null,t.spec?t.spec:"\u65e0")}},{title:"\u5355\u4f4d",dataIndex:"stocks.data[0].unit",render:function(e,t){return i.a.createElement("span",null,e||t.unit)}},{title:"\u51fa\u5e93\u6570\u91cf",render:function(e,t){return i.a.createElement("div",null,i.a.createElement(Ne.a,{className:"inStockNum",defaultValue:0,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||(t.quantity=e.target.value,t.count=t.quantity*t.retail_price,console.log(t))}}))}},{title:"\u6210\u672c\u4ef7",dataIndex:"retail_price"},{title:"\u5269\u4f59\u5e93\u5b58",dataIndex:"stocks[data][0][in_stock]",render:function(e,t){return i.a.createElement("span",null,e||t.in_stock||0)}},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.deleteItems(a)}},"\u5220\u9664"))}}];return i.a.createElement("div",{className:"inStockNewNew"},i.a.createElement(rl,{visible:this.state.visible,onCancel:this.hideSelectGoods,onSubmit:this.selectedGoods,channel:this.props.location.state.channel,ref:this.child,actId:this.actId}),i.a.createElement("div",{className:"header"},"\u65b0\u5efa\u51fa\u5e93",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement("div",{className:"filter"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",null,"\u51fa\u5e93\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{onChange:function(t){e.setState({type:t})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"BROKEN"},"\u7834\u635f"),i.a.createElement(Q.a.Option,{value:"REQUISITION"},"\u96f6\u7528"),i.a.createElement(Q.a.Option,{value:"OTHER"},"\u5176\u4ed6"),i.a.createElement(Q.a.Option,{value:"SALE"},"\u9500\u552e\u51fa\u5e93"),i.a.createElement(Q.a.Option,{value:"CHECK"},"\u76d8\u70b9\u51fa\u5e93"))),i.a.createElement("li",null,"\u5907\u6ce8\uff1a",i.a.createElement(Ne.a,{maxLength:50,value:this.state.remark,suffix:i.a.createElement("span",{className:"limit"},this.state.remark.length,"/50"),onChange:function(t){e.setState({remark:t.target.value})}})),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.selectGoods},"\u9009\u62e9\u51fa\u5e93\u5546\u54c1")))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.stock_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.confirmInStock},"\u786e\u8ba4\u51fa\u5e93")))}}]),t}(i.a.Component),sl=(a(1240),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).id=e.location.state.id,a.state={data:{},tableData:[],remark:"1",type:"2",time:"3"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Ft({},this.id).then(function(t){e.setState({data:t.data,tableData:t.data.stockLogs.data}),console.log(t)}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",{className:"inStockDetail"},i.a.createElement("div",{className:"header"},"\u51fa\u5e93\u8be6\u60c5",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement("span",{className:"title"},"\u57fa\u672c\u4fe1\u606f"),i.a.createElement("div",{className:"filter"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",{className:"needMargin"},"\u51fa\u5e93\u7c7b\u578b\uff1a",t.stock_type),i.a.createElement("li",{className:"needMargin"},"\u51fa\u5e93\u65f6\u95f4\uff1a",t.batch_date),i.a.createElement("li",null,"\u5907\u6ce8\uff1a",t.remark))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement("span",{className:"title"},"\u51fa\u5e93\u5546\u54c1"),t.statistic?i.a.createElement("p",null,"\u5171",t.statistic.products_type_count,"\u4e2asku\uff0c\u5165\u5e93\u6570\u91cf",t.statistic.products_count,"\uff0c\u5408\u8ba1\u91d1\u989d",t.statistic.money_count,"\u5143"):"",i.a.createElement(ve.a,{columns:[{title:"\u5546\u54c1",dataIndex:"stock.data.productEntity.data.name"},{title:"\u89c4\u683c",dataIndex:"stock.data.spec"},{title:"\u5206\u7c7b",dataIndex:"stock.data.productEntity.data.category_desc"},{title:"\u5165\u5e93\u6570\u91cf",dataIndex:"quantity"},{title:"\u6210\u672c\u4ef7",dataIndex:"stock.data.productEntity.data.cost_price"},{title:"\u5c0f\u8ba1",dataIndex:"amount"}],rowKey:function(e){return e.stock_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.tableData}))))}}]),t}(i.a.Component));a(1241);function cl(e){return ne({url:"/api/backend/admins",method:"get",params:e})}function ol(e){return ne({url:"/api/backend/admins/delete",method:"delete",params:e})}function ul(e,t){return ne({url:"/api/backend/operate_logs",method:"get",params:e})}a(1242);var ml=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e;a.state.info.name?O(a.state.info.tel)?a.state.add_id?(e={name:a.state.info.name,mobile:a.state.info.tel,role_ids:a.state.add_id},ne({url:"/api/backend/admins",method:"post",data:e})).then(function(e){a.setState({info:{name:"",tel:""}}),a.handleCancel()}).catch(function(e){}):B.a.error("\u8bf7\u5206\u914d\u89d2\u8272"):B.a.error("\u8bf7\u586b\u5199\u6b63\u786e\u683c\u5f0f\u7684\u624b\u673a\u53f7"):B.a.error("\u8bf7\u586b\u5199\u59d3\u540d")},a.onChange=function(e){console.log("checked = ",e),a.setState({add_id:e})},a.onInput=function(e,t){a.setState({info:Object(be.a)({},a.state.info,Object(Y.a)({},t,e.target.value))})},a.state={confirmLoading:!1,info:{name:"",tel:""},add_id:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.onRoles){var a=[];a.push(e.add_id+""),this.setState({add_id:a});var n=[];e.onRoles.forEach(function(t,a){Object.keys(t).forEach(function(t){n.push({label:e.onRoles[a][t],value:t})})}),this.setState({options:n})}}},{key:"render",value:function(){var e=this,t=this.state.confirmLoading;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u589e\u8d26\u53f7",width:520,visible:this.props.visible,confirmLoading:t,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"addNewAccount"},i.a.createElement("li",null,i.a.createElement("span",null,"\u59d3\u540d"),i.a.createElement(Ne.a,{type:"text",value:this.state.info.name,onInput:function(t){e.onInput(t,"name")}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u624b\u673a\u53f7\u7801"),i.a.createElement(Ne.a,{type:"tel",value:this.state.info.tel,placeholder:"\u624b\u673a\u53f7\u53ef\u7528\u4e8e\u767b\u5f55",onInput:function(t){e.onInput(t,"tel")}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u89d2\u8272"),this.state.add_id&&this.state.add_id.length?i.a.createElement(un.a.Group,{options:this.state.options,value:this.state.add_id,onChange:this.onChange}):i.a.createElement(un.a.Group,{options:this.state.options,value:[],onChange:this.onChange})))))}}]),t}(i.a.Component),dl=(a(227),a(381),a(576),a(205)),pl=(a(1244),a(1245),dl.a.TreeNode),hl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).makeTree=function(e){return e.map(function(e){return e.children?i.a.createElement(pl,{title:e.name,key:e.id},a.makeTree(e.children)):i.a.createElement(pl,{title:e.name,key:e.id})})},a.onCheck=function(e,t){a.setState({defaultKeys:e}),t.halfCheckedKeys&&t.halfCheckedKeys.length&&a.setState({parent_id:t.halfCheckedKeys[0]})},a.state={permissions:[],defaultKeys:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=[];e.permissions&&e.activedList&&(console.log(e,"++++++"),e.activedList.forEach(function(e){a.push(e.id+"")}),console.log(a,"???????"),this.setState({permissions:e.permissions,defaultKeys:a}))}},{key:"render",value:function(){return i.a.createElement("div",null,this.state.permissions&&this.state.permissions.length?i.a.createElement(dl.a,{defaultExpandAll:!0,checkable:!0,selectable:!1,onCheck:this.onCheck,checkedKeys:this.state.defaultKeys},this.makeTree(this.state.permissions)):"\u6682\u65e0\u6570\u636e")}}]),t}(i.a.Component),fl=wr.a.TabPane,El=dl.a.TreeNode,vl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onSelect=function(e,t){console.log("selected",e,t)},a.onCheck=function(e,t){var n=e.slice();e&&e.length&&n.push(t.halfCheckedKeys[0]),console.log("onCheck",e,t),n.length>0&&(n=n.filter(function(e){return e})),a.setState({activeKeys:e}),a.setState({selectedObj:Object(be.a)({},a.state.selectedObj,Object(Y.a)({},a.state.activeKey,n))})},a.handleCancel=function(){a.setState({roleData:[]}),a.props.onClose()},a.callback=function(e){a.setState({activeKey:e})},a.checkedKeys=function(e){if(e&&e.length){for(var t=[],n=0;n<e.length;n++)e[n].child&&e[n].child.length?(e[n].child.forEach(function(e){e.selected&&t.push(e.id+"")}),a.checkedKeys(e[n].child)):e[n].selected&&t.push(e[n].id);return t}},a.submit=function(){var e,t;(e={role_permissions:a.state.selectedObj},t=a.state.id,ne({url:"/api/backend/admins/".concat(t,"/setPermissions"),method:"post",data:e})).then(function(e){B.a.success("\u8bbe\u7f6e\u6743\u9650\u6210\u529f"),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.makeTree=function(e){if(e&&e.length)return e.map(function(e){return e.child&&e.child.length?i.a.createElement(El,{title:e.name,key:e.id,selected:e.selected},a.makeTree(e.child)):i.a.createElement(El,{title:e.name,key:e.id,selected:e.selected})})},a.state={activeKey:"",name:"",phone:"",id:"",activeKeys:[],permissions:[],selectedObj:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;(this.setState({roleData:[]}),e.userAuthInfo)&&(we({}).then(function(e){i.setState({permissions:e.data})}).catch(function(e){}),this.setState({name:e.userAuthInfo.name,phone:e.userAuthInfo.mobile,id:e.userAuthInfo.id}),this.setState({activeKey:e.userAuthInfo.roles[0].id+""}),(a={},n=e.userAuthInfo.id,ne({url:"/api/backend/admins/".concat(n,"/rolePermissions"),method:"get",params:a})).then(function(e){i.setState({roleData:e.data,activeKey:e.data[0].id+""}),i.callback(e.data[0].id+""),e.data.forEach(function(e){i.setState({selectedObj:Object(be.a)({},i.state.selectedObj,Object(Y.a)({},e.id,i.checkedKeys(e.permissions)))})})}).catch(function(e){}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6743\u9650\u914d\u7f6e",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,destroyOnClose:!0},i.a.createElement("div",{className:"all"},i.a.createElement("div",{className:"boxHeader"},i.a.createElement("div",{className:"userInfo"},"\u59d3\u540d\uff1a",this.state.name,i.a.createElement("span",null,"\u624b\u673a\u53f7\u7801\uff1a",this.state.phone))),i.a.createElement("div",{className:"taps"},this.state.roleData&&this.state.roleData.length?i.a.createElement(wr.a,{defaultActiveKey:this.state.roleData[0].id+"",onChange:this.callback,type:"card",style:{width:"100%"},activeKey:this.state.activeKey},this.state.roleData.map(function(t){return i.a.createElement(fl,{tab:t.name,key:t.id},i.a.createElement("div",{className:"tree1"},i.a.createElement(dl.a,{defaultExpandAll:!0,checkable:!0,selectable:!1,onCheck:e.onCheck,defaultCheckedKeys:e.checkedKeys(t.permissions)},e.makeTree(t.permissions))))})):"\u6682\u65e0\u6570\u636e"),i.a.createElement("div",{className:"footBtn"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.submit},"\u4fdd\u5b58\u914d\u7f6e")))))}}]),t}(i.a.Component),_l=a(634);a.n(_l).a.mock("http://localhost:8888/list.mock","get",{code:0,data:{"list|2-5":[{"id|+1":1,name:"@name",time:"@date",phone:"number|13",roleName:"@cname",accountNum:"@integer(60,160)",status:1}]},message:"\u64cd\u4f5c\u6210\u529f",systemDate:(new Date).getTime()});a(1246);var gl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e,t;(e={role_ids:a.state.selected},t=a.state.id,ne({url:"/api/backend/admins/".concat(t,"/setRoles"),method:"post",data:e})).then(function(e){a.props.onClose(),a.props.refresh()}).catch(function(e){})},a.onChange=function(e){console.log("checked = ",e),a.setState({selected:e})},a.state={confirmLoading:!1,name:"",phone:"",id:"",selected:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.onRoles&&e.userInfo||e.roleInfo){var a=[];e.onRoles.forEach(function(t,n){Object.keys(t).forEach(function(t){a.push({label:e.onRoles[n][t],value:t})})}),this.setState({options:a}),this.setState({name:e.userInfo.name,phone:e.userInfo.mobile,id:e.userInfo.id});var n=[];a.forEach(function(e){n.push(e.value)}),n=(n=e.userInfo.roles.filter(function(e){return-1==n.indexOf(e.id)})).map(function(e){return e.id+""}),this.setState({selected:n})}}},{key:"render",value:function(){var e=this.state.confirmLoading;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u4fee\u6539\u89d2\u8272",width:520,visible:this.props.visible,confirmLoading:e,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"editRole"},i.a.createElement("li",null,i.a.createElement("span",null,"\u59d3\u540d\uff1a"),i.a.createElement("h5",null,this.state.name)),i.a.createElement("li",null,i.a.createElement("span",null,"\u624b\u673a\u53f7\u7801\uff1a"),i.a.createElement("h5",null,this.state.phone)),i.a.createElement("li",null,i.a.createElement("span",null,"\u89d2\u8272\uff1a"),i.a.createElement(un.a.Group,{options:this.state.options,onChange:this.onChange,value:this.state.selected})))))}}]),t}(i.a.Component),bl=(Ne.a.Search,ve.a.Column),yl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){cl({limit:50,page:1}).then(function(e){var t=[];e.data.forEach(function(e){t.push(Object(Y.a)({},"visible"+e.id,!1))}),a.setState({tableData:e.data,visible:t})}).catch(function(e){}),a.props.refresh()},a.searchDatas=function(e){cl({limit:10,page:1,search:"name:".concat(e,";mobile:").concat(e)}).then(function(e){a.setState({tableData:e.data})}).catch(function(e){})},a.handleCancel=function(){a.props.onClose()},a.showAuth=function(e){e.roles&&e.roles.length?(a.handleCancel(),a.setState({listAuthInfo:e}),a.setState({listAuthVisible:!0})):B.a.error("\u8bf7\u5148\u7ed9\u8be5\u5458\u5de5\u8bbe\u7f6e\u89d2\u8272")},a.closeAuth=function(){a.setState({listAuthVisible:!1}),a.props.onShow()},a.showEditRole=function(e){a.handleCancel(),a.setState({roleInfo:e}),a.setState({roleEditVisible:!0})},a.closeEditRole=function(){a.setState({roleEditVisible:!1}),a.props.onShow()},a.state={tableData:[],listAuthVisible:!1,roleEditVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"componentWillReceiveProps",value:function(e,t){e.onRoles&&this.setState({roles:e.onRoles})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(vl,{visible:this.state.listAuthVisible,onClose:this.closeAuth,userAuthInfo:this.state.listAuthInfo,refresh:this.refresh}),i.a.createElement(gl,{visible:this.state.roleEditVisible,onClose:this.closeEditRole,onRoles:this.state.roles,userInfo:this.state.roleInfo,refresh:this.refresh}),i.a.createElement(ge.a,{title:"\u5458\u5de5\u5217\u8868",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null},i.a.createElement("div",{className:"list"},i.a.createElement(St,{getDatas:this.searchDatas,text:"\u8bf7\u8f93\u5165\u5458\u5de5\u59d3\u540d\u6216\u624b\u673a\u53f7\u7801"}),i.a.createElement("div",{className:"listChart"},i.a.createElement(ve.a,{dataSource:this.state.tableData,rowKey:function(e){return e.id}},i.a.createElement(bl,{style:{width:"170px"},title:"\u59d3\u540d",dataIndex:"name",key:"name"}),i.a.createElement(bl,{style:{width:"150px"},title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile",key:"mobile"}),i.a.createElement(bl,{style:{width:"190px"},title:"\u65b0\u589e\u65f6\u95f4",dataIndex:"created_at",key:"created_at"}),i.a.createElement(bl,{style:{width:"150px"},className:"max-roles",title:"\u89d2\u8272",render:function(e,t){var a=[];return t.roles&&t.roles.forEach(function(e){a.push(e.name)}),i.a.createElement("span",null,a.toString())},key:"roles"}),i.a.createElement(bl,{title:"\u64cd\u4f5c",key:"action",render:function(t,a){return i.a.createElement("span",{className:"operationBox"},i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8d26\u53f7\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){var t=[];t.push(a.id),ol({ids:t}).then(function(t){e.refresh(),e.props.refresh()})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664\u8d26\u53f7")),i.a.createElement("span",{className:"operation",onClick:function(){return e.showAuth(a)}},"\u6743\u9650\u914d\u7f6e"),i.a.createElement("span",{className:"operation",onClick:function(){return e.showEditRole(a)}},"\u4fee\u6539\u89d2\u8272"))}}))))))}}]),t}(i.a.Component),Cl=(Ne.a.Search,ve.a.Column),kl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){cl({limit:50,page:1,role_id:a.state.id}).then(function(e){a.setState({tableData:e.data})}).catch(function(e){}),a.props.refresh()},a.searchDatas=function(e){cl({limit:10,page:1,role_id:a.state.id,search:"name:".concat(e,";mobile:").concat(e)}).then(function(e){a.setState({tableData:e.data})}).catch(function(e){})},a.handleCancel=function(){a.props.onClose()},a.showAuth=function(e){a.handleCancel(),a.setState({userAuthInfo:e}),a.setState({listAuthVisible:!0})},a.closeAuth=function(){a.setState({listAuthVisible:!1}),a.props.onShow()},a.showEditRole=function(e){a.handleCancel(),a.setState({userInfo:e}),a.setState({roleEditVisible:!0})},a.closeEditRole=function(){a.setState({roleEditVisible:!1}),a.props.onShow()},a.state={tableData:[],listAuthVisible:!1,roleEditVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;e.onRoles&&this.setState({roles:e.onRoles}),e.m_role&&(this.setState({id:e.m_role.id}),cl({limit:50,page:1,role_id:e.m_role.id}).then(function(e){a.setState({tableData:e.data})}).catch(function(e){}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(vl,{visible:this.state.listAuthVisible,onClose:this.closeAuth,userAuthInfo:this.state.userAuthInfo,refresh:this.refresh}),i.a.createElement(gl,{visible:this.state.roleEditVisible,onClose:this.closeEditRole,onRoles:this.state.roles,userInfo:this.state.userInfo,refresh:this.refresh}),i.a.createElement(ge.a,{title:"\u7ba1\u7406\u8d26\u53f7",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null},i.a.createElement("div",{className:"list"},i.a.createElement(St,{getDatas:this.searchDatas,text:"\u8bf7\u8f93\u5165\u5458\u5de5\u59d3\u540d\u6216\u624b\u673a\u53f7\u7801"}),i.a.createElement("div",{className:"listChart"},i.a.createElement(ve.a,{dataSource:this.state.tableData,rowKey:function(e){return e.id}},i.a.createElement(Cl,{style:{width:"170px"},title:"\u59d3\u540d",dataIndex:"name",key:"name"}),i.a.createElement(Cl,{style:{width:"150px"},title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile",key:"mobile"}),i.a.createElement(Cl,{style:{width:"190px"},title:"\u65b0\u589e\u65f6\u95f4",dataIndex:"created_at",key:"created_at"}),i.a.createElement(Cl,{title:"\u64cd\u4f5c",key:"action",className:" primary",render:function(t,a){return i.a.createElement("span",{className:"operationBox"},i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8d26\u53f7\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){var t=[];t.push(a.id),ol({ids:t}).then(function(t){e.refresh(),e.props.refresh()}).catch(function(e){})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664\u8d26\u53f7")),i.a.createElement("span",{className:"operation",onClick:function(){return e.showAuth(a)}},"\u6743\u9650\u914d\u7f6e"),i.a.createElement("span",{className:"operation",onClick:function(){return e.showEditRole(a)}},"\u4fee\u6539\u89d2\u8272"))}}))))))}}]),t}(i.a.Component),Sl=(a(1247),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.props.onSubmit(a.props.editInfo,a.state.value)},a.handleChange=function(e){a.setState({value:e.target.value})},a.state={confirmLoading:!1,value:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.editInfo&&("string"==typeof e.editInfo.name?this.setState({value:e.editInfo.name}):this.setState({value:""}))}},{key:"render",value:function(){var e=this.state.confirmLoading;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:this.state.value?"\u4fee\u6539\u89d2\u8272\u540d":"\u65b0\u5efa\u89d2\u8272",width:520,visible:this.props.visible,confirmLoading:e,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"editContent"},i.a.createElement("span",null,"\u89d2\u8272\u540d\u79f0"),i.a.createElement(Ne.a,{className:"editInput",value:this.state.value,onChange:this.handleChange,type:"text"}))))}}]),t}(i.a.Component)),Ol=(Ne.a.Search,ve.a.Column),Nl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.searchDatas=function(e){cl({limit:10,page:1,only_trashed:!0,search:"name:".concat(e,";mobile:").concat(e)}).then(function(e){a.setState({tableData:e.data})}).catch(function(e){})},a.state={tableData:[],confirmLoading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;e.visible&&cl({limit:50,page:1,only_trashed:!0}).then(function(e){a.setState({tableData:e.data})}).catch(function(e){})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u5458\u5de5\u5217\u8868",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null},i.a.createElement("div",{className:"list"},i.a.createElement(St,{getDatas:this.searchDatas,text:"\u8bf7\u8f93\u5165\u5458\u5de5\u59d3\u540d\u6216\u624b\u673a\u53f7\u7801"}),i.a.createElement("div",{className:"listChart"},i.a.createElement(ve.a,{dataSource:this.state.tableData,rowKey:function(e){return e.id}},i.a.createElement(Ol,{style:{width:"170px"},title:"\u59d3\u540d",dataIndex:"name",key:"name"}),i.a.createElement(Ol,{style:{width:"150px"},title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile",key:"mobile"}),i.a.createElement(Ol,{style:{width:"190px"},title:"\u65b0\u589e\u65f6\u95f4",dataIndex:"created_at",key:"created_at"}),i.a.createElement(Ol,{style:{width:"190px"},title:"\u5220\u9664\u65f6\u95f4",dataIndex:"deleted_at",key:"deleted_at"}),i.a.createElement(Ol,{style:{width:"150px"},title:"\u89d2\u8272",render:function(e,t){var a=[];return t.roles&&t.roles.forEach(function(e){a.push(e.name)}),i.a.createElement("span",null,a.toString())}}))))))}}]),t}(i.a.Component),wl=(a(1248),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){var e=a.child.current.state.defaultKeys,t=(a.child.current.state.parent_id||a.state.permissions[0].id,[]);e.forEach(function(e){-1==t.indexOf(e)&&t.push(e)}),function(e,t){return ne({url:"/api/backend/roles/".concat(t,"/setPermissions"),method:"post",data:e})}({permission_ids:t},a.state.role.id).then(function(e){B.a.success("\u8bbe\u7f6e\u6743\u9650\u6210\u529f"),a.handleCancel(),a.props.refresh()})},a.state={role:"",permissions:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.role&&(we({}).then(function(e){i.setState({permissions:e.data})}).catch(function(e){}),this.setState({role:e.role}),e.visible&&(a={},n=e.role.id,ne({url:"/api/backend/roles/".concat(n,"/permissions"),method:"get",params:a})).then(function(e){i.setState({activeKeys:e.data})}).catch(function(e){}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6743\u9650\u914d\u7f6e",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null},i.a.createElement("div",{className:"all"},i.a.createElement("div",{className:"boxHeader"},i.a.createElement("span",null,"\u89d2\u8272\u540d\u79f0\uff1a",this.state.role.name),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8d26\u53f7\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){var t,a;(t={},a=e.state.role.id,ne({url:"/api/backend/roles/delete/".concat(a),method:"delete",params:t})).then(function(t){e.handleCancel(),e.props.refresh()}).catch(function(e){})}},i.a.createElement(_e.a,{size:"small"},"\u5220\u9664\u8be5\u89d2\u8272"))),i.a.createElement("div",{className:"tree"},i.a.createElement(hl,{permissions:this.state.permissions,ref:this.child,activedList:this.state.activeKeys})),i.a.createElement("div",{className:"footBtn"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.submit},"\u4fdd\u5b58\u914d\u7f6e")))))}}]),t}(i.a.Component)),xl=ve.a.Column,Il=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(o.a)(this,Object(u.a)(t).call(this))).refresh=function(){var t;(t={},ne({url:"/api/backend/roles",method:"get",params:t})).then(function(t){e.setState({tableData:t.data});var a=[];t.data.forEach(function(e){a.push(Object(Y.a)({},e.id,e.name))}),e.setState({roles:a})}).catch(function(e){})},e.showList=function(){e.setState({listVisible:!0})},e.closeList=function(){e.setState({listVisible:!1})},e.showModal=function(){var t=Object($.a)(X.a.mark(function t(a){return X.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({editInfo:a,editRoleVisible:!0});case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.onCancel=function(){e.setState({editRoleVisible:!1})},e.onSubmit=function(t,a){var n,i;t.id?(n={name:a},i=t.id,ne({url:"/api/backend/roles/".concat(i),method:"put",data:n})).then(function(t){e.setState({editRoleVisible:!1}),e.refresh()}).catch(function(e){}):function(e){return ne({url:"/api/backend/roles",method:"post",data:e})}({name:a}).then(function(t){e.setState({editRoleVisible:!1}),e.refresh()}).catch(function(e){})},e.showFrozen=function(){e.setState({frozenVisible:!0})},e.closeFrozen=function(){e.setState({frozenVisible:!1})},e.showAuthoritySetting=function(t){e.setState({a_role:t,authoritySettingVisible:!0})},e.closeAuthoritySetting=function(){e.setState({authoritySettingVisible:!1})},e.showAddStaff=function(t){e.setState({add_id:t}),e.setState({addStaffVisible:!0})},e.closeAddStaff=function(){e.setState({addStaffVisible:!1}),e.refresh()},e.showManageStaff=function(t){e.setState({manageStaffVisible:!0,m_role:t})},e.closeManageStaff=function(){e.setState({manageStaffVisible:!1})},e.state={tableData:[],visible:!1,listVisible:!1,editRoleVisible:!1,frozenVisible:!1,authoritySettingVisible:!1,addStaffVisible:!1,manageStaffVisible:!1},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(yl,{visible:this.state.listVisible,onClose:this.closeList,onRoles:this.state.roles,refresh:this.refresh,onShow:this.showList}),i.a.createElement(Nl,{visible:this.state.frozenVisible,onClose:this.closeFrozen}),i.a.createElement(kl,{visible:this.state.manageStaffVisible,onClose:this.closeManageStaff,onRoles:this.state.roles,m_role:this.state.m_role,refresh:this.refresh,onShow:this.showManageStaff}),i.a.createElement(Sl,{visible:this.state.editRoleVisible,editInfo:this.state.editInfo,onSubmit:this.onSubmit,onCancel:this.onCancel}),i.a.createElement(ml,{visible:this.state.addStaffVisible,onCancel:this.closeAddStaff,onRoles:this.state.roles,add_id:this.state.add_id}),i.a.createElement(wl,{visible:this.state.authoritySettingVisible,onClose:this.closeAuthoritySetting,role:this.state.a_role,refresh:this.refresh}),i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",className:"btn btnList",onClick:this.showList},"\u5458\u5de5\u5217\u8868"),i.a.createElement(_e.a,{size:"small",className:"btn btnAdd",onClick:this.showModal},i.a.createElement("i",{className:"iconfont",style:{color:"#4F9863",fontSize:"12px",marginRight:"6px"}},"\ue7e0"),"\u65b0\u5efa\u89d2\u8272"),i.a.createElement("span",{className:"frozenAccounts",onClick:this.showFrozen},"\u67e5\u770b\u5df2\u5220\u9664\u8d26\u53f7")),i.a.createElement("div",{className:"chart"},i.a.createElement(ve.a,{dataSource:this.state.tableData,rowKey:function(e){return e.id}},i.a.createElement(xl,{className:"column",title:"\u89d2\u8272",dataIndex:"name",key:"name",render:function(t,a){return i.a.createElement("span",{className:"editIcon"},i.a.createElement("span",null,t),i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},className:"iconfont",onClick:function(){return e.showModal(a)}},"\ue7a0"))}}),i.a.createElement(xl,{className:"column primary",title:"\u5df2\u914d\u7f6e\u8d26\u53f7\u6570",dataIndex:"administrators_count",key:"administrators_count"}),i.a.createElement(xl,{title:"\u64cd\u4f5c",key:"action",className:"column",render:function(t,a){return i.a.createElement("span",null,i.a.createElement("span",{className:"operation",onClick:function(){return e.showManageStaff(a)}},"\u7ba1\u7406\u8d26\u53f7"),i.a.createElement("span",{className:"operation",onClick:function(){return e.showAddStaff(a.id)}},"\u65b0\u589e\u8d26\u53f7"),i.a.createElement("span",{className:"operation",onClick:function(){return e.showAuthoritySetting(a)}},i.a.createElement("i",{style:{color:"#4F9863",marginRight:"10px"},className:"iconfont"},"\ue818"),"\u6743\u9650\u8bbe\u7f6e"))}}))))}}]),t}(i.a.Component),jl=Object(U.g)(Il);a(1249);var Tl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).remove=function(){a.setState({text:"\u70b9\u51fb\u4e0a\u4f20App",resource_id:""})},a.handleChange=function(e){"uploading"!==e.file.status?"error"!==e.file.status?"done"===e.file.status&&(B.a.success("\u4e0a\u4f20\u6210\u529f"),a.setState({iconLoading:!1,text:e.file.response.data.name,resource_id:e.file.response.data.resource_id})):B.a.error(e.file.response.message):a.setState({iconLoading:!0,text:"\u4e0a\u4f20App\u4e2d"})},a.state={text:"\u70b9\u51fb\u4e0a\u4f20App",resource_id:"",iconLoading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state.text;return i.a.createElement("div",null,i.a.createElement(Zt.a,{name:"file",showUploadList:!1,headers:{Authorization:"".concat(k())},onChange:this.handleChange,disabled:this.state.iconLoading,action:"".concat(v.apiUrl,"/api/backend/merchant/app/packages/upload")},i.a.createElement(_e.a,{loading:this.state.iconLoading,icon:"vertical-align-top"},e)))}}]),t}(n.Component),Rl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e;(e={},ne({url:"/api/backend/merchant/app/packages",method:"get",params:e})).then(function(e){a.setState({versions:e.data})}).catch(function(e){})},a.onRadioChange=function(e){a.setState({type:e.target.value})},a.onPlatformChange=function(e){a.setState({platform:e.target.value})},a.onUploadTypeChange=function(e){a.setState({uploadType:e.target.value})},a.check=function(){var e=Object(Ja.a)(a).state;if(e.version)if("ID"!==a.state.uploadType||a.child.current.state.resource_id)if("URL"!==a.state.uploadType||a.state.appUrl)if(e.desc){var t="ID"===a.state.uploadType?a.child.current.state.resource_id:"",n="ID"===a.state.uploadType?"":a.state.appUrl;a.submit(e.version,t,n,e.type,e.desc,e.platform)}else B.a.error("\u8bf7\u586b\u5199APP\u63cf\u8ff0");else B.a.error("\u8bf7\u586b\u5199\u8d44\u6e90\u5305URL");else B.a.error("\u8bf7\u4e0a\u4f20\u8d44\u6e90\u5305");else B.a.error("\u8bf7\u586b\u5199\u7248\u672c\u53f7")},a.submit=function(e,t,n,i,r,l){var s;(s={version:e,resource_id:t,resource_url:n,type:i,desc:r,platform:l},ne({url:"/api/backend/merchant/app/packages",method:"post",data:s})).then(function(e){B.a.success("\u65b0\u5efaAPP\u7248\u672c\u6210\u529f"),a.setState({type:0,version:"",desc:"",platform:"IOS",appUrl:""},function(){"ID"===a.state.uploadType&&a.child.current.remove(),a.refresh()})}).catch(function(e){})},a.onSuccessUpload=function(e){a.setState({appUrl:e})},a.state={versions:[],type:0,version:"",desc:"",platform:"IOS",appUrl:"",uploadType:"ID"},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u7248\u672c\u53f7",dataIndex:"version"},{title:"\u8d44\u6e90\u5305\u5730\u5740",dataIndex:"resource_url"},{title:"\u7248\u672c\u5e73\u53f0",dataIndex:"platform",render:function(e,t){return i.a.createElement("span",null,"ANDROID"===e?"\u5b89\u5353":"IOS")}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created_at"}];return i.a.createElement("div",{className:"app_version"},i.a.createElement("div",{className:"new_app_version"},i.a.createElement("div",{className:"app_header"},"\u65b0\u5efa",i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.check},"\u4fdd\u5b58")),i.a.createElement("div",{className:"app_body"},i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",null,i.a.createElement("h5",null,"\u7248\u672c\u53f7:"),i.a.createElement(Ne.a,{value:this.state.version,onChange:function(t){e.setState({version:t.target.value})}})),i.a.createElement("span",null,i.a.createElement("h5",null,"\u4e0a\u4f20\u7c7b\u578b\uff1a"),i.a.createElement(mn.a.Group,{onChange:this.onUploadTypeChange,value:this.state.uploadType},i.a.createElement(mn.a,{value:"ID"},"\u8d44\u6e90\u5305"),i.a.createElement(mn.a,{value:"URL"},"\u8d44\u6e90\u5305URL"))),"ID"===this.state.uploadType&&i.a.createElement("span",null,i.a.createElement("h5",null,"\u8d44\u6e90\u5305\uff1a"),i.a.createElement(Tl,{ref:this.child})),"URL"===this.state.uploadType&&i.a.createElement("span",null,i.a.createElement("h5",null,"\u8d44\u6e90\u5305URL:"),i.a.createElement(Ne.a,{value:this.state.appUrl,onChange:function(t){e.setState({appUrl:t.target.value})}})),i.a.createElement("span",null,i.a.createElement("h5",null,"\u8d44\u6e90\u5305\u7c7b\u578b\uff1a"),i.a.createElement(mn.a.Group,{onChange:this.onRadioChange,value:this.state.type},i.a.createElement(mn.a,{value:0},"\u8865\u4e01"),i.a.createElement(mn.a,{value:1},"\u975e\u8865\u4e01"))),i.a.createElement("span",null,i.a.createElement("h5",null,"\u8d44\u6e90\u5305\u5e73\u53f0\uff1a"),i.a.createElement(mn.a.Group,{onChange:this.onPlatformChange,value:this.state.platform},i.a.createElement(mn.a,{value:"IOS"},"IOS\u7aef"),i.a.createElement(mn.a,{value:"ANDROID"},"\u5b89\u5353\u7aef"))),i.a.createElement("span",null,i.a.createElement("h5",null,"APP\u7248\u672c\u63cf\u8ff0\uff1a"),i.a.createElement(Ne.a,{value:this.state.desc,onChange:function(t){e.setState({desc:t.target.value})}}))))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.versions})))}}]),t}(i.a.Component),Al=Object(U.g)(Rl),Dl=(a(1250),ge.a.confirm),Pl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).showInitConfirm=function(e){var t=Object(Ja.a)(a);Dl({title:"\u8bf7\u6c42\u79ef\u5206\u89c4\u5219\u521d\u59cb\u5316",content:"\u5f53\u524d\u4f1a\u5458\u7b49\u7ea7\u4e0b\u6682\u65e0\u79ef\u5206\u89c4\u5219\uff0c\u662f\u5426\u521d\u59cb\u5316\u79ef\u5206\u89c4\u5219\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t;(t={user_member_grade_id:e},ne({url:"/api/backend/score_rules/init/member_grade_rules",method:"post",data:t})).then(function(e){B.a.success(e.message)}).catch(function(e){})},onCancel:function(){t.setState({data:[]})}})},a.getVipRules=function(e){-1==e?ir({}).then(function(e){var t=[];y.a.map(e,function(e){t.push(e),y.a.map(e.children,function(e){t.push(e)})}),a.setState({data:t,source:e})}):ir({searchJson:w({user_member_grade_id:e})}).then(function(t){if(t.data&&!t.data.length)a.showInitConfirm(e);else{var n=[];y.a.map(t,function(e){n.push(e),y.a.map(e.children,function(e){n.push(e)})}),a.setState({data:n,source:t})}}).catch(function(e){})},a.handleChange=function(e,t,n){var i=a.state.data;y.a.map(i,function(a){a.slug===e&&("rule.amount"===n?a.rule={amount:t}:a[n]=t)}),a.setState({data:i})},a.setData=function(e){return a.state.data.filter(function(t){return t.slug===e})[0]},a.saveData=function(){var e=a.state.data,t=a.state.source;y.a.map(e,function(e){y.a.map(t,function(t){e.slug===t.slug?t=e:y.a.map(t.children,function(t){t.slug===e.slug&&(t=e)})})});var n,i=-1===a.state.activeTab?"":a.state.activeTab;(n={rules:t,user_member_grade_id:i},ne({url:"/api/backend/score_rules",method:"put",data:n})).then(function(e){B.a.success("\u4fdd\u5b58\u6210\u529f")})},a.onChangeTab=function(e){a.setState({activeTab:e.id},function(){a.getVipRules(e.id)})},a.state={source:[],data:[],vips:[],activeTab:-1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getVipRules(-1),rr({}).then(function(t){t.data.unshift({id:-1,grade_name:"\u65e0"}),e.setState({vips:t.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("div",{className:"r_top"},i.a.createElement("div",{className:"r_top_header"},i.a.createElement("span",null,"\u79ef\u5206\u8bbe\u7f6e"),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.saveData},"\u4fdd\u5b58")),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},this.state.vips.map(function(t){return i.a.createElement("li",{key:t.id,className:e.state.activeTab==t.id?"active":"",onClick:function(){return e.onChangeTab(t)}},t.grade_name)})))),t.length?i.a.createElement("div",null,i.a.createElement("div",{className:"r_top"},i.a.createElement("div",{className:"r_top_body"},i.a.createElement(ke.a,{checkedChildren:"\u542f\u7528",unCheckedChildren:"\u505c\u7528",disabled:-1!==this.state.activeTab,checked:this.setData("PAYMENT").status,onChange:function(t){return e.handleChange("PAYMENT",t,"status")}}),"\u8d2d\u4e70\u4ea7\u751f\u79ef\u5206"),i.a.createElement("ul",{className:"r_top_footer"},i.a.createElement("li",{slug:"PAYMENT_PREORDER_FIRST"},i.a.createElement(un.a,{checked:this.setData("PAYMENT_PREORDER_FIRST").status,disabled:-1!==this.state.activeTab,onChange:function(t){e.handleChange("PAYMENT_PREORDER_FIRST",t.target.checked,"status")}},"\u9884\u5b9a\u5546\u57ce\u9996\u6b21\u8d2d\u7269\uff1a\u589e\u52a0",i.a.createElement(Ne.a,{value:this.setData("PAYMENT_PREORDER_FIRST").score_num,onChange:function(t){e.handleChange("PAYMENT_PREORDER_FIRST",t.target.value,"score_num")}}),"\u79ef\u5206")),i.a.createElement("li",null,i.a.createElement(un.a,{disabled:-1!==this.state.activeTab,checked:this.setData("PAYMENT_SCAN_CODE").status,onChange:function(t){e.handleChange("PAYMENT_SCAN_CODE",t.target.checked,"status")}},"\u626b\u7801\u4ed8\uff1a\u6bcf\u6d88\u8d39",i.a.createElement(Ne.a,{value:this.setData("PAYMENT_SCAN_CODE").rule.amount,onChange:function(t){e.handleChange("PAYMENT_SCAN_CODE",t.target.value,"rule.amount")}}),"\u5143\uff0c\u589e\u52a0\uff1a",i.a.createElement(Ne.a,{value:this.setData("PAYMENT_SCAN_CODE").score_num,onChange:function(t){e.handleChange("PAYMENT_SCAN_CODE",t.target.value,"score_num")}}),"\u79ef\u5206")),i.a.createElement("li",null,i.a.createElement(un.a,{disabled:-1!==this.state.activeTab,checked:this.setData("PAYMENT_PREORDER").status,onChange:function(t){e.handleChange("PAYMENT_PREORDER",t.target.checked,"status")}},"\u9884\u5b9a\u5546\u57ce\uff1a\u6bcf\u6d88\u8d39",i.a.createElement(Ne.a,{value:this.setData("PAYMENT_PREORDER").rule.amount,onChange:function(t){e.handleChange("PAYMENT_PREORDER",t.target.value,"rule.amount")}}),"\u5143\uff0c\u589e\u52a0\uff1a",i.a.createElement(Ne.a,{value:this.setData("PAYMENT_PREORDER").score_num,onChange:function(t){e.handleChange("PAYMENT_PREORDER",t.target.value,"score_num")}}),"\u79ef\u5206")))),i.a.createElement("div",{className:"r_top"},i.a.createElement("div",{className:"r_top_body"},i.a.createElement(ke.a,{disabled:-1!==this.state.activeTab,checkedChildren:"\u542f\u7528",unCheckedChildren:"\u505c\u7528",checked:this.setData("CHARGE").status,onChange:function(t){return e.handleChange("CHARGE",t,"status")}}),"\u50a8\u503c\u4ea7\u751f\u79ef\u5206"),i.a.createElement("ul",{className:"r_top_footer"},i.a.createElement("li",null,i.a.createElement(un.a,{disabled:-1!==this.state.activeTab,checked:this.setData("CHARGE_FIRST").status,onChange:function(t){e.handleChange("CHARGE_FIRST",t.target.checked,"status")}},"\u9996\u6b21\u50a8\u503c\uff1a\u589e\u52a0",i.a.createElement(Ne.a,{value:this.setData("CHARGE_FIRST").score_num,onChange:function(t){e.handleChange("CHARGE_FIRST",t.target.value,"score_num")}}),"\u79ef\u5206")),i.a.createElement("li",null,i.a.createElement(un.a,{disabled:-1!==this.state.activeTab,checked:this.setData("CHARGE_EVERY_TIME").status,onChange:function(t){e.handleChange("CHARGE_EVERY_TIME",t.target.checked,"status")}},"\u6bcf\u50a8\u503c",i.a.createElement(Ne.a,{value:this.setData("CHARGE_EVERY_TIME").rule&&this.setData("CHARGE_EVERY_TIME").rule.amount||0,onChange:function(t){e.handleChange("CHARGE_EVERY_TIME",t.target.value,"rule.amount")}}),"\u5143\uff0c\u589e\u52a0",i.a.createElement(Ne.a,{value:this.setData("CHARGE_EVERY_TIME").score_num,onChange:function(t){e.handleChange("CHARGE_EVERY_TIME",t.target.value,"score_num")}}),"\u79ef\u5206")))),i.a.createElement("div",{className:"r_top"},i.a.createElement("div",{className:"r_top_body"},i.a.createElement(ke.a,{disabled:-1!==this.state.activeTab,checkedChildren:"\u542f\u7528",unCheckedChildren:"\u505c\u7528",checked:this.setData("OTHER").status,onChange:function(t){return e.handleChange("OTHER",t,"status")}}),"\u5176\u4ed6\u65b9\u5f0f\u4ea7\u751f\u79ef\u5206"),i.a.createElement("div",{className:"r_top_footer"},i.a.createElement(un.a,{disabled:-1!==this.state.activeTab,checked:this.setData("BIND_MOBILE").status,onChange:function(t){e.handleChange("BIND_MOBILE",t.target.checked,"status")}},"\u7ed1\u5b9a\u624b\u673a\u53f7\uff1a\u589e\u52a0",i.a.createElement(Ne.a,{value:this.setData("BIND_MOBILE").score_num,onChange:function(t){e.handleChange("BIND_MOBILE",t.target.value,"score_num")}}),"\u79ef\u5206")))):i.a.createElement("span",{className:"requestInit"},"\u5f53\u524d\u4f1a\u5458\u7b49\u7ea7\u4e0b\u6682\u65e0\u79ef\u5206\u89c4\u5219\uff0c\u8bf7\u5148 ",i.a.createElement("span",{onClick:function(){return e.showInitConfirm(e.state.activeTab)}},"\u521d\u59cb\u5316\u79ef\u5206\u89c4\u5219"),"\u3002")))}}]),t}(i.a.Component),Vl=(a(1251),ge.a.confirm),Ll=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.showConfirm=function(e){var t=a.handleCancel,n=a.props.failedTagList;Vl({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont"},"\ue82a")),icon:null,width:"280px",closable:!0,content:i.a.createElement("div",{className:"U_confirm"},i.a.createElement("i",{className:"iconfont"},"\ue7dc"),e.message),cancelText:"\u67e5\u770b\u8be6\u60c5",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){t()},onCancel:function(){n(e.failed_user_ids),t()}})},a.onSubmit=function(){var e=a.props.conditionsData||{};if("create"==a.state.type){if(!a.state.tagName)return void B.a.error("\u8bf7\u586b\u5199\u6807\u7b7e\u540d");if(!a.state.groupId)return void B.a.error("\u8bf7\u9009\u62e9\u5206\u7ec4");Zi({name:a.state.tagName,group_id:a.state.groupId}).then(function(t){er({user_ids:a.props.checkedAry,logic_conditions:e},t.data.id).then(function(e){e.failed_count?a.showConfirm(e):(a.setState({tagName:""}),B.a.success("\u6807\u7b7e\u6dfb\u52a0\u6210\u529f"),a.handleCancel())})})}else er({user_ids:a.props.checkedAry,logic_conditions:e},a.state.selectedTags[0]).then(function(e){e.failed_count?a.showConfirm(e):(B.a.success("\u6807\u7b7e\u6dfb\u52a0\u6210\u529f"),a.handleCancel())})},a.onChange=function(e){a.setState({groupId:e}),Qi({},e).then(function(e){a.setState({tagList:e.data})})},a.state={type:"create",tagName:"",tagGroup:"",tagGroupList:[],tagList:[],selectedTags:[],groupId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;$i({}).then(function(t){var a=t.data.filter(function(e){return 0==e.auto_tag});e.setState({tagGroupList:a})})}},{key:"handleChange",value:function(e){var t=[];t.push(e.id),this.setState({selectedTags:t})}},{key:"render",value:function(){var e=this,t=Q.a.Option,a=Gt.a.CheckableTag;return i.a.createElement("div",{className:"addTag"},i.a.createElement(ge.a,{title:"create"==this.state.type?"\u65b0\u5efa\u6807\u7b7e":"\u52a0\u5165\u5df2\u6709\u6807\u7b7e",className:"user_add",width:520,maskClosable:!1,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.onSubmit,cancelButtonProps:this.handleCancel,cancelText:"\u53d6\u6d88",okText:"\u4fdd\u5b58",zIndex:1001},i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"inline-flex":"none"},onClick:function(){e.setState({type:"join"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u52a0\u5165\u5df2\u6709\u6807\u7b7e"),i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"none":"inline-flex"},onClick:function(){e.setState({type:"create"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u6807\u7b7e"),i.a.createElement("ul",{className:"mainUl t_body"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9009\u62e9\u5206\u7ec4"),i.a.createElement(Q.a,{showSearch:!0,style:{width:300},optionFilterProp:"children",placeholder:"\u8bf7\u9009\u62e9\u5206\u7ec4",defaultActiveFirstOption:!1,onChange:this.onChange,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.tagGroupList.map(function(e){return i.a.createElement(t,{key:e.id},e.name)}))),i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"inline-block":"none"}},"\u6807\u7b7e\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.tagName,onFocus:function(){e.state.groupId||B.a.error("\u8bf7\u5148\u9009\u62e9\u5206\u7ec4")},onChange:function(t){e.setState({tagName:t.target.value})}})),i.a.createElement("li",{className:"tags",style:{display:"create"!=this.state.type&&this.state.tagList?"inline-block":"none"}},this.state.tagList.length>0?this.state.tagList.map(function(t){return i.a.createElement(a,{key:t.id,checked:e.state.selectedTags.indexOf(t.id)>-1,onChange:function(a){return e.handleChange(t,a)}},t.name)}):"\u8be5\u5206\u7ec4\u4e0b\u6682\u65e0\u6807\u7b7e"))))}}]),t}(i.a.Component),Ml=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.onSubmit=function(){var e=a.props.conditionsData||{};if("create"==a.state.type){if(!a.state.name)return void B.a.error("\u8bf7\u586b\u5199\u7fa4\u7ec4\u540d\u79f0");if(!a.state.remark)return void B.a.error("\u8bf7\u586b\u5199\u5907\u6ce8");Yi({name:a.state.name,remark:a.state.remark},"static").then(function(t){qi({ids:a.props.checkedAry,logic_conditions:e},t.data.id).then(function(e){B.a.success("\u7fa4\u7ec4\u6dfb\u52a0\u6210\u529f"),a.setState({name:"",remark:""}),a.handleCancel()})})}else{if(!a.state.selectedGroups.length)return void B.a.error("\u8bf7\u5148\u9009\u62e9\u5206\u7ec4");qi({ids:a.props.checkedAry,logic_conditions:e},a.state.selectedGroups[0]).then(function(e){B.a.success("\u7fa4\u7ec4\u6dfb\u52a0\u6210\u529f"),a.handleCancel()})}},a.state={type:"create",name:"",remark:"",groupList:[],selectedGroups:[],groupId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Ji({}).then(function(t){e.setState({groupList:t.data})})}},{key:"handleChange",value:function(e){var t=[];t.push(e.id),this.setState({selectedGroups:t}),console.log(t)}},{key:"render",value:function(){var e=this,t=Gt.a.CheckableTag;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"create"==this.state.type?"\u65b0\u5efa\u7fa4\u7ec4":"\u52a0\u5165\u9759\u6001\u7fa4\u7ec4",className:"user_add",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.onSubmit,cancelButtonProps:this.handleCancel,cancelText:"\u53d6\u6d88",okText:"\u4fdd\u5b58",maskClosable:!1,zIndex:1001},i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"inline-flex":"none"},onClick:function(){e.setState({type:"join"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u52a0\u5165\u9759\u6001\u7fa4\u7ec4"),i.a.createElement("div",{className:"t_header",style:{display:"create"==this.state.type?"none":"inline-flex"},onClick:function(){e.setState({type:"create"})}},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u7fa4\u7ec4"),i.a.createElement("ul",{className:"mainUl t_body"},i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"block":"none"}},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left",style:{display:"create"==this.state.type?"block":"none"}},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",style:{display:"create"==this.state.type?"inline-block":"none"},value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}})),i.a.createElement("li",{className:"tags t_group",style:{display:"create"==this.state.type?"none":"inline-block"}},this.state.groupList.length>0?this.state.groupList.map(function(a){return i.a.createElement(t,{key:a.id,checked:e.state.selectedGroups.indexOf(a.id)>-1,onChange:function(t){return e.handleChange(a,t)}},a.name)}):"\u8be5\u5206\u7ec4\u4e0b\u6682\u65e0\u6807\u7b7e"))))}}]),t}(i.a.Component),Ul=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u59d3\u540d",dataIndex:"wx_name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u624b\u673a\u53f7",dataIndex:"mobile"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"created_at"},{title:"\u50a8\u503c\u603b\u989d",dataIndex:"charge_amount"},{title:"\u8d2d\u4e70\u603b\u989d",dataIndex:"total_purchase_amount"},{title:"\u8d2d\u4e70\u6b21\u6570",dataIndex:"purchased_count"},{title:"\u8d26\u6237\u4f59\u989d",dataIndex:"account_balance"}],r=["wx_name","mobile","created_at","charge_amount","total_purchase_amount","purchased_count","account_balance","id"];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:""}},function(){a.child.current.pagination(a.child.current.state.current)})},a.failedTagList=function(e){a.setState({tagVisible:!1,paginationParams:{searchJson:w({user_ids:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.closeAddTags=function(){a.setState({tagVisible:!1})},a.onSubmitAdd=function(){a.setState({tagVisible:!1})},a.showAddTags=function(e){a.setState({tagVisible:!0,conditions_data:e})},a.closeAddGroup=function(){a.setState({groupVisible:!1})},a.onSubmitGroup=function(){a.setState({groupVisible:!1})},a.showAddGroup=function(e){a.setState({groupVisible:!0,conditions_data:e})},a.jump=function(e){a.props.history.push({pathname:"/user/userDetails",state:{id:e.id,path:"/user",current:a.child.current.state.current}})},a.search=function(e){a.setState({api:tr,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:tr,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){ye.forEach(function(a){a.children.forEach(function(a){if(e==a.value){var n={};n.title=a.label,n.dataIndex=e,t.push(n)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.child=i.a.createRef(),a.state={api:tr,id:"",filterVisible:!1,customVisible:!1,tagVisible:!1,groupVisible:!1,balanceVisible:!1,user_data:[],defaultItem:r,checkedAry:[],paginationParams:{logic_conditions:[],search:"",only:r.join(",")},columns:n,current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom),this.props.location.query&&this.props.location.query.groupId?this.setState({id:this.props.location.query.groupId,api:ar}):this.props.location.query&&this.props.location.query.tagId&&this.setState({id:this.props.location.query.tagId,api:nr})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(pr,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,showAddGroup:this.showAddGroup,closeAddGroup:this.closeAddGroup,showAddTags:this.showAddTags,closeAddTags:this.closeAddTags}),i.a.createElement(Ll,{visible:this.state.tagVisible,onClose:this.closeAddTags,onSubmit:this.onSubmitAdd,checkedAry:this.state.checkedAry,failedTagList:this.failedTagList,conditionsData:this.state.conditions_data}),i.a.createElement(Ml,{visible:this.state.groupVisible,onClose:this.closeAddGroup,onSubmit:this.onSubmitGroup,checkedAry:this.state.checkedAry,conditionsData:this.state.conditions_data}),i.a.createElement("div",{className:"userHeader"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u6635\u79f0\u6216\u624b\u673a\u53f7\u7801"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.showAddGroup},"\u52a0\u7fa4\u7ec4"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.showAddTags},"\u52a0\u6807\u7b7e"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.showBalance},"\u8d60\u9001"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length},"\u5bfc\u51fa")),i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879")),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:ye,targetKeys:this.state.defaultItem,handleCustom:this.handleCustom,firstItem:"wx_name"})),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),Fl=Object(U.g)(Ul),Gl=(a(219),a(130)),Bl=(a(1252),a(1513)),zl=a(1514),Hl=a(1512),Kl=a(640),Jl=a(635),Wl=a.n(Jl),Yl=(a(1253),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e,t,n;a.state.inputValue&&(e=a.state.switchValue?"normal":"mutual_exclusion",t="\u81ea\u52a8"==a.state.modelValue,(n={name:a.state.inputValue,type:e,auto_tag:t},ne({url:"/api/backend/tag_groups",method:"post",data:n})).then(function(e){a.setState({modelValue:"\u81ea\u52a8",inputValue:"",switchValue:"1"}),a.props.refresh(),a.props.onClose()}))},a.switchChange=function(e){a.setState({switchValue:e})},a.modelChange=function(e){a.setState({modelValue:e.target.value})},a.inputChange=function(e){a.setState({inputValue:e.target.value})},a.state={modelValue:"\u81ea\u52a8",inputValue:"",switchValue:"1"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u5efa\u5206\u7ec4",className:"tagModel",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,maskClosable:!1,okText:"\u4fdd\u5b58",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"modelHeader"},i.a.createElement(ke.a,{checked:this.state.switchValue,checkedChildren:"\u591a\u9009",unCheckedChildren:"\u5355\u9009",onChange:this.switchChange}),i.a.createElement(mn.a.Group,{onChange:this.modelChange,value:this.state.modelValue},i.a.createElement(mn.a,{value:"\u81ea\u52a8"},"\u81ea\u52a8"),i.a.createElement(mn.a,{value:"\u624b\u52a8"},"\u624b\u52a8"))),i.a.createElement("div",{className:"name"},"\u5206\u7ec4\u540d\u79f0",i.a.createElement(Ne.a,{value:this.state.inputValue,onChange:this.inputChange}))))}}]),t}(i.a.Component)),ql=(a(577),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.renderChild=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(a.child.current){if(!a.child.current.state)return!1;document.getElementsByClassName("advanced")[0].style.marginLeft=e?"60px":"140px"}},a.handleSubmit=function(){a.state.selectedValue&&a.state.tagName?Zi({name:a.state.tagName,group_id:a.state.selectedValue,logic_conditions:a.child.current.state.data||""}).then(function(e){a.setState({tagName:"",selectedValue:""}),a.props.refresh(),a.handleCancel()}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u76f8\u5173\u4fe1\u606f")},a.onGroupChange=function(e){a.setState({selectedValue:e}),a.state.tagGroups.forEach(function(t){t.id==e&&a.setState({automatic:t.auto_tag})})},a.clearFilter=function(){a.child.current.clearFilter()},a.state={tagGroups:[],tagName:"",selectedValue:"",automatic:!1},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.tagGroups&&this.setState({tagGroups:e.tagGroups})}},{key:"render",value:function(){var e=this,t=Q.a.Option;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u5efa\u6807\u7b7e",maskClosable:!1,width:this.state.automatic?1088:520,visible:this.props.visible,onCancel:this.handleCancel,footer:i.a.createElement("div",null,this.state.automatic?i.a.createElement(_e.a,{size:"small",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"):i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9009\u62e9\u5206\u7ec4"),this.state.tagGroups&&this.state.tagGroups.length?i.a.createElement(Q.a,{defaultActiveFirstOption:!1,showSearch:!0,style:{width:200},onChange:this.onGroupChange,value:this.state.selectedValue,className:"tag_group",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.tagGroups.map(function(e){return i.a.createElement(t,{value:e.id,key:e.id},e.name)})):""),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6807\u7b7e\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.tagName,onChange:function(t){e.setState({tagName:t.target.value})}})),i.a.createElement("li",{style:{display:this.state.automatic?"block":"none"}},i.a.createElement("span",{className:"left"},"\u7b5b\u9009\u6761\u4ef6"),i.a.createElement("div",{className:"advanced"},i.a.createElement(ft,{ref:this.child,value:ye,operation:Ce,renderChild:this.renderChild}))))))}}]),t}(i.a.Component)),Xl=(a(272),a(284)),$l=a.n(Xl),Ql=G.a.RangePicker,Zl=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCityData=function(){var e=[];return e=(e=(e=e.concat(a.state.provinceData)).concat(a.state.cityData)).concat(a.state.areaData)},a.renderTree=function(){var e=Q.a.Option;a.state.selectedItems;switch(a.state.type){case"timestamp":return i.a.createElement("span",null,i.a.createElement(G.a,{placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",showToday:!1,value:a.state.activeKey}));case"period":return i.a.createElement("span",null,i.a.createElement(Ql,{locale:$l.a,value:a.state.activeKey}));case"input":return i.a.createElement("span",null,i.a.createElement(Ne.a,{placeholder:"Basic usage",disabled:!0,className:"optionInput",value:a.state.activeKey}));case"inputRange":return i.a.createElement("span",{className:"inputRange"},i.a.createElement(Ne.a,{placeholder:"Basic usage",disabled:!0,className:"optionInput",value:a.state.activeKey[0]}),i.a.createElement("span",null,"-"),i.a.createElement(Ne.a,{placeholder:"Basic usage",disabled:!0,className:"optionInput",value:a.state.activeKey[1]}));case"selectedBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",disabled:!0,placeholder:"Inserted are removed",value:a.state.activeKey,className:"selectedBox"}));case"selectedTagBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,disabled:!0,value:a.state.activeKey+"",className:"selectedBox"},a.state.selectedTagItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id+""},e.name)})));case"selectedGroupBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,disabled:!0,value:a.state.activeKey,className:"selectedBox"},a.state.selectedGroupItems.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id+""},e.name)})));case"cityBox":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,disabled:!0,value:a.state.activeKey,className:"selectedBox tagBox"},a.handleCityData().map(function(e){return i.a.createElement(Q.a.Option,{key:e.region_code+"",label:e.name,value:e.region_code+""},e.name)})));case"selectedBoxGender":return i.a.createElement("span",null,i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:a.state.activeKey,disabled:!0,style:{width:120}},i.a.createElement(e,{value:"1"},"\u7537"),i.a.createElement(e,{value:"2"},"\u5973"),i.a.createElement(e,{value:"0"},"\u65e0")));default:return null}},a.state={activeKey:"",type:"",value:"",gender:"",period:"",timestamp:"",city:[],provinceData:[],cityData:[],areaData:[],selectedTagItems:[],selectedGroupItems:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;this.setState({activeKey:e.activeKey}),void 0!==e.type&&Ce[e.type].forEach(function(t){t.value==e.operation&&a.setState({type:t.type})})}},{key:"componentDidMount",value:function(){var e=this;xe({}).then(function(t){var a=[];t.forEach(function(e){a=a.concat(e.children)});var n=[];a.forEach(function(e){n=n.concat(e.children)}),e.setState({provinceData:t,cityData:a,areaData:n})}).catch(function(e){}),Ji({}).then(function(t){e.setState({selectedGroupItems:t.data})}),Xi({limit:100,page:1}).then(function(t){e.setState({selectedTagItems:t.data})})}},{key:"render",value:function(){return i.a.createElement("span",null,this.renderTree())}}]),t}(i.a.Component),es=(Q.a.Option,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={singleLineData:{},activeKey:[],activeOptions:"",item:e.item,type:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[];console.log(this.state.item,"=============");var a=this.state.item,n=a.key.indexOf("_");a.key=a.key.substring(n+1,a.key.length),ye.forEach(function(n){n.children.forEach(function(i){i.value==a.key&&(t.push(n.value),e.setState({type:i.type}),Ce[i.type].forEach(function(t){t.value==a.operation&&e.setState({activeOptions:t.label})}))})}),t.push(this.state.item.key),this.setState({activeKey:t})}},{key:"render",value:function(){return i.a.createElement("div",{className:"singleBox"},this.state.item&&this.state.item.key?i.a.createElement("div",{style:{width:"100%"},className:"selectChild"},i.a.createElement(Oe.a,{options:ye,className:"cascader",value:this.state.activeKey,expandTrigger:"hover",allowClear:!1,disabled:!0}),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,style:{width:120,marginLeft:5},disabled:!0,value:this.state.activeOptions}),i.a.createElement(Zl,{activeKey:this.state.item.value,type:this.state.type,operation:this.state.item.operation})):"")}}]),t}(i.a.Component)),ts=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={singleAry:[{key:"",value:"",operation:"",cid:x()}],item:e.item},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"groupBox"},this.state.item.conditions&&this.state.item.conditions.length?i.a.createElement("div",null,i.a.createElement("div",{className:this.state.item.conditions.length>1?"lines":""},this.state.item.conditions.map(function(e,t){return i.a.createElement(es,{key:t,item:e})}),i.a.createElement("div",{className:"switch"},this.state.item.conditions.length>1?i.a.createElement(ke.a,{disabled:!0,checkedChildren:"\u4e14",unCheckedChildren:"\u6216",checked:"and"==this.state.item.logic}):"")),i.a.createElement("div",{className:"addNew1"},i.a.createElement("i",{className:"iconfont"},"\ue822"),i.a.createElement("span",null,"\u65b0\u52a0\u4e00\u4e2a\u6761\u4ef6"))):"")}}]),t}(i.a.Component),as=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={groupData:e.groupData},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,this.state.groupData&&this.state.groupData.conditions?i.a.createElement("div",null,i.a.createElement("div",{className:this.state.groupData.conditions[0].children.length>1?"groups":""},this.state.groupData.conditions[0].children.map(function(e,t){return i.a.createElement(ts,{key:t,item:e})}),i.a.createElement("div",{className:"switch"},this.state.groupData&&this.state.groupData.conditions&&this.state.groupData.conditions[0].children.length>1?i.a.createElement(ke.a,{checkedChildren:"\u4e14",unCheckedChildren:"\u6216",checked:"and"==this.state.groupData.conditions[0].logic,disabled:!0}):"")),i.a.createElement("div",{className:this.state.groupData.conditions[0].children.length>1?"addNewGroup1 addNewGroupTwo1":"addNewGroup1"},i.a.createElement("i",{className:"iconfont"},"\ue822"),i.a.createElement("span",null,"\u65b0\u52a0\u4e00\u4e2a\u6761\u4ef6"))):"")}}]),t}(i.a.Component),ns=(Q.a.Option,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({groupData:{}},function(){a.props.onCancel()})},a.state={groupData:{},nameValue:"",remarkValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.groupId&&(a={},n=e.groupId,ne({url:"/api/backend/tags/".concat(n),method:"get",params:a})).then(function(e){console.log(e),e.data?i.setState({groupData:e.data}):i.setState({groupData:e})}).catch(function(e){})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7fa4\u7ec4\u8be6\u60c5",className:"disabled-filter",width:1088,maskClosable:!1,visible:this.props.visible,onCancel:this.handleCancel,centered:!0,footer:null},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9009\u62e9\u5206\u7ec4"),i.a.createElement(Q.a,{style:{width:200},value:this.state.groupData.group_name,className:"tag_group",disabled:!0})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.name})),i.a.createElement("li",{style:{display:"block"}},i.a.createElement("span",{className:"left"},"\u7b5b\u9009\u6761\u4ef6"),this.state.groupData&&this.state.groupData.conditions?i.a.createElement("div",{className:"advanced",style:{marginLeft:this.state.groupData.conditions[0].children.length>1?"60px":"140px"}},i.a.createElement(as,{groupData:this.state.groupData})):""))))}}]),t}(i.a.Component)),is=-1,rs=ge.a.confirm,ls=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOver,a=e.connectDragSource,n=e.connectDropTarget,r=(e.moveRow,Object(ga.a)(e,["isOver","connectDragSource","connectDropTarget","moveRow"])),l=Object(be.a)({},r.style,{cursor:"move"}),s=r.className;return t&&(r.index>is&&(s+=" drop-over-downward"),r.index<is&&(s+=" drop-over-upward")),a(n(i.a.createElement("tr",Object.assign({},r,{className:s,style:l}))))}}]),t}(i.a.Component),ss={beginDrag:function(e){return is=e.index,{index:e.index}}},cs=Object(Bl.a)("row",{drop:function(e,t){var a=t.getItem().index,n=e.index;a!==n&&(e.moveRow(a,n),t.getItem().index=n)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}})(Object(zl.a)("row",ss,function(e){return{connectDragSource:e.dragSource()}})(ls)),os=i.a.createElement("div",{style:{fontSize:"12px"}},"\u8fdb\u884c\u6807\u7b7e\u89c4\u5219\u8ba1\u7b97\u65f6\uff0c\u4e00\u4e2a\u5ba2\u6237\u53ea\u5141\u8bb8\u88ab\u6253\u4e0a\u8be5\u5206\u7ec4\u7684\u4e00\u4e2a\u6807\u7b7e"),us=i.a.createElement("div",{style:{fontSize:"12px"}},"\u8fdb\u884c\u6807\u7b7e\u89c4\u5219\u8ba1\u7b97\u65f6\uff0c\u4e00\u4e2a\u5ba2\u6237\u5141\u8bb8\u88ab\u6253\u4e0a\u8be5\u5206\u7ec4\u7684\u591a\u4e2a\u6807\u7b7e"),ms=i.a.createElement("div",{style:{fontSize:"12px"}},"\u901a\u8fc7\u62d6\u62fd\u6807\u7b7e\uff0c\u8bbe\u7f6e\u6807\u7b7e\u89c4\u5219\u7684\u6267\u884c\u987a\u5e8f\uff0c\u5f53\u67d0\u4e2a\u7528\u6237\u6ee1\u8db3\u4e86\u524d\u9762\u7684\u6807\u7b7e\u89c4\u5219\uff0c\u5c06\u4e0d\u518d\u8fd0\u7b97\u540e\u9762\u7684\u6807\u7b7e\u89c4\u5219\u3002"),ds=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).moveRow=function(e,t){var n=a.state.allTagsInGroup[e];a.setState(Wl()(a.state,{allTagsInGroup:{$splice:[[e,1],[t,0,n]]}})),setTimeout(function(){a.sortTag()},1e3)},a.moveNoRow=function(e,t){a.state.allTagsInGroup[e];setTimeout(function(){a.sortTag()},1e3)},a.sortTag=function(){var e={};a.state.allTagsInGroup.forEach(function(t,a){e[t.id+""]=a});var t,n,i=a.state.activeGroupId||a.state.tagGroups[0].id;(t={priorities:e},n=i,ne({url:"/api/backend/tag_groups/".concat(n),method:"put",data:t})).then(function(e){console.log(e)}).catch(function(e){})},a.refresh=function(){$i({}).then(function(e){a.setState({tagGroups:e.data,activeGroup:e.data[0]}),a.complainPopover(e.data[0].id);var t=a.state.activeGroupId||e.data[0].id,n="\u666e\u901a\u7ec4"==e.data[0].type?"#4F9863":"#FF9C4B",i=document.getElementsByClassName("ant-tabs-tab-active");i[0].style.setProperty("background",n,"important"),i[0].style.setProperty("border","1px solid ".concat(n),"important"),Qi({},t).then(function(e){a.setState({allTagsInGroup:e.data})}).catch(function(e){})}).catch(function(e){})},a.showCreateNew=function(){a.setState({createNewVisible:!0})},a.hideCreateNew=function(){a.setState({createNewVisible:!1})},a.showCreateTag=function(){a.setState({createTagVisible:!0})},a.hideCreateTag=function(){a.setState({createTagVisible:!1})},a.onEdit=function(e,t){a[t](e)},a.tagGroupChange=function(e){a.complainPopover(e);var t=a.state.tagGroups.filter(function(t){return t.id==e});a.setState({activeGroupId:e,activeGroup:t[0]}),Qi({},e).then(function(e){a.setState({allTagsInGroup:e.data})}).catch(function(e){})},a.remove=function(e){Qi({},e).then(function(t){t.data.length?a.showErrorConfirm():a.showConfirm(e)}).catch(function(e){})},a.showErrorConfirm=function(){var e=a.refresh,t=rs({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){t.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u8be5\u6807\u7b7e\u5206\u7ec4\u4e0b\u8fd8\u6709\u6807\u7b7e\uff0c\u65e0\u6cd5\u5220\u9664\uff01"),cancelText:"\u53d6\u6d88",okText:"\u77e5\u9053\u4e86",okButtonProps:{size:"small"},cancelButtonProps:{size:"small",style:{display:"none"}},onOk:function(){e()}})},a.showAjaxError=function(e){a.refresh;var t=rs({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){t.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},e),cancelText:"\u53d6\u6d88",okText:"\u77e5\u9053\u4e86",okButtonProps:{size:"small"},cancelButtonProps:{size:"small",style:{display:"none"}},onOk:function(){}})},a.showConfirm=function(e){var t=a.refresh,n=a.showAjaxError,r=rs({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u6807\u7b7e\u5206\u7ec4\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,i;(a={},i=e,ne({url:"/api/backend/tag_groups/".concat(i),method:"delete",params:a})).then(function(e){200==e.status_code?n(e.message):t()})},onCancel:function(){}})},a.complainPopover=function(e){"\u4e92\u65a5\u7ec4"===a.state.tagGroups.filter(function(t){return t.id==e})[0].type?a.setState({singleOrDouble:"single"}):a.setState({singleOrDouble:"double"})},a.showDetail=function(e){a.setState({detailVisible:!0,detailId:e.id})},a.hideDetail=function(){a.setState({detailVisible:!1,detailId:""})},a.clickTab=function(e,t){for(var n="\u666e\u901a\u7ec4"==a.state.tagGroups.filter(function(t){return t.id==e})[0].type?"#4F9863":"#FF9C4B",i=t.target,r=document.getElementsByClassName("ant-tabs-tab"),l=[],s=0;s<r.length;s++)l.push(r[s]);l.forEach(function(e){e.style.setProperty("background","#fff","important"),e.style.setProperty("border"," 1px solid #d9d9d9","important")}),i.parentNode.style.setProperty("background",n,"important"),i.parentNode.style.setProperty("border","1px solid ".concat(n),"important")},a.goUserList=function(e){a.props.history.push({pathname:"/user",query:{tagId:e.id}})},a.state={activeGroup:[],createNewVisible:!1,createTagVisible:!1,tagGroups:[],allTagsInGroup:[],singleOrDouble:"",activeGroupId:"",detailId:"",detailVisible:!1},a.components={body:{row:cs}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=wr.a.TabPane,a=ve.a.Column;return i.a.createElement("div",{className:"tag_manage"},i.a.createElement(Yl,{visible:this.state.createNewVisible,onClose:this.hideCreateNew,refresh:this.refresh}),i.a.createElement(ql,{visible:this.state.createTagVisible,onClose:this.hideCreateTag,tagGroups:this.state.tagGroups,refresh:this.refresh}),i.a.createElement(ns,{visible:this.state.detailVisible,onCancel:this.hideDetail,groupId:this.state.detailId}),i.a.createElement("div",{className:"header_tag"},i.a.createElement("div",{className:"createNew"},i.a.createElement(_e.a,{size:"small",className:"btn btnAdd fBtn",onClick:this.showCreateNew},i.a.createElement("i",{className:"iconfont",style:{color:"#4F9863",fontSize:"12px",marginRight:"6px"}},"\ue7e0"),"\u65b0\u5efa\u5206\u7ec4"),i.a.createElement(_e.a,{size:"small",className:"btn btnAdd",onClick:this.showCreateTag},i.a.createElement("i",{className:"iconfont",style:{color:"#4F9863",fontSize:"12px",marginRight:"6px"}},"\ue7e0"),"\u65b0\u5efa\u6807\u7b7e"))),i.a.createElement("div",{className:"tagGroups"},this.state.tagGroups&&this.state.tagGroups.length?i.a.createElement("div",{className:"popopver"},i.a.createElement(Gl.a,{content:"single"==this.state.singleOrDouble?os:us,placement:"bottom",trigger:"hover"},"single"==this.state.singleOrDouble?"\u5355\u9009":"\u591a\u9009",i.a.createElement("i",{className:"iconfont"},"\ue7dd"))):"",this.state.tagGroups&&this.state.tagGroups.length?i.a.createElement(wr.a,{defaultActiveKey:this.state.tagGroups[0].id+"",onChange:this.tagGroupChange,animated:!1,type:"editable-card",hideAdd:!0,onEdit:this.onEdit,onTabClick:this.clickTab},this.state.tagGroups.map(function(n){return i.a.createElement(t,{tab:i.a.createElement("span",null,n.name,n.auto_tag?"(\u81ea\u52a8)":"(\u624b\u52a8)"),key:n.id},i.a.createElement("div",{className:"chart chart_tag"},i.a.createElement(Hl.a,{backend:Kl.a},i.a.createElement(ve.a,{dataSource:e.state.allTagsInGroup,rowKey:function(e){return e.id},rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},components:e.components,onRow:function(t,a){return{index:a,moveRow:"\u4e92\u65a5\u7ec4"==e.state.activeGroup.type&&1==e.state.activeGroup.auto_tag?e.moveRow:e.moveNoRow}}},i.a.createElement(a,{className:"column",title:"\u6807\u7b7e\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",null,t),i.a.createElement("span",{style:{display:1==e.state.activeGroup.auto_tag?"inline-block":"none"}},i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},className:"iconfont",onClick:function(){return e.showDetail(a)}},"\ue7ab")))}}),i.a.createElement(a,{className:"column primary",title:"\u4eba\u6570",dataIndex:"model_count",key:"model_count"}),i.a.createElement(a,{title:"\u64cd\u4f5c",key:"action",className:"column groupOperation",render:function(t,a){return i.a.createElement("span",null,i.a.createElement("span",{className:"operation",onClick:function(){return e.goUserList(a)}},"\u8be6\u60c5"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u6807\u7b7e\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){var t,n;(t={},n=a.id,ne({url:"/api/backend/tags/".concat(n),method:"delete",params:t})).then(function(t){e.refresh()})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664")),i.a.createElement(Gl.a,{content:ms,placement:"bottom",trigger:"hover"},i.a.createElement("span",{style:{display:"\u4e92\u65a5\u7ec4"==e.state.activeGroup.type&&1==e.state.activeGroup.auto_tag?"inline-block":"none"}},i.a.createElement("i",{className:"iconfont",style:{fontSize:"14px"}},"\ue836"))))}})))))})):""))}}]),t}(i.a.Component),ps=(a(1256),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).init=function(){a.setState({name:"",num:"",discount:""})},a.handleCancel=function(){a.props.onCancel()},a.check=function(){var e=a.state,t=e.name,n=e.num,i=e.discount;t?n?i?a.submit(t,n,i):B.a.error("\u8bf7\u9009\u62e9\u6298\u6263"):B.a.error("\u8bf7\u586b\u5199\u6240\u9700\u79ef\u5206"):B.a.error("\u8bf7\u586b\u5199\u4f1a\u5458\u7b49\u7ea7\u540d\u79f0")},a.submit=function(e,t,n){var i=a.props.isEdit?lr:sr,r=a.props.isEdit?a.props.record.id:"";a.props.onSubmit(i,r,e,t,n)},a.state={name:"",num:"",discount:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.isEdit?this.setState({name:e.record.grade_name,num:e.record.score_num,discount:e.record.discount}):this.init()}},{key:"render",value:function(){var e=this,t=Object(Se.a)(Array.from({length:101}).keys());return i.a.createElement("div",null,i.a.createElement(ge.a,{title:this.props.isEdit?"\u7f16\u8f91\u4f1a\u5458\u7b49\u7ea7":"\u65b0\u5efa\u4f1a\u5458\u7b49\u7ea7",maskClosable:!1,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.check,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7b49\u7ea7\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6240\u9700\u79ef\u5206"),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:this.state.num,onChange:function(t){e.setState({num:t.target.value})},onBlur:function(t){Number.isInteger(t.target.value)||e.setState({num:parseInt(t.target.value)})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4eab\u53d7\u6298\u6263"),i.a.createElement(Q.a,{placeholder:"\u8bf7\u9009\u62e9\u64cd\u4f5c\u4eba",value:this.state.discount,onChange:function(t){e.setState({discount:t})},defaultActiveFirstOption:!1},t.map(function(e){return i.a.createElement(Q.a.Option,{value:e},e)}))))))}}]),t}(n.Component)),hs=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).showModal=function(e){a.setState({addNewClassVisible:!0,isEdit:e})},a.hideModal=function(){a.setState({addNewClassVisible:!1})},a.refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.submit=function(e,t,n,i,r){e({grade_name:n,score_num:i,discount:r},t).then(function(e){B.a.success(e.message),a.hideModal(),a.modal.current.init(),a.refresh()}).catch(function(e){})},a.edit=function(e){a.setState({record:e},function(){a.showModal(!0)})},a.delete=function(e){var t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u4f1a\u5458\u7b49\u7ea7\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,n;(a={},n=e,ne({url:"/api/backend/users/member_grades/".concat(n),method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})}})},a.paginationChange=function(e){a.setState({data:e})},a.state={api:rr,data:[],addNewClassVisible:!1,record:""},a.child=i.a.createRef(),a.modal=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u4f1a\u5458\u7b49\u7ea7",dataIndex:"grade_name"},{title:"\u6240\u9700\u79ef\u5206",dataIndex:"score_num"},{title:"\u4eab\u53d7\u6298\u6263",dataIndex:"discount"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"20px"},onClick:function(){return e.edit(a)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.delete(a.id)}},"\u5220\u9664"))}}],a={visible:this.state.addNewClassVisible,onCancel:this.hideModal,onSubmit:this.submit,record:this.state.record,isEdit:this.state.isEdit};return i.a.createElement("div",{className:"membership"},i.a.createElement(ps,Object.assign({},a,{ref:this.modal})),i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",className:"btn btnAdd",onClick:function(){return e.showModal(!1)}},i.a.createElement("i",{className:"iconfont",style:{color:"#4F9863",fontSize:"12px",marginRight:"6px"}},"\ue7e0"),"\u65b0\u589e\u4f1a\u5458\u7b49\u7ea7"),i.a.createElement("span",null,"\u6ce8\uff1a\u6210\u4e3a\u4f1a\u5458\u7684\u524d\u63d0\u662f\u50a8\u503c")),i.a.createElement("div",{className:"chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,valChange:this.paginationChange,text:"\u6761\u6570\u636e"})))}}]),t}(i.a.Component),fs=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,"ConsumerBehavior")}}]),t}(i.a.Component),Es=(a(1257),a(1258),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.renderChild=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(a.child.current){if(!a.child.current.state)return!1;document.getElementsByClassName("advanced")[0].style.marginLeft=e?"60px":"140px"}},a.handleSubmit=function(){a.state.nameValue&&a.state.remarkValue?Yi({name:a.state.nameValue,remark:a.state.remarkValue,logic_conditions:a.child.current.state.data||""},a.state.type).then(function(e){a.props.refresh(),a.props.onCancel(),a.setState({type:"",nameValue:"",remarkValue:""})}).catch(function(e){}):B.a.error("\u8bf7\u586b\u5199\u76f8\u5173\u4fe1\u606f")},a.clearFilter=function(){a.child.current.clearFilter()},a.state={type:"",nameValue:"",remarkValue:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.type&&this.setState({type:e.type})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"dynamic"==this.state.type?"\u65b0\u5efa\u667a\u80fd\u7fa4\u7ec4":"\u65b0\u5efa\u9759\u6001\u7fa4\u7ec4",width:"dynamic"==this.state.type?1088:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,"dynamic"==this.state.type?i.a.createElement(_e.a,{size:"small",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"):i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.nameValue,onChange:function(t){e.setState({nameValue:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.remarkValue,onChange:function(t){e.setState({remarkValue:t.target.value})}})),i.a.createElement("li",{style:{display:"dynamic"==this.state.type?"block":"none"}},i.a.createElement("span",{className:"left"},"\u7b5b\u9009\u6761\u4ef6"),i.a.createElement("div",{className:"advanced"},i.a.createElement(ft,{value:ye,operation:Ce,ref:this.child,renderChild:this.renderChild}))))))}}]),t}(i.a.Component)),vs=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.setState({groupData:{}},function(){a.props.onCancel()})},a.state={groupData:{},nameValue:"",remarkValue:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.groupId&&(a={},n=e.groupId,ne({url:"/api/backend/groups/".concat(n),method:"get",params:a})).then(function(e){console.log(e),e.data?i.setState({groupData:e.data}):i.setState({groupData:e})}).catch(function(e){})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7fa4\u7ec4\u8be6\u60c5",maskClosable:!1,className:"disabled-filter",width:"\u667a\u80fd\u7fa4\u7ec4"==this.state.groupData.type?1088:520,visible:this.props.visible,onCancel:this.handleCancel,centered:!0,footer:null},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7fa4\u7ec4\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.name})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",disabled:!0,value:this.state.groupData.remark})),i.a.createElement("li",{style:{display:"\u667a\u80fd\u7fa4\u7ec4"==this.state.groupData.type?"block":"none"}},i.a.createElement("span",{className:"left"},"\u7b5b\u9009\u6761\u4ef6"),this.state.groupData&&this.state.groupData.conditions?i.a.createElement("div",{className:"advanced",style:{marginLeft:this.state.groupData.conditions[0].children.length>1?"60px":"140px"}},i.a.createElement(as,{groupData:this.state.groupData})):""))))}}]),t}(i.a.Component),_s=wr.a.TabPane,gs=ve.a.Column,bs=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={dynamicList:[],staticList:[],createVisible:!1,type:"dynamic",detailVisible:!1,detailId:""},a.refresh=function(){var e;(e={},ne({url:"/api/backend/groups/user/dynamic",method:"get",params:e})).then(function(e){a.setState({dynamicList:e.data})}).catch(function(e){}),Ji({}).then(function(e){a.setState({staticList:e.data})}).catch(function(e){})},a.addNewStatic=function(){a.setState({type:"static",createVisible:!0})},a.addNewDynamic=function(){a.setState({type:"dynamic",createVisible:!0})},a.onCancel=function(){a.setState({createVisible:!1})},a.showDetail=function(e){a.setState({detailVisible:!0,detailId:e.id})},a.hideDetail=function(){a.setState({detailVisible:!1,detailId:""})},a.goUserList=function(e){a.props.history.push({pathname:"/user",query:{groupId:e.id}})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(vs,{visible:this.state.detailVisible,onCancel:this.hideDetail,groupId:this.state.detailId}),i.a.createElement(Es,{visible:this.state.createVisible,type:this.state.type,onCancel:this.onCancel,refresh:this.refresh}),i.a.createElement(wr.a,{defaultActiveKey:"dynamic",type:"card"},i.a.createElement(_s,{tab:"\u667a\u80fd\u7fa4\u7ec4",key:"dynamic"},i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNewDynamic},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u7fa4\u7ec4"),i.a.createElement(ve.a,{dataSource:this.state.dynamicList,rowKey:function(e){return e.id},rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}},i.a.createElement(gs,{className:"column_group",title:"\u7fa4\u7ec4\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a){return i.a.createElement("span",{className:"editIcon"},i.a.createElement("span",null,t),i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},className:"iconfont",onClick:function(){return e.showDetail(a)}},"\ue7ab"))}}),i.a.createElement(gs,{className:"column_group primary",title:"\u5efa\u7acb\u65f6\u95f4",dataIndex:"created_at",key:"created_at"}),i.a.createElement(gs,{className:"column_group primary",title:"\u603b\u4eba\u6570",dataIndex:"model_count",key:"model_count"}),i.a.createElement(gs,{title:"\u64cd\u4f5c",key:"action",className:"column_group groupOperation",render:function(t,a){return i.a.createElement("span",null,i.a.createElement("span",{className:"operation",onClick:function(){return e.goUserList(a)}},"\u8be6\u60c5"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8d26\u53f7\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){Wi({},a.id).then(function(t){e.refresh()})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664")))}})))),i.a.createElement(_s,{tab:"\u9759\u6001\u7fa4\u7ec4",key:"static"},i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.addNewStatic},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u7fa4\u7ec4"),i.a.createElement(ve.a,{dataSource:this.state.staticList,rowKey:function(e){return e.id},rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}},i.a.createElement(gs,{className:"column_group",title:"\u7fa4\u7ec4\u540d\u79f0",dataIndex:"name",key:"name",render:function(t,a){return i.a.createElement("span",{className:"editIcon"},i.a.createElement("span",null,t),i.a.createElement("i",{style:{color:"#4F9863",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},className:"iconfont",onClick:function(){return e.showDetail(a)}},"\ue7ab"))}}),i.a.createElement(gs,{className:"column_group primary",title:"\u5efa\u7acb\u65f6\u95f4",dataIndex:"created_at",key:"created_at"}),i.a.createElement(gs,{className:"column_group primary",title:"\u603b\u4eba\u6570",dataIndex:"model_count",key:"model_count"}),i.a.createElement(gs,{title:"\u64cd\u4f5c",key:"action",className:"column_group groupOperation",render:function(t,a){return i.a.createElement("span",null,i.a.createElement("span",{className:"operation",onClick:function(){return e.goUserList(a)}},"\u8be6\u60c5"),i.a.createElement(Qt.a,{title:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8d26\u53f7\u4e48",okText:"\u786e\u5b9a",icon:null,cancelText:"\u53d6\u6d88",onConfirm:function(){[].push(a.id),Wi({},a.id).then(function(t){e.refresh()})}},i.a.createElement("span",{className:"operation"},"\u5220\u9664")))}}))))))}}]),t}(i.a.Component),ys=Object(U.g)(bs),Cs=(a(1259),a(1260),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){var e,t;(e={score_num:a.state.scoreValue},t=a.props.id,ne({url:"/api/backend/users/".concat(t,"/add/score"),method:"put",data:e})).then(function(e){a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.state={scoreValue:"",score:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){this.setState({score:e.score})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7fa4\u7ec4\u8be6\u60c5",className:"adjustScore",width:520,visible:this.props.visible,onCancel:this.handleCancel,centered:!0,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",maskClosable:!1,onOk:this.submit},i.a.createElement("div",{className:"a_header"},"\u73b0\u6709\u79ef\u5206 : ",this.state.score),i.a.createElement("div",{className:"a_body"},i.a.createElement("span",null,"\u589e\u52a0\u79ef\u5206"),i.a.createElement(Ne.a,{value:this.state.scoreValue,onChange:function(t){e.setState({scoreValue:t.target.value})}}))))}}]),t}(i.a.Component)),ks=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.paginationChange=function(e){a.setState({data:e})},a.state={api:mr,params:{status:0},data:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[{title:"\u540d\u79f0",dataIndex:"coupon_name"},{title:"\u4ef7\u503c",dataIndex:"benefit",render:function(e,t){return i.a.createElement("span",null,e,"\u5143")}},{title:"\u4f7f\u7528\u6761\u4ef6",dataIndex:"balance",render:function(e,t){for(var a in t.deliverable_desc)return t.deliverable_desc[a]}},{title:"\u9886\u53d6\u65f6\u95f4",dataIndex:"received_at"},{title:"\u5931\u6548\u65f6\u95f4",dataIndex:"invalid_at"}];return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u4f18\u60e0\u5238\u8bb0\u5f55",maskClosable:!1,width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.check,footer:null},i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:e,rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,id:this.props.userId,ref:this.child,text:"\u6761\u6570\u636e",valChange:this.paginationChange,params:this.state.params}))))}}]),t}(n.Component),Ss=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.paginationChange=function(e){a.setState({data:e})},a.state={api:dr,params:{status:0},data:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u79ef\u5206\u8bb0\u5f55",maskClosable:!1,width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.check,footer:null},i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:[{title:"\u65f6\u95f4",dataIndex:"happen_at"},{title:"\u52a8\u4f5c",dataIndex:"desc"},{title:"\u79ef\u5206\u53d8\u52a8",dataIndex:"value"}],rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,id:this.props.userId,text:"\u6761\u6570\u636e",valChange:this.paginationChange,params:this.state.params}))))}}]),t}(n.Component),Os=wr.a.TabPane,Ns=ge.a.confirm,ws=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e,t;(e={},t=a.props.location.state.id,ne({url:"/api/backend/users/".concat(t),method:"get",params:e})).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.callback=function(e){console.log(e)},a.removeGroup=function(e){a.showConfirm(e,cr,"\u7fa4\u7ec4")},a.removeTag=function(e){a.showConfirm(e,or,"\u6807\u7b7e")},a.showAdjust=function(){a.setState({adjustScoreVisible:!0})},a.hideAdjust=function(){a.setState({adjustScoreVisible:!1})},a.showCouponRecords=function(){a.setState({couponRecords:!0})},a.hideCouponRecords=function(){a.setState({couponRecords:!1})},a.showIntegralRecords=function(){a.setState({integralRecords:!0})},a.hideIntegralRecords=function(){a.setState({integralRecords:!1})},a.showConfirm=function(e,t,n){var r,l=a.refresh,s=a.props.location.state.id;r="\u7fa4\u7ec4"==n?"group_id":"tag_id";var c=Ns({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){c.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5",n,"\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){t(Object(Y.a)({},r,e),s).then(function(e){l()}).catch(function(e){})},onCancel:function(){}})},a.jumpUserStore=function(){},a.jumpOrder=function(){},a.showBalance=function(){a.setState({balanceVisible:!0})},a.hideBalance=function(){a.setState({balanceVisible:!1})},a.goBack=function(){a.props.history.push({pathname:a.props.location.state.path,state:{current:a.props.location.state.current}})},a.delete=function(){var e=[];e.push(a.props.location.state.id);var t=a.goBack,n=Ns({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u7528\u6237\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a;console.log(e,"+++++++++++++++++"),(a={user_ids:e},console.log(a),ne({url:"/api/backend/users/delete",method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})},onCancel:function(){}})},a.state={data:{},activeGroup:"dynamic",adjustScoreVisible:!1,integralRecords:!1,couponRecords:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t={visible:this.state.couponRecords,onClose:this.hideCouponRecords,userId:this.props.location.state.id},a={visible:this.state.integralRecords,onClose:this.hideIntegralRecords,userId:this.props.location.state.id},n={visible:this.state.balanceVisible,onCancel:this.hideBalance,refresh:this.refresh,type:"user",id:this.state.data.id};return i.a.createElement("div",null,i.a.createElement(Sr,n),i.a.createElement(ks,t),i.a.createElement(Ss,a),i.a.createElement(Cs,{visible:this.state.adjustScoreVisible,onClose:this.hideAdjust,score:this.state.data.score,id:this.props.location.state.id,refresh:this.refresh}),i.a.createElement("div",{className:"u_top"},i.a.createElement("div",{className:"u_header"},i.a.createElement("span",null,"\u7528\u6237\u8be6\u60c5"),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"default",style:{marginRight:"20px"},size:"small",onClick:this.delete},"\u5220\u9664\u8be5\u7528\u6237"),i.a.createElement(_e.a,{type:"default",size:"small",onClick:this.goBack},"\u8fd4\u56de\u7528\u6237\u5217\u8868"))),i.a.createElement("div",{className:"u_body"},i.a.createElement("ul",{className:"u_body_top"},i.a.createElement("li",{className:"firstChild"},i.a.createElement("h3",null,i.a.createElement("img",{src:this.state.data.avatar,alt:""}))),i.a.createElement("li",null,i.a.createElement("p",null,"ID\uff1a",this.state.data.id),i.a.createElement("p",null,"\u624b\u673a\u53f7\u7801\uff1a",this.state.data.mobile),i.a.createElement("p",null,"\u6ce8\u518c\u65f6\u95f4\uff1a",this.state.data.created_at)),i.a.createElement("li",null,i.a.createElement("p",null,"\u6635\u79f0\uff1a",this.state.data.nickname),i.a.createElement("p",null,"\u59d3\u540d\uff1a",this.state.data.real_name||"\u6682\u65e0"),i.a.createElement("p",null,"\u6027\u522b\uff1a",this.state.data.sex),i.a.createElement("p",null,"\u5730\u533a\uff1a",this.state.data.province," ",this.state.data.city," ")),i.a.createElement("li",null,i.a.createElement("p",null,"\u4f1a\u5458\u7b49\u7ea7\uff1a",this.state.data.member_rank),i.a.createElement("p",null,"\u6765\u6e90\uff1a",this.state.data.register_channel),i.a.createElement("p",null,"\u7b2c\u4e00\u6b21\u8d2d\u4e70\u65f6\u95f4\uff1a",this.state.data.first_purchased_at),i.a.createElement("p",null,"\u8ddd\u79bb\u6700\u8fd1\u4e00\u6b21\u8d2d\u4e70\uff1a",this.state.data.last_purchased_at))),i.a.createElement("ul",{className:"u_body_bottom"},i.a.createElement("li",null,"\u8d26\u6237\u4f59\u989d",i.a.createElement("h4",null,this.state.data.balance,i.a.createElement("span",{onClick:this.showBalance,style:{cursor:"pointer"}},"\u8c03\u6574"))),i.a.createElement("li",null,"\u4f18\u60e0\u5238",i.a.createElement("h4",null,this.state.data.active_coupon_record_count,i.a.createElement("span",{onClick:this.showCouponRecords,style:{cursor:"pointer"}},"\u67e5\u770b\u8bb0\u5f55"))),i.a.createElement("li",null,"\u79ef\u5206 ",i.a.createElement("h4",null,this.state.data.total_score,i.a.createElement("span",{onClick:this.showAdjust,style:{cursor:"pointer"}},"\u8c03\u6574"),i.a.createElement("span",{onClick:this.showIntegralRecords,style:{cursor:"pointer"}},"\u67e5\u770b\u8bb0\u5f55"))),i.a.createElement("li",null,"\u88ab\u8d2d\u4e70\u6b21\u6570 ",i.a.createElement("h4",null,"\u6682\u65e0")),i.a.createElement("li",null,"\u8fd4\u4f63\u603b\u989d ",i.a.createElement("h4",null,"\u6682\u65e0")),i.a.createElement("li",null,this.state.data.superior_shop?i.a.createElement("div",null,i.a.createElement("p",null,"\u4e0a\u7ebf\uff1a",this.state.data.superior_shop.keeper_name,"(\u5e97\u94fa\u7f16\u53f7:",this.state.data.superior_shop.code,")"),i.a.createElement("p",null,"\u6210\u4e3a\u6b64\u4eba\u4e0b\u7ebf\u65f6\u95f4\uff1a",this.state.data.subordinated_at),i.a.createElement("p",null,"\u6210\u4e3a\u4e0b\u7ebf\u65f6\u95f4\uff1a",this.state.data.first_subordinated_at)):"\u6682\u65e0\u4e0a\u7ebf")))),i.a.createElement("div",{className:"u_middle"},i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("h3",null,"\u603b\u6d88\u8d39\u91d1\u989d ",this.state.data.consume_total_amount),i.a.createElement("div",null,i.a.createElement("span",null,"\u5c0f\u7a0b\u5e8f\u6d88\u8d39\u91d1\u989d",i.a.createElement("p",null,this.state.data.online_consume_total_amount)),i.a.createElement("span",null,"\u95e8\u5e97\u6d88\u8d39\u91d1\u989d",i.a.createElement("p",null,this.state.data.offline_consume_total_amount)))),i.a.createElement("li",null,i.a.createElement("h3",null,"\u603b\u8d2d\u4e70\u6b21\u6570 ",this.state.data.purchase_total_count,i.a.createElement("span",{className:"jump",onClick:this.jumpOrder},"\u8be6\u60c5")),i.a.createElement("div",null,i.a.createElement("span",null,"\u5c0f\u7a0b\u5e8f\u8d2d\u4e70\u6b21\u6570",i.a.createElement("p",null,this.state.data.online_purchase_total_count)),i.a.createElement("span",null,"\u95e8\u5e97\u8d2d\u4e70\u6b21\u6570",i.a.createElement("p",null,this.state.data.offline_purchase_total_count)))),i.a.createElement("li",null,i.a.createElement("h3",null,"\u603b\u50a8\u503c\u91d1\u989d ",this.state.data.deposit_total_amount,i.a.createElement("span",{className:"jump",onClick:this.jumpUserStore},"\u8be6\u60c5")),i.a.createElement("div",null,i.a.createElement("span",null,"\u50a8\u503c\u6b21\u6570",i.a.createElement("p",null,this.state.data.deposit_total_count)),i.a.createElement("span",null,"\u8d60\u9001\u91d1\u989d",i.a.createElement("p",null,this.state.data.deposit_total_gift_amount)))))),i.a.createElement("div",{className:"u_group"},i.a.createElement("div",{className:"u_group_header"},i.a.createElement("span",{className:"left activeG"},"\u6240\u5728\u9759\u6001\u7fa4\u7ec4")),i.a.createElement("div",{className:"u_group_body"},this.state.data.groups&&this.state.data.groups.data.length?this.state.data.groups.data.map(function(t){return i.a.createElement(Gt.a,{closable:!0,key:t.id,onClose:function(){return e.removeGroup(t.id)}},t.name)}):"")),i.a.createElement("div",{className:"u_group"},i.a.createElement("div",{className:"u_group_header"},i.a.createElement("span",{className:"dynamic"==this.state.activeGroup?"left activeG":"left",onClick:function(){e.setState({activeGroup:"dynamic"})}},"\u81ea\u52a8\u6807\u7b7e"),i.a.createElement("span",{className:"static"==this.state.activeGroup?"left activeG":"left",onClick:function(){e.setState({activeGroup:"static"})}},"\u624b\u52a8\u6807\u7b7e")),i.a.createElement("div",{className:"u_group_body"},i.a.createElement(wr.a,{activeKey:this.state.activeGroup,onChange:this.callback},[{text:"\u6240\u5728\u667a\u80fd\u7fa4\u7ec4",type:"dynamic"},{text:"\u6240\u5728\u9759\u6001\u7fa4\u7ec4",type:"static"}].map(function(t){return i.a.createElement(Os,{tab:t.text,key:t.type},"dynamic"==e.state.activeGroup?i.a.createElement("div",null,e.state.data.dynamicTags&&e.state.data.dynamicTags.data.length?e.state.data.dynamicTags.data.map(function(e){return i.a.createElement(Gt.a,{key:e.id},e.name)}):""):i.a.createElement("div",null,e.state.data.staticTags&&e.state.data.staticTags.data.length?e.state.data.staticTags.data.map(function(t){return i.a.createElement(Gt.a,{closable:"static"==e.state.activeGroup,key:t.id,onClose:function(){return e.removeTag(t.id)}},t.name)}):""))})))))}}]),t}(i.a.Component);a(578);a(1261);var xs=null,Is=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).sendSms=Object($.a)(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return xs=setInterval(function(){a.setState({countDown:a.state.countDown-1}),0===a.state.countDown&&(clearInterval(xs),a.setState({countDown:60}))},1e3),e.next=3,t=a.state.userValue,ne({url:"/api/backend/auth/send_captcha",method:"post",data:{mobile:t}});case 3:e.sent&&B.a.success("\u77ed\u4fe1\u53d1\u9001\u6210\u529f");case 5:case"end":return e.stop()}var t},e)})),a.onSubmit=function(){if(a.state.userValue&&a.state.password){var e,t=a.state.password;(e={mobile:a.state.userValue,captcha:t},ne({url:"/api/backend/auth/login",method:"post",data:e})).then(function(e){var t,n,i;t="bearer "+e.token,E.a.set(v.tokenKey,t,{expires:v.cookiesExpires}),B.a.success("\u767b\u5f55\u6210\u529f"),(n={},i=e.user.id,ne({url:"/api/backend/admins/".concat(i,"/permissions"),methid:"get",params:n})).then(function(e){var t;t=JSON.stringify(e.data),h.a.set(v.storageUserKey,t)}),setTimeout(function(){a.props.history.replace("/")},500)})}else B.a.error("\u8bf7\u8f93\u5165\u7528\u6237\u540d\u6216\u5bc6\u7801")},a.state={loading:!1,rememberPassword:!1,userValue:"",password:"",popoverUserVisible:!1,popoverPassVisible:!1,countDown:60,public_key:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;this.state.countDown<60&&this.sendSms(),(e={},ne({url:"/api/backend/public_key",method:"get",params:e})).then(function(e){t.setState({public_key:e.public_key})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=i.a.createElement("div",{className:"tips"},i.a.createElement("h4",null,"!"),i.a.createElement("p",null,"\u8bf7\u586b\u5199\u6b64\u5b57\u6bb5"));return i.a.createElement("div",{className:"page-login"},i.a.createElement("div",{className:this.state.show?"loginBox all_trans5 show":"loginBox all_trans5"},i.a.createElement(Nr.a,null,i.a.createElement("div",{className:"title"},i.a.createElement("h3",null),i.a.createElement("span",null,"PineHub")),i.a.createElement("div",{className:"form"},i.a.createElement("div",{className:"user"},i.a.createElement("i",{className:"iconfont",style:{marginBottom:"3px"}},"\ue7ae"),i.a.createElement(Gl.a,{placement:"bottomLeft",content:t,trigger:"click",visible:this.state.popoverUserVisible},i.a.createElement("input",{type:"text",className:"input",placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",value:this.state.userValue,onChange:function(t){e.setState({userValue:t.target.value})},onBlur:function(){e.state.userValue||(e.setState({popoverUserVisible:!0}),setTimeout(function(){e.setState({popoverUserVisible:!1})},2e3))}}))),i.a.createElement("div",{className:"user"},i.a.createElement("i",{className:"iconfont"},"\ue7c9"),i.a.createElement(Gl.a,{placement:"bottomLeft",content:t,trigger:"click",visible:this.state.popoverPassVisible},i.a.createElement("input",{type:"tel",className:"input",readOnly:!this.state.userValue,onKeyDown:function(t){13===t.keyCode&&e.onSubmit()},placeholder:"\u9a8c\u8bc1\u7801",onInput:function(t){e.setState({password:t.target.value})},onBlur:function(){e.state.userValue&&!e.state.password&&(e.setState({popoverPassVisible:!0}),setTimeout(function(){e.setState({popoverPassVisible:!1})},2e3))}})),i.a.createElement(_e.a,{size:"small",type:"primary",disabled:this.state.countDown<60||!this.state.userValue,className:"getCode",onClick:this.sendSms},60===this.state.countDown?"\u53d1\u9001\u9a8c\u8bc1\u7801":this.state.countDown+"s")),i.a.createElement("div",{style:{lineHeight:"40px",width:"100%"}},i.a.createElement(_e.a,{className:"submit-btn",size:"small",type:"primary",loading:this.state.loading,onClick:function(){return e.onSubmit()}},this.state.loading?"\u8bf7\u7a0d\u540e":"\u767b\u5f55"))))),i.a.createElement("div",{className:"company"},"Copyright \xa9 2019 \u5b89\u5fbd\u4eac\u6296\u4e91\u6570\u636e\u79d1\u6280\u6709\u9650\u516c\u53f8"))}}]),t}(i.a.Component);Is=Nr.a.create({})(Is);var js=Object(U.g)(Is),Ts=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).resetPassword=function(){var e;a.state.v_code&&a.state.password_1&&a.state.password_2&&(a.state.password_1==a.state.password_2&&(e={},ne({url:"/api/backend/admins/resetPwd",method:"put",data:e})).then(function(e){}))},a.sendSms=function(){window.timer=setInterval(function(){a.setState({countDown:a.state.countDown-1}),0===a.state.countDown&&(clearInterval(window.timer),a.setState({countDown:60}))},1e3)},a.state={countDown:59,v_code:"",password_1:"",password_2:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.state.countDown<60&&this.sendSms()}},{key:"render",value:function(){var e=this,t=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/;return i.a.createElement("div",{className:"page-login"},i.a.createElement("div",{className:"loginBox"},i.a.createElement(Nr.a,null,i.a.createElement("div",{className:"title"},i.a.createElement("h3",null),i.a.createElement("span",null,"PineHub")),i.a.createElement("div",{className:"form"},i.a.createElement("div",{className:"phone"},"\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u7ed9:",i.a.createElement("h4",null,this.props.location.state.phone)),i.a.createElement("div",{className:"user"},i.a.createElement("i",{className:"iconfont"},"\ue7ae"),i.a.createElement("input",{type:"tel",className:"input",placeholder:"\u9a8c\u8bc1\u7801",onInput:function(t){e.setState({v_code:t.target.value})},onBlur:function(){e.state.v_code||B.a.error("\u8bf7\u8f93\u5165\u60a8\u6536\u5230\u7684\u9a8c\u8bc1\u7801")}}),i.a.createElement(_e.a,{size:"small",type:"primary",disabled:this.state.countDown<60,className:"getCode",onClick:this.sendSms},60===this.state.countDown?"\u91cd\u53d1\u9a8c\u8bc1\u7801":this.state.countDown+"s")),i.a.createElement("div",{className:"user"},i.a.createElement("i",{className:"iconfont"},"\ue7c9"),i.a.createElement("input",{type:"password",className:"input",placeholder:"\u91cd\u8bbe\u60a8\u7684\u5bc6\u7801",autoComplete:"true",onInput:function(t){e.setState({password_1:t.target.value})},onBlur:function(){e.state.password_1?t.test(e.state.password_1)||B.a.error("\u65b0\u5bc6\u7801\u957f\u5ea68-20\u4f4d\uff0c\u5fc5\u987b\u5305\u542b\u5927\u5c0f\u5199\u5b57\u6bcd\u548c\u6570\u5b57"):B.a.error("\u8bf7\u8f93\u5165\u60a8\u7684\u65b0\u5bc6\u7801")}})),i.a.createElement("div",{className:"user"},i.a.createElement("i",{className:"iconfont"},"\ue7c9"),i.a.createElement("input",{type:"password",className:"input",autoComplete:"true",placeholder:"\u518d\u8f93\u5165\u4e00\u904d\u5bc6\u7801",onInput:function(t){e.setState({password_2:t.target.value})},onBlur:function(){e.state.password_2!=e.state.password_1&&B.a.error("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4")}})),i.a.createElement(_e.a,{className:"submit-btn",type:"primary",size:"small",onClick:this.resetPassword},"\u4e0b\u4e00\u6b65")))),i.a.createElement("div",{className:"company"},"Copyright \xa9 2019 \u5b89\u5fbd\u4eac\u6296\u4e91\u6570\u636e\u79d1\u6280\u6709\u9650\u516c\u53f8"))}}]),t}(i.a.Component),Rs=Object(U.g)(Ts);a(1263),a(579);function As(e){return ne({url:"/api/backend/marketing/coupons",method:"get",params:e})}function Ds(e){return ne({url:"/api/backend/marketing/coupons",method:"post",data:e})}function Ps(e,t){return ne({url:"/api/backend/marketing/coupons/".concat(t),method:"delete",params:e})}function Vs(e,t){return ne({url:"/api/backend/marketing/coupons/".concat(t,"/get_off_shelves"),method:"put",data:e})}function Ls(e,t){return ne({url:"/api/backend/marketing/coupons/".concat(t,"/put_on_shelves"),method:"put",data:e})}function Ms(e,t){return ne({url:"/api/backend/marketing/coupons/".concat(t,"/platform_send"),method:"put",data:e})}var Us=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).pagination=function(e,t){console.log(e,"....");var n={limit:10};n.page=e,function(e,t){return ne({url:"/api/backend/marketing/coupons/".concat(t,"/receive_flows"),method:"get",params:e})}(n,t).then(function(e){a.setState({data:e.data,total:e.meta.pagination.total})})},a.showTotal=function(e,t){return"\u5171 ".concat(e,"\u6761\u8bb0\u5f55\uff0c\u7b2c").concat(t[0],"-").concat(t[1]," \u6761\u6570\u636e")},a.onChange=function(e){a.pagination(e,a.state.id),a.setState({current:e})},a.handleCancel=function(){a.props.onCancel()},a.state={data:[],id:"",total:0,current:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){console.log(e),e.couponId&&e.couponId!==this.props.couponId&&(this.setState({id:e.couponId}),this.pagination(1,e.couponId))}},{key:"render",value:function(){return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u9886\u53d6\u8be6\u60c5",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:[{title:"\u4f18\u60e0\u5238\u540d\u79f0",dataIndex:"coupon_name"},{title:"\u4ef7\u503c",dataIndex:"benefit"},{title:"\u9886\u53d6\u65e5\u671f",dataIndex:"received_at"},{title:"\u4f7f\u7528\u65e5\u671f",dataIndex:"used_at"},{title:"\u9886\u53d6\u4eba",dataIndex:"receiver_name"},{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no"},{title:"\u72b6\u6001",dataIndex:"state_desc"}],rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(F.a,{locale:H.a},i.a.createElement(wt.a,{total:this.state.total,showTotal:this.showTotal,showQuickJumper:!0,defaultCurrent:1,pageSize:10,onChange:this.onChange})))))}}]),t}(n.Component),Fs=(a(1264),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={img:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){console.log(e),e.record.qr_code&&this.setState({img:e.record.qr_code})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u4e8c\u7ef4\u7801",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("div",{className:"couponImg"},i.a.createElement("img",{src:this.state.img,alt:""}))))}}]),t}(n.Component)),Gs=(a(1265),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={data:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a,n,i=this;e.id&&(a={},n=e.id,ne({url:"/api/backend/marketing/coupons/".concat(n),method:"get",params:a})).then(function(e){switch(e.data.release_mode){case"MANUAL_RECEIVE":e.data.release_mode_desc="\u4e3b\u52a8\u9886\u53d6";break;case"PLATFORM_SEND":e.data.release_mode_desc="\u76f4\u63a5\u53d1\u9001";break;case"INTEGRAL_EXCHANGE":e.data.release_mode_desc="\u79ef\u5206\u5546\u57ce"}e.data.floor_desc=0===e.data.floor?"\u65e0\u95e8\u69db":"".concat(e.data.floor,"\u5143"),i.setState({data:e.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this.state.data;return i.a.createElement(ge.a,{title:"\u4f18\u60e0\u5238\u8be6\u60c5",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},e.coupon_id&&i.a.createElement("ul",{className:"mainUl couponDetail"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4f18\u60e0\u5238\u540d\u79f0:"),i.a.createElement("span",{className:"limit"},e.name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4f18\u60e0\u5238\u56fe\u7247:"),i.a.createElement("img",{src:e.banner,alt:""})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9886\u53d6\u65b9\u5f0f:"),i.a.createElement("span",{className:"limit"},e.release_mode_desc)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4f18\u60e0\u5238\u5f62\u5f0f:"),i.a.createElement("span",{className:"limit"},"DISCOUNT"===e.type?"\u6298\u6263\u5238":"\u73b0\u91d1\u5238")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6709\u6548\u671f:"),i.a.createElement("span",{className:"limit"},e.valid_term_desc)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4f7f\u7528\u95e8\u69db:"),i.a.createElement("span",{className:"limit"},e.floor_desc)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u4f7f\u7528\u8bf4\u660e:"),i.a.createElement("span",{className:"limit"},e.description)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5907\u6ce8:"),i.a.createElement("span",{className:"limit"},e.remark)),e.applicable_desc.length&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9002\u7528\u8303\u56f4:"),i.a.createElement("span",{className:"limit"},e.applicable_desc[0].value_display)),e.deliverable_desc.length&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53d1\u653e\u8303\u56f4:"),i.a.createElement("span",{className:"limit"},e.deliverable_desc[0].value_display)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53d1\u653e\u603b\u91cf:"),i.a.createElement("span",{className:"limit"},e.issue_count)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u662f\u5426\u4f18\u60e0\u5171\u4eab:"),i.a.createElement("span",{className:"limit"},e.is_sharing_preferential?"\u662f":"\u5426")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u652f\u4ed8\u662f\u5426\u53ef\u7528:"),i.a.createElement("span",{className:"limit"},e.is_code_scan_available?"\u662f":"\u5426"))))}}]),t}(n.Component)),Bs=[{cn:"\u4e3b\u52a8\u9886\u53d6",en:"MANUAL_RECEIVE"},{cn:"\u76f4\u63a5\u53d1\u9001",en:"PLATFORM_SEND"},{cn:"\u79ef\u5206\u5546\u57ce",en:"INTEGRAL_EXCHANGE"},{cn:"\u65b0\u4eba\u4f18\u60e0\u5238",en:"NEW_USER"}];var zs=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",obj_type:"USER"}},function(){a.child.current.pagination(a.child.current.state.current)})},a.renderStatus=function(e){var t,n=a.confirmPopover;if("PLATFORM_SEND"===e.release_mode)switch(e.state){case 0:t=i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return n(Ms,"\u53d1\u9001",e.coupon_id)}},"\u53d1\u9001");break;default:t=""}else switch(e.state){case 0:t=i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return n(Ls,"\u4e0a\u67b6",e.coupon_id)}},"\u4e0a\u67b6");break;case 1:t=i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return n(Vs,"\u4e0b\u67b6",e.coupon_id)}},"\u4e0b\u67b6");break;default:t=""}return t},a.search=function(e){a.setState({api:As,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:As(),paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,obj_type:"USER"})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){ye.forEach(function(a){a.children.forEach(function(a){if(e==a.value){var n={};n.title=a.label,n.dataIndex=e,t.push(n)}})})}),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t})},a.paginationChange=function(e){a.setState({data:e})},a.newCoupon=function(){a.props.history.push({pathname:"/marketing/newCoupon"})},a.showPickUpDetail=function(e){a.setState({pickUpDetailsVisible:!0,couponId:e.coupon_id})},a.hidePickUpDetail=function(){a.setState({pickUpDetailsVisible:!1})},a.confirmPopover=function(e,t,n){var r=a.refresh,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",t,"\u8be5\u4f18\u60e0\u5238\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){e({},n).then(function(e){B.a.success(e.message),r()})},onCancel:function(){}})},a.deleteWarning=function(){var e=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){e.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u8be5\u4f18\u60e0\u5238\u8fd8\u672a\u4e0b\u67b6\uff0c\u8bf7\u5148\u4e0b\u67b6"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small",style:{display:"none"}},onOk:function(){},onCancel:function(){}})},a.deletePopover=function(e){var t=a.deleteWarning,n=a.confirmPopover;"\u76f4\u63a5\u53d1\u653e"===e.release_mode?n(Ps,"\u5220\u9664",e.coupon_id):1===e.state?t():n(Ps,"\u5220\u9664",e.coupon_id)},a.showPromotionCode=function(e){a.setState({promotionCodeVisible:!0,record:e})},a.hidePromotionCode=function(){a.setState({promotionCodeVisible:!1})},a.setMessage=function(){a.props.history.push({pathname:"/marketing/setMarketingMessage",state:{mode:"couponConsumer"}})},a.showCouponDetails=function(e){a.setState({detailsVisible:!0,detailsId:e.coupon_id})},a.hideCouponDetails=function(){a.setState({detailsVisible:!1})};var n=[{title:"\u4f18\u60e0\u5238\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{onClick:function(){return a.showCouponDetails(t)},style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u9886\u53d6\u65b9\u5f0f",dataIndex:"release_mode",render:function(e,t){return i.a.createElement("span",null,function(e){var t;return y.a.map(Bs,function(a){e===a.en&&(t=a.cn)}),t}(e))}},{title:"\u6709\u6548\u671f",dataIndex:"valid_term_desc"},{title:"\u53d1\u653e\u603b\u91cf/\u5269\u4f59\u5e93\u5b58",dataIndex:"issue_count",render:function(e,t){return i.a.createElement("span",null,t.issue_count,"/",t.remain_count)}},{title:"\u9886\u53d6\u4eba\u6570/\u5f20\u6570",dataIndex:"received_count",render:function(e,t){return i.a.createElement("span",null,t.received_member_count,"/",e)}},{title:"\u5df2\u4f7f\u7528",dataIndex:"used_count"},{title:"\u72b6\u6001",dataIndex:"state_desc",render:function(e,t){if("PLATFORM_SEND"===t.release_mode){switch(t.state){case 0:e="\u672a\u53d1\u9001";break;case 1:e="\u53d1\u9001\u4e2d";break;case 2:e="\u5df2\u53d1\u9001";break;default:e=""}return e}return e}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.showPickUpDetail(t)}},"\u9886\u53d6\u8be6\u60c5"),a.renderStatus(t),"MANUAL_RECEIVE"===t.release_mode?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.showPromotionCode(t)}},"\u4e8c\u7ef4\u7801"):"",i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.deletePopover(t)}},"\u5220\u9664"))}}];return a.state={filterVisible:!1,customVisible:!1,api:As,data:[],paginationParams:{logic_conditions:[],search:"",obj_type:"USER"},columns:n,pickUpDetailsVisible:!1,promotionCodeVisible:!1,couponId:"",detailsVisible:!1,detailsId:"",record:{}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e={visible:this.state.pickUpDetailsVisible,onCancel:this.hidePickUpDetail,couponId:this.state.couponId},t={visible:this.state.promotionCodeVisible,onCancel:this.hidePromotionCode,record:this.state.record},a={visible:this.state.detailsVisible,onCancel:this.hideCouponDetails,id:this.state.detailsId};return i.a.createElement("div",{className:"couponTab"},i.a.createElement(Gs,a),i.a.createElement(Us,e),i.a.createElement(Fs,t),i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement("div",{className:"consumerHeader"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u4f18\u60e0\u5238\u540d\u79f0"}),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.setMessage,style:{marginLeft:"20px"}},"\u8bbe\u7f6e\u9ed8\u8ba4\u6a21\u677f\u6d88\u606f")),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{size:"small",className:"addCoupon",onClick:this.newCoupon},i.a.createElement(de,{type:"icon-plus-circle-fill"}),"\u65b0\u5efa\u4f18\u60e0\u5238"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),Hs=Object(U.g)(zs),Ks=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",obj_type:"MERCHANT"}},function(){a.child.current.pagination(a.child.current.state.current)})},a.renderStatus=function(e){var t,n=a.confirmPopover;switch(e.state){case 0:t=i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return n(Ms,"\u53d1\u9001",e.coupon_id)}},"\u53d1\u9001");break;default:t=""}return t},a.search=function(e){a.setState({api:As,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:As,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){ye.forEach(function(a){a.children.forEach(function(a){if(e==a.value){var n={};n.title=a.label,n.dataIndex=e,t.push(n)}})})}),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.setState({columns:t})},a.paginationChange=function(e){a.setState({data:e})},a.newCoupon=function(){a.props.history.push({pathname:"/marketing/newCouponShop"})},a.showPickUpDetail=function(e){a.setState({pickUpDetailsVisible:!0,couponId:e.coupon_id})},a.hidePickUpDetail=function(){a.setState({pickUpDetailsVisible:!1})},a.confirmPopover=function(e,t,n){var r=a.refresh,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",t,"\u8be5\u4f18\u60e0\u5238\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){e({},n).then(function(e){B.a.success("".concat(t,"\u6210\u529f\uff01")),r()})},onCancel:function(){}})},a.setMessage=function(){a.props.history.push({pathname:"/marketing/setMarketingMessage",state:{mode:"couponMerchant"}})},a.showCouponDetails=function(e){a.setState({detailsVisible:!0,detailsId:e.coupon_id})},a.hideCouponDetails=function(){a.setState({detailsVisible:!1})};var n=[{title:"\u4f18\u60e0\u5238\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{onClick:function(){return a.showCouponDetails(t)},style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u4ef7\u503c",dataIndex:"benefit",render:function(e,t){return"".concat(e,"\u5143")}},{title:"\u6709\u6548\u671f",dataIndex:"valid_term_desc"},{title:"\u53d1\u653e\u603b\u91cf/\u5269\u4f59\u5e93\u5b58",dataIndex:"issue_count",render:function(e,t){return i.a.createElement("span",null,t.issue_count,"/",t.remain_count)}},{title:"\u9886\u53d6\u4eba\u6570/\u5f20\u6570",dataIndex:"received_count",render:function(e,t){return i.a.createElement("span",null,t.received_member_count,"/",e)}},{title:"\u5df2\u4f7f\u7528",dataIndex:"used_count"},{title:"\u72b6\u6001",dataIndex:"state_desc",render:function(e,t){switch(t.state){case 0:e="\u672a\u53d1\u9001";break;case 2:e="\u5df2\u53d1\u9001";break;default:e=""}return e}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.showPickUpDetail(t)}},"\u9886\u53d6\u8be6\u60c5"),a.renderStatus(t),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.confirmPopover(Ps,"\u5220\u9664",t.coupon_id)}},"\u5220\u9664"))}}];return a.state={filterVisible:!1,customVisible:!1,api:As,data:[],paginationParams:{logic_conditions:[],search:"",obj_type:"MERCHANT"},columns:n,pickUpDetailsVisible:!1,detailsVisible:!1,detailsId:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e={visible:this.state.pickUpDetailsVisible,onCancel:this.hidePickUpDetail,couponId:this.state.couponId},t={visible:this.state.detailsVisible,onCancel:this.hideCouponDetails,id:this.state.detailsId};return i.a.createElement("div",{className:"couponTab"},i.a.createElement(Gs,t),i.a.createElement(Us,e),i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement("div",{className:"consumerHeader"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u4f18\u60e0\u5238\u540d\u79f0"}),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.setMessage,style:{marginLeft:"20px"}},"\u8bbe\u7f6e\u9ed8\u8ba4\u6a21\u677f\u6d88\u606f")),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{size:"small",className:"addCoupon",onClick:this.newCoupon},i.a.createElement(de,{type:"icon-plus-circle-fill"}),"\u65b0\u5efa\u4f18\u60e0\u5238"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange})))}}]),t}(n.Component),Js=Object(U.g)(Ks),Ws=(a(1266),wr.a.TabPane),Ys=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={key:"USER"},a.callback=function(e){a.setState({key:e})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.state&&this.props.location.state.key||"USER";console.log(t),this.setState({key:t},function(){console.log(e.state)})}},{key:"render",value:function(){return i.a.createElement("div",{className:"coupon"},i.a.createElement(wr.a,{activeKey:this.state.key,onChange:this.callback},i.a.createElement(Ws,{tab:"\u6d88\u8d39\u8005",key:"USER"},i.a.createElement(Hs,null)),i.a.createElement(Ws,{tab:"\u5546\u6237",key:"MERCHANT"},i.a.createElement(Js,null))))}}]),t}(i.a.Component),qs=Object(U.g)(Ys);a(580),a(1267);function Xs(e){return ne({url:"/api/backend/marketing/integral_mall/exchange_records",method:"get",params:e})}function $s(e){return ne({url:"/api/backend/marketing/integral_mall/integral_products",method:"get",params:e})}function Qs(e){return ne({url:"/api/backend/marketing/integral_mall/available/products",method:"get",params:e})}function Zs(e,t){return ne({url:"/api/backend/marketing/integral_mall/".concat(t,"/get_off_shelves"),method:"put",data:e})}function ec(e,t){return ne({url:"/api/backend/marketing/integral_mall/".concat(t),method:"delete",params:e})}var tc=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:1,selectedItems:[],coupons:[],scrollPage:1,totalCount:"",remainCount:"",amount:"",score:"",limitDate:"",limit:"",remain:{remain_count:0}},a.onRadioChange=function(e){console.log("radio checked",e.target.value),a.setState({value:e.target.value})},a.handleCancel=function(){a.props.onCancel()},a.handleChange=function(e){var t,n=a.state.coupons.filter(function(t){return t.id==e})[0];t=n.issue_count,a.setState({selectedItems:e,totalCount:t,remainCount:t,remain:n})},a.tagScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getCoupons(n)}},a.getCoupons=function(e){Qs({limit:10,page:e,searchJson:w({type:"COUPON"})}).then(function(e){e.data.length&&a.setState({coupons:a.state.coupons.concat(e.data)})})},a.onDateChange=function(e,t){a.setState({limitDate:t})},a.checkParams=function(){var e=Object(Ja.a)(a).state;if(e.selectedItems)if(e.amount>e.remain.remain_count)B.a.error("\u53d1\u653e\u603b\u91cf\u4e0d\u53ef\u5927\u4e8e\u4f18\u60e0\u5238\u603b\u91cf");else if(e.score)if(2!=e.value||e.limit){var t=!!e.limitDate,n=1==e.value?1e4:e.limit,i={product_id:a.state.selectedItems,product_type:"COUPON",issue_count:a.state.amount,pv:a.state.score,is_auto_expire:t,expire_date:e.limitDate,receive_limit:n},r={product_id:a.state.selectedItems,product_type:"COUPON",issue_count:a.state.amount,pv:a.state.score,is_auto_expire:t,receive_limit:n},l=t?i:r;a.submit(l)}else B.a.error("\u8bf7\u586b\u5199\u6bcf\u4eba\u9650\u9886\u5f20\u6570");else B.a.error("\u8bf7\u586b\u5199\u5151\u6362\u6240\u9700\u79ef\u5206");else B.a.error("\u8bf7\u5148\u9009\u62e9\u4f18\u60e0\u5238")},a.submit=function(e){(function(e){return ne({url:"/api/backend/marketing/integral_mall/integral_products",method:"post",data:e})})(e).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh("1")}).catch(function(e){})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Qs({limit:10,page:1,searchJson:w({type:"COUPON"})}).then(function(t){e.setState({coupons:t.data})})}},{key:"render",value:function(){var e=this,t=this.state.selectedItems;return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u65b0\u5efa\u79ef\u5206\u5546\u54c1",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9009\u62e9\u4f18\u60e0\u5238:"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:t,className:"couponSelect",onChange:this.handleChange,onPopupScroll:this.tagScroll,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.coupons.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,label:e.name,value:e.id},e.name)}))),i.a.createElement("li",{className:"moreLineLi"},i.a.createElement("div",{className:"moreLine"},i.a.createElement("span",{className:"left"},"\u53d1\u653e\u603b\u91cf:"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.amount,type:"number",onChange:function(t){t.target.value<0||e.setState({amount:t.target.value})},onBlur:function(t){console.log(t.target.value),t.target.value>e.state.totalCount?B.a.error("\u53d1\u653e\u603b\u91cf\u4e0d\u53ef\u5927\u4e8e\u4f18\u60e0\u5238\u603b\u91cf"):e.setState({remainCount:e.state.totalCount-t.target.value})}})),this.state.remainCount?i.a.createElement("span",{className:"extra"},"\u4f18\u60e0\u5238\u603b\u91cf",this.state.remainCount,"\u5f20"):i.a.createElement("span",{className:"extra"},"\u4f18\u60e0\u5238\u603b\u91cf",this.state.remain.issue_count||0,"\u5f20")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5151\u6362\u6240\u9700\u79ef\u5206:"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.score,type:"number",onChange:function(t){e.setState({score:t.target.value})}})),i.a.createElement("li",{className:"i_li moreLineLi"},i.a.createElement("div",{className:"moreLine"},i.a.createElement("span",{className:"left"},"\u81ea\u52a8\u4e0b\u67b6\u65f6\u95f4:"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:this.onDateChange}))),i.a.createElement("span",{className:"extra"},"\u4e0d\u586b\u5219\u4e0d\u81ea\u52a8\u4e0b\u67b6")),i.a.createElement("li",{className:"radio"},i.a.createElement("span",{className:"left"},"\u5151\u6362\u9650\u5236:"),i.a.createElement(mn.a.Group,{onChange:this.onRadioChange,value:this.state.value},i.a.createElement(mn.a,{value:1},"\u65e0\u9650\u5236"),i.a.createElement(mn.a,{value:2},"\u6bcf\u4eba\u9650\u5151",i.a.createElement(Ne.a,{type:"number",disabled:2!=this.state.value,value:this.state.limit,onChange:function(t){e.setState({limit:t.target.value})}}),"\u5f20")))),i.a.createElement("div",{className:"i_save_btn"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.checkParams},"\u4fdd\u5b58"))))}}]),t}(n.Component),ac=G.a.RangePicker,nc=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onChangeTab=function(e){a.setState({activeTab:e},function(){a.refresh(e)})},a.renderStatus=function(e){return"\u5df2\u4e0a\u67b6"===e.state_desc?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.operation(e.id,"off_shelves")}},"\u4e0b\u67b6"):i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return a.operation(e.id,"delete")}},"\u5220\u9664")},a.operation=function(e,t){var n="delete"===t?"\u5220\u9664":"\u4e0b\u67b6",r=a.state.activeTab,l=a.refresh,s="delete"===t?ec:Zs,c=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){c.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",n,"\u8be5\u79ef\u5206\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){s({},e).then(function(e){B.a.success("".concat(n,"\u6210\u529f\uff01")),l(r)})},onCancel:function(){}})},a.paginationChange=function(e){a.setState({data:e})},a.refresh=function(e){a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({type:"COUPON",state:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCreate=function(){a.setState({visible:!0})},a.hideCreate=function(){a.setState({visible:!1})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{exchange_date:t})})},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);e.type="COUPON",e.state=a.state.activeTab,a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.changeSearchValue=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,Object(Y.a)({},t,e.target.value))})},a.clear=function(){a.setState({searchJson:{exchange_date:"",product_name:""}},function(){a.search()})};var n=[{title:"\u4f18\u60e0\u4ef7\u540d\u79f0",dataIndex:"name"},{title:"\u4e0a\u67b6\u65f6\u95f4",dataIndex:"created_at"},{title:"\u6240\u9700\u79ef\u5206",dataIndex:"pv"},{title:"\u53ef\u5151\u6362/\u5df2\u5151\u6362",render:function(e,t){return"".concat(t.available_count,"/").concat(t.received_count)}},{title:"\u72b6\u6001",dataIndex:"state_desc"},{title:"\u64cd\u4f5c",dataIndex:"status",render:function(e,t){return i.a.createElement("div",{className:"1"},a.renderStatus(t))}}];return a.child=i.a.createRef(),a.state={data:[],api:$s,activeTab:"1",columns:n,visible:!1,paginationParams:{searchJson:w({type:"COUPON"})},searchJson:{exchange_date:"",product_name:""}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t={visible:this.state.visible,onCancel:this.hideCreate,refresh:this.refresh};return i.a.createElement(n.Fragment,null,i.a.createElement(tc,t),i.a.createElement("div",{className:"i_banner"},i.a.createElement("div",{className:"i_inputs"},i.a.createElement("span",null,"\u4f18\u60e0\u5238\u540d\u79f0:"),i.a.createElement(Ne.a,{size:"small",placeholder:"\u8bf7\u8f93\u5165\u4f18\u60e0\u5238\u540d\u79f0",value:this.state.searchJson.product_name,onChange:function(t){e.changeSearchValue(t,"product_name")}})),i.a.createElement("div",{className:"i_inputs"},i.a.createElement("span",null,"\u5151\u6362\u65f6\u95f4:"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(ac,{onChange:this.onDateChange}))),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"),i.a.createElement("span",{className:"i_filter",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6")),i.a.createElement("ul",{className:"i_tabs"},[{name:"\u5df2\u4e0a\u67b6",key:1},{name:"\u5df2\u4e0b\u67b6",key:2},{name:"\u8fc7\u671f\u4e0b\u67b6",key:3}].map(function(t,a){return i.a.createElement("li",{key:t.key,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t.key)}},t.name)}),i.a.createElement(_e.a,{size:"small",onClick:this.showCreate},i.a.createElement(de,{type:"icon-plus-circle-fill"}),"\u65b0\u5efa\u79ef\u5206\u5546\u54c1")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange,text:"\u6761\u6570\u636e"})))}}]),t}(n.Component),ic=G.a.RangePicker,rc=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{exchanged_at:t})})},a.refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);e.type="COUPON",a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.changeSearchValue=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,Object(Y.a)({},t,e.target.value))})},a.clear=function(){a.setState({searchJson:{exchanged_at:"","user.nickname":"","user.mobile":"",product_name:""}},function(){a.search()})};return a.child=i.a.createRef(),a.state={api:Xs,data:[],columns:[{title:"\u5151\u6362\u65f6\u95f4",dataIndex:"exchanged_at"},{title:"\u4f18\u60e0\u5238\u540d\u79f0",dataIndex:"product_name"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"nickname"},{title:"\u7528\u6237\u624b\u673a\u53f7",dataIndex:"mobile"},{title:"\u652f\u4ed8\u79ef\u5206",dataIndex:"pv"}],paginationParams:{searchJson:w({type:"COUPON"})},searchJson:{exchanged_at:"","user.nickname":"","user.mobile":"",product_name:""}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"i_banner"},i.a.createElement("div",{className:"i_inputs needMargin"},i.a.createElement("span",null,"\u7528\u6237\u6635\u79f0:"),i.a.createElement(Ne.a,{size:"small",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u6635\u79f0",value:this.state.searchJson["user.nickname"],onChange:function(t){e.changeSearchValue(t,"user.nickname")}})),i.a.createElement("div",{className:"i_inputs needMargin"},i.a.createElement("span",null,"\u7528\u6237\u624b\u673a\uff1a"),i.a.createElement(Ne.a,{size:"small",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u624b\u673a",value:this.state.searchJson["user.mobile"],onChange:function(t){e.changeSearchValue(t,"user.mobile")}})),i.a.createElement("div",{className:"i_inputs"},i.a.createElement("span",null,"\u5151\u6362\u65f6\u95f4:"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(ic,{onChange:this.onDateChange}))),i.a.createElement("div",{className:"i_inputs"},i.a.createElement("span",null,"\u4f18\u60e0\u5238\u540d\u79f0:"),i.a.createElement(Ne.a,{size:"small",placeholder:"\u8bf7\u8f93\u5165\u4f18\u60e0\u5238\u540d\u79f0",value:this.state.searchJson.product_name,onChange:function(t){e.changeSearchValue(t,"product_name")}})),i.a.createElement(_e.a,{size:"small",type:"primary",className:"i_btn",onClick:this.search},"\u641c\u7d22"),i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa"),i.a.createElement("span",{className:"i_filter",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),lc=wr.a.TabPane,sc=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).callback=function(e){console.log(e)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"integral"},i.a.createElement(wr.a,{defaultActiveKey:"1",onChange:this.callback},i.a.createElement(lc,{tab:"\u5151\u6362\u7ba1\u7406",key:"1"},i.a.createElement(nc,null)),i.a.createElement(lc,{tab:"\u5151\u6362\u8bb0\u5f55",key:"2"},i.a.createElement(rc,null)))))}}]),t}(n.Component),cc=(a(1268),a(1269),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).customMessage=function(e){a.props.history.push({pathname:"/marketing/customWeChatMessage",state:{item:e}})},a.paginationChange=function(e){a.setState({data:e})},a.refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.checkSyncWeChat=function(){var e;(e={},ne({url:"/api/backend/wechat/mp/template_messages/sync/check",method:"get",params:e})).then(function(e){"sync_end"===e.sync_state&&(window.clearInterval(a.timer),a.setState({btnText:e.message,loading:!1}),a.refresh(),window.setTimeout(function(){a.setState({btnText:"\u540c\u6b65\u5c0f\u7a0b\u5e8f\u5fae\u4fe1\u6a21\u677f\u6d88\u606f\u5e93"})},2e3))}).catch(function(e){})},a.syncWeChat=function(){var e;(e={},ne({url:"/api/backend/wechat/mp/template_messages/sync",method:"get",params:e})).then(function(e){"sync"!==e.sync_state&&"accepted"!==e.sync_state||(a.setState({loading:!0,btnText:e.message}),a.timer=window.setInterval(function(){a.checkSyncWeChat()},1e3))}).catch(function(e){})},a.switchChange=function(e,t){(t?Dn:Pn)({},e.id).then(function(e){B.a.success(e.message)}).catch(function(e){})},a.state={data:[],loading:!1,btnText:"\u540c\u6b65\u5c0f\u7a0b\u5e8f\u5fae\u4fe1\u6a21\u677f\u6d88\u606f\u5e93",api:An,checked:!1},a.child=i.a.createRef(),a.timer=null,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=this.state.data;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"wechatHeader"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.syncWeChat,loading:this.state.loading},this.state.btnText)),i.a.createElement("ul",{className:"m_wechat"},t.map(function(t){return i.a.createElement("li",{key:t.id,className:"m_wechat_li"},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,t.title),i.a.createElement(ke.a,{defaultChecked:t.is_open,onChange:function(a){return e.switchChange(t,a)}})),i.a.createElement("div",{className:"ulBody",onClick:function(){return e.customMessage(t)}},i.a.createElement("h4",null,t.inner_title),i.a.createElement("ul",null,t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))})),i.a.createElement("div",{className:"pagination",style:{visibility:t.length?"visible":"hidden"}},i.a.createElement(xt,{api:this.state.api,ref:this.child,valChange:this.paginationChange})))}}]),t}(n.Component)),oc=Object(U.g)(cc),uc=(a(1270),a(1271),Q.a.Option),mc=Ne.a.TextArea,dc=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={obj_type:"USER",biz_type:0,name:"",content:"",remark:"",is_auto_send:0,code:""},a.handleCancel=function(){a.props.onCancel()},a.submit=function(){console.log(a.props.mode);var e=a.state;"export"!==a.props.mode||e.code?e.name?e.content?e.remark?a.create(e):B.a.error("\u8bf7\u586b\u5199\u77ed\u4fe1\u7533\u8bf7\u8bf4\u660e"):B.a.error("\u8bf7\u586b\u5199\u77ed\u4fe1\u6a21\u677f\u5185\u5bb9"):B.a.error("\u8bf7\u586b\u5199\u77ed\u4fe1\u6a21\u677f\u540d\u79f0"):B.a.error("\u8bf7\u586b\u5199\u77ed\u4fe1\u6a21\u677fcode")},a.create=function(e){("export"===a.props.mode?Jn:Fn)(Object(be.a)({},e)).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.typeChange=function(e,t){a.setState(Object(Y.a)({},e,t))},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u65b0\u5efa\u6a21\u677f",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53d1\u9001\u5bf9\u8c61:"),i.a.createElement(Q.a,{value:this.state.obj_type,onChange:function(t){return e.typeChange("obj_type",t)},className:"sms_select"},i.a.createElement(uc,{value:"USER"},"\u7528\u6237"),i.a.createElement(uc,{value:"MERCHANT"},"\u5546\u5bb6"))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53d1\u9001\u7c7b\u578b:"),i.a.createElement(Q.a,{value:this.state.biz_type,onChange:function(t){return e.typeChange("biz_type",t)},className:"sms_select"},i.a.createElement(uc,{value:0},"\u9a8c\u8bc1\u7801"),i.a.createElement(uc,{value:1},"\u77ed\u4fe1\u901a\u77e5"),i.a.createElement(uc,{value:2},"\u63a8\u5e7f\u77ed\u4fe1"),i.a.createElement(uc,{value:3},"\u56fd\u9645/\u6e2f\u6fb3\u53f0\u6d88\u606f"))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6a21\u677f\u540d\u79f0:"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.name,maxLength:30,onChange:function(t){e.setState({name:t.target.value})},placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0 \u4e0d\u8d85\u8fc730\u4e2a\u5b57\u7b26"})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u77ed\u4fe1\u5185\u5bb9:"),i.a.createElement(mc,{className:"liTextArea",rows:3,value:this.state.content,onChange:function(t){e.setState({content:t.target.value})},placeholder:"\u53d8\u91cf\u683c\u5f0f:${code};\r\n\u793a\u4f8b:\u60a8\u7684\u9a8c\u8bc1\u7801\u4e3a:${code},\u8be5\u9a8c\u8bc1\u78015\u5206\u949f\u5185\u6709\u6548\uff0c\u8bf7\u52ff\u6cc4\u9732\u4e0e\u4ed6\u4eba\u3002"})),"export"===this.props.mode&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6a21\u677fcode:"),i.a.createElement(Ne.a,{className:"liTextArea",value:this.state.code,onChange:function(t){e.setState({code:t.target.value})},placeholder:"\u8bf7\u8f93\u5165\u5df2\u6709\u77ed\u4fe1\u6a21\u677fcode"})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7533\u8bf7\u8bf4\u660e:"),i.a.createElement(mc,{className:"liTextArea",rows:3,value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})},placeholder:"\u8bf7\u63cf\u8ff0\u60a8\u7684\u4e1a\u52a1\u4f7f\u7528\u573a\u666f"})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53d1\u9001\u65b9\u5f0f:"),i.a.createElement(Q.a,{value:this.state.is_auto_send,onChange:function(t){return e.typeChange("is_auto_send",t)},className:"sms_select"},i.a.createElement(uc,{value:0},"\u624b\u52a8")))),i.a.createElement("div",{className:"i_save_btn"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.submit},"\u4fdd\u5b58")))}}]),t}(n.Component),pc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.refresh=function(){a.setState({paginationParams:{searchJson:w({obj_type:a.state.role})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.changeRole=function(e){a.setState({role:e,paginationParams:Object(be.a)({},a.state.paginationParams,{obj_type:e})},function(){a.refresh()})},a.goRecord=function(){a.props.history.push({pathname:"/marketing/sendOutRecord"})},a.showNew=function(e){a.setState({visible:!0,mode:e})},a.hideVisible=function(){a.setState({visible:!1})},a.switchChange=function(e,t){(t?Mn:Un)({},e.id).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.state={role:"USER",data:[],api:Gn,paginationParams:{searchJson:w({obj_type:"USER"})},visible:!1,mode:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state.role,a=[{title:"\u6a21\u677f\u540d\u79f0",dataIndex:"name"},{title:"\u6a21\u677f\u7c7b\u578b",dataIndex:"biz_type"},{title:"\u77ed\u4fe1\u5185\u5bb9",dataIndex:"content",render:function(e,t){return i.a.createElement("span",{className:"m_message_box"},i.a.createElement("span",{className:"m_content"},e),i.a.createElement("div",{className:"popopver"},i.a.createElement(Gl.a,{content:e,placement:"bottom",trigger:"hover"},i.a.createElement(de,{type:"icon-eye-fill"}))))}},{title:"\u53d1\u9001\u65b9\u5f0f",render:function(e,t){return t.is_auto_send?"\u81ea\u52a8":"\u624b\u52a8"}},{title:"\u53d1\u9001\u89c4\u5219",dataIndex:"spec"},{title:"\u72b6\u6001",dataIndex:"state"},{title:"\u5931\u8d25\u539f\u56e0",render:function(e,t){return t.rejected_reason?t.rejected_reason:"\u65e0"}},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement(ke.a,{checked:a.is_open,onChange:function(t){return e.switchChange(a,t)}})}}],n={visible:this.state.visible,onCancel:this.hideVisible,refresh:this.refresh,mode:this.state.mode};return i.a.createElement("div",{className:"m_sms"},i.a.createElement(dc,n),i.a.createElement("div",{className:"header"},i.a.createElement("div",{className:"left"},i.a.createElement("p",null,i.a.createElement("span",{className:"USER"===t?"active":"",onClick:function(){return e.changeRole("USER")}},"\u7528\u6237\u77ed\u4fe1\u9b54\u677f"),i.a.createElement("span",{className:"MERCHANT"===t?"active":"",onClick:function(){return e.changeRole("MERCHANT")}},"\u5546\u5bb6\u77ed\u4fe1\u6a21\u677f")),i.a.createElement("h5",null,"\u77ed\u4fe1\u5269\u4f59\u6761\u657010000\u6761")),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showNew("export")},style:{marginRight:"10px"}},i.a.createElement(de,{type:"icon-plus-circle-fill"}),"\u5bfc\u5165\u5df2\u6709\u6a21\u677f"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showNew("create")}},i.a.createElement(de,{type:"icon-plus-circle-fill"}),"\u65b0\u5efa\u6a21\u677f"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.goRecord},"\u53d1\u9001\u8bb0\u5f55"))),i.a.createElement("div",{className:"chart u_chart noMargin"},i.a.createElement(ve.a,{columns:a,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),hc=Object(U.g)(pc),fc=wr.a.TabPane,Ec=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).callback=function(){},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"m_message"},i.a.createElement(wr.a,{defaultActiveKey:"1",onChange:this.callback},i.a.createElement(fc,{tab:"\u5fae\u4fe1\u6d88\u606f",key:"1"},i.a.createElement(oc,null)),i.a.createElement(fc,{tab:"\u77ed\u4fe1\u6a21\u677f",key:"2"},i.a.createElement(hc,null))))}}]),t}(n.Component);a(1272),a(1273);function vc(e){return ne({url:"/api/backend/marketing/deposit_cards",method:"get",params:e})}function _c(e){return ne({url:"/api/backend/marketing/deposit_cards/bought/records",method:"get",params:e})}function gc(e){return ne({url:"/api/backend/marketing/deposit_cards/bought/statistics",method:"get",params:e})}function bc(e,t){return ne({url:"/api/backend/marketing/deposit_cards/".concat(t,"/disable"),method:"put",data:e})}function yc(e,t){return ne({url:"/api/backend/marketing/deposit_cards/".concat(t,"/enable"),method:"put",data:e})}function Cc(e){return ne({url:"/api/backend/marketing/deposit_cards/mode/enable",method:"put",data:e})}function kc(e){return ne({url:"/api/backend/marketing/deposit_cards/mode/disable",method:"put",data:e})}var Sc=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",price:"",gift_amount:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){if(a.state.name)if(a.state.price)if(a.state.gift_amount){var e=a.state;e.obj_type=a.props.role,a.save(e)}else B.a.error("\u8bf7\u586b\u5199\u8d60\u9001\u91d1\u989d");else B.a.error("\u8bf7\u586b\u5199\u50a8\u503c\u91d1\u989d");else B.a.error("\u8bf7\u586b\u5199\u50a8\u503c\u5361\u540d\u79f0")},a.save=function(e){var t;(t=e,ne({url:"/api/backend/marketing/deposit_cards",method:"post",params:t})).then(function(e){B.a.success(e.message),a.props.onCancel(),a.props.refresh(),a.setState({name:"",price:"",gift_amount:""})}).catch(function(e){})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u65b0\u5efa\u50a8\u503c\u5361",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u50a8\u503c\u540d\u79f0:"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u50a8\u503c\u91d1\u989d\uff08\u5143\uff09:"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.price,onChange:function(t){e.setState({price:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8d60\u9001\u91d1\u989d\uff08\u5143\uff09:"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.gift_amount,onChange:function(t){e.setState({gift_amount:t.target.value})}}))),i.a.createElement("div",{className:"us_save_btn"},i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.handleSubmit},"\u4fdd\u5b58"))))}}]),t}(n.Component),Oc=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).handleCancel=function(){a.props.onCancel()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u63a8\u5e7f\u7801",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1}))}}]),t}(n.Component),Nc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({paginationParams:{searchJson:w({obj_type:a.state.role})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.changeRole=function(e){a.setState({role:e},function(){a.refresh()})},a.storeIsOpen=function(e){a.setState({storeIsOpen:e}),(e?Cc:kc)({}).then(function(e){B.a.success("\u50a8\u503c\u529f\u80fd".concat(e.message))}).catch(function(e){})},a.onSwitchChange=function(e,t){(t?yc:bc)({},e.id).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.showNewStoreCard=function(){a.setState({newVisible:!0})},a.hideNewStoreCard=function(){a.setState({newVisible:!1})},a.showPromotionCode=function(){a.setState({promotionCodeVisible:!0})},a.hidePromotionCode=function(){a.setState({promotionCodeVisible:!1})},a.goStoreRecord=function(){a.props.history.push({pathname:"/marketing/storeRecord"})},a.warningPopover=function(){var e=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){e.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u8be5\u50a8\u503c\u5361\u5904\u4e8e\u5f00\u542f\u72b6\u6001\uff0c\u4e0d\u53ef\u5220\u9664\uff0c\u8bf7\u5148\u7981\u7528\u8be5\u50a8\u503c\u5361\u3002"),okText:"\u77e5\u9053\u4e86",okButtonProps:{size:"small"},cancelButtonProps:{size:"small",style:{display:"none"}},onOk:function(){},onCancel:function(){}})},a.deletePopover=function(e){var t=a.refresh,n=e,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u50a8\u503c\u5361\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var e,a;(e={},a=n.id,ne({url:"/api/backend/marketing/deposit_cards/".concat(a),method:"delete",params:e})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})},onCancel:function(){}})},a.paginationChange=function(e){a.setState({data:e})},a.state={role:"USER",storeIsOpen:!0,newVisible:!1,promotionCodeVisible:!1,data:[],api:vc,paginationParams:{searchJson:w({obj_type:"USER"})}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u50a8\u503c\u5361\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u50a8\u503c\u91d1\u989d",dataIndex:"price"},{title:"\u8d60\u9001\u91d1\u989d",dataIndex:"gift_amount"},{title:"\u65b0\u5efa\u65f6\u95f4",dataIndex:"created_at"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",{className:"usOperation"},i.a.createElement(ke.a,{checked:a.is_open,onChange:function(t){return e.onSwitchChange(a,t)}}),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:a.is_open?e.warningPopover:function(){return e.deletePopover(a)}},"\u5220\u9664"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return e.showPromotionCode(a)}},"\u63a8\u5e7f\u7801"))}}],a=this.state,r=a.role,l=a.storeIsOpen,s={visible:this.state.newVisible,onCancel:this.hideNewStoreCard,role:r,refresh:this.refresh},c={visible:this.state.promotionCodeVisible,onCancel:this.hidePromotionCode};return i.a.createElement(n.Fragment,null,i.a.createElement(Sc,s),i.a.createElement(Oc,c),i.a.createElement("div",{className:"usHeader"},i.a.createElement("span",{className:"USER"===r?"active":"",onClick:function(){return e.changeRole("USER")}},"\u6d88\u8d39\u8005"),i.a.createElement("span",{className:"MERCHANT"===r?"active":"",onClick:function(){return e.changeRole("MERCHANT")}},"\u5546\u6237")),i.a.createElement("div",{className:"usBody"},i.a.createElement("div",{className:"top"},i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.goStoreRecord},"\u50a8\u503c\u8bb0\u5f55"),i.a.createElement(_e.a,{size:"small",onClick:this.showNewStoreCard},i.a.createElement(de,{type:"icon-plus-circle-fill"})," \u65b0\u5efa\u50a8\u503c\u5361")),i.a.createElement("div",null,"\u50a8\u503c\u529f\u80fd:",i.a.createElement("span",{className:l?"active":"",onClick:function(){return e.storeIsOpen(!0)}},"\u5f00\u542f"),i.a.createElement("span",{className:l?"":"active",onClick:function(){return e.storeIsOpen(!1)}},"\u5173\u95ed"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component),wc=(a(1274),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.userScroll=function(e){var t=a.state,n=t.scrollPage;if(n<t.total_page){e.persist();var i=e.target;if(i.scrollTop+i.offsetHeight===i.scrollHeight){var r=n+1;a.setState({scrollPage:r}),a.getUserList(r)}}},a.getUserList=function(e){a.setState({spinState:!0},function(){var t=a.state.userInputValue;tr({limit:10,page:e,searchJson:w({logic_conditions:t?{logic:"and",conditions:[{logic:"or",conditions:[{key:"user_mobile",operation:"like",value:t},{key:"user_wx_name",operation:"like",value:t}]}]}:{}})}).then(function(e){a.setState({total_page:e.meta.pagination.total_pages}),e.data.length?a.setState({users:a.state.users.concat(e.data)},function(){a.setState({spinState:!1})}):a.setState({loading:!1})}).catch(function(e){a.setState({spinState:!1})})})},a.state={selectedItems:[],users:[],scrollPage:1,userInputValue:null,spinState:!1,total_page:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;tr({limit:10,page:1}).then(function(t){e.setState({users:t.data})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedItems,n=t.users,r=t.spinState;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",mode:"tags",value:a,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.userScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",notFoundContent:r?"loading":"\u6682\u65e0\u6570\u636e",filterOption:!1,onSearch:Object(b.debounce)(function(t){t!==e.state.userInputValue&&e.setState({users:[],userInputValue:t},function(){e.getUserList(0)})},500)},n.map(function(e,t){return i.a.createElement(Q.a.Option,{key:t,label:e.nickname+"("+e.mobile+")",value:e.id+""},e.nickname+"("+e.mobile+")")}))}}]),t}(n.Component)),xc=(n.Component,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.goodScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getUserList(n)}},a.getUserList=function(e){Dt({limit:10,page:e}).then(function(e){e.data.length&&a.setState({goods:a.state.goods.concat(e.data)})}).catch(function(e){})},a.state={selectedItems:[],goods:[],scrollPage:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Dt({limit:10,page:1}).then(function(t){e.setState({goods:t.data})})}},{key:"render",value:function(){var e=this.state.selectedItems;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u7528\u6237\u7fa4\u7ec4",mode:"tags",value:e,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.goodScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.goods.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_id+"",label:e.name,value:e.product_id+""},e.name)}))}}]),t}(n.Component)),Ic=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.state={selectedItems:[],goods:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;He({}).then(function(t){e.setState({goods:t})})}},{key:"render",value:function(){var e=this.state.selectedItems;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u7528\u6237\u7fa4\u7ec4",mode:"tags",value:e,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.goodScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.goods.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)}))}}]),t}(n.Component),jc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.goodScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getUserList(n)}},a.getUserList=function(e){gt({limit:10,page:e}).then(function(e){e.data.length&&a.setState({goods:a.state.goods.concat(e.data)})}).catch(function(e){})},a.state={selectedItems:[],goods:[],scrollPage:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;gt({limit:10,page:1}).then(function(t){e.setState({goods:t.data})})}},{key:"render",value:function(){var e=this.state.selectedItems;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u7528\u6237\u7fa4\u7ec4",mode:"tags",value:e,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.goodScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.goods.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)}))}}]),t}(n.Component),Tc=G.a.RangePicker,Rc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onRadioChange=function(e,t){a.setState({radioValue:Object(be.a)({},a.state.radioValue,Object(Y.a)({},e,t.target.value))})},a.onDateChange=function(e,t){a.setState({radioValue:Object(be.a)({},a.state.radioValue,{valid_at:t[0],invalid_at:t[1]})})},a.onCheckBoxChange=function(e){console.log("checked = ".concat(e))},a.check=function(){var e=a.state.radioValue;if(a.banner.current.state.imgUrl)if(e.banner=a.banner.current.state.imgUrl,e.name)if(e.cash||e.discount)if("DISCOUNT"===e.type&&e.discount>100&&e.discount<0)B.a.error("\u6298\u6263\u8303\u56f4\u4e3a0-100");else if(e.benefit="CASH"===e.type?e.cash:e.discount,"DATE_TYPE_FIX_TERM_TODAY"===e.valid_date_type?e.fixed_begin_term=0:"DATE_TYPE_FIX_TERM_TOMORROW"===e.valid_date_type&&(e.fixed_begin_term=1),"DATE_TYPE_FIX_TIME_RANGE"!==e.valid_date_type||e.valid_at||e.invalid_at)if(0!==e.fixed_begin_term||e.fixed_term_today)if(1!==e.fixed_begin_term||e.fixed_term_tomorrow)if(e.fixed_term=0===e.fixed_begin_term?parseInt(e.fixed_term_today):parseInt(e.fixed_term_tomorrow),e.valid_date_type="DATE_TYPE_FIX_TIME_RANGE"===e.valid_date_type?"DATE_TYPE_FIX_TIME_RANGE":"DATE_TYPE_FIX_TERM",1!==e.floor||e.floorValue)if(e.floor=0===e.floor?0:e.floorValue,e.description)if(e.remark){var t={};switch(a.state.radioValue.productType){case"ALL":t.strategy="COUPON_USE_IN_ALL_PRODUCT_SET";break;case"PARTIAL_AVAILABLE_ID":t.strategy="COUPON_USE_IN_PRODUCT_SET",t.value=a.ableGood.current.state.selectedItems;break;case"PARTIAL_FORBIDDEN":t.strategy="COUPON_USE_NOT_IN_PRODUCT_SET",t.value=a.disableGood.current.state.selectedItems;break;case"PARTIAL_AVAILABLE_CATE":t.strategy="COUPON_USE_IN_PRODUCT_CATEGORY_SET",t.value=a.ableGoodCate.current.state.selectedItems;break;case"PARTIAL_AVAILABLE_GROUP":t.strategy="COUPON_USE_IN_PRODUCT_GROUP_SET",t.value=a.ableGoodGroup.current.state.selectedItems}if("COUPON_USE_IN_ALL_PRODUCT_SET"===t.strategy||t.value&&t.value.length){var n={};switch(a.state.radioValue.userType){case"ALL":n.strategy="COUPON_PUT_IN_ALL_USER_SET";break;case"PARTIAL_AVAILABLE_ID":n.strategy="COUPON_PUT_IN_USER_SET",n.value=a.ableUser.current.state.selectedItems;break;case"PARTIAL_FORBIDDEN":n.strategy="COUPON_PUT_IN_USER_SET",n.value=a.disableUser.current.state.selectedItems;break;case"PARTIAL_AVAILABLE_GROUP":n.strategy="COUPON_PUT_IN_USER_GROUP_SET",n.value=a.ableUserGroup.current.state.selectedItems;break;case"PARTIAL_FORBIDDEN_GROUP":n.strategy="COUPON_PUT_NOT_IN_USER_GROUP_SET",n.value=a.disableUserGroup.current.state.selectedItems}"INTEGRAL_EXCHANGE"===e.release_mode||"COUPON_PUT_IN_ALL_USER_SET"===n.strategy||n.value&&n.value.length?(e.use_conditions=[],e.put_conditions=[],e.use_conditions.push(t),e.put_conditions.push(n),"PLATFORM_SEND"===e.release_mode||"NEW_USER"===e.release_mode||e.issue_count?(e.obj_type="USER",a.submit(e)):B.a.error("\u8bf7\u8f93\u5165\u53d1\u653e\u603b\u91cf")):B.a.error("\u8bf7\u9009\u62e9\u7528\u6237\u6216\u7528\u6237\u7ec4")}else B.a.error("\u8bf7\u586b\u5199\u5546\u54c1\u6216\u5546\u54c1\u7ec4")}else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u5907\u6ce8");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u4f7f\u7528\u8bf4\u660e");else B.a.error("\u8bf7\u586b\u5199\u95e8\u69db\u503c");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u6709\u6548\u671f\u5929\u6570");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u6709\u6548\u671f\u5929\u6570");else B.a.error("\u8bf7\u9009\u62e9\u4f18\u60e0\u5238\u6709\u6548\u671f\u8303\u56f4");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u529b\u5ea6");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u540d\u79f0");else B.a.error("\u8bf7\u9009\u62e9\u4f18\u60e0\u5238\u56fe\u7247")},a.submit=function(e){Ds(Object(be.a)({},e)).then(function(e){B.a.success(e.message),window.setTimeout(function(){a.props.history.push({pathname:"/marketing",state:{key:"USER"}})},2e3)}).catch(function(e){})},a.couponValidDate=function(){var e=a.state.radioValue,t="";switch(e.valid_date_type){case"DATE_TYPE_FIX_TERM_TOMORROW":t="\u4ece\u9886\u5230\u5238\u6b21\u65e5\u5f00\u59cb".concat(e.fixed_term_tomorrow||0,"\u5929");break;case"DATE_TYPE_FIX_TERM_TODAY":t="\u4ece\u9886\u5230\u5238\u5f53\u65e5\u5f00\u59cb".concat(e.fixed_term_today||0,"\u5929");break;case"DATE_TYPE_FIX_TIME_RANGE":t=e.valid_at?"".concat(e.valid_at,"-").concat(e.invalid_at):"\u6682\u65e0";break;default:t="\u6682\u65e0"}return t},a.releaseType=function(){var e="";switch(a.state.radioValue.release_mode){case"MANUAL_RECEIVE":e="\u4e3b\u52a8\u9886\u53d6";break;case"PLATFORM_SEND":e="\u76f4\u63a5\u53d1\u9001";break;case"INTEGRAL_EXCHANGE":e="\u79ef\u5206\u5546\u57ce"}return e},a.renderGoods=function(){var e="";switch(a.state.radioValue.productType){case"ALL":e="\u5168\u90e8\u5546\u54c1";break;case"PARTIAL_AVAILABLE_ID":e="\u6307\u5b9a\u5546\u54c1\u53ef\u7528";break;case"PARTIAL_FORBIDDEN":e="\u6307\u5b9a\u5546\u54c1\u4e0d\u53ef\u7528";break;case"PARTIAL_AVAILABLE_CATE":e="\u9009\u62e9\u5546\u54c1\u5206\u7c7b";break;case"PARTIAL_AVAILABLE_GROUP":e="\u9009\u62e9\u5546\u54c1\u7ec4"}return e},a.renderReleaseRange=function(){var e="";switch(a.state.radioValue.userType){case"ALL":e="\u6240\u6709\u7528\u6237";break;case"PARTIAL_AVAILABLE_ID":e="\u6307\u5b9a\u7528\u6237\u53ef\u7528";break;case"PARTIAL_FORBIDDEN_ID":e="\u6307\u5b9a\u7528\u6237\u4e0d\u53ef\u7528";break;case"PARTIAL_AVAILABLE_GROUP":e="\u6307\u5b9a\u7fa4\u7ec4\u53ef\u7528";break;case"PARTIAL_FORBIDDEN_GROUP":e="\u6307\u5b9a\u7fa4\u7ec4\u4e0d\u53ef\u7528"}return e},a.state={radioValue:{valid_date_type:"DATE_TYPE_FIX_TIME_RANGE",type:"CASH",cash:"",discount:"",floor:0,floorValue:"",productType:"ALL",userType:"ALL",is_sharing_preferential:!0,is_code_scan_available:!1,release_mode:"MANUAL_RECEIVE",name:"",valid_at:"",invalid_at:"",fixed_term_today:"",fixed_term_tomorrow:"",description:"",issue_count:"",get_limit_days:"",get_limit:""},userGroup:[],goods:[],goodsGroup:[],goodsCate:[]},a.ableUser=i.a.createRef(),a.disableUser=i.a.createRef(),a.ableUserGroup=i.a.createRef(),a.disableUserGroup=i.a.createRef(),a.ableGood=i.a.createRef(),a.disableGood=i.a.createRef(),a.ableGoodGroup=i.a.createRef(),a.ableGoodCate=i.a.createRef(),a.banner=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state.radioValue;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"c_header"},i.a.createElement("span",null,"\u65b0\u5efa\u4f18\u60e0\u5238"),i.a.createElement(_e.a,{type:"default",size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"c_body"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u9886\u53d6\u65b9\u5f0f:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("release_mode",t)},value:t.release_mode},i.a.createElement(mn.a,{value:"MANUAL_RECEIVE"},"\u4e3b\u52a8\u9886\u53d6"),i.a.createElement(mn.a,{value:"PLATFORM_SEND"},"\u76f4\u63a5\u53d1\u9001"),i.a.createElement(mn.a,{value:"INTEGRAL_EXCHANGE"},"\u79ef\u5206\u5546\u57ce"),i.a.createElement(mn.a,{value:"NEW_USER"},"\u65b0\u4eba\u4f18\u60e0\u5238"))),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5238\u56fe\u7247:"),i.a.createElement(ta,{ref:this.banner})),i.a.createElement("li",{className:"normalLi"},i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5238\u540d\u79f0:"),i.a.createElement(Ne.a,{value:t.name,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{name:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5f62\u5f0f:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("type",t)},value:t.type},i.a.createElement(mn.a,{value:"CASH"},"\u73b0\u91d1\u5238",i.a.createElement(Ne.a,{type:"number",value:t.cash,onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{cash:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5143")),i.a.createElement(mn.a,{value:"DISCOUNT"},"\u6298\u6263\u5238",i.a.createElement(Ne.a,{type:"number",value:t.discount,onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{discount:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u6298")))),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u6709\u6548\u671f:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("valid_date_type",t)},value:t.valid_date_type},"NEW_USER"!==this.state.radioValue.release_mode&&i.a.createElement(mn.a,{value:"DATE_TYPE_FIX_TIME_RANGE"},"\u56fa\u5b9a\u65e5\u671f",i.a.createElement(F.a,{locale:H.a},i.a.createElement(Tc,{onChange:this.onDateChange}))),i.a.createElement(mn.a,{value:"DATE_TYPE_FIX_TERM_TODAY"},"\u9886\u5230\u5238\u5f53\u65e5\u5f00\u59cb",i.a.createElement(Ne.a,{value:t.fixed_term_today,type:"number",onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{fixed_term_today:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5929")),i.a.createElement(mn.a,{value:"DATE_TYPE_FIX_TERM_TOMORROW"},"\u9886\u5230\u5238\u6b21\u65e5\u5f00\u59cb",i.a.createElement(Ne.a,{value:t.fixed_term_tomorrow,type:"number",onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{fixed_term_tomorrow:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5929")))),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f7f\u7528\u95e8\u69db:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("floor",t)},value:t.floor},i.a.createElement(mn.a,{value:0},"\u65e0\u95e8\u69db"),i.a.createElement(mn.a,{value:1},"\u6ee1\u8db3",i.a.createElement(Ne.a,{type:"number",value:t.floorValue,onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{floorValue:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5143")))),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f7f\u7528\u8bf4\u660e:"),i.a.createElement(Ne.a,{placeholder:"\u5177\u4f53\u8be6\u7ec6\u8bf4\u660e",value:t.description,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{description:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u5907\u6ce8:"),i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8",value:t.remark,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{remark:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u9002\u7528\u5546\u54c1:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("productType",t)},value:t.productType},i.a.createElement(mn.a,{value:"ALL"},"\u5168\u90e8\u5546\u54c1"),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_ID"},"\u6307\u5b9a\u5546\u54c1\u53ef\u7528"),i.a.createElement(xc,{ref:this.ableGood}),i.a.createElement(mn.a,{value:"PARTIAL_FORBIDDEN"},"\u6307\u5b9a\u5546\u54c1\u4e0d\u53ef\u7528"),i.a.createElement(xc,{ref:this.disableGood}),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_CATE"},"\u9009\u62e9\u5546\u54c1\u5206\u7c7b"),i.a.createElement(Ic,{ref:this.ableGoodCate}),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_GROUP"},"\u9009\u62e9\u5546\u54c1\u7ec4"),i.a.createElement(jc,{ref:this.ableGoodGroup}))),"INTEGRAL_EXCHANGE"!==this.state.radioValue.release_mode&&"NEW_USER"!==this.state.radioValue.release_mode&&i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u53d1\u653e\u8303\u56f4:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("userType",t)},value:t.userType},i.a.createElement(mn.a,{value:"ALL"},"\u6240\u6709\u7528\u6237"),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_ID"},"\u6307\u5b9a\u7528\u6237\u53ef\u7528"),i.a.createElement(wc,{ref:this.ableUser}),i.a.createElement(mn.a,{value:"PARTIAL_FORBIDDEN_ID"},"\u6307\u5b9a\u7528\u6237\u4e0d\u53ef\u7528"),i.a.createElement(wc,{ref:this.disableUser}))),"PLATFORM_SEND"!==this.state.radioValue.release_mode&&"NEW_USER"!==this.state.radioValue.release_mode?i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u53d1\u653e\u603b\u91cf:"),i.a.createElement("div",{className:"liRight"},i.a.createElement(Ne.a,{className:"bigInput",value:t.issue_count,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{issue_count:t.target.value})})}}),"INTEGRAL_EXCHANGE"!==this.state.radioValue.release_mode&&i.a.createElement("div",null,"\u6bcf\u4eba ",i.a.createElement(Ne.a,{className:"smallInput",value:t.get_limit_days,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{get_limit_days:t.target.value})})}}),"\u5929\u5185\uff0c\u9650\u9886 ",i.a.createElement(Ne.a,{className:"smallInput",value:t.get_limit,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{get_limit:t.target.value})})}}),"\u5f20"))):"",i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5171\u4eab:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("is_sharing_preferential",t)},value:t.is_sharing_preferential},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),i.a.createElement("li",{style:{display:"none"}},i.a.createElement("span",{className:"c_left"},"\u652f\u4ed8\u53ef\u7528:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("is_code_scan_available",t)},value:t.is_code_scan_available},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426")))),i.a.createElement("div",{className:"right"},i.a.createElement("h4",null,"\u4f18\u60e0\u5238\u5c55\u793a"),i.a.createElement("div",{className:"c_container"},i.a.createElement("div",{className:"c_container_header"},i.a.createElement("h3",null,t.name||"\u4f18\u60e0\u5238\u540d\u79f0")),i.a.createElement("div",{className:"c_container_body"},i.a.createElement("i",null,t.floor?"\u6ee1\u8db3".concat(t.floorValue||0,"\u5143"):"\u65e0\u95e8\u69db"),i.a.createElement("i",null,"\u6709\u6548\u671f\uff1a",this.couponValidDate()))),i.a.createElement("p",null,this.releaseType()),i.a.createElement("span",null,"\u9002\u7528\u5546\u54c1\uff1a",this.renderGoods()),i.a.createElement("span",null,"\u53d1\u653e\u8303\u56f4\uff1a",this.renderReleaseRange()),i.a.createElement("span",null,"\u4f7f\u7528\u8bf4\u660e\uff1a",this.state.radioValue.description||"\u6682\u65e0"))),i.a.createElement("div",{className:"c_bottom"},i.a.createElement(_e.a,{size:"small"},"\u91cd\u7f6e"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.check},"\u4fdd\u5b58")))}}]),t}(n.Component),Ac=(a(1275),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.userScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getUserList(n)}},a.getUserList=function(e){et({limit:10,page:e}).then(function(e){e.data.length&&a.setState({users:a.state.users.concat(e.data)})}).catch(function(e){})},a.state={selectedItems:[],users:[],scrollPage:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;et({limit:10,page:1}).then(function(t){e.setState({users:t.data})})}},{key:"render",value:function(){var e=this.state.selectedItems;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u7528\u6237",mode:"tags",value:e,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.userScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.users.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)}))}}]),t}(n.Component)),Dc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.userScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getUserList(n)}},a.getUserList=function(e){ha({limit:10,page:e}).then(function(e){e.data.length&&a.setState({users:a.state.users.concat(e.data)})}).catch(function(e){})},a.state={selectedItems:[],users:[],scrollPage:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;ha({limit:10,page:1}).then(function(t){e.setState({users:t.data})})}},{key:"render",value:function(){var e=this.state.selectedItems;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u7528\u6237\u7fa4\u7ec4",mode:"tags",value:e,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.userScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.users.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)}))}}]),t}(n.Component),Pc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){e=e.filter(function(e){return parseInt(e)}),a.setState({selectedItems:e})},a.userScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getUserList(n)}},a.getUserList=function(e){mi({limit:10,page:e}).then(function(e){e.data.length&&a.setState({users:a.state.users.concat(e.data)})}).catch(function(e){})},a.state={selectedItems:[],users:[],scrollPage:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;mi({limit:10,page:1}).then(function(t){e.setState({users:t.data})})}},{key:"render",value:function(){var e=this.state.selectedItems;return i.a.createElement(Q.a,{defaultActiveFirstOption:!1,placeholder:"\u8bf7\u9009\u62e9\u6e20\u9053",mode:"tags",value:e,className:"selectedBox tagBox",onChange:this.handleChange,onPopupScroll:this.userScroll,allowClear:!0,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.users.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)}))}}]),t}(n.Component),Vc=G.a.RangePicker,Lc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onRadioChange=function(e,t){a.setState({radioValue:Object(be.a)({},a.state.radioValue,Object(Y.a)({},e,t.target.value))})},a.onDateChange=function(e,t){a.setState({radioValue:Object(be.a)({},a.state.radioValue,{valid_at:t[0],invalid_at:t[1]})})},a.onCheckBoxChange=function(e){console.log("checked = ".concat(e))},a.check=function(){var e=a.state.radioValue;if(a.banner.current.state.imgUrl)if(e.banner=a.banner.current.state.imgUrl,e.name)if(e.cash||e.discount)if("DISCOUNT"===e.type&&e.discount>100&&e.discount<0)B.a.error("\u6298\u6263\u8303\u56f4\u4e3a0-100");else if(e.benefit="CASH"===e.type?e.cash:e.discount,"DATE_TYPE_FIX_TERM_TODAY"===e.valid_date_type?e.fixed_begin_term=0:"DATE_TYPE_FIX_TERM_TOMORROW"===e.valid_date_type&&(e.fixed_begin_term=1),"DATE_TYPE_FIX_TIME_RANGE"!==e.valid_date_type||e.valid_at||e.invalid_at)if(0!==e.fixed_begin_term||e.fixed_term_today)if(1!==e.fixed_begin_term||e.fixed_term_tomorrow)if(e.fixed_term=0===e.fixed_begin_term?e.fixed_term_today:e.fixed_term_tomorrow,e.valid_date_type="DATE_TYPE_FIX_TIME_RANGE"===e.valid_date_type?"DATE_TYPE_FIX_TIME_RANGE":"DATE_TYPE_FIX_TERM",1!==e.floor||e.floorValue)if(e.floor=0===e.floor?0:e.floorValue,e.description)if(e.remark){var t={};switch(a.state.radioValue.productType){case"ALL":t.strategy="COUPON_USE_IN_ALL_PRODUCT_SET";break;case"PARTIAL_AVAILABLE_ID":t.strategy="COUPON_USE_IN_PRODUCT_SET",t.value=a.ableGood.current.state.selectedItems;break;case"PARTIAL_FORBIDDEN":t.strategy="COUPON_USE_NOT_IN_PRODUCT_SET",t.value=a.disableGood.current.state.selectedItems;break;case"PARTIAL_AVAILABLE_CATE":t.strategy="COUPON_USE_IN_PRODUCT_CATEGORY_SET",t.value=a.ableGoodCate.current.state.selectedItems;break;case"PARTIAL_AVAILABLE_GROUP":t.strategy="COUPON_USE_IN_PRODUCT_GROUP_SET",t.value=a.ableGoodGroup.current.state.selectedItems}if("COUPON_USE_IN_ALL_PRODUCT_SET"===t.strategy||t.value&&t.value.length){var n={};switch(a.state.radioValue.userType){case"ALL":n.strategy="COUPON_PUT_IN_ALL_SHOP_SET";break;case"PARTIAL_AVAILABLE_ID":n.strategy="COUPON_PUT_IN_SHOP_SET",n.value=a.ableUser.current.state.selectedItems;break;case"PARTIAL_FORBIDDEN":n.strategy="COUPON_PUT_NOT_IN_SHOP_SET",n.value=a.disableUser.current.state.selectedItems;break;case"PARTIAL_AVAILABLE_GROUP":n.strategy="COUPON_PUT_IN_SHOP_CHANNEL_SET",n.value=a.ableUserGroup.current.state.selectedItems;break;case"PARTIAL_FORBIDDEN_GROUP":n.strategy="COUPON_PUT_IN_SHOP_GROUP_SET",n.value=a.ableChannel.current.state.selectedItems}"INTEGRAL_EXCHANGE"===e.release_mode||"COUPON_PUT_IN_ALL_SHOP_SET"===n.strategy||n.value&&n.value.length?(e.use_conditions=[],e.put_conditions=[],e.use_conditions.push(t),e.put_conditions.push(n),e.obj_type="MERCHANT",a.submit(e)):B.a.error("\u8bf7\u9009\u62e9\u5546\u6237\u6216\u5546\u6237\u7ec4")}else B.a.error("\u8bf7\u586b\u5199\u5546\u54c1\u6216\u5546\u54c1\u7ec4")}else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u5907\u6ce8");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u4f7f\u7528\u8bf4\u660e");else B.a.error("\u8bf7\u586b\u5199\u95e8\u69db\u503c");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u6709\u6548\u671f\u5929\u6570");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u6709\u6548\u671f\u5929\u6570");else B.a.error("\u8bf7\u9009\u62e9\u4f18\u60e0\u5238\u6709\u6548\u671f\u8303\u56f4");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u529b\u5ea6");else B.a.error("\u8bf7\u586b\u5199\u4f18\u60e0\u5238\u540d\u79f0");else B.a.error("\u8bf7\u9009\u62e9\u4f18\u60e0\u5238\u56fe\u7247")},a.submit=function(e){Ds(Object(be.a)({},e)).then(function(e){B.a.success(e.message),a.props.history.push({pathname:"/marketing",state:{key:"MERCHANT"}})}).catch(function(e){})},a.couponValidDate=function(){var e=a.state.radioValue,t="";switch(e.valid_date_type){case"DATE_TYPE_FIX_TERM_TOMORROW":t="\u4ece\u9886\u5230\u5238\u6b21\u65e5\u5f00\u59cb".concat(e.fixed_term_tomorrow||0,"\u5929");break;case"DATE_TYPE_FIX_TERM_TODAY":t="\u4ece\u9886\u5230\u5238\u5f53\u65e5\u5f00\u59cb".concat(e.fixed_term_today||0,"\u5929");break;case"DATE_TYPE_FIX_TIME_RANGE":t=e.valid_at?"".concat(e.valid_at,"-").concat(e.invalid_at):"\u6682\u65e0";break;default:t="\u6682\u65e0"}return t},a.releaseType=function(){var e="";switch(a.state.radioValue.release_mode){case"MANUAL_RECEIVE":e="\u4e3b\u52a8\u9886\u53d6";break;case"PLATFORM_SEND":e="\u76f4\u63a5\u53d1\u9001";break;case"INTEGRAL_EXCHANGE":e="\u79ef\u5206\u5546\u57ce"}return e},a.renderGoods=function(){var e="";switch(a.state.radioValue.productType){case"ALL":e="\u5168\u90e8\u5546\u54c1";break;case"PARTIAL_AVAILABLE_ID":e="\u6307\u5b9a\u5546\u54c1\u53ef\u7528";break;case"PARTIAL_FORBIDDEN":e="\u6307\u5b9a\u5546\u54c1\u4e0d\u53ef\u7528";break;case"PARTIAL_AVAILABLE_CATE":e="\u9009\u62e9\u5546\u54c1\u5206\u7c7b";break;case"PARTIAL_AVAILABLE_GROUP":e="\u9009\u62e9\u5546\u54c1\u7ec4"}return e},a.renderReleaseRange=function(){var e="";switch(a.state.radioValue.userType){case"ALL":e="\u6240\u6709\u5546\u6237";break;case"PARTIAL_AVAILABLE_ID":e="\u6307\u5b9a\u5546\u6237\u53ef\u7528";break;case"PARTIAL_FORBIDDEN_ID":e="\u6307\u5b9a\u5546\u6237\u4e0d\u53ef\u7528";break;case"PARTIAL_AVAILABLE_GROUP":e="\u6307\u5b9a\u7fa4\u7ec4\u53ef\u7528";break;case"PARTIAL_FORBIDDEN_GROUP":e="\u6307\u5b9a\u6e20\u9053\u53ef\u7528"}return e},a.state={radioValue:{valid_date_type:"DATE_TYPE_FIX_TIME_RANGE",type:"CASH",cash:"",discount:"",floor:0,floorValue:"",productType:"ALL",userType:"ALL",is_sharing_preferential:!0,release_mode:"PLATFORM_SEND",name:"",valid_at:"",invalid_at:"",fixed_term_today:"",fixed_term_tomorrow:"",description:""},userGroup:[],goods:[],goodsGroup:[],goodsCate:[]},a.ableUser=i.a.createRef(),a.disableUser=i.a.createRef(),a.ableUserGroup=i.a.createRef(),a.disableUserGroup=i.a.createRef(),a.ableGood=i.a.createRef(),a.disableGood=i.a.createRef(),a.ableGoodGroup=i.a.createRef(),a.ableGoodCate=i.a.createRef(),a.banner=i.a.createRef(),a.ableChannel=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state.radioValue;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"c_header"},i.a.createElement("span",null,"\u65b0\u5efa\u4f18\u60e0\u5238"),i.a.createElement(_e.a,{type:"default",size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"c_body"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5238\u56fe\u7247:"),i.a.createElement(ta,{ref:this.banner})),i.a.createElement("li",{className:"normalLi"},i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5238\u540d\u79f0:"),i.a.createElement(Ne.a,{value:t.name,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{name:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f18\u60e0\u5f62\u5f0f:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("type",t)},value:t.type},i.a.createElement(mn.a,{value:"CASH"},"\u73b0\u91d1\u5238",i.a.createElement(Ne.a,{type:"number",value:t.cash,onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{cash:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5143")),i.a.createElement(mn.a,{value:"DISCOUNT"},"\u6298\u6263\u5238",i.a.createElement(Ne.a,{type:"number",value:t.discount,onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{discount:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u6298")))),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u6709\u6548\u671f:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("valid_date_type",t)},value:t.valid_date_type},i.a.createElement(mn.a,{value:"DATE_TYPE_FIX_TIME_RANGE"},"\u56fa\u5b9a\u65e5\u671f",i.a.createElement(F.a,{locale:H.a},i.a.createElement(Vc,{onChange:this.onDateChange}))),i.a.createElement(mn.a,{value:"DATE_TYPE_FIX_TERM_TODAY"},"\u9886\u5230\u5238\u5f53\u65e5\u5f00\u59cb",i.a.createElement(Ne.a,{value:t.fixed_term_today,type:"number",onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{fixed_term_today:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5929")),i.a.createElement(mn.a,{value:"DATE_TYPE_FIX_TERM_TOMORROW"},"\u9886\u5230\u5238\u6b21\u65e5\u5f00\u59cb",i.a.createElement(Ne.a,{value:t.fixed_term_tomorrow,type:"number",onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{fixed_term_tomorrow:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5929")))),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f7f\u7528\u95e8\u69db:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("floor",t)},value:t.floor},i.a.createElement(mn.a,{value:0},"\u65e0\u95e8\u69db"),i.a.createElement(mn.a,{value:1},"\u6ee1\u8db3",i.a.createElement(Ne.a,{type:"number",value:t.floorValue,onChange:function(t){t.target.value<=0||e.setState({radioValue:Object(be.a)({},e.state.radioValue,{floorValue:t.target.value})})}}),i.a.createElement("span",{className:"fixed"},"\u5143")))),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u4f7f\u7528\u8bf4\u660e:"),i.a.createElement(Ne.a,{placeholder:"\u5177\u4f53\u8be6\u7ec6\u8bf4\u660e",value:t.description,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{description:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u5907\u6ce8:"),i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8",value:t.remark,onChange:function(t){e.setState({radioValue:Object(be.a)({},e.state.radioValue,{remark:t.target.value})})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u9002\u7528\u5546\u54c1:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("productType",t)},value:t.productType},i.a.createElement(mn.a,{value:"ALL"},"\u5168\u90e8\u5546\u54c1"),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_ID"},"\u6307\u5b9a\u5546\u54c1\u53ef\u7528"),i.a.createElement(xc,{ref:this.ableGood}),i.a.createElement(mn.a,{value:"PARTIAL_FORBIDDEN"},"\u6307\u5b9a\u5546\u54c1\u4e0d\u53ef\u7528"),i.a.createElement(xc,{ref:this.disableGood}),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_CATE"},"\u9009\u62e9\u5546\u54c1\u5206\u7c7b"),i.a.createElement(Ic,{ref:this.ableGoodCate}),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_GROUP"},"\u9009\u62e9\u5546\u54c1\u7ec4"),i.a.createElement(jc,{ref:this.ableGoodGroup}))),"INTEGRAL_EXCHANGE"!==this.state.radioValue.release_mode&&i.a.createElement("li",null,i.a.createElement("span",{className:"c_left"},"\u53d1\u653e\u8303\u56f4:"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange("userType",t)},value:t.userType},i.a.createElement(mn.a,{value:"ALL"},"\u6240\u6709\u5546\u6237"),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_ID"},"\u6307\u5b9a\u5546\u6237\u53ef\u7528"),i.a.createElement(Ac,{ref:this.ableUser}),i.a.createElement(mn.a,{value:"PARTIAL_FORBIDDEN_ID"},"\u6307\u5b9a\u5546\u6237\u4e0d\u53ef\u7528"),i.a.createElement(Ac,{ref:this.disableUser}),i.a.createElement(mn.a,{value:"PARTIAL_AVAILABLE_GROUP"},"\u6307\u5b9a\u7fa4\u7ec4\u53ef\u7528"),i.a.createElement(Dc,{ref:this.ableUserGroup}),i.a.createElement(mn.a,{value:"PARTIAL_FORBIDDEN_GROUP"},"\u6307\u5b9a\u6e20\u9053\u53ef\u7528"),i.a.createElement(Pc,{ref:this.ableChannel})))),i.a.createElement("div",{className:"right"},i.a.createElement("h4",null,"\u4f18\u60e0\u5238\u5c55\u793a"),i.a.createElement("div",{className:"c_container"},i.a.createElement("div",{className:"c_container_header"},i.a.createElement("h3",null,t.name||"\u4f18\u60e0\u5238\u540d\u79f0")),i.a.createElement("div",{className:"c_container_body"},i.a.createElement("i",null,t.floor?"\u6709\u95e8\u69db":"\u65e0\u95e8\u69db"),i.a.createElement("i",null,"\u6709\u6548\u671f\uff1a",this.couponValidDate()))),i.a.createElement("p",null,this.releaseType()),i.a.createElement("span",null,"\u9002\u7528\u5546\u54c1\uff1a",this.renderGoods()),i.a.createElement("span",null,"\u53d1\u653e\u8303\u56f4\uff1a",this.renderReleaseRange()),i.a.createElement("span",null,"\u4f7f\u7528\u8bf4\u660e\uff1a",this.state.radioValue.description||"\u6682\u65e0"))),i.a.createElement("div",{className:"c_bottom"},i.a.createElement(_e.a,{size:"small"},"\u91cd\u7f6e"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.check},"\u4fdd\u5b58")))}}]),t}(n.Component),Mc=(a(1276),G.a.RangePicker),Uc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{created_at:t})})},a.getPreMonthData=function(){gc({searchJson:w({start_date:A()[0],end_date:A()[1]})}).then(function(e){a.handleData(e.data)}).catch(function(e){})},a.handleData=function(e){for(var t in e)a.setState(Object(Y.a)({},t,e[t]))},a.getCurMonthData=function(){gc({searchJson:w({start_date:P()[0],end_date:P()[1]})}).then(function(e){a.handleData(e.data)}).catch(function(e){})},a.getCustomMonthData=function(){var e=a.state.startTime,t=a.state.endTime;e?t?gc({searchJson:w({start_date:e,end_date:t})}).then(function(e){a.handleData(e.data)}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u7ed3\u675f\u65f6\u95f4"):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u8d77\u59cb\u65f6\u95f4")},a.paginationChange=function(e){a.setState({data:e})},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.clear=function(){a.setState({searchJson:{"depositCard.name":"",created_at:"",search:"",member_type:""}},function(){a.search()})},a.selectTime=function(e){switch(a.setState({time:e}),e){case"custom":break;case"thisMonth":a.getCurMonthData();break;default:a.getPreMonthData()}},a.onStartChange=function(e,t){a.setState({startTime:t})},a.onEndChange=function(e,t){a.setState({endTime:t},function(){a.getCustomMonthData()})},a.disableTime=function(e){var t=a.state.startTime;return e<J()(t).subtract(30,"days")||e>J()(t).add(30,"days")},a.state={data:[],api:_c,paginationParams:{searchJson:{}},time:"lastMonth",deposit_total_amount:0,deposit_total:0,gift_total_amount:0,bought_user_total:0,startTime:"",endTime:"",searchJson:{"depositCard.name":"",created_at:"",search:"",member_type:""}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getPreMonthData()}},{key:"render",value:function(){var e=this,t=[{title:"\u50a8\u503c\u5361\u540d\u79f0",dataIndex:"card_name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u50a8\u503c\u91d1\u989d",dataIndex:"card_price"},{title:"\u8d60\u9001\u91d1\u989d",dataIndex:"card_gift_amount"},{title:"\u8d2d\u4e70\u65f6\u95f4",dataIndex:"bought_at"},{title:"\u6635\u79f0",dataIndex:"nickname"},{title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile"}],a=this.state.time;return i.a.createElement("div",{className:"storeRecord"},i.a.createElement("div",{className:"header"},"\u50a8\u503c\u8bb0\u5f55",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement("ul",{className:"body_top"},[{key:"lastMonth",value:"\u4e0a\u6708"},{key:"thisMonth",value:"\u672c\u6708"},{key:"custom",value:"\u81ea\u5b9a\u4e49",showTime:!0}].map(function(t){return i.a.createElement("li",{key:t.key,className:t.key===a?"active":"",onClick:function(){return e.selectTime(t.key)}},t.value)}),i.a.createElement("div",{style:{marginLeft:"20px"}},"custom"===a&&i.a.createElement(F.a,{locale:H.a},i.a.createElement("div",null,i.a.createElement(G.a,{onChange:this.onStartChange}),"---",i.a.createElement(G.a,{onChange:this.onEndChange,disabledDate:this.disableTime,onOpenChange:this.open}),i.a.createElement("span",{className:"notice"},"* \u7b5b\u9009\u4ec5\u652f\u6301\u7b5b\u9009\u4e00\u4e2a\u6708\u8303\u56f4\u4ee5\u5185\u54e6"))))),i.a.createElement("ul",{className:"datas"},i.a.createElement("li",null,"\u50a8\u503c\u603b\u989d",i.a.createElement("span",null,this.state.deposit_total_amount)),i.a.createElement("li",null,"\u8d2d\u4e70\u6b21\u6570",i.a.createElement("span",null,this.state.deposit_total)),i.a.createElement("li",null,"\u8d60\u9001\u603b\u989d",i.a.createElement("span",null,this.state.gift_total_amount)),i.a.createElement("li",null,"\u8d2d\u4e70\u4eba\u6570",i.a.createElement("span",null,this.state.bought_user_total)))),i.a.createElement("div",{className:"chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u50a8\u503c\u540d\u79f0\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u50a8\u503c\u5361\u540d\u79f0",value:this.state.searchJson["depositCard.name"],onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{"depositCard.name":t.target.value})})}})),i.a.createElement("li",{className:"needMargin"},"\u8d2d\u4e70\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(Mc,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u6307\u5b9a\u641c\u7d22\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0\u6216\u624b\u673a\u53f7",value:this.state.searchJson.search,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{search:t.target.value})})}})),i.a.createElement("li",null,"\u7528\u6237\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.member_type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{member_type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"USER"},"\u7528\u6237"),i.a.createElement(Q.a.Option,{value:"MERCHANT"},"\u5546\u6237"))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u7b5b\u9009"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange,text:"\u6761\u6570\u636e"}))))}}]),t}(n.Component),Fc=(a(1277),G.a.RangePicker,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getPreMonthData=function(){zn({searchJson:w({start_date:A()[0],end_date:A()[1]})}).then(function(e){a.handleData(e.data)}).catch(function(e){})},a.getCurMonthData=function(){zn({searchJson:w({start_date:P()[0],end_date:P()[1]})}).then(function(e){a.handleData(e.data)}).catch(function(e){})},a.getCustomMonthData=function(){var e=a.state.startTime,t=a.state.endTime;e?t?zn({searchJson:w({start_date:e,end_date:t})}).then(function(e){a.handleData(e.data)}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u7ed3\u675f\u65f6\u95f4"):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u8d77\u59cb\u65f6\u95f4")},a.handleData=function(e){var t,n,i,r;!e instanceof Array||(t=n=i=r=0,e.forEach(function(e){t+=e.send_total,n+=e.send_total_success,i+=e.send_total_fail,r+=e.send_total_wait_report}),a.setState({total:t,success:n,failed:i,wait:r}))},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{send_at:t})})},a.paginationChange=function(e){a.setState({data:e})},a.search=function(){a.setState({api:Bn,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(a.state.searchJson)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.clear=function(){a.setState({searchJson:{template_name:"",template_code:"",obj_type:"",is_auto_send:!0,send_at:"",phone_number:"",send_state:-1}},function(){a.search()})},a.selectTime=function(e){switch(a.setState({time:e}),e){case"custom":break;case"thisMonth":a.getCurMonthData();break;default:a.getPreMonthData()}},a.onStartChange=function(e,t){a.setState({startTime:t})},a.onEndChange=function(e,t){a.setState({endTime:t},function(){a.getCustomMonthData()})},a.disableTime=function(e){var t=a.state.startTime;return e<J()(t).subtract(30,"days")||e>J()(t).add(30,"days")},a.state={data:[],api:Bn,paginationParams:{search:""},time:"lastMonth",total:0,success:0,failed:0,wait:0,startTime:"",endTime:"",searchJson:{template_name:"",template_code:"",obj_type:"",is_auto_send:"",send_at:"",phone_number:"",send_state:-1}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getPreMonthData()}},{key:"render",value:function(){var e=this,t=[{title:"\u53d1\u9001\u65f6\u95f4",dataIndex:"send_at"},{title:"\u77ed\u4fe1\u5185\u5bb9",dataIndex:"template_content",render:function(e,t){return i.a.createElement("span",{className:"m_message_box"},i.a.createElement("span",{className:"m_content"},e),i.a.createElement("div",{className:"popopver"},i.a.createElement(Gl.a,{content:e,placement:"bottom",trigger:"hover"},i.a.createElement(de,{type:"icon-eye-fill"}))))}},{title:"\u53d1\u9001\u7c7b\u578b",render:function(e,t){return"USER"===t.obj_type?"\u7528\u6237":"\u5546\u5bb6"}},{title:"\u53d1\u9001\u65b9\u5f0f",render:function(e,t){return t.is_auto_send?"\u81ea\u52a8":"\u624b\u52a8"}},{title:"\u63a5\u6536\u624b\u673a",dataIndex:"phone_number"},{title:"\u6a21\u677f\u540d\u79f0",dataIndex:"template_name"},{title:"\u53d1\u9001\u7ed3\u679c",dataIndex:"send_state"},{title:"\u5931\u8d25\u539f\u56e0",render:function(e,t){return t.failed_reason||"\u65e0"}}],a=this.state.time;return i.a.createElement("div",{className:"sendOutRecord"},i.a.createElement("div",{className:"header"},"\u53d1\u9001\u8bb0\u5f55",i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"body"},i.a.createElement("ul",{className:"body_top"},[{key:"lastMonth",value:"\u4e0a\u6708"},{key:"thisMonth",value:"\u672c\u6708"},{key:"custom",value:"\u81ea\u5b9a\u4e49",showTime:!0}].map(function(t){return i.a.createElement("li",{key:t.key,className:t.key===a?"active":"",onClick:function(){return e.selectTime(t.key)}},t.value)}),i.a.createElement("div",{style:{marginLeft:"20px"}},"custom"===a&&i.a.createElement(F.a,{locale:H.a},i.a.createElement("div",null,i.a.createElement(G.a,{onChange:this.onStartChange}),"---",i.a.createElement(G.a,{onChange:this.onEndChange,disabledDate:this.disableTime,onOpenChange:this.open}),i.a.createElement("span",{className:"notice"},"* \u7b5b\u9009\u4ec5\u652f\u6301\u7b5b\u9009\u4e00\u4e2a\u6708\u8303\u56f4\u4ee5\u5185\u54e6"))))),i.a.createElement("ul",{className:"datas"},i.a.createElement("li",null,"\u53d1\u9001\u603b\u6570",i.a.createElement("span",null,this.state.total)),i.a.createElement("li",null,"\u53d1\u9001\u6210\u529f",i.a.createElement("span",null,this.state.success)),i.a.createElement("li",null,"\u53d1\u9001\u5931\u8d25",i.a.createElement("span",null,this.state.failed)),i.a.createElement("li",null,"\u7b49\u5f85\u56de\u6267",i.a.createElement("span",null,this.state.wait)))),i.a.createElement("div",{className:"chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u6a21\u677f\u540d\u79f0\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6a21\u677f\u540d\u79f0",value:this.state.searchJson.template_name,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{template_name:t.target.value})})}})),i.a.createElement("li",{className:"needMargin"},"\u53d1\u9001\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:this.onDateChange}))),i.a.createElement("li",{className:"needMargin"},"\u53d1\u9001\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.obj_type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{obj_type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"USER"},"\u7528\u6237"),i.a.createElement(Q.a.Option,{value:"MERCHANT"},"\u5546\u6237"))),i.a.createElement("li",{className:"needMargin"},"\u63a5\u6536\u624b\u673a\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801",value:this.state.searchJson.phone_number,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{phone_number:t.target.value})})}})),i.a.createElement("li",null,"\u53d1\u9001\u65b9\u5f0f\uff1a",i.a.createElement(Q.a,{placeholder:"\u8bf7\u9009\u62e9\u53d1\u9001\u65b9\u5f0f",value:this.state.searchJson.is_auto_send,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{is_auto_send:t})})}},i.a.createElement(Q.a.Option,{value:!0},"\u81ea\u52a8\u53d1\u9001"),i.a.createElement(Q.a.Option,{value:!1},"\u624b\u52a8\u53d1\u9001"))),i.a.createElement("li",null,"\u53d1\u9001\u7ed3\u679c\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.send_state,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{send_state:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:-1},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:0},"\u672a\u53d1\u9001"),i.a.createElement(Q.a.Option,{value:1},"\u7b49\u5f85\u56de\u6267"),i.a.createElement(Q.a.Option,{value:2},"\u53d1\u9001\u5931\u8d25"),i.a.createElement(Q.a.Option,{value:3},"\u53d1\u9001\u6210\u529f"))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u8868\u683c"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component)),Gc=(a(1278),a(382),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){a.state.activeItem.id?(a.props.save(a.state.activeItem,a.props.type),a.handleCancel()):B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u6d88\u606f")},a.setActiveItem=function(e){a.setState({activeItem:e})},a.state={list:[],activeItem:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.list&&e.list.length&&this.setState({list:e.list})}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u9009\u62e9\u77ed\u4fe1\u6a21\u677f",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.submit,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",maskClosable:!1},i.a.createElement("ul",{className:"set_m_wechat"},this.state.list.length&&this.state.list.map(function(t){return i.a.createElement("li",{key:t.id,className:e.state.activeItem.id===t.id?"active m_message_li":"m_message_li",onClick:function(){return e.setActiveItem(t)}},i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",t.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",t.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",t.biz_type))})))}}]),t}(n.Component)),Bc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){a.state.activeItem.template_id?(a.props.save(a.state.activeItem,a.props.type),a.handleCancel()):B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u6d88\u606f")},a.setActiveItem=function(e){a.props.save(e,a.props.type),a.handleCancel()},a.state={list:[],activeItem:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.list&&e.list.length&&this.setState({list:e.list})}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u9009\u62e9\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u6a21\u677f",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"set_m_wechat"},this.state.list.length?this.state.list.map(function(t){return i.a.createElement("li",{key:t.template_id,className:e.state.activeItem.template_id===t.template_id?"m_wechat_li active":"m_wechat_li",onClick:function(){return e.setActiveItem(t)}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,t.title)),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,t.inner_title),i.a.createElement("ul",null,t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))}):"\u6682\u65e0\u6a21\u677f\uff0c\u5148\u53bb\u8bbe\u7f6e\u6a21\u677f\u5427\uff5e"))}}]),t}(n.Component),zc={order_success_m:"USER_ORDER_PAY_SUCCESS",order_got_m:"USER_ORDER_WAIT_PICK_UP",order_wrong_m:"USER_ORDER_EXCEPTION",order_cancel_m:"USER_ORDER_PLATFORM_CANCEL",order_refund_m:"USER_ORDER_EXCEPTION_REFUND",order_success_w:"USER_ORDER_PAY_SUCCESS",order_got_w:"USER_ORDER_WAIT_PICK_UP",order_wrong_w:"USER_ORDER_EXCEPTION",order_cancel_w:"USER_ORDER_PLATFORM_CANCEL",order_refund_w:"USER_ORDER_EXCEPTION_REFUND",goods_wrong_m:"MERCHANT_ORDER_GOODS_UNQUALIFIED_REFUNDED",goods_wrong_w:"MERCHANT_ORDER_GOODS_UNQUALIFIED_REFUNDED",coupon_fade_w:"USER_COUPON_SOON_TO_EXPIRE",coupon_fade_m:"USER_COUPON_SOON_TO_EXPIRE",coupon_got_w:"USER_COUPON_RECEIVED",coupon_got_m:"USER_COUPON_RECEIVED",merchant_fade_m:"MERCHANT_COUPON_SOON_TO_EXPIRE",merchant_fade_w:"MERCHANT_COUPON_SOON_TO_EXPIRE",merchant_got_m:"MERCHANT_COUPON_RECEIVED",merchant_got_w:"MERCHANT_COUPON_RECEIVED"},Hc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose(),a.props.showWeChat(a.props.type)},a.submit=function(){a.state.activeItem.id?(a.props.save(a.state.activeItem,a.props.type),a.props.onClose()):B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u6d88\u606f")},a.setActiveItem=function(e){a.setState({activeItem:e})},a.state={list:[],activeItem:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;e.templateId&&Vn({},e.templateId).then(function(e){a.setState({list:e.data})})}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u9009\u62e9\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u6a21\u677f",width:1e3,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.submit,maskClosable:!1},i.a.createElement("ul",{className:"set_m_wechat"},this.state.list.length?this.state.list.map(function(t){return i.a.createElement("li",{key:t.template_id,className:e.state.activeItem.id===t.id?"m_wechat_li active":"m_wechat_li",onClick:function(){return e.setActiveItem(t)}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,t.title)),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,t.inner_title),i.a.createElement("ul",null,t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))}):"\u8be5\u6a21\u677f\u4e0b\u6682\u65e0\u81ea\u5b9a\u4e49\u6a21\u677f\u54e6\uff0c\u5148\u53bb\u8bbe\u7f6e\u6a21\u677f\u5427\uff5e"))}}]),t}(n.Component),Kc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).init=function(){setTimeout(function(){window.location.reload()},1500)},a.showWeChat=function(e){a.setState({weChatVisible:!0,type:e})},a.hideWeChat=function(){a.setState({weChatVisible:!1})},a.showSmsMessage=function(e){a.setState({messageVisible:!0,type:e})},a.hideSmsMessage=function(){a.setState({messageVisible:!1})},a.showCustomMessage=function(e){a.setState({customMessageVisible:!0,templateId:e})},a.hideCustomMessage=function(){a.setState({customMessageVisible:!1})},a.saveParentWechat=function(e,t){a.setState(Object(Y.a)({},t,e),function(){a.showCustomMessage(e.id)})},a.saveWeChat=function(e,t){console.log(t);var n="user"===a.props.location.state.mode?"ORDER":"COUPON";console.log(zc[t],"+++++++++++"),Kn({type:n,template_type:"WX_TEMPLATE_MESSAGE",template_id:e.id,trigger:zc[t]}).then(function(n){B.a.success(n.message),a.setState(Object(Y.a)({},t,e))})},a.saveSMS=function(e,t){Kn({type:"user"===a.props.location.state.mode?"ORDER":"COUPON",template_type:"SMS",template_id:e.id,trigger:zc[t]}).then(function(n){B.a.success(n.message),a.setState(Object(Y.a)({},t,e))})},a.state={weChatList:[],messageList:[],weChatVisible:!1,messageVisible:!1,customMessageVisible:!1,type:"",templateId:"",order_success_w:{},order_success_m:{},order_got_w:{},order_got_m:{},order_wrong_w:{},order_wrong_m:{},order_cancel_w:{},order_cancel_m:{},order_refund_w:{},order_refund_m:{},goods_wrong_m:{},coupon_fade_w:{},coupon_fade_m:{},coupon_got_w:{},coupon_got_m:{},merchant_fade_m:{},merchant_got_m:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t="user"===this.props.location.state.mode?"ORDER":"COUPON";An({}).then(function(t){e.setState({weChatList:t.data})}).catch(function(e){}),Gn({}).then(function(t){e.setState({messageList:t.data})}).catch(function(e){}),Hn({searchJson:w({type:t})}).then(function(t){t.data.forEach(function(t){switch(t.template_type){case"SMS":switch(console.log("sms"),t.trigger){case"USER_COUPON_RECEIVED":e.setState({coupon_got_m:t.template});break;case"USER_COUPON_SOON_TO_EXPIRE":e.setState({coupon_fade_m:t.template});break;case"MERCHANT_COUPON_RECEIVED":e.setState({merchant_got_m:t.template});break;case"MERCHANT_COUPON_SOON_TO_EXPIRE":e.setState({merchant_fade_m:t.template})}break;default:switch(console.log("other"),t.trigger){case"USER_COUPON_RECEIVED":e.setState({coupon_got_w:t.template});break;case"USER_COUPON_SOON_TO_EXPIRE":e.setState({coupon_fade_w:t.template})}}})})}},{key:"render",value:function(){var e=this,t=this.props.location.state.mode,a={visible:this.state.messageVisible,list:this.state.messageList,onClose:this.hideSmsMessage,save:this.saveSMS,type:this.state.type},r={visible:this.state.weChatVisible,list:this.state.weChatList,onClose:this.hideWeChat,save:this.saveParentWechat,type:this.state.type},l={visible:this.state.customMessageVisible,onClose:this.hideCustomMessage,type:this.state.type,templateId:this.state.templateId,showWeChat:this.showWeChat,save:this.saveWeChat};return i.a.createElement(n.Fragment,null,i.a.createElement(Gc,a),i.a.createElement(Bc,r),i.a.createElement(Hc,l),"user"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u4e0b\u5355\u6210\u529f"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_success_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_success_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_success_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_success_w.name),i.a.createElement($n,{refresh:this.init,type:zc.order_success_w,id:this.state.order_success_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_success_w.inner_title),i.a.createElement("ul",null,this.state.order_success_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_success_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_success_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_success_m")}},i.a.createElement($n,{refresh:this.init,type:zc.order_success_m,id:this.state.order_success_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_success_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_success_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_success_m.biz_type)))),i.a.createElement("h3",null,"\u5546\u54c1\u5df2\u5230\u81ea\u63d0\u70b9"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_got_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_got_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_got_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_got_w.name),i.a.createElement($n,{refresh:this.init,type:zc.order_got_w,id:this.state.order_got_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_got_w.inner_title),i.a.createElement("ul",null,this.state.order_got_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_got_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_got_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_got_m")}},i.a.createElement($n,{refresh:this.init,type:zc.order_got_m,id:this.state.order_got_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_got_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_got_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_got_m.biz_type)))),i.a.createElement("h3",null,"\u8ba2\u5355\u5f02\u5e38(\u65e9\u9910\u9884\u5b9a)"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_wrong_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_wrong_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_wrong_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_wrong_w.name),i.a.createElement($n,{refresh:this.init,type:zc.order_wrong_w,id:this.state.order_wrong_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_wrong_w.inner_title),i.a.createElement("ul",null,this.state.order_wrong_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_wrong_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_wrong_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_wrong_m")}},i.a.createElement($n,{refresh:this.init,type:zc.order_wrong_m,id:this.state.order_wrong_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_wrong_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_wrong_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_wrong_m.biz_type)))),i.a.createElement("h3",null,"\u5e73\u53f0\u53d6\u6d88\u8ba2\u5355"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_cancel_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_cancel_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_cancel_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_cancel_w.name),i.a.createElement($n,{refresh:this.init,type:zc.order_cancel_w,id:this.state.order_cancel_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_cancel_w.inner_title),i.a.createElement("ul",null,this.state.order_cancel_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_cancel_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_cancel_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_cancel_m")}},i.a.createElement($n,{refresh:this.init,type:zc.order_cancel_m,id:this.state.order_cancel_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_cancel_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_cancel_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_cancel_m.biz_type)))),i.a.createElement("h3",null,"\u9884\u5b9a\u5355\u5546\u54c1\u4e0d\u9f50\u9000\u6b3e"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("order_refund_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.order_refund_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("order_refund_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.order_refund_w.name),i.a.createElement($n,{refresh:this.init,type:zc.order_refund_w,id:this.state.order_refund_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.order_refund_w.inner_title),i.a.createElement("ul",null,this.state.order_refund_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("order_refund_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.order_refund_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("order_refund_m")}},i.a.createElement($n,{refresh:this.init,type:zc.order_refund_m,id:this.state.order_refund_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.order_refund_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.order_refund_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.order_refund_m.biz_type))))),"goods"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u5546\u54c1\u5f02\u5e38\u9000\u6b3e"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("goods_wrong_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.goods_wrong_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("goods_wrong_m")}},i.a.createElement($n,{refresh:this.init,type:zc.goods_wrong_m,id:this.state.goods_wrong_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.goods_wrong_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.goods_wrong_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.goods_wrong_m.biz_type))))),"couponConsumer"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u4f18\u60e0\u5238\u5373\u5c06\u8fc7\u671f"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("coupon_fade_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.coupon_fade_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("coupon_fade_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.coupon_fade_w.name),i.a.createElement($n,{refresh:this.init,type:zc.coupon_fade_w,id:this.state.coupon_fade_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.coupon_fade_w.inner_title),i.a.createElement("ul",null,this.state.coupon_fade_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("coupon_fade_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.coupon_fade_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("coupon_fade_m")}},i.a.createElement($n,{refresh:this.init,type:zc.coupon_fade_m,id:this.state.coupon_fade_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.coupon_fade_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.coupon_fade_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.coupon_fade_m.biz_type)))),i.a.createElement("h3",null,"\u83b7\u5f97\u4f18\u60e0\u5238"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_m_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showWeChat("coupon_got_w")}},"\u8bbe\u7f6e\u5fae\u4fe1\u6a21\u677f"),this.state.coupon_got_w.id&&i.a.createElement("div",{className:"m_wechat_li",onClick:function(){return e.showWeChat("coupon_got_w")}},i.a.createElement("div",{className:"ul_header"},i.a.createElement("h3",null,this.state.coupon_got_w.name),i.a.createElement($n,{refresh:this.init,type:zc.coupon_got_w,id:this.state.coupon_got_w.id})),i.a.createElement("div",{className:"ulBody"},i.a.createElement("h4",null,this.state.coupon_got_w.inner_title),i.a.createElement("ul",null,this.state.coupon_got_w.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value"},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"}))))),i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("coupon_got_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.coupon_got_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("coupon_got_m")}},i.a.createElement($n,{refresh:this.init,type:zc.coupon_got_m,id:this.state.coupon_got_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.coupon_got_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.coupon_got_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.coupon_got_m.biz_type))))),"couponMerchant"===t&&i.a.createElement("div",{className:"set_m"},i.a.createElement("h3",null,"\u4f18\u60e0\u5238\u5373\u5c06\u8fc7\u671f"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("merchant_fade_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.merchant_fade_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("merchant_fade_m")}},i.a.createElement($n,{refresh:this.init,type:zc.merchant_fade_m,id:this.state.merchant_fade_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.merchant_fade_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.merchant_fade_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.merchant_fade_m.biz_type)))),i.a.createElement("h3",null,"\u83b7\u5f97\u4f18\u60e0\u5238"),i.a.createElement("ul",{className:"set_m_ul"},i.a.createElement("li",{className:"set_w_li"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:function(){return e.showSmsMessage("merchant_got_m")}},"\u8bbe\u7f6e\u77ed\u4fe1\u6a21\u677f"),this.state.merchant_got_m.id&&i.a.createElement("div",{className:"m_message_li",onClick:function(){return e.showSmsMessage("merchant_got_m")}},i.a.createElement($n,{refresh:this.init,type:zc.merchant_got_m,id:this.state.merchant_got_m.id}),i.a.createElement("p",null," \u6a21\u677f\u540d\u79f0\uff1a ",this.state.merchant_got_m.name),i.a.createElement("p",null," \u77ed\u4fe1\u5185\u5bb9\uff1a ",this.state.merchant_got_m.content),i.a.createElement("p",null," \u6a21\u677f\u7c7b\u578b\uff1a ",this.state.merchant_got_m.biz_type))))))}}]),t}(n.Component);a(1279);var Jc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getOverView=function(e){(function(e){return ne({url:"/api/backend/finance/overview/statistics/list",method:"get",params:e})})({searchJson:e}).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.changeTab=function(e){switch(a.setState({activeTab:e}),e){case"\u8fd17\u5929":a.selectWeek();break;case"\u8fd130\u5929":a.selectMonth();break;default:a.selectToday()}},a.selectToday=function(){var e=J()().format("YYYY-MM-DD");a.searchDate([e,e])},a.selectWeek=function(){var e=J()().format("YYYY-MM-DD"),t=J()().subtract("days",6).format("YYYY-MM-DD");a.searchDate([t,e])},a.selectMonth=function(){var e=J()().format("YYYY-MM-DD"),t=J()().subtract("days",30).format("YYYY-MM-DD");a.searchDate([t,e])},a.searchDate=function(e){var t;(t={searchJson:w({start_date:e[0],end_date:e[1]})},ne({url:"/api/backend/finance/overview/statistics",method:"get",params:t})).then(function(e){a.handleData(e.data)})},a.handleData=function(e){for(var t in e)a.setState(Object(Y.a)({},t,e[t]))},a.changeChartTab=function(e){a.setState({activeChartTab:e})},a.handleChange=function(e){var t={};"\u65e5\u6c47\u603b"===a.state.activeChartTab?(t.summary_type="DAY",t.year="2019",t.month=e):(t.summary_type="MONTH",t.year="2019"),a.getOverView(w(t))},a.state={data:[],activeTab:"\u4eca\u65e5",activeChartTab:"\u65e5\u6c47\u603b",income_total_amount:0,refund_total_amount:0,settlement_total_amount:0,withdraw_total_amount:0,searchJson:w({summary_type:"DAY",year:"2019",month:"1"})},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.selectToday(),this.getOverView(this.state.searchJson)}},{key:"render",value:function(){var e,t=this,a=this.state.activeChartTab,r=[];return r="\u65e5\u6c47\u603b"===a?[{name:"\u4e00\u6708",key:1},{name:"\u4e8c\u6708",key:2},{name:"\u4e09\u6708",key:3},{name:"\u56db\u6708",key:4},{name:"\u4e94\u6708",key:5},{name:"\u516d\u6708",key:6},{name:"\u4e03\u6708",key:7},{name:"\u516b\u6708",key:8},{name:"\u4e5d\u6708",key:9},{name:"\u5341\u6708",key:10},{name:"\u5341\u4e00\u6708",key:11},{name:"\u5341\u4e8c\u6708",key:12}]:[{name:"2019",key:2019}],e="\u65e5\u6c47\u603b"===a?"\u8bf7\u9009\u62e9\u6708\u4efd":"\u8bf7\u9009\u62e9\u5e74\u4efd",i.a.createElement(n.Fragment,null,i.a.createElement("ul",{className:"ov_header"},["\u4eca\u65e5","\u8fd17\u5929","\u8fd130\u5929"].map(function(e){return i.a.createElement("li",{key:e,onClick:function(){return t.changeTab(e)},className:t.state.activeTab===e?"active":""},e)})),i.a.createElement("ul",{className:"data"},i.a.createElement("li",null,"\u8ba2\u5355\u603b\u989d",i.a.createElement("span",null,this.state.settlement_total_amount)),i.a.createElement("li",null,"\u5165\u8d26\u603b\u989d",i.a.createElement("span",null,this.state.income_total_amount)),i.a.createElement("li",null,"\u9000\u6b3e\u91d1\u989d",i.a.createElement("span",null,this.state.refund_total_amount)),i.a.createElement("li",null,"\u63d0\u73b0\u91d1\u989d",i.a.createElement("span",null,this.state.withdraw_total_amount))),i.a.createElement("div",{className:"ovChart"},i.a.createElement("ul",{className:"ovChartHeader"},i.a.createElement("li",null,["\u65e5\u6c47\u603b","\u6708\u6c47\u603b"].map(function(e){return i.a.createElement("span",{key:e,onClick:function(){return t.changeChartTab(e)},className:a===e?"active":""},e)})),i.a.createElement("li",null,i.a.createElement(Q.a,{style:{width:320},onChange:this.handleChange,placeholder:e},r.map(function(e){return i.a.createElement(Q.a.Option,{value:e.key},e.name)})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u65e5\u671f",dataIndex:"date"},{title:"\u6536\u5165",dataIndex:"income_total_amount"},{title:"\u9000\u6b3e",dataIndex:"refund_total_amount"},{title:"\u63d0\u73b0",dataIndex:"withdraw_total_amount"}],rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data}))))}}]),t}(i.a.Component),Wc=Object(U.g)(Jc);a(1280);function Yc(e){return ne({url:"/api/backend/finance/deposit/bought/records",method:"get",params:e})}function qc(e){return ne({url:"/api/backend/finance/deposit/bought/statistics",method:"get",params:e})}function Xc(e){return ne({url:"/api/backend/finance/merchant/balance/change/logs",method:"get",params:e})}function $c(e){return ne({url:"/api/backend/finance/user/balance/change/logs",method:"get",params:e})}a(1281);var Qc=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onStartChange=function(e,t){a.setState({startTime:t})},a.onEndChange=function(e,t){a.setState({endTime:t},function(){a.getCustomMonthData()})},a.disableTime=function(e){var t=a.state.startTime;return e<J()(t).subtract(30,"days")||e>J()(t).add(30,"days")},a.selectTime=function(e){switch(a.setState({time:e}),e){case"custom":break;case"thisMonth":a.getCurMonthData();break;default:a.getPreMonthData()}},a.getCustomMonthData=function(){var e=a.state.startTime,t=a.state.endTime;e?t?a.props.api({searchJson:w({start_date:e,end_date:t})}).then(function(e){a.props.handleData(e.data)}).catch(function(e){}):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u7ed3\u675f\u65f6\u95f4"):B.a.error("\u8bf7\u9009\u62e9\u67e5\u8be2\u8d77\u59cb\u65f6\u95f4")},a.getPreMonthData=function(){a.props.api({searchJson:w({start_date:A()[0],end_date:A()[1]})}).then(function(e){a.props.handleData(e.data)}).catch(function(e){})},a.getCurMonthData=function(){a.props.api({searchJson:w({start_date:P()[0],end_date:P()[1]})}).then(function(e){a.props.handleData(e.data)}).catch(function(e){})},a.state={time:"lastMonth",startTime:"",endTime:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getPreMonthData()}},{key:"render",value:function(){var e=this,t=this.state.time;return i.a.createElement(n.Fragment,null,i.a.createElement("ul",{className:"selectTimeRange"},[{key:"lastMonth",value:"\u4e0a\u6708"},{key:"thisMonth",value:"\u672c\u6708"},{key:"custom",value:"\u81ea\u5b9a\u4e49",showTime:!0}].map(function(a){return i.a.createElement("li",{key:a.key,className:a.key===t?"active":"",onClick:function(){return e.selectTime(a.key)}},a.value)}),i.a.createElement("div",{style:{marginLeft:"20px"}},"custom"===t&&i.a.createElement(F.a,{locale:H.a},i.a.createElement("div",null,i.a.createElement(G.a,{onChange:this.onStartChange}),"---",i.a.createElement(G.a,{onChange:this.onEndChange,disabledDate:this.disableTime,onOpenChange:this.open}),i.a.createElement("span",{className:"notice"},"* \u7b5b\u9009\u4ec5\u652f\u6301\u7b5b\u9009\u4e00\u4e2a\u6708\u8303\u56f4\u4ee5\u5185\u54e6"))))))}}]),t}(n.Component),Zc=G.a.RangePicker,eo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{created_at:t})})},a.handleData=function(e){for(var t in e)a.setState(Object(Y.a)({},t,e[t]))},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.clear=function(){a.setState({searchJson:{"depositCard.name":"",created_at:"",search:"",member_type:""}},function(){a.search()})},a.state={data:[],api:Yc,paginationParams:{searchJson:{}},time:"lastMonth",deposit_total_amount:0,deposit_total:0,gift_total_amount:0,bought_user_total:0,startTime:"",channels:[],endTime:"",searchJson:{"depositCard.name":"",created_at:"",search:"",member_type:"",channel_id:""}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;ui({}).then(function(t){e.setState({channels:t.data})})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"overviewBalance"},i.a.createElement("div",{className:"body"},i.a.createElement(Qc,{api:qc,handleData:this.handleData}),i.a.createElement("ul",{className:"datas"},i.a.createElement("li",null,"\u50a8\u503c\u603b\u989d",i.a.createElement("span",null,this.state.deposit_total_amount)),i.a.createElement("li",null,"\u8d2d\u4e70\u6b21\u6570",i.a.createElement("span",null,this.state.deposit_total)),i.a.createElement("li",null,"\u8d60\u9001\u603b\u989d",i.a.createElement("span",null,this.state.gift_total_amount)),i.a.createElement("li",null,"\u8d2d\u4e70\u4eba\u6570",i.a.createElement("span",null,this.state.bought_user_total)))),i.a.createElement("div",{className:"ob_chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u6307\u5b9a\u641c\u7d22\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0\u6216\u624b\u673a\u53f7",value:this.state.searchJson.search,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{search:t.target.value})})}})),i.a.createElement("li",{className:"needMargin"},"\u9009\u62e9\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(Zc,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u9009\u62e9\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.member_type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{member_type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"USER"},"\u7528\u6237"),i.a.createElement(Q.a.Option,{value:"MERCHANT"},"\u5546\u6237"))),i.a.createElement("li",null,"\u9009\u62e9\u6e20\u9053\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.channel_id,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{channel_id:t})})},defaultActiveFirstOption:!1},this.state.channels.map(function(e){return i.a.createElement(Q.a.Option,{value:e.id},e.name)}))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"),i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u7b5b\u9009\u7ed3\u679c"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u6635\u79f0",dataIndex:"nickname"},{title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile"},{title:"\u6e20\u9053",dataIndex:"channel"},{title:"\u50a8\u503c\u540d\u79f0",dataIndex:"card_name"},{title:"\u50a8\u503c\u91d1\u989d",dataIndex:"card_price",render:function(e,t){return"".concat(e,"\u5143")}},{title:"\u8d60\u9001\u91d1\u989d",dataIndex:"card_gift_amount",render:function(e,t){return"".concat(e,"\u5143")}}],rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component),to=(a(581),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){if(!a.loading)if(a.loading=!0,a.state.remark)if(a.state.file){var e,t=new FormData;t.append("file",a.state.file.originFileObj),t.append("strategy","MERCHANT_BALANCE_ADJUST"),t.append("import_mode","IMMEDIATE"),t.append("remark",a.state.remark),(e=t,ne({url:"/api/backend/import",method:"post",data:e})).then(function(e){B.a.success(e.message),a.handleCancel(),a.loading=!1}).catch(function(e){a.loading=!1})}else B.a.error("\u8bf7\u4e0a\u4f20\u6587\u4ef6");else B.a.error("\u8bf7\u586b\u5199\u5907\u6ce8")},a.state={remark:"",file:""},a.loading=!1,a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this,a={name:"file",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",headers:{authorization:"authorization-text"},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(console.log(e),t.setState({file:e.file}),B.a.success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f"))):"error"===e.file.status&&B.a.error("".concat(e.file.name," file upload failed."))}};return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6279\u91cf\u8c03\u6574\u4f59\u989d",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",okButtonProps:{disabled:this.loading},cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",{className:"normalLi"},i.a.createElement("span",{className:"left c_left"},"\u5907\u6ce8"),i.a.createElement(Ne.a,{className:"liInput",type:"text",value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}})),i.a.createElement("li",{className:"normalLi"},i.a.createElement("span",{className:"left c_left"},"\u4e0a\u4f20\u6587\u4ef6"),i.a.createElement(Zt.a,a,i.a.createElement(_e.a,null,i.a.createElement(me.a,{type:"upload"})," \u70b9\u51fb\u4e0a\u4f20\u6587\u4ef6"))))))}}]),t}(n.Component)),ao=G.a.RangePicker,no=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{created_at:t})})},a.renderType=function(e){var t;switch(e){case"DEPOSIT":t="\u5145\u503c";break;case"SELF_PICK_CASHBACK":t="\u81ea\u63d0\u8fd4\u73b0";break;case"SALE_CASHBACK":t="\u9500\u552e\u8fd4\u73b0";break;case"RECEIVE_RED_PACKET":t="\u9886\u53d6\u7ea2\u5305";break;case"REFUND":t="\u9000\u6b3e";break;case"WITHDRAW":t="\u63d0\u73b0";break;case"CONSUME":t="\u6d88\u8d39";break;default:t="\u5176\u4ed6"}return t},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.changeSearchValue=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,Object(Y.a)({},t,e.target.value))})},a.clear=function(){a.setState({searchJson:{type:"","shop.name":"","shop.keeper_name":"","shop.keeper_mobile":"",created_at:""}},function(){a.search()})},a.showUpload=function(){a.setState({uploadVisible:!0})},a.closeUpload=function(){a.setState({uploadVisible:!1})},a.state={data:[],api:Xc,searchJson:{type:"","shop.nickname":"","shop.keeper_name":"","shop.mobile":"",created_at:""},uploadVisible:!1},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u5e97\u94fa\u540d\u79f0",dataIndex:"shop_name"},{title:"\u6536\u5165",dataIndex:"income"},{title:"\u652f\u51fa",dataIndex:"expense"},{title:"\u65f6\u95f4",dataIndex:"created_at"},{title:"\u7c7b\u578b",dataIndex:"type",render:function(t,a){return e.renderType(t)}},{title:"\u5907\u6ce8",dataIndex:"remark"}];return i.a.createElement("div",{className:"overviewShopBalance"},i.a.createElement(to,{visible:this.state.uploadVisible,onClose:this.closeUpload}),i.a.createElement(_e.a,{size:"small",style:{marginBottom:"10px"},onClick:this.showUpload},"\u6279\u91cf\u8c03\u6574\u4f59\u989d"),i.a.createElement("p",null,"\u5269\u4f59\u4f59\u989d\u603b\u989d:1000000"),i.a.createElement("div",{className:"ob_chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u5e97\u94fa\u540d\u79f0\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0",value:this.state.searchJson["shop.name"],onChange:function(t){e.changeSearchValue(t,"shop.name")}})),i.a.createElement("li",{className:"needMargin"},"\u624b\u673a\u53f7\u7801\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801",value:this.state.searchJson["shop.keeper_mobile"],onChange:function(t){e.changeSearchValue(t,"shop.keeper_mobile")}})),i.a.createElement("li",{className:"needMargin"},"\u9009\u62e9\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(ao,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u9009\u62e9\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"DEPOSIT"},"\u5145\u503c"),i.a.createElement(Q.a.Option,{value:"SELF_PICK_CASHBACK"},"\u81ea\u63d0\u8fd4\u73b0"),i.a.createElement(Q.a.Option,{value:"SALE_CASHBACK"},"\u9500\u552e\u8fd4\u73b0"),i.a.createElement(Q.a.Option,{value:"RECEIVE_RED_PACKET"},"\u9886\u53d6\u7ea2\u5305"),i.a.createElement(Q.a.Option,{value:"REFUND"},"\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"WITHDRAW"},"\u63d0\u73b0"),i.a.createElement(Q.a.Option,{value:"CONSUME"},"\u6d88\u8d39"),i.a.createElement(Q.a.Option,{value:"OTHER"},"\u5176\u4ed6"))),i.a.createElement("li",null,"\u5e97\u4e3b\u59d3\u540d\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u5e97\u4e3b\u59d3\u540d",value:this.state.searchJson["shop.keeper_name"],onChange:function(t){e.changeSearchValue(t,"shop.keeper_name")}})),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"),window.hasPermission("balance_detailed_export")&&i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u7b5b\u9009\u7ed3\u679c"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component),io=G.a.RangePicker,ro=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{created_at:t})})},a.paginationChange=function(e){a.setState({data:e})},a.changeSearchValue=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,Object(Y.a)({},t,e.target.value))})},a.clear=function(){a.setState({searchJson:{type:"","user.nickname":"","user.real_name":"","user.mobile":"",created_at:""}},function(){a.search()})},a.renderType=function(e){var t;switch(e){case"DEPOSIT":t="\u5145\u503c";break;case"RECEIVE_RED_PACKET":t="\u9886\u53d6\u7ea2\u5305";break;case"REFUND":t="\u9000\u6b3e";break;case"WITHDRAW":t="\u63d0\u73b0";break;case"CONSUME":t="\u6d88\u8d39";break;default:t=""}return t},a.state={data:[],api:$c,searchJson:{type:"","user.nickname":"","user.real_name":"","user.mobile":"",created_at:""},paginationParams:{}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u6635\u79f0",dataIndex:"nickname"},{title:"\u6536\u5165",dataIndex:"income"},{title:"\u652f\u51fa",dataIndex:"expense"},{title:"\u65f6\u95f4",dataIndex:"created_at"},{title:"\u7c7b\u578b",dataIndex:"type",render:function(t,a){return e.renderType(t)}},{title:"\u5907\u6ce8",dataIndex:"remark"}];return i.a.createElement("div",{className:"overviewShopBalance"},i.a.createElement("p",null,"\u5269\u4f59\u4f59\u989d\u603b\u989d:\u5f85\u5b9a\uff08\u6b64\u5904\u9700\u8981\u63a5\u53e3\uff09"),i.a.createElement("div",{className:"ob_chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u6635\u79f0/\u59d3\u540d\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0/\u59d3\u540d",value:this.state.searchJson["user.nickname"],onChange:function(t){e.changeSearchValue(t,"user.nickname")}})),i.a.createElement("li",{className:"needMargin"},"\u624b\u673a\u53f7\u7801\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",value:this.state.searchJson["user.mobile"],onChange:function(t){e.changeSearchValue(t,"user.mobile")}})),i.a.createElement("li",{className:"needMargin"},"\u9009\u62e9\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(io,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u9009\u62e9\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"DEPOSIT"},"\u5145\u503c"),i.a.createElement(Q.a.Option,{value:"RECEIVE_RED_PACKET"},"\u9886\u53d6\u7ea2\u5305"),i.a.createElement(Q.a.Option,{value:"REFUND"},"\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"WITHDRAW"},"\u63d0\u73b0"),i.a.createElement(Q.a.Option,{value:"CONSUME"},"\u6d88\u8d39"))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"),window.hasPermission("balance_detailed_export")&&i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u7b5b\u9009\u7ed3\u679c"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange,text:"\u6761\u8bb0\u5f55"}))))}}]),t}(n.Component),lo=(a(1282),wr.a.TabPane),so=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).callback=function(){},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"coupon bd_header"},i.a.createElement(wr.a,{defaultActiveKey:"1",onChange:this.callback},i.a.createElement(lo,{tab:"\u6d88\u8d39\u8005\u4f59\u989d",key:"1"},i.a.createElement(ro,null)),i.a.createElement(lo,{tab:"\u5546\u6237\u4f59\u989d",key:"2"},i.a.createElement(no,null)),i.a.createElement(lo,{tab:"\u50a8\u503c\u8bb0\u5f55",key:"3"},i.a.createElement(eo,null))))}}]),t}(n.Component);a(582);function co(e){return ne({url:"/api/backend/finance/refund/list",method:"get",params:e})}function oo(e){return ne({url:"/api/backend/finance/refund/application/list",method:"get",params:e})}function uo(e){return ne({url:"/api/backend/finance/refund/handle",method:"put",data:e})}var mo=G.a.RangePicker,po=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);e.member_type="USER",a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{created_at:t})})},a.changeSearchValue=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,Object(Y.a)({},t,e.target.value))})},a.clear=function(){a.setState({searchJson:{member_info:"",trade_no:"",type:"",state:"",created_at:""}},function(){a.search()})},a.state={api:co,data:[],paginationParams:{searchJson:w({member_type:"USER"})},searchJson:{member_info:"",trade_no:"",type:"",state:"",created_at:""}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"cr_chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u7528\u6237\u4fe1\u606f\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0/\u624b\u673a\u53f7\u7801",value:this.state.searchJson.member_info,onChange:function(t){e.changeSearchValue(t,"member_info")}})),i.a.createElement("li",{className:"needMargin"},"\u8ba2\u5355\u7f16\u53f7\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u8ba2\u5355\u7f16\u53f7",value:this.state.searchJson.trade_no,onChange:function(t){e.changeSearchValue(t,"trade_no")}})),i.a.createElement("li",{className:"needMargin"},"\u7533\u8bf7\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(mo,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u9000\u6b3e\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"ORDER_EXCEPTION"},"\u8ba2\u5355\u5f02\u5e38\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"MEMBER_AFTER_SALE"},"\u7528\u6237\u7533\u8bf7\u552e\u540e"),i.a.createElement(Q.a.Option,{value:"ORDER_MANUAL_CANCEL"},"\u7528\u6237\u53d6\u6d88\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"ORDER_PLATFORM_CANCEL"},"\u5e73\u53f0\u53d6\u6d88\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"ORDER_AGENT_PRODUCT_EXCEPTION"},"\u5546\u6237\u5546\u54c1\u5f02\u5e38"))),i.a.createElement("li",null,"\u9000\u6b3e\u72b6\u6001\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.state,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{state:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"0"},"\u5f85\u5904\u7406"),i.a.createElement(Q.a.Option,{value:"1"},"\u5f85\u786e\u8ba4"),i.a.createElement(Q.a.Option,{value:"2"},"\u5df2\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"3"},"\u62d2\u7edd\u9000\u6b3e"))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"),window.hasPermission("refund_detailed_export")&&i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u7b5b\u9009\u7ed3\u679c"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u6635\u79f0/\u624b\u673a\u53f7",dataIndex:"nickname"},{title:"\u8ba2\u5355\u7f16\u53f7",dataIndex:"trade_no"},{title:"\u9000\u6b3e\u7c7b\u578b",dataIndex:"type",render:function(e,t){switch(e){case"ORDER_EXCEPTION":return"\u8ba2\u5355\u5f02\u5e38\u9000\u6b3e";case"MEMBER_AFTER_SALE":return"\u7528\u6237\u7533\u8bf7\u552e\u540e";case"ORDER_MANUAL_CANCEL":return"\u7528\u6237\u53d6\u6d88\u9000\u6b3e";case"ORDER_PLATFORM_CANCEL":return"\u5e73\u53f0\u53d6\u6d88\u9000\u6b3e";case"ORDER_AGENT_PRODUCT_EXCEPTION":return"\u5546\u6237\u5546\u54c1\u5f02\u5e38"}}},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"applied_at"},{title:"\u9000\u6b3e\u72b6\u6001",dataIndex:"state_desc"},{title:"\u5b9e\u4ed8\u6b3e/\u9000\u6b3e\u91d1\u989d",dataIndex:"settlement_total_fee",render:function(e,t){return"".concat(t.settlement_total_fee,"\u5143/").concat(t.refund_amount,"\u5143")}},{title:"\u5907\u6ce8",dataIndex:"remark"}],rowKey:function(e){return e.refund_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component),ho=Object(U.g)(po),fo=G.a.RangePicker,Eo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.search=function(){var e={},t=a.state.searchJson;for(var n in t)t[n]&&(e[n]=t[n]);e.member_type="MERCHANT",a.setState({paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{created_at:t})})},a.changeSearchValue=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,Object(Y.a)({},t,e.target.value))})},a.clear=function(){a.setState({searchJson:{member_info:"",trade_no:"",type:"",state:"",created_at:""}},function(){a.search()})},a.state={api:co,data:[],paginationParams:{searchJson:w({member_type:"MERCHANT"})},searchJson:{member_info:"",trade_no:"",type:"",state:"",created_at:""}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"cr_chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u7528\u6237\u4fe1\u606f\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0/\u624b\u673a\u53f7\u7801",value:this.state.searchJson.member_info,onChange:function(t){e.changeSearchValue(t,"member_info")}})),i.a.createElement("li",{className:"needMargin"},"\u8ba2\u5355\u7f16\u53f7\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u8ba2\u5355\u7f16\u53f7",value:this.state.searchJson.trade_no,onChange:function(t){e.changeSearchValue(t,"trade_no")}})),i.a.createElement("li",{className:"needMargin"},"\u7533\u8bf7\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(fo,{onChange:this.onDateChange}))),i.a.createElement("li",null,"\u9000\u6b3e\u7c7b\u578b\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.type,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{type:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:""},"\u5168\u90e8"),i.a.createElement(Q.a.Option,{value:"ORDER_EXCEPTION"},"\u8ba2\u5355\u5f02\u5e38\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"MEMBER_AFTER_SALE"},"\u7528\u6237\u7533\u8bf7\u552e\u540e"),i.a.createElement(Q.a.Option,{value:"ORDER_MANUAL_CANCEL"},"\u7528\u6237\u53d6\u6d88\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"ORDER_PLATFORM_CANCEL"},"\u5e73\u53f0\u53d6\u6d88\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"ORDER_AGENT_PRODUCT_EXCEPTION"},"\u5546\u6237\u5546\u54c1\u5f02\u5e38"))),i.a.createElement("li",null,"\u9000\u6b3e\u72b6\u6001\uff1a",i.a.createElement(Q.a,{value:this.state.searchJson.state,onChange:function(t){e.setState({searchJson:Object(be.a)({},e.state.searchJson,{state:t})})},defaultActiveFirstOption:!1},i.a.createElement(Q.a.Option,{value:"0"},"\u5f85\u5904\u7406"),i.a.createElement(Q.a.Option,{value:"1"},"\u5f85\u786e\u8ba4"),i.a.createElement(Q.a.Option,{value:"2"},"\u5df2\u9000\u6b3e"),i.a.createElement(Q.a.Option,{value:"3"},"\u62d2\u7edd\u9000\u6b3e"))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"),window.hasPermission("refund_detailed_export")&&i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u7b5b\u9009\u7ed3\u679c"),i.a.createElement("span",{className:"clear",onClick:this.clear},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u5e97\u94fa\u540d\u79f0/\u59d3\u540d/\u624b\u673a\u53f7",dataIndex:"nickname"},{title:"\u8ba2\u5355\u7f16\u53f7",dataIndex:"trade_no"},{title:"\u9000\u6b3e\u7c7b\u578b",dataIndex:"type",render:function(e,t){switch(e){case"ORDER_EXCEPTION":return"\u8ba2\u5355\u5f02\u5e38\u9000\u6b3e";case"MEMBER_AFTER_SALE":return"\u7528\u6237\u7533\u8bf7\u552e\u540e";case"ORDER_MANUAL_CANCEL":return"\u7528\u6237\u53d6\u6d88\u9000\u6b3e";case"ORDER_PLATFORM_CANCEL":return"\u5e73\u53f0\u53d6\u6d88\u9000\u6b3e";case"ORDER_AGENT_PRODUCT_EXCEPTION":return"\u5546\u6237\u5546\u54c1\u5f02\u5e38"}}},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"applied_at"},{title:"\u9000\u6b3e\u72b6\u6001",dataIndex:"state_desc"},{title:"\u5b9e\u4ed8\u6b3e/\u9000\u6b3e\u91d1\u989d",render:function(e,t){return"".concat(t.settlement_total_fee,"\u5143/").concat(t.refund_amount,"\u5143")}},{title:"\u5907\u6ce8",dataIndex:"remark"}],rowKey:function(e){return e.refund_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component),vo=Object(U.g)(Eo),_o=(a(1283),wr.a.TabPane),go=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={active:"USER",USER:0,MERCHANT:0},a.getTotalApplications=function(e){oo({searchJson:w({member_type:e})}).then(function(t){a.setState(Object(Y.a)({},e,t.meta.pagination.total))})},a.callback=function(e){a.setState({active:e},function(){a.getTotalApplications(e)})},a.goRefundApplication=function(){var e="USER"===a.state.active?"consumer":"merchant";a.props.history.push({pathname:"/finance/refundApplication",state:{type:e}})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getTotalApplications("USER"),this.getTotalApplications("MERCHANT")}},{key:"render",value:function(){var e=this.state,t=e.USER,a=e.MERCHANT;return i.a.createElement("div",{className:"refund_detail_total"},i.a.createElement("div",{className:"coupon"},i.a.createElement(wr.a,{defaultActiveKey:"USER",activeKey:this.state.active,onChange:this.callback},i.a.createElement(_o,{tab:"\u6d88\u8d39\u8005\u9000\u6b3e",key:"USER"},i.a.createElement(ho,{total:this.state.total})),i.a.createElement(_o,{tab:"\u5546\u6237\u9000\u6b3e",key:"MERCHANT"},i.a.createElement(vo,{total:this.state.total})))),i.a.createElement("div",{className:"cr_header_total"},window.hasPermission("refund_detailed_application")&&i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.goRefundApplication},"\u9000\u6b3e\u7533\u8bf7(",t+a||0,")")))}}]),t}(n.Component);a(1284);function bo(e){return ne({url:"/api/backend/finance/merchant/withdrawals/records",method:"get",params:e})}function yo(e){return ne({url:"/api/backend/finance/merchant/withdrawals/records/batch_financial_confirm",method:"post",data:e})}var Co=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){console.log(JSON.stringify(a.child.current.state.data)),a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.showAddGroup=function(){a.props.showAddGroup(a.child.current.state.data)},a.closeAdd=function(){a.props.closeAddGroup(),a.props.closeAddTags()},a.showAddTags=function(){a.props.showAddTags(a.child.current.state.data)},a.export=function(){a.props.export(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.export},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:this.props.value,api:{getChannels:ui,groups:ha},operation:this.props.operation,slug:"merchant_withdrawal_record"})))}}]),t}(i.a.Component),ko=[{value:"money_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5e97\u94fa\u540d\u79f0",value:"shop_name",type:"equalCompare"},{label:"\u5e97\u94fa\u7f16\u53f7",value:"shop_code",type:"equalCompare"},{label:"\u5e97\u94fa\u4e3b\u59d3\u540d",value:"shop_keeper_name",type:"absoluteCompare"},{label:"\u5e97\u94fa\u4e3b\u624b\u673a\u53f7",value:"shop_keeper_mobile",type:"absoluteCompare"},{label:"\u6e20\u9053",value:"channel",type:"channel"},{label:"\u63d0\u73b0\u91d1\u989d",value:"amount",type:"numCompare"},{label:"\u7533\u8bf7\u65f6\u95f4",value:"applied_time",type:"timeCompare"},{label:"\u786e\u8ba4\u65f6\u95f4",value:"confirmed_time",type:"timeCompare"},{label:"\u6700\u540e\u786e\u8ba4\u65f6\u95f4",value:"verified_time",type:"timeCompare"},{label:"\u5ba1\u6838\u901a\u8fc7\u65f6\u95f4",value:"passed_time",type:"timeCompare"},{label:"\u5ba1\u6838\u62d2\u7edd\u65f6\u95f4",value:"failed_time",type:"timeCompare"},{label:"\u72b6\u6001",value:"state",type:"withdrawState"}]}],So={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],channel:[{label:"\u7b49\u4e8e",value:"=",type:"selectedChannelOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedChannelBox"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedChannelBox"}],detailAddress:[{label:"\u7b49\u4e8e",value:"like",type:"orderDetailAddress"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],withdrawState:[{label:"\u7b49\u4e8e",value:"=",type:"withdrawStateEqual"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u4e2d",value:"all",type:"withdrawState"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"withdrawState"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"withdrawState"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTypeEqual"}],merchantOrder:[{label:"\u7b49\u4e8e",value:"in",type:"merchantOrder"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"all",type:"merchantOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"merchantOrder"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],timeCompare:[{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"noTimePeriod"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},Oo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.props.onSubmit(a.state.value)},a.state={value:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u53d1\u653e\u5931\u8d25\u539f\u56e0",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5931\u8d25\u539f\u56e0"),i.a.createElement(Ne.a,{value:this.state.value,onChange:function(t){e.setState({value:t.target.value})}})))))}}]),t}(n.Component),No=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).goApplication=function(){a.props.history.push({pathname:"/finance/withdrawApplication"})},a.refresh=function(){a.setState({filterVisible:!1,paginationParams:{searchJson:{}}},function(){a.child.current.pagination(a.child.current.state.current)})},a.handleData=function(e){for(var t in console.log(e),e)a.setState(Object(Y.a)({},t,e[t]))},a.paginationChange=function(e){a.setState({data:e})},a.search=function(e){a.setState({api:bo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:bo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.changeStatus=function(e){a.setState({status:e},function(){a.setState({api:bo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({state:e})})},function(){a.child.current.pagination(a.child.current.state.current)})})},a.failedSend=function(){a.setState({reasonVisible:!0})},a.closeReason=function(){a.setState({reasonVisible:!1})},a.submitFailedReason=function(e){var t;(t={record_ids:a.state.checkedAry,failed_reason:e},ne({url:"/api/backend/finance/merchant/withdrawals/records/batch_fail",method:"post",data:t})).then(function(e){B.a.success(e.message),a.refresh(),a.closeReason()}).catch(function(e){})},a.sended=function(){var e=a.refresh,t=a.state.checkedAry,n=(Object(Ja.a)(a),ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u662f\u5426\u786e\u5b9a\u6240\u9009\u8bb0\u5f55\u5747\u5df2\u53d1\u653e?"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a;(a={record_ids:t},ne({url:"/api/backend/finance/merchant/withdrawals/records/batch_pass",method:"post",data:a})).then(function(t){B.a.success("\u53d1\u653e\u6210\u529f"),e()}).catch(function(e){})}}))},a.export=function(e){var t=w({strategy:"MERCHANT_WITHDRAWAL_RECORD",customize_columns:[],logic_conditions:e});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(t,"&Authorization=").concat(k())},a.state={api:bo,data:[],filterVisible:!1,paginationParams:{searchJson:{}},last_month_withdraw_total:0,summary_total:0,this_month_withdraw_total:0,status:null,checkedAry:[],reasonVisible:!1,conditions:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state.status,a={onChange:function(t,a){e.setState({checkedAry:t})}},n={visible:this.state.reasonVisible,onCancel:this.closeReason,onSubmit:this.submitFailedReason};return i.a.createElement("div",{className:"withdrawDetails"},i.a.createElement(Co,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,value:ko,operation:So,export:this.export}),i.a.createElement(Oo,n),i.a.createElement("div",{className:"wd_header"},window.hasPermission("withdraw_detailed_application")&&i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.goApplication},"\u63d0\u73b0\u7533\u8bf7")),i.a.createElement("div",{className:"wd_chartContent"},i.a.createElement("ul",{className:"header_left",style:{background:"#F6F7FA",paddingLeft:"20px"}},i.a.createElement("li",null,"\u5e97\u94fa:",i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u7f16\u53f7"})),i.a.createElement("li",null,i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"))),i.a.createElement("div",{className:"operation"},i.a.createElement("ul",{className:"left"},i.a.createElement("li",{className:t?"":"active",onClick:function(){return e.changeStatus(null)}},"\u5168\u90e8"),i.a.createElement("li",{className:1===t?"active":"",onClick:function(){return e.changeStatus(1)}},"\u53d1\u8d77\u63d0\u73b0"),i.a.createElement("li",{className:2===t?"active":"",onClick:function(){return e.changeStatus(2)}},"\u8d22\u52a1\u5904\u7406\u4e2d"),i.a.createElement("li",{className:3===t?"active":"",onClick:function(){return e.changeStatus(3)}},"\u5df2\u53d1\u653e"),i.a.createElement("li",{className:4===t?"active":"",onClick:function(){return e.changeStatus(4)}},"\u53d1\u653e\u5931\u8d25")),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{size:"small",onClick:this.sended,disabled:!this.state.checkedAry.length},"\u5df2\u53d1\u653e"),i.a.createElement(_e.a,{size:"small",style:{marginLeft:"10px"},onClick:this.failedSend,disabled:!this.state.checkedAry.length},"\u53d1\u653e\u5931\u8d25"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u5e97\u94fa\u540d\u79f0/\u59d3\u540d/\u624b\u673a\u53f7",render:function(e,t){return"".concat(t.shop_name,"/").concat(t.shop_keeper_name,"/").concat(t.shop_keeper_mobile)}},{title:"\u6e20\u9053",dataIndex:"channel_name"},{title:"\u63d0\u73b0\u91d1\u989d",dataIndex:"withdrawal_amount",render:function(e,t){return"".concat(e,"\u5143")}},{title:"\u786e\u8ba4\u65f6\u95f4",dataIndex:"applied_time"},{title:"\u63d0\u73b0\u72b6\u6001",dataIndex:"state_desc"}],rowSelection:a,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component);a(1285);var wo=G.a.RangePicker,xo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleData=function(e){for(var t in e)a.setState(Object(Y.a)({},t,e[t]))},a.state={data:[],settlement_total_amount:0,settlement_wx_total_amount:0,settlement_alipay_total_amount:0,settlement_balance_total_amount:0,settlement_cmb_total_amount:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e={},ne({url:"/api/backend/finance/payment/overview/statistics",method:"get",params:e})).then(function(e){t.handleData(e.data)})}},{key:"render",value:function(){return i.a.createElement(n.Fragment,null,i.a.createElement("ul",{className:"data"},i.a.createElement("li",null,"\u652f\u4ed8\u603b\u989d",i.a.createElement("span",null,this.state.settlement_total_amount)),i.a.createElement("li",null,"\u5fae\u4fe1\u652f\u4ed8",i.a.createElement("span",null,this.state.settlement_wx_total_amount)),i.a.createElement("li",null,"\u652f\u4ed8\u5b9d\u652f\u4ed8",i.a.createElement("span",null,this.state.settlement_alipay_total_amount)),i.a.createElement("li",null,"\u4f59\u989d\u652f\u4ed8",i.a.createElement("span",null,this.state.settlement_balance_total_amount)),i.a.createElement("li",null,"\u62db\u884c\u4e00\u7f51\u901a",i.a.createElement("span",null,this.state.settlement_cmb_total_amount))),i.a.createElement("div",{className:"id_chartContent"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",{className:"needMargin"},"\u8ba2\u5355\u7f16\u53f7\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u8ba2\u5355\u7f16\u53f7"})),i.a.createElement("li",{className:"needMargin"},"\u624b\u673a\u53f7\u7801\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801"})),i.a.createElement("li",{className:"needMargin"},"\u6d41\u6c34\u53f7\u7801\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u8f93\u5165\u6d41\u6c34\u53f7\u7801"})),i.a.createElement("li",{className:"needMargin"},"\u4ea4\u6613\u7c7b\u578b\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u9009\u62e9\u4ea4\u6613\u7c7b\u578b\uff08\u8fd9\u91cc\u662f\u4e0b\u62c9\u9009\u62e9\u6846\uff09"})),i.a.createElement("li",{className:"needMargin"},"\u652f\u4ed8\u65b9\u5f0f\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u9009\u62e9\u652f\u4ed8\u65b9\u5f0f\uff08\u8fd9\u91cc\u662f\u4e0b\u62c9\u9009\u62e9\u6846\uff09"})),i.a.createElement("li",{className:"needMargin"},"\u8ba2\u5355\u7c7b\u578b\uff1a",i.a.createElement(Ne.a,{placeholder:"\u8bf7\u9009\u62e9\u8ba2\u5355\u7c7b\u578b\uff08\u8fd9\u91cc\u662f\u4e0b\u62c9\u9009\u62e9\u6846\uff09"})),i.a.createElement("li",null,"\u4e0b\u5355\u65f6\u95f4\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(wo,{onChange:this.onDateChange}))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary"},"\u641c\u7d22"),window.hasPermission("income_detailed_export")&&i.a.createElement(_e.a,{size:"small"},"\u5bfc\u51fa\u7b5b\u9009\u7ed3\u679c"),i.a.createElement("span",{className:"clear"},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u8ba2\u5355\u53f7",dataIndex:"name"},{title:"\u4ea4\u6613\u6d41\u6c34",dataIndex:"a"},{title:"\u4ea4\u6613\u7c7b\u578b",dataIndex:"b"},{title:"\u8ba2\u5355\u7c7b\u578b",dataIndex:"c"},{title:"\u652f\u4ed8\u65b9\u5f0f",dataIndex:"cName"},{title:"\u4e0b\u5355\u65f6\u95f4",dataIndex:"mobile"},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"mobile"}],rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange}))))}}]),t}(n.Component),Io=(a(583),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.paginationChange=function(e){a.setState({data:e})},a.handleRefund=function(e,t,n){var r=a.refresh,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",e,"\u9000\u6b3e\u7533\u8bf7\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){uo({refund_ids:t,is_pass:n}).then(function(t){B.a.success("".concat(e,"\u6210\u529f\uff01")),r()})},onCancel:function(){}})},a.state={data:[],api:oo,checkedAry:[],params:{searchJson:w({member_type:"USER"})}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u6635\u79f0/\u624b\u673a\u53f7",dataIndex:"nickname"},{title:"\u8ba2\u5355\u7f16\u53f7",dataIndex:"trade_no"},{title:"\u9000\u6b3e\u7c7b\u578b",dataIndex:"type",render:function(e,t){switch(e){case"ORDER_EXCEPTION":return"\u8ba2\u5355\u5f02\u5e38\u9000\u6b3e";case"MEMBER_AFTER_SALE":return"\u7528\u6237\u7533\u8bf7\u552e\u540e";case"ORDER_MANUAL_CANCEL":return"\u7528\u6237\u53d6\u6d88\u9000\u6b3e";case"ORDER_PLATFORM_CANCEL":return"\u5e73\u53f0\u53d6\u6d88\u9000\u6b3e";case"ORDER_AGENT_PRODUCT_EXCEPTION":return"\u5546\u6237\u5546\u54c1\u5f02\u5e38"}}},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"applied_at"},{title:"\u5b9e\u4ed8\u6b3e/\u9000\u6b3e\u91d1\u989d",render:function(e,t){return"".concat(t.settlement_total_fee,"\u5143/").concat(t.refund_amount,"\u5143")}},{title:"\u5907\u6ce8",dataIndex:"remark"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",{className:"appOperation"},i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.handleRefund("\u540c\u610f\u8be5\u7b14",[a.refund_id],!0)}},"\u540c\u610f"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return e.handleRefund("\u91cd\u65b0\u5904\u7406\u8be5\u7b14",[a.refund_id],!1)}},"\u91cd\u65b0\u5904\u7406"))}}],a={onChange:function(t,a){e.setState({checkedAry:t})}};return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"ca_header"},i.a.createElement(_e.a,{size:"small",type:"primary",disabled:0==this.state.checkedAry.length,onClick:function(){return e.handleRefund("\u540c\u610f\u8be5\u82e5\u5e72\u7b14",e.state.checkedAry,!0)}}," \u540c\u610f"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:function(){return e.handleRefund("\u91cd\u65b0\u5904\u7406\u8be5\u82e5\u5e72\u7b14",e.state.checkedAry,!1)}},"\u91cd\u65b0\u5904\u7406")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:a,columns:t,rowKey:function(e){return e.refund_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.params,valChange:this.paginationChange})))}}]),t}(n.Component)),jo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.paginationChange=function(e){a.setState({data:e})},a.handleRefund=function(e,t,n){var r=a.refresh,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a",e,"\u9000\u6b3e\u7533\u8bf7\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){uo({refund_ids:t,is_pass:n}).then(function(t){B.a.success("".concat(e,"\u8be5\u7533\u8bf7\u6210\u529f\uff01")),r()})},onCancel:function(){}})},a.state={data:[],api:oo,checkedAry:[],params:{searchJson:w({member_type:"MERCHANT"})}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u6635\u79f0/\u624b\u673a\u53f7",dataIndex:"nickname"},{title:"\u8ba2\u5355\u7f16\u53f7",dataIndex:"trade_no"},{title:"\u9000\u6b3e\u7c7b\u578b",dataIndex:"type",render:function(e,t){switch(e){case"ORDER_EXCEPTION":return"\u8ba2\u5355\u5f02\u5e38\u9000\u6b3e";case"MEMBER_AFTER_SALE":return"\u7528\u6237\u7533\u8bf7\u552e\u540e";case"ORDER_MANUAL_CANCEL":return"\u7528\u6237\u53d6\u6d88\u9000\u6b3e";case"ORDER_PLATFORM_CANCEL":return"\u5e73\u53f0\u53d6\u6d88\u9000\u6b3e";case"ORDER_AGENT_PRODUCT_EXCEPTION":return"\u5546\u6237\u5546\u54c1\u5f02\u5e38"}}},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"applied_at"},{title:"\u5b9e\u4ed8\u6b3e/\u9000\u6b3e\u91d1\u989d",render:function(e,t){return"".concat(t.settlement_total_fee,"\u5143/").concat(t.refund_amount,"\u5143")}},{title:"\u5907\u6ce8",dataIndex:"remark"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",{className:"appOperation"},i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.handleRefund("\u540c\u610f\u8be5\u7b14",[a.refund_id],!0)}},"\u540c\u610f"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"10px"},onClick:function(){return e.handleRefund("\u91cd\u65b0\u5904\u7406\u8be5\u7b14",[a.refund_id],!1)}},"\u91cd\u65b0\u5904\u7406"))}}],a={onChange:function(t,a){e.setState({checkedAry:t})}};return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"ca_header"},i.a.createElement(_e.a,{size:"small",type:"primary",disabled:0==this.state.checkedAry.length,onClick:function(){return e.handleRefund("\u540c\u610f\u8be5\u82e5\u5e72\u7b14",e.state.checkedAry,!0)}}," \u540c\u610f"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:function(){return e.handleRefund("\u91cd\u65b0\u5904\u7406\u8be5\u82e5\u5e72\u7b14",e.state.checkedAry,!1)}},"\u91cd\u65b0\u5904\u7406")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:a,columns:t,rowKey:function(e){return e.refund_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.params,valChange:this.paginationChange})))}}]),t}(n.Component),To=(a(1286),wr.a.TabPane),Ro=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).callback=function(e){a.setState({activeTab:e})},a.state={activeTab:"1"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e="consumer"===this.props.location.state.type?"1":"2";this.setState({activeTab:e})}},{key:"render",value:function(){var e=this,t=this.state.activeTab;return i.a.createElement("div",{className:"coupon"},i.a.createElement(wr.a,{activeKey:t,onChange:this.callback},i.a.createElement(To,{tab:"\u6d88\u8d39\u8005\u9000\u6b3e",key:"1"},i.a.createElement(Io,null)),i.a.createElement(To,{tab:"\u5e97\u94fa\u9000\u6b3e",key:"2"},i.a.createElement(jo,null))),i.a.createElement(_e.a,{className:"goBack",size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875"))}}]),t}(n.Component),Ao=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){console.log(JSON.stringify(a.child.current.state.data)),a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.showAddGroup=function(){a.props.showAddGroup(a.child.current.state.data)},a.closeAdd=function(){a.props.closeAddGroup(),a.props.closeAddTags()},a.showAddTags=function(){a.props.showAddTags(a.child.current.state.data)},a.withdraw=function(){a.props.withdraw(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.withdraw},"\u786e\u8ba4\u63d0\u73b0"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:this.props.value,api:{getChannels:ui,groups:ha},operation:this.props.operation,slug:"merchant_withdraw_log"})))}}]),t}(i.a.Component),Do=[{value:"money_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5e97\u94fa\u540d\u79f0",value:"shop_name",type:"equalCompare"},{label:"\u5e97\u94fa\u7f16\u53f7",value:"shop_code",type:"equalCompare"},{label:"\u5e97\u94fa\u4e3b\u59d3\u540d",value:"shop_keeper_name",type:"absoluteCompare"},{label:"\u5e97\u94fa\u4e3b\u624b\u673a\u53f7",value:"shop_keeper_mobile",type:"absoluteCompare"},{label:"\u6e20\u9053",value:"channel",type:"channel"},{label:"\u63d0\u73b0\u91d1\u989d",value:"amount",type:"numCompare"},{label:"\u7533\u8bf7\u65f6\u95f4",value:"created_at",type:"timeCompare"}]}],Po={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],detailAddress:[{label:"\u7b49\u4e8e",value:"like",type:"orderDetailAddress"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],channel:[{label:"\u7b49\u4e8e",value:"=",type:"selectedChannelOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedChannelBox"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedChannelBox"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],consumerOrder:[{label:"\u7b49\u4e8e",value:"=",type:"consumerOrderEqual"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u4e2d",value:"all",type:"consumerOrder"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"consumerOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"consumerOrder"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTypeEqual"}],merchantOrder:[{label:"\u7b49\u4e8e",value:"in",type:"merchantOrder"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"all",type:"merchantOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"merchantOrder"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],timeCompare:[{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"noTimePeriod"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},Vo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).paginationChange=function(e){a.setState({data:e})},a.withdraw=function(e){e?yo({searchJson:w({logic_conditions:e})}).then(function(e){a.refresh(),B.a.success("\u63d0\u73b0\u6210\u529f"),a.setState({filterVisible:!1})}).catch(function(e){}):a.notice()},a.notice=function(){var e=a.refresh,t=Object(Ja.a)(a),n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u672a\u9009\u62e9\u9ad8\u7ea7\u7b5b\u9009\u5c06\u4f1a\u5c06\u6240\u6709\u63d0\u73b0\u7533\u8bf7\u5168\u90e8\u63d0\u73b0\uff0c\u662f\u5426\u7ee7\u7eed?"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){yo({searchJson:{}}).then(function(a){t.setState({filterVisible:!1}),e(),B.a.success("\u63d0\u73b0\u6210\u529f")}).catch(function(e){})}})},a.search=function(e){a.setState({api:bo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,state:1})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:bo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,state:1})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.refresh=function(){a.setState({filterVisible:!1,paginationParams:{searchJson:w({state:1})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.state={data:[],paginationParams:{searchJson:w({state:1})},api:bo,filterVisible:!1,checkedAry:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",{className:"withdrawApp"},i.a.createElement(Ao,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,value:Do,operation:Po,withdraw:this.withdraw}),i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("div",{className:"wa_chartContent"},i.a.createElement("ul",{className:"header_left",style:{background:"#F6F7FA",paddingLeft:"20px"}},i.a.createElement("li",null,"\u5e97\u94fa:",i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u7f16\u53f7"})),i.a.createElement("li",null,i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:[{title:"\u5e97\u94fa\u540d\u79f0/\u59d3\u540d/\u624b\u673a\u53f7",render:function(e,t){return"".concat(t.shop_name,"/").concat(t.shop_keeper_name,"/").concat(t.shop_keeper_mobile)}},{title:"\u6e20\u9053",dataIndex:"channel_name"},{title:"\u91d1\u989d",dataIndex:"withdrawal_amount"}],rowSelection:t,rowKey:function(e){return e.log_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange}))))}}]),t}(n.Component),Lo=(a(584),a(204)),Mo=(a(585),a(638)),Uo=(a(1485),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).stay=function(e){e.nativeEvent.stopImmediatePropagation()},a.close=function(){a.setState({displayColorPicker:"none"})},a.handleClick=function(){var e=a.state.displayColorPicker;e="none"===e?"block":"none",a.setState({displayColorPicker:e})},a.handleChange=function(e){var t=e.hex;a.setState({color:t}),a.props.colorChange(t)},a.state={color:e.defaultColor||"#666",displayColorPicker:"none"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.close)}},{key:"render",value:function(){var e=this.state,t=e.color,a=e.displayColorPicker;return i.a.createElement("div",{className:"reactColor",onClick:this.stay},i.a.createElement(_e.a,{onClick:this.handleClick,size:"small",style:{background:t}},i.a.createElement(me.a,{type:"down"})),i.a.createElement("div",{style:{position:"absolute",zIndex:66,display:a}},i.a.createElement(Mo.SketchPicker,{color:this.state.color,onChange:this.handleChange})))}}]),t}(i.a.Component)),Fo=Lo.a.Panel,Go=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){Vn({limit:100,page:1},a.props.location.state.item.id).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.submit=function(){var e,t,n=a.state.item.items,i=[];n.forEach(function(e){var t={};t.value=e.value,t.color=e.color||"#666",i.push(t)}),(e={content:i},t=a.state.item.id,ne({url:"/api/backend/wechat/mp/template_messages/".concat(t,"/custom/create"),method:"post",data:e})).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.valueChange=function(e,t){var n=a.state.item;n.items.forEach(function(a){a.key===e.key&&(a.value=t.target.value)}),a.setState({item:n})},a.colorChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000",n=a.state.item;n.items.forEach(function(a){a.key===e.key&&(a.color=t)}),a.setState({item:n})},a.editMessage=function(e){a.props.history.push({pathname:"/marketing/editWeChatMessage",state:{item:e,listId:a.props.location.state.item.id}})},a.show=function(e){var t=a.state.data;t.forEach(function(t){t.id===e.id&&(t.showDelete=!0)}),a.setState({data:t})},a.hide=function(e){var t=a.state.data;t.forEach(function(t){t.id===e.id&&(t.showDelete=!1)}),a.setState({data:t})},a.delete=function(e){Ln({},a.props.location.state.item.id,e.id).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.child=i.a.createRef(),a.state={item:e.location.state.item,data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=this.state,a=t.item,r=t.data;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"newBox"},i.a.createElement("div",{className:"preview"},i.a.createElement("h3",null,"\u5fae\u4fe1\u6a21\u677f\u6d88\u606f"),i.a.createElement("div",{className:"m_ul"},i.a.createElement("h4",null,a.title),i.a.createElement("ul",null,a.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value",style:{color:e.color||"#666"}},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"})))),i.a.createElement("div",{className:"configuration"},i.a.createElement("h2",null,"\u914d\u7f6e"),i.a.createElement("ul",null,a.items.map(function(t){return i.a.createElement("li",{key:t.key},i.a.createElement("span",null,t.key),i.a.createElement(Ne.a,{value:t.value,onChange:function(a){return e.valueChange(t,a)}}),i.a.createElement(Uo,{ref:e.child,colorChange:function(a){return e.colorChange(t,a)}}))})),i.a.createElement("div",{className:"btnBox"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.submit},"\u7acb\u5373\u521b\u5efa"))),i.a.createElement("div",{className:"information"},i.a.createElement("h3",null,"\u914d\u7f6e\u5c0f\u52a9\u624b(\u8865\u5145\u8bf4\u660e)"),i.a.createElement("span",{className:"span"},"\u5404\u4e2a\u914d\u7f6e\u9879\u4e2d\uff0c\u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6587\u672c\uff0c\u5728\u9700\u8981\u7684\u5730\u65b9\u5173\u8054\u4e0a\u6b64\u6a21\u677f\u6d88\u606f\u4e4b\u540e\uff0c\u5c06\u91c7\u7528\u4f60\u81ea\u5b9a\u4e49\u7684\u5185\u5bb9\u53bb\u53d1\u9001\u6d88\u606f\u7ed9\u7528\u6237\u3002\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5927\u62ec\u53f7\u7684\u5f62\u5f0f\uff0c\u5982xxx\uff0c\u5176\u4e2d\uff0cxxx\u4ee3\u8868\u7684\u662f\u4e0b\u65b9\u67d0\u4e00\u7c7b\u4e2d\u7684\u53ef\u9009\u9879\uff0c\u586b\u5199\u65f6\u8bf7\u67e5\u770b\u5c0f\u624b\u518c\uff0c\u5426\u5219\uff0c\u4e0d\u5728\u4e0b\u65b9\u5c0f\u624b\u518c\u4e2d\u7684\u503c\u5c06\u4ee5\u4f60\u586b\u5199\u7684\u5927\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u53d1\u9001\u3002"),i.a.createElement("span",null,"\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u586b\u5199\u6b63\u786e\u7684\u5339\u914d\u9879\uff0c\u5982\u4e0d\u8981\u5728\u4f18\u60e0\u5238\u6709\u5173\u7684\u6a21\u677f\u4fe1\u606f\u4e2d\u586b\u5199\u8ba2\u5355\u4e2d\u7684\u914d\u7f6e\u9879\uff0c\u9020\u6210\u4e0d\u53ef\u8bc6\u522b\u7684\u914d\u7f6e\u9879\u4ecd\u7136\u5c06\u4ee5\u4f60\u586b\u5199\u7684\u5927\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u53d1\u9001\u3002"),i.a.createElement(Lo.a,{bordered:!1},i.a.createElement(Fo,{header:"\u4f18\u60e0\u5238",key:"1"},i.a.createElement("p",null,"title: \u4f18\u60e0\u5238\u6807\u9898"),i.a.createElement("p",null,"validateTime: \u4f18\u60e0\u5238\u6709\u6548\u65f6\u95f4"),i.a.createElement("p",null,"cardCode: \u4f18\u60e0\u5238\u7f16\u7801code")),i.a.createElement(Fo,{header:"\u8ba2\u5355",key:"2"},i.a.createElement("p",null,"username: \u7528\u6237\u6635\u79f0\uff0c\u672a\u7ed1\u5b9a\u624b\u673a\u53f7\u975e\u7528\u6237\u65f6\u5219\u586b\u767b\u5f55\u65f6\u6635\u79f0"),i.a.createElement("p",null,"name: \u540cusername"),i.a.createElement("p",null,"selfPickUpCode: \u81ea\u63d0\u7801"),i.a.createElement("p",null,"address: \u81ea\u63d0\u5730\u5740\u3001\u65e9\u9910\u8f66\u5730\u5740"),i.a.createElement("p",null,"pickUpTime: \u81ea\u63d0\u65f6\u95f4"),i.a.createElement("p",null,"title: \u5f85\u81ea\u63d0\u7684\u5546\u54c1\u540d\u79f0"),i.a.createElement("p",null,"amount: \u8ba2\u5355\u5b9e\u4ed8\u91d1\u989d"),i.a.createElement("p",null,"paidAt: \u652f\u4ed8\u65f6\u95f4"))))),i.a.createElement("div",{className:"m_list"},r.map(function(t){return i.a.createElement("div",{className:"m_list_item"},i.a.createElement("div",{className:"m_ul",onMouseEnter:function(){return e.show(t)},onMouseLeave:function(){return e.hide(t)}},i.a.createElement("h4",null,t.title),i.a.createElement("ul",{onClick:function(){return e.editMessage(t)}},t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value",style:{color:e.color||"#666"}},e.value))})),i.a.createElement("p",{onClick:function(){return e.editMessage(t)}},i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"})),i.a.createElement("div",{className:"delete",style:{visibility:t.showDelete?"visible":"hidden"},onClick:function(){return e.delete(t)}},i.a.createElement(de,{type:"icon-delete-fill"}))))})))}}]),t}(n.Component),Bo=Object(U.g)(Go),zo=Lo.a.Panel,Ho=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){Vn({limit:10,page:1},a.state.id).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.submit=function(){var e,t,n,i=a.state.item.items,r=[];i.forEach(function(e){var t={};t.value=e.value,t.color=e.color||"#666",r.push(t)}),(e={content:r},t=a.state.id,n=a.state.item.id,ne({url:"/api/backend/wechat/mp/template_messages/".concat(t,"/custom/").concat(n),method:"put",data:e})).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.valueChange=function(e,t){var n=a.state.item;n.items.forEach(function(a){a.key===e.key&&(a.value=t.target.value)}),a.setState({item:n})},a.colorChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000",n=a.state.item;n.items.forEach(function(a){a.key===e.key&&(a.color=t)}),a.setState({item:n})},a.show=function(e){e.showDelete=!0,a.setState({item:e})},a.hide=function(e){e.showDelete=!1,a.setState({item:e})},a.delete=function(e){Ln({},a.state.id,e.id).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.child=i.a.createRef(),a.state={item:e.location.state.item,id:e.location.state.listId,data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=this.state,a=t.item,r=t.data;return i.a.createElement(n.Fragment,null,i.a.createElement("div",{className:"newBox"},i.a.createElement("div",{className:"preview"},i.a.createElement("h3",null,"\u5fae\u4fe1\u6a21\u677f\u6d88\u606f"),i.a.createElement("div",{className:"m_ul"},i.a.createElement("h4",null,a.title),i.a.createElement("ul",null,a.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value",style:{color:e.color||"#666"}},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"})))),i.a.createElement("div",{className:"configuration"},i.a.createElement("h2",null,"\u914d\u7f6e"),i.a.createElement("ul",null,a.items.map(function(t){return i.a.createElement("li",{key:t.key},i.a.createElement("span",null,t.key),i.a.createElement(Ne.a,{value:t.value,onChange:function(a){return e.valueChange(t,a)}}),i.a.createElement(Uo,{defaultColor:t.color,ref:e.child,colorChange:function(a){return e.colorChange(t,a)}}))})),i.a.createElement("div",{className:"btnBox"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.submit},"\u7acb\u5373\u66f4\u65b0"))),i.a.createElement("div",{className:"information"},i.a.createElement("h3",null,"\u914d\u7f6e\u5c0f\u52a9\u624b(\u8865\u5145\u8bf4\u660e)"),i.a.createElement("span",{className:"span"},"\u5404\u4e2a\u914d\u7f6e\u9879\u4e2d\uff0c\u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6587\u672c\uff0c\u5728\u9700\u8981\u7684\u5730\u65b9\u5173\u8054\u4e0a\u6b64\u6a21\u677f\u6d88\u606f\u4e4b\u540e\uff0c\u5c06\u91c7\u7528\u4f60\u81ea\u5b9a\u4e49\u7684\u5185\u5bb9\u53bb\u53d1\u9001\u6d88\u606f\u7ed9\u7528\u6237\u3002\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5927\u62ec\u53f7\u7684\u5f62\u5f0f\uff0c\u5982xxx\uff0c\u5176\u4e2d\uff0cxxx\u4ee3\u8868\u7684\u662f\u4e0b\u65b9\u67d0\u4e00\u7c7b\u4e2d\u7684\u53ef\u9009\u9879\uff0c\u586b\u5199\u65f6\u8bf7\u67e5\u770b\u5c0f\u624b\u518c\uff0c\u5426\u5219\uff0c\u4e0d\u5728\u4e0b\u65b9\u5c0f\u624b\u518c\u4e2d\u7684\u503c\u5c06\u4ee5\u4f60\u586b\u5199\u7684\u5927\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u53d1\u9001\u3002"),i.a.createElement("span",null,"\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u586b\u5199\u6b63\u786e\u7684\u5339\u914d\u9879\uff0c\u5982\u4e0d\u8981\u5728\u4f18\u60e0\u5238\u6709\u5173\u7684\u6a21\u677f\u4fe1\u606f\u4e2d\u586b\u5199\u8ba2\u5355\u4e2d\u7684\u914d\u7f6e\u9879\uff0c\u9020\u6210\u4e0d\u53ef\u8bc6\u522b\u7684\u914d\u7f6e\u9879\u4ecd\u7136\u5c06\u4ee5\u4f60\u586b\u5199\u7684\u5927\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u53d1\u9001\u3002"),i.a.createElement(Lo.a,{bordered:!1},i.a.createElement(zo,{header:"\u4f18\u60e0\u5238",key:"1"},i.a.createElement("p",null,"title: \u4f18\u60e0\u5238\u6807\u9898"),i.a.createElement("p",null,"validateTime: \u4f18\u60e0\u5238\u6709\u6548\u65f6\u95f4"),i.a.createElement("p",null,"cardCode: \u4f18\u60e0\u5238\u7f16\u7801code")),i.a.createElement(zo,{header:"\u8ba2\u5355",key:"2"},i.a.createElement("p",null,"selfPickUpCode: \u81ea\u63d0\u7801"),i.a.createElement("p",null,"address: \u81ea\u63d0\u5730\u5740\u3001\u65e9\u9910\u8f66\u5730\u5740"),i.a.createElement("p",null,"pickUpTime: \u81ea\u63d0\u65f6\u95f4"),i.a.createElement("p",null,"title: \u5f85\u81ea\u63d0\u7684\u5546\u54c1\u540d\u79f0"),i.a.createElement("p",null,"amount: \u8ba2\u5355\u5b9e\u4ed8\u91d1\u989d"),i.a.createElement("p",null,"paidAt: \u652f\u4ed8\u65f6\u95f4"))))),i.a.createElement("div",{className:"m_list"},r.map(function(t){return i.a.createElement("div",{className:"m_list_item"},i.a.createElement("div",{className:"m_ul",onMouseEnter:function(){return e.show(t)},onMouseLeave:function(){return e.hide(t)}},i.a.createElement("h4",null,t.title),i.a.createElement("ul",null,t.items.map(function(e){return i.a.createElement("li",{key:e.key},i.a.createElement("span",{className:"key"},e.key),i.a.createElement("span",{className:"value",style:{color:e.color||"#666"}},e.value))})),i.a.createElement("p",null,i.a.createElement("span",null,"\u67e5\u770b\u8be6\u60c5"),i.a.createElement(me.a,{type:"right"})),i.a.createElement("div",{className:"delete",style:{visibility:t.showDelete?"visible":"hidden"},onClick:function(){return e.delete(t)}},i.a.createElement(de,{type:"icon-delete-fill"}))))})))}}]),t}(n.Component),Ko=a(296);a(611);function Jo(e){return ne({url:"/api/backend/distribution/sales/cashback/platform/summaries",method:"get",params:e})}function Wo(e,t){return ne({url:"/api/backend/distribution/sales/cashback/platform/summaries/".concat(t,"/records"),method:"get",params:e})}var Yo=G.a.MonthPicker,qo=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(e,"..."),a.setState({filterVisible:!1,paginationParams:{searchJson:e}},function(){a.child.current.pagination(a.child.current.state.current)})},a.export=function(e){var t=w({strategy:"MERCHANT_MONTH_SALES_CASHBACK_RECORD",customize_columns:[],logic_conditions:[],summary_id:e.id});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(t,"&Authorization=").concat(k())},a.details=function(e){a.props.history.push({pathname:"/distribution/cashbackDetails",state:{id:e.id}})},a.handleStatistics=function(e){a.props.history.push({pathname:"/distribution/distributionStatistics/handleStatistics",state:{id:e.id,type:"basic"}})},a.paginationChange=function(e){a.setState({data:e})},a.onDateChange=function(e,t){var n=t.split("-");a.refresh(w({year:Number(n[0]),month:Number(n[1])}))},a.selectWholeYear=function(){a.refresh(w({year:2020}))};var n=[{title:"\u6c47\u603b\u6708\u4efd",dataIndex:"month",render:function(e,t){return i.a.createElement("span",null,t.summary_year+"-"+t.summary_month)}},{title:"\u603b\u9500\u552e\u989d",dataIndex:"sales_amount"},{title:"\u603b\u8fd4\u4f63\u989d",dataIndex:"amount"},{title:"\u5e02\u573a\u63a8\u5e7f\u670d\u52a1\u8d39",dataIndex:"market_promotion_service_fee"},{title:"\u53d1\u653e\u72b6\u6001",dataIndex:"issue_state_desc"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.export(t)}},"\u5bfc\u51fa"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return a.details(t)}},"\u8be6\u60c5"),t.can_adjust&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return a.handleStatistics(t)}},"\u5904\u7406"))}}];return a.state={filterVisible:!1,customVisible:!1,api:Jo,value:"",data:[],paginationParams:{searchJson:{}},columns:n},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"basic_statistics"},i.a.createElement("div",{className:"basic_statistics_header"},i.a.createElement("ul",{className:"header_left"},i.a.createElement("li",null,"\u65f6\u95f4:",i.a.createElement(Yo,{picker:"month",placeholder:"\u8bf7\u9009\u62e9\u6708\u4efd",locale:Ko.a,onChange:this.onDateChange,renderExtraFooter:function(){return i.a.createElement("span",{onClick:e.selectWholeYear,style:{cursor:"pointer",color:"#4f9863"}},"\u4e00\u6574\u5e74")}})),i.a.createElement("li",null,i.a.createElement(_e.a,{type:"primary",size:"small"},"\u7b5b\u9009")))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{text:"\u6761\u6570\u636e",api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),Xo=(a(1486),function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(qo,this.props))}}]),t}(n.Component));function $o(e){return ne({url:"/api/backend/distribution/self_pick/cashback/records",method:"get",params:e})}var Qo=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){console.log(JSON.stringify(a.child.current.state.data)),a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.showAddGroup=function(){a.props.showAddGroup(a.child.current.state.data)},a.closeAdd=function(){a.props.closeAddGroup(),a.props.closeAddTags()},a.showAddTags=function(){a.props.showAddTags(a.child.current.state.data)},a.export=function(){a.props.export(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.export},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:this.props.value,operation:this.props.operation,slug:"merchant_self_pick_cashback_record"})))}}]),t}(i.a.Component),Zo=[{value:"money_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u8fd4\u73b0\u65f6\u95f4",value:"commission_at",type:"timeCompare"}]}],eu={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],detailAddress:[{label:"\u7b49\u4e8e",value:"like",type:"orderDetailAddress"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],consumerOrder:[{label:"\u7b49\u4e8e",value:"=",type:"consumerOrderEqual"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u4e2d",value:"all",type:"consumerOrder"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"consumerOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"consumerOrder"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTypeEqual"}],merchantOrder:[{label:"\u7b49\u4e8e",value:"in",type:"merchantOrder"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"all",type:"merchantOrder"},{label:"\u4e0d\u7b49\u4e8e\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"merchantOrder"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],timeCompare:[{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"noTimePeriod"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},tu=(a(1487),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.state={items:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(console.log(e),e.items&&e.items.length){var a=e.items;a.forEach(function(e){var t=[];for(var a in e.spec_value)t.push(e.spec_value[a]);e.spec_desc=t.join(",")}),this.setState({items:a,text:e.text})}}},{key:"render",value:function(){var e=this.state.items;return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:this.state.text,width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"distributionsReviews"},e&&e.length&&e.map(function(e,t){return i.a.createElement("li",{key:t,className:t%2?"":"dark-row"},i.a.createElement("div",{className:"right"},i.a.createElement("span",null,e.name)))}))))}}]),t}(i.a.Component)),au=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:""}},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:$o,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.search=function(e){a.setState({api:$o,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.reviewGoods=function(e,t){a.setState({reviewGoodsVisible:!0,items:e,text:t})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.paginationChange=function(e){a.setState({data:e})},a.onDateChange=function(){},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0,isToday:!1},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){console.log(e,"--- type---"),console.log(a,">>>>>>>>>>>>>>>>>>>>>>>>>>");var n=w({strategy:e,customize_columns:t,logic_conditions:a});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())};var n=[{title:"\u8fd4\u73b0\u65f6\u95f4",dataIndex:"cashback_time"},{title:"\u5e97\u94fa",dataIndex:"shop_name"},{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no"},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u5546\u54c1",render:function(e,t){return t.products.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.products[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.products)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u7528\u6237",dataIndex:"user_name"},{title:"\u8fd4\u73b0\u91d1\u989d",dataIndex:"cashback_amount",render:function(e,t){return"".concat(e,"\u5143")}}];return a.state={filterVisible:!1,customVisible:!1,exportVisible:!1,api:$o,data:[],paginationParams:{logic_conditions:[],search:""},columns:n,reviewGoodsVisible:!1,items:[],conditions:{}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"MERCHANT_SELF_PICK_CASHBACK_RECORD",value:"\u5e97\u94fa\u81ea\u63d0\u8fd4\u4f63",showSelector:!1}],conditions:this.state.conditions};return i.a.createElement("div",{className:"basic_statistics"},i.a.createElement(dn,e),i.a.createElement(tu,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items,text:"\u5546\u54c1"}),i.a.createElement(Qo,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,value:Zo,operation:eu,export:this.showExport}),i.a.createElement("div",{className:"basic_statistics_header"},i.a.createElement("ul",{className:"header_left"},i.a.createElement("li",null,"\u5e97\u94fa:",i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u7f16\u53f7/\u5e97\u94fa\u4e3b\u59d3\u540d/\u624b\u673a\u53f7\u7801"})),i.a.createElement("li",null,i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009")))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{text:"\u6761\u6570\u636e",api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),nu=(G.a.RangePicker,G.a.MonthPicker),iu=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.setState({filterVisible:!1,paginationParams:{searchJson:e}},function(){a.child.current.pagination(a.child.current.state.current)})},a.handleStatistics=function(e){a.props.history.push({pathname:"/distribution/distributionStatistics/handleStatistics",state:{id:e.id,type:"Sales"}})},a.search=function(e){a.setState({api:Jo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.send=function(e){var t=a.state.canClick,n=Object(Ja.a)(a);if(t){a.setState({canClick:!1});var r=a.refresh,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u53d1\u653e\u8be5\u7b14\u4f63\u91d1\u5417?"),okText:"\u77e5\u9053\u4e86",onOk:function(){var t,a;(t={},a=e.id,ne({url:"/api/backend/distribution/sales/cashback/platform/summaries/".concat(a,"/issue_balance"),method:"put",data:t})).then(function(e){B.a.success(e.message),n.setState({canClick:!0}),r()})},onCancel:function(){n.setState({canClick:!0})}})}},a.details=function(e){a.props.history.push({pathname:"/distribution/cashbackDetails",state:{id:e.id,type:"saleCashback"}})},a.paginationChange=function(e){a.setState({data:e})},a.onDateChange=function(e,t){var n=t.split("-");a.refresh(w({year:Number(n[0]),month:Number(n[1])}))},a.selectWholeYear=function(){a.refresh(w({year:2020}))};var n=[{title:"\u8fd4\u4f63\u65f6\u95f4",dataIndex:"add_to_balance_time",render:function(e,t){return i.a.createElement("span",null,e||"\u6682\u65e0")}},{title:"\u6c47\u603b\u6708\u4efd",dataIndex:"month",render:function(e,t){return i.a.createElement("span",null,t.summary_year+"-"+t.summary_month)}},{title:"\u603b\u9500\u552e\u989d",dataIndex:"sales_amount"},{title:"\u603b\u8fd4\u4f63\u989d",dataIndex:"amount"},{title:"\u5e02\u573a\u63a8\u5e7f\u670d\u52a1\u8d39",dataIndex:"market_promotion_service_fee"},{title:"\u53d1\u653e\u72b6\u6001",dataIndex:"issue_state_desc"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,t.can_issue&&i.a.createElement("span",{style:{color:a.state.canClick?"#4F9863":"#ccc",cursor:"pointer",marginRight:"20px"},onClick:function(){return a.send(t)}},"\u53d1\u9001"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.details(t)}},"\u8be6\u60c5"),t.can_adjust&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return a.handleStatistics(t)}},"\u5904\u7406"))}}];return a.state={filterVisible:!1,customVisible:!1,api:Jo,data:[],paginationParams:{logic_conditions:[],search:""},columns:n,reviewGoodsVisible:!1,items:[],canClick:!0},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"basic_statistics"},i.a.createElement("div",{className:"basic_statistics_header"},i.a.createElement("ul",{className:"header_left"},i.a.createElement("li",null,"\u6c47\u603b\u6708\u4efd:",i.a.createElement(nu,{picker:"month",placeholder:"\u8bf7\u9009\u62e9\u6708\u4efd",locale:Ko.a,onChange:this.onDateChange,renderExtraFooter:function(){return i.a.createElement("span",{onClick:e.selectWholeYear,style:{cursor:"pointer",color:"#4f9863"}},"\u4e00\u6574\u5e74")}})),i.a.createElement("li",null,i.a.createElement("h4",{className:"higherFilter"},"\u7b5b\u9009")))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{text:"\u6761\u6570\u636e",api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),ru=wr.a.TabPane,lu=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).callback=function(e){console.log(e)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"distributionStatistics"},i.a.createElement(wr.a,{defaultActiveKey:"PICKUP_CASHBACK",onChange:this.callback},i.a.createElement(ru,{tab:"\u81ea\u63d0\u8fd4\u73b0",key:"PICKUP_CASHBACK"},i.a.createElement(au,null)),i.a.createElement(ru,{tab:"\u9500\u552e\u8fd4\u73b0",key:"SALE_CASHBACK"},i.a.createElement(iu,this.props)))))}}]),t}(n.Component),su=(a(1488),a(1489),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.check=function(){var e=a.state,t=e.ratio,n=e.title,i=e.min_pv,r=e.max_pv;n?(console.log(i),"undefined"!==typeof i&&null!==i&&""!==i?r?t?i-r>0?B.a.error("\u5206\u533a\u6700\u5c0f\u503c\u4e0d\u53ef\u5927\u4e8e\u5206\u533a\u6700\u5927\u503c"):a.submit(n,i,r,t):B.a.error("\u8bf7\u586b\u5199\u5206\u4f63\u6bd4\u4f8b"):B.a.error("\u8bf7\u586b\u5199\u533a\u95f4\u6700\u5927\u503c"):B.a.error("\u8bf7\u586b\u5199\u533a\u95f4\u6700\u5c0f\u503c")):B.a.error("\u8bf7\u586b\u5199\u540d\u79f0")},a.submit=function(e,t,n,i){t=parseInt(t),n=parseInt(n),i=parseInt(i),(a.state.id?Ur:Lr)({title:e,min_pv:t,max_pv:n,ratio:i},a.state.id).then(function(e){a.setState({ratio:"",title:"",min_pv:"",max_pv:""},function(){B.a.success(e.message),a.handleCancel(),a.props.refresh()})}).catch(function(e){})},a.state={ratio:"",title:"",min_pv:"",max_pv:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){for(var a in console.log(e),console.log(e),e.record)this.setState(Object(Y.a)({},a,e.record[a]))}},{key:"render",value:function(){var e=this;return i.a.createElement(ge.a,{title:"\u65b0\u5efa\u4f63\u91d1\u6bd4\u4f8b",maskClosable:!1,width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.check,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",placeholder:"\u8bf7\u586b\u5199\u540d\u79f0",value:this.state.title,onChange:function(t){e.setState({title:t.target.value})}})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"PV\u533a\u95f4"),i.a.createElement("div",{className:"rangeRatioBox"},i.a.createElement(Ne.a,{className:"rangeRatioInput",placeholder:"\u8bf7\u586b\u5199\u533a\u95f4\u6700\u5c0f\u503c",value:this.state.min_pv,onChange:function(t){e.setState({min_pv:t.target.value})}}),"-",i.a.createElement(Ne.a,{className:"rangeRatioInput",placeholder:"\u8bf7\u586b\u5199\u533a\u95f4\u6700\u5927\u503c",value:this.state.max_pv,onChange:function(t){e.setState({max_pv:t.target.value})}}))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5206\u4f63\u6bd4\u4f8b"),i.a.createElement(Ne.a,{className:"liInput",placeholder:"\u8bf7\u586b\u5199\u5206\u4f63\u6bd4\u4f8b",value:this.state.ratio,onChange:function(t){e.setState({ratio:t.target.value})}}))))}}]),t}(n.Component)),cu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e;Mr({}).then(function(e){e.data.forEach(function(e){a.setState(Object(Y.a)({},e.key,e.value))})}),(e={limit:100,page:1},ne({url:"/api/backend/distribution/bonus/levels",method:"get",params:e})).then(function(e){a.setState({tableData:e.data})}).catch(function(e){})},a.delete=function(e){var t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u533a\u95f4\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,n;(a={},n=e.id,ne({url:"/api/backend/distribution/bonus/levels/".concat(n),method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})},onCancel:function(){}})},a.createNew=function(){a.setState({visible:!0,record:{ratio:"",title:"",min_pv:"",max_pv:""}})},a.close=function(){a.setState({visible:!1})},a.valueChange=function(e,t){t="PI"===e?parseFloat(t):parseInt(t),a.setState(Object(Y.a)({},e,t))},a.edit=function(e){a.setState({record:e,visible:!0})},a.submitSetting=function(e){Ie({type:"DISTRIBUTION",key:e,value:a.state[e]}).then(function(e){B.a.success(e.message)})},a.state={tableData:[],visible:!1,record:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u533a\u95f4\u540d\u79f0",dataIndex:"title"},{title:"PV\u533a\u95f4",render:function(e,t){return"".concat(t.min_pv," - ").concat(t.max_pv)}},{title:"\u5206\u4f63\u6bd4\u4f8b(%)",dataIndex:"ratio"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.edit(a)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return e.delete(a)}},"\u5220\u9664"))}}],a=this.state,n={visible:this.state.visible,onClose:this.close,refresh:this.refresh,record:this.state.record};return i.a.createElement("div",{className:"cash_back_setting"},i.a.createElement(su,n),i.a.createElement("ul",{className:"setting_items"},i.a.createElement("li",null,i.a.createElement("h4",null,"\u751f\u4ea7\u529b\u6307\u6570\u8bbe\u7f6e:"),i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",null,i.a.createElement("h5",null,"\u751f\u4ea7\u529b\u6307\u6570:"),i.a.createElement(Ne.a,{type:"number",value:a.PI,onChange:function(t){return e.valueChange("PI",t.target.value)},onBlur:function(t){return e.submitSetting("PI")}})),i.a.createElement("span",null,i.a.createElement("h5",null,"\u51c0\u8425\u4e1a\u989d\u6362\u7b97\u6bd4\u7387(%)\uff1a"),i.a.createElement(Ne.a,{type:"number",value:a.NET_SALES_CONVERSION_RATIO,onBlur:function(t){return e.submitSetting("NET_SALES_CONVERSION_RATIO")},onChange:function(t){return e.valueChange("NET_SALES_CONVERSION_RATIO",t.target.value)}})))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u81ea\u63d0\u8fd4\u73b0\u8bbe\u7f6e:"),i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",null,i.a.createElement("h5",null,"\u81ea\u63d0\u8865\u8d34\u6bd4\u4f8b(%):"),i.a.createElement(Ne.a,{type:"number",onBlur:function(t){return e.submitSetting("SELF_PICK_SUBSIDY_RATIO")},value:a.SELF_PICK_SUBSIDY_RATIO,onChange:function(t){return e.valueChange("SELF_PICK_SUBSIDY_RATIO",t.target.value)}})),i.a.createElement("span",null,i.a.createElement("h5",null,"\u81ea\u63d0\u4f63\u91d1\u6bd4\u4f8b(%)\uff1a"),i.a.createElement(Ne.a,{type:"number",onBlur:function(t){return e.submitSetting("SELF_PICK_COMMISSION_RATIO")},value:a.SELF_PICK_COMMISSION_RATIO,onChange:function(t){return e.valueChange("SELF_PICK_COMMISSION_RATIO",t.target.value)}})))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u9500\u552e\u8fd4\u73b0\u8bbe\u7f6e:"),i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",null,i.a.createElement("h5",null,"\u9500\u552e\u8865\u8d34\u6bd4\u4f8b(%):"),i.a.createElement(Ne.a,{type:"number",onBlur:function(t){return e.submitSetting("SALES_SUBSIDY_RATIO")},value:a.SALES_SUBSIDY_RATIO,onChange:function(t){return e.valueChange("SALES_SUBSIDY_RATIO",t.target.value)}})),i.a.createElement("span",null,i.a.createElement("h5",null,"\u9500\u552e\u4f63\u91d1\u6bd4\u4f8b(%)\uff1a"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.createNew},"\u589e\u52a0\u4f63\u91d1\u6bd4\u4f8b"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.tableData})))))}}]),t}(n.Component),ou=(a(1490),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).search=function(){var e={};a.state.searchJson.admin_id&&(e.admin_id=a.state.searchJson.admin_id),a.state.searchJson.operate_date&&(e.operate_date=a.state.searchJson.operate_date),console.log(e),a.setState({api:ul,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w(e)})},function(){a.child.current.pagination(a.child.current.state.current)})},a.setData=function(e){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{admin_id:e})})},a.onDateChange=function(e,t){a.setState({searchJson:Object(be.a)({},a.state.searchJson,{operate_date:t})})},a.paginationChange=function(e){a.setState({data:e})},a.state={data:[],api:ul,paginationParams:{search:""},searchJson:{admin_id:"",operate_date:""},admins:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;cl({}).then(function(t){e.setState({admins:t.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=[{title:"\u64cd\u4f5c\u4eba",dataIndex:"operator_name"},{title:"\u9875\u9762",dataIndex:"page_name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u884c\u4e3a",dataIndex:"action",render:function(e,t){return i.a.createElement("span",null,e||"\u65e0")}},{title:"\u64cd\u4f5c\u65e5\u671f",dataIndex:"operate_at"},{title:"IP",dataIndex:"ip"}];return i.a.createElement("div",{className:"operationLogs"},i.a.createElement("ul",{className:"filter"},i.a.createElement("li",null,"\u64cd\u4f5c\u4eba\uff1a",i.a.createElement(Q.a,{placeholder:"\u8bf7\u9009\u62e9\u64cd\u4f5c\u4eba",value:this.state.searchJson.admin_id,onChange:function(t){return e.setData(t)},defaultActiveFirstOption:!1},this.state.admins.map(function(e){return i.a.createElement(Q.a.Option,{value:e.id},e.name)}))),i.a.createElement("li",null,"\u64cd\u4f5c\u65e5\u671f\uff1a",i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:this.onDateChange}))),i.a.createElement("li",{className:"button"},i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.search},"\u641c\u7d22"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,text:"\u6761\u8bb0\u5f55",valChange:this.paginationChange})))}}]),t}(n.Component)),uu=(a(1491),function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(o.a)(this,Object(u.a)(t).call(this))).handleCancel=function(){e.props.onClose()},e.handleSubmit=function(){var t=e.child.current.state.imgUrl||e.child.current.state.imageUrl,a=Object(Ja.a)(e).state;if(a.name)if(a.desc)if(t){if("FULL_REDUCTION"===a.type){if(!a.limit_amount)return void B.a.error("\u8bf7\u586b\u5199\u4eab\u53d7\u4f18\u60e0\u6d3b\u52a8\u4ea7\u54c1\u7684\u8d2d\u4e70\u91d1\u989d");if(!a.discount_amount)return void B.a.error("\u8bf7\u586b\u5199\u6ee1\u51cf\u91d1\u989d")}a.image=t,a.use_conditions=[],a.use_conditions.push({strategy:a.userType}),e.props.onSubmit(a)}else B.a.error("\u8bf7\u4e0a\u4f20\u6d3b\u52a8\u56fe\u7247");else B.a.error("\u8bf7\u8f93\u5165\u6d3b\u52a8\u63cf\u8ff0");else B.a.error("\u8bf7\u8f93\u5165\u6d3b\u52a8\u540d\u79f0")},e.onChange=function(t,a,n){n&&a.target.value<0&&(a.target.value=0),e.setState(Object(Y.a)({},t,a.target.value))},e.onRadioChange=function(t){e.setState(Object(Y.a)({},t,!e.state[t]))},e.disabledDate=function(e){return e&&e<=J()().endOf("day")},e.onDateChange=function(t,a,n){e.setState(Object(Y.a)({},n,a))},e.state={name:"",type:"DISCOUNT",desc:"",buy_max_num:0,act_price:0,limit_amount:0,max_discount_amount:0,discount:100,discount_amount:0,status:0,userType:"ACTIVITY_USE_IN_ALL_USER_SET",user_limit_day:0,user_limit_num:0,is_join_sales_cashback:!1},e.child=i.a.createRef(),e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a={display:"block",height:"30px",lineHeight:"30px"};return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u521b\u5efa\u6d3b\u52a8",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u540d\u79f0: "),i.a.createElement(Ne.a,{maxLength:8,className:"liInput",value:t.name,onChange:function(t){return e.onChange("name",t)}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u63cf\u8ff0: "),i.a.createElement(Ne.a,{className:"liInput",value:t.desc,onChange:function(t){return e.onChange("desc",t)}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u56fe\u7247: "),i.a.createElement(ta,{ref:this.child})),i.a.createElement("li",null,i.a.createElement("span",null,"\u9650\u8d2d\u5468\u671f\uff08\u5929\uff09: "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.user_limit_day,onChange:function(t){return e.onChange("user_limit_day",t,!0)}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u9650\u8d2d\u6570\u91cf\uff08\u4ef6\uff09: "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.user_limit_num,onChange:function(t){return e.onChange("user_limit_num",t,!0)}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u662f\u5426\u53c2\u4e0e\u9500\u552e\u8fd4\u4f63"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onChange("is_join_sales_cashback",t)},value:this.state.is_join_sales_cashback},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u4eba\u7fa4\u8bbe\u7f6e: "),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onChange("userType",t)},value:this.state.userType},i.a.createElement(mn.a,{value:"ACTIVITY_USE_IN_ALL_USER_SET"},"\u5168\u90e8\u7528\u6237"),i.a.createElement(mn.a,{value:"ACTIVITY_USE_IN_NEW_USER_SET"},"\u65b0\u7528\u6237"))),i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u7c7b\u578b: "),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onChange("type",t)},value:this.state.type},i.a.createElement(mn.a,{style:a,value:"DISCOUNT"},"\u6298\u6263\u6d3b\u52a8"),i.a.createElement(mn.a,{style:a,value:"FULL_REDUCTION"},"\u6ee1\u51cf\u6d3b\u52a8"),i.a.createElement(mn.a,{style:a,value:"NONE"},"\u65e0\u7279\u6b8a\u4f18\u60e0"))),"NONE"===this.state.type&&i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u7edf\u4e00\u4ef7\u683c: "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.act_price,onChange:function(t){return e.onChange("act_price",t,!0)}})),"DISCOUNT"===this.state.type&&i.a.createElement("li",null,i.a.createElement("span",null,"\u6298\u6263(0-100\u767e\u5206\u5236): "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.discount,onChange:function(t){return e.onChange("discount",t,!0)}})),("FULL_REDUCTION"===this.state.type||"DISCOUNT"===this.state.type)&&i.a.createElement("li",null,i.a.createElement("span",null,"\u4eab\u53d7\u4f18\u60e0\u6d3b\u52a8\u4ea7\u54c1\u7684\u8d2d\u4e70\u91d1\u989d: "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.limit_amount,onChange:function(t){return e.onChange("limit_amount",t,!0)}})),"FULL_REDUCTION"===this.state.type&&i.a.createElement("li",null,i.a.createElement("span",null,"\u6ee1\u51cf\u91d1\u989d: "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.discount_amount,onChange:function(t){return e.onChange("discount_amount",t,!0)}})),"NONE"===this.state.type&&i.a.createElement("li",null,i.a.createElement("span",null,"\u6700\u5927\u4f18\u60e0\u91d1\u989d: "),i.a.createElement(Ne.a,{type:"number",className:"liInput",value:t.max_discount_amount,onChange:function(t){return e.onChange("max_discount_amount",t,!0)}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u8d77\u59cb\u65f6\u95f4: "),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{format:"YYYY-MM-DD HH:mm",showTime:!0,style:{width:"300px"},disabledDate:this.disabledDate,onChange:function(t,a){return e.onDateChange(t,a,"start_date")}}))),i.a.createElement("li",null,i.a.createElement("span",null,"\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4: "),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{format:"YYYY-MM-DD HH:mm",showTime:!0,style:{width:"300px"},disabledDate:this.disabledDate,onChange:function(t,a){return e.onDateChange(t,a,"end_date")}}))))))}}]),t}(n.Component)),mu=(a(1492),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){a.handleCancel()},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6d3b\u52a8\u6a21\u677f(\u9996\u9875)",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"activityModules"},i.a.createElement("li",null,i.a.createElement("h3",null,"\u6a21\u677f\u4e00\uff1a"),i.a.createElement("div",{className:"moduleContainer"},i.a.createElement("span",{className:"pics"},"\u8fd9\u662f\u4e00\u5f20\u56fe\u7247"))),i.a.createElement("li",null,i.a.createElement("h3",null,"\u6a21\u677f\u4e8c\uff1a"),i.a.createElement("div",{className:"moduleContainer"},i.a.createElement("span",null,"\u8fd9\u662f\u4e00\u5f20\u6761\u5e45"),i.a.createElement("div",{className:"products"},i.a.createElement("em",null,"\u8fd9\u662f\u4e00\u4e2a\u5546\u54c1"),i.a.createElement("em",null,"\u8fd9\u662f\u4e00\u4e2a\u5546\u54c1"),i.a.createElement("em",null,"\u8fd9\u662f\u4e00\u4e2a\u5546\u54c1")))))))}}]),t}(n.Component));function du(e,t){return ne({url:"/api/backend/activities/".concat(t,"/to_start"),method:"put",data:e})}function pu(e,t){return ne({url:"/api/backend/activities/".concat(t,"/to_end"),method:"put",data:e})}function hu(e,t){return ne({url:"/api/backend/activities/".concat(t,"/products/shelfable"),method:"get",params:e})}function fu(e,t){return ne({url:"/api/backend/activities/".concat(t,"/products"),method:"get",params:e})}function Eu(e,t){return ne({url:"/api/backend/activities/".concat(t),method:"get",params:e})}function vu(e,t,a){return ne({url:"/api/backend/activities/".concat(t,"/products/").concat(a),method:"put",data:e})}var _u=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onModuleChange=function(e){a.setState({module:e})},a.handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e=a.child.current.state.imgUrl||a.child.current.state.imageUrl,t=Object(Ja.a)(a).state;if(e){if("module_2"===a.state.module){if(!t.productOne||!t.productTwo||!t.productThree)return void B.a.error("\u8bf7\u5148\u9009\u62e9\u6a21\u677f\u5c55\u793a\u5546\u54c1");if(t.productOne===t.productTwo||t.productTwo===t.productThree||t.productOne===t.productThree)return void B.a.error("\u8bf7\u52ff\u9009\u62e9\u76f8\u540c\u5546\u54c1")}var n=[],i=[t.productOne,t.productTwo,t.productThree];n.push({name:t.module,image:e,data:i}),a.props.onSubmit(n,a.props.actId)}else B.a.error("\u8bf7\u4e0a\u4f20\u6a21\u677f\u5bf9\u5e94\u56fe\u7247\u6216\u6a2a\u5e45")},a.onProductChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.state={module:"module_1",products:[],productOne:"",productTwo:"",productThree:"",defaultImg:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;e.actId&&(fu({page:1,limit:100},e.actId).then(function(e){y.a.map(e.data,function(e){e.product_entity.spec_value?e.name=e.product_entity.name+"-"+e.product_entity.spec_value[Object.keys(e.product_entity.spec_value)[0]]:e.name=e.product_entity.name}),a.setState({products:e.data})}).catch(function(e){}),console.log(e,"----------------------\x3e"),e.entryTemplate.length&&this.setState({module:e.entryTemplate[0].name,defaultImg:e.entryTemplate[0].image,productOne:e.entryTemplate[0].data.length&&e.entryTemplate[0].data[0],productTwo:e.entryTemplate[0].data.length&&e.entryTemplate[0].data[1],productThree:e.entryTemplate[0].data.length&&e.entryTemplate[0].data[2]}))}},{key:"render",value:function(){var e=this,t=this.state,a=this.props.banner&&this.props.banner.image||this.state.defaultImg;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7f16\u8f91\u9996\u9875",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u9996\u9875\u6a21\u677f: "),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:t.module,className:"selectedBox",onChange:this.onModuleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},[{key:"module_1",value:"module_1",name:"\u6a21\u677f\u4e00"},{key:"module_2",value:"module_2",name:"\u6a21\u677f\u4e8c"}].map(function(e){return i.a.createElement(Q.a.Option,{key:e.key,label:e.name,value:e.value},e.name)}))),"module_1"===t.module&&i.a.createElement("li",null,i.a.createElement("span",null,"\u4e0a\u4f20\u56fe\u7247"),i.a.createElement(ta,{defaultImg:a,ref:this.child})),"module_2"===t.module&&i.a.createElement(n.Fragment,null,i.a.createElement("li",null,i.a.createElement("span",null,"\u4e0a\u4f20\u6761\u5e45"),i.a.createElement(ta,{defaultImg:a,ref:this.child})),i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u5546\u54c1\u4e00"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:t.productOne,className:"selectedBox",onChange:function(t){return e.onProductChange(t,"productOne")},optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id,label:e.name},e.name)}))),i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u5546\u54c1\u4e8c"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:t.productTwo,className:"selectedBox",onChange:function(t){return e.onProductChange(t,"productTwo")},optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id,label:e.name},e.name)}))),i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u5546\u54c1\u4e09"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:t.productThree,className:"selectedBox",onChange:function(t){return e.onProductChange(t,"productThree")},optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id,value:e.id,label:e.name},e.name)})))))))}}]),t}(n.Component),gu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.status=function(e){var t="";switch(e){case 0:t="\u5f85\u5f00\u59cb";break;case 2:t="\u5df2\u7ed3\u675f";break;default:t="\u8fdb\u884c\u4e2d"}return t},a.handleType=function(e){var t="";switch(e){case"DISCOUNT":t="\u6298\u6263\u6d3b\u52a8";break;case"FULL_REDUCTION":t="\u6ee1\u51cf\u6d3b\u52a8";break;default:t="\u65e0\u7279\u6b8a\u4f18\u60e0"}return t},a.handleTarget=function(e){var t="";switch(e){case"ALL_USER":t="\u5168\u90e8\u7528\u6237";break;case"NEW_USER":t="\u65b0\u7528\u6237";break;default:t="\u65e0"}return t},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6d3b\u52a8\u8be6\u60c5",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},i.a.createElement("ul",{className:"mainUl couponDetail"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u540d\u79f0:"),i.a.createElement("span",{className:"limit"},this.props.details.name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u63cf\u8ff0:"),i.a.createElement("span",{className:"limit"},this.props.details.desc)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u7c7b\u578b:"),i.a.createElement("span",{className:"limit"},this.handleType(this.props.details.type))),this.props.details.applicable_desc&&this.props.details.applicable_desc.length?i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u4eba\u7fa4:"),i.a.createElement("span",{className:"limit"},this.props.details.applicable_desc[0].value_display)):"",i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u56fe\u7247:"),i.a.createElement("img",{style:{width:"100px",height:"100px"},src:this.props.details.image,alt:""})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u9650\u8d2d\u5468\u671f:"),i.a.createElement("span",{className:"limit"},this.props.details.user_limit_day,"\u5929")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6bcf\u4eba\u9650\u8d2d\u6570\u91cf:"),i.a.createElement("span",{className:"limit"},this.props.details.user_limit_num,"\u4ef6")),i.a.createElement("li",null,i.a.createElement("span",null,"\u662f\u5426\u53c2\u4e0e\u9500\u552e\u8fd4\u4f63"),i.a.createElement("span",{className:"limit"},this.props.details.is_join_sales_cashback?"\u662f":"\u5426")),"NONE"===this.props.details.type&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6700\u5927\u4f18\u60e0\u91d1\u989d:"),i.a.createElement("span",{className:"limit"},this.props.details.max_discount_amount)),"DISCOUNT"===this.props.details.type&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6298\u6263(0-100\u767e\u5206\u5236):"),i.a.createElement("span",{className:"limit"},this.props.details.discount)),"FULL_REDUCTION"===this.props.details.type&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6ee1\u51cf\u91d1\u989d:"),i.a.createElement("span",{className:"limit"},"\u6ee1",this.props.details.limit_amount,"\u5143\u51cf",this.props.details.discount_amount,"\u5143")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u8d77\u59cb\u65f6\u95f4:"),i.a.createElement("span",{className:"limit"},this.props.details.start_date||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4:"),i.a.createElement("span",{className:"limit"},this.props.details.end_date||"\u65e0")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u72b6\u6001:"),i.a.createElement("span",{className:"limit"},this.status(this.props.details.status))))))}}]),t}(n.Component),bu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.onDateChange=function(e,t,n){a.setState(Object(Y.a)({},n,t))},a.submit=function(){a.props.onSubmit(a.state.end_date),a.handleCancel()},a.state={end_date:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4\u9009\u62e9",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.submit,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u7ed3\u675f\u65f6\u95f4:"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{style:{width:"300px"},disabledDate:this.disabledDate,onChange:function(t,a){return e.onDateChange(t,a,"end_date")}}))))))}}]),t}(n.Component),yu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e;(e={},ne({url:"/api/backend/activities/list",method:"get",params:e})).then(function(e){y.a.map(e.data,function(e){1===e.status?e.isOpen=!0:e.isOpen=!1}),a.setState({data:e.data})}).catch(function(e){})},a.showNewAct=function(){a.setState({newActVisible:!0})},a.hideNewAct=function(){a.setState({newActVisible:!1})},a.createNewAct=function(e){for(var t in e)""!==e[t]&&null!==e[t]||"start_date"===t||"end_date"===t||(e[t]=0),"start_date"!==t&&"end_date"!==t||(e[t]=a.handleDate(e[t]));var n;(n=e,ne({url:"/api/backend/activities/create_new",method:"post",data:n})).then(function(e){B.a.success(e.message),a.hideNewAct(),a.refresh()})},a.handleDate=function(e){var t=e,a=e.split(":");return a.length&&a.length<3&&(t=e+":00"),t},a.status=function(e){var t="";switch(e){case 0:t="\u5f85\u5f00\u59cb";break;case 2:t="\u5df2\u7ed3\u675f";break;default:t="\u8fdb\u884c\u4e2d"}return t},a.jump=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.props.history.push({pathname:e,state:t})},a.showActivityModules=function(){a.setState({activityModulesVisible:!0})},a.hideActivityModules=function(){a.setState({activityModulesVisible:!1})},a.showEditIndex=function(e){a.setState({editIndexVisible:!0,actId:e.id,entryTemplate:e.entry_template})},a.hideEditIndex=function(){a.setState({editIndexVisible:!1})},a.submitEditIndex=function(e,t){var n,i;console.log(e),(n={template:e},i=t,ne({url:"/api/backend/activities/".concat(i,"/set_entry_template"),method:"put",data:n})).then(function(e){B.a.success(e.message),a.hideEditIndex(),a.refresh()}).catch(function(e){})},a.switchChange=function(e,t){var n=e?du:pu;2===t.status?a.setState({dateSelectVisible:!0,record:t}):n({},t.id).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.showDetails=function(e){a.setState({detailsVisible:!0,details:e})},a.hideDetails=function(){a.setState({detailsVisible:!1})},a.onDateClose=function(){a.setState({dateSelectVisible:!1})},a.onDateSubmit=function(e){du({end_date:e},a.state.record.id).then(function(e){B.a.success(e.message),a.refresh()}).catch(function(e){})},a.deleteActivity=function(e){var t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u6d3b\u52a8\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,n;(a={},n=e.id,ne({url:"/api/backend/activities/".concat(n),method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})}})},a.state={newActVisible:!1,activityModulesVisible:!1,editIndexVisible:!1,data:[],actId:"",entryTemplate:[],detailsVisible:!1,details:{},dateSelectVisible:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u6d3b\u52a8\u540d\u79f0",dataIndex:"name",align:"center",render:function(t,a){return i.a.createElement("span",{onClick:function(){return e.showDetails(a)},style:{color:"#4F9863",cursor:"pointer"}},t)}},{title:"\u8d77\u6b62\u65f6\u95f4",dataIndex:"start_date",align:"center",render:function(e,t){return i.a.createElement("span",null,e?"".concat(e,"\uff5e").concat(t.end_date||""):"\u65e0")}},{title:"\u6d3b\u52a8\u51c6\u5907",dataIndex:"is_ready_for_start",align:"center",render:function(e,t){return i.a.createElement("span",null,e?"\u5df2\u5c31\u7eea":"\u672a\u5c31\u7eea")}},{title:"\u6d3b\u52a8\u72b6\u6001",dataIndex:"status",align:"center",render:function(t,a){return e.status(t)}},{title:"\u6d3b\u52a8\u5f00\u542f/\u5173\u95ed",dataIndex:"isOpen",align:"center",render:function(t,a){return i.a.createElement(ke.a,{checked:a.isOpen,onChange:function(t){return e.switchChange(t,a)}})}},{title:"\u64cd\u4f5c",align:"center",render:function(t,a){return i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:function(){return e.jump("/activities/activityProductsManage",{actId:a.id,name:a.name})}},"\u5546\u54c1\u7ba1\u7406"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.jump("/activities/editActivityPage",{actId:a.id,template:a.template})}},"\u7f16\u8f91\u6d3b\u52a8\u9875"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showEditIndex(a)}},"\u7f16\u8f91\u9996\u9875"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.deleteActivity(a)}},"\u5220\u9664"))}}],a={visible:this.state.newActVisible,onClose:this.hideNewAct,onSubmit:this.createNewAct},n={visible:this.state.activityModulesVisible,onClose:this.hideActivityModules,onSubmit:this.createNewAct},r={visible:this.state.editIndexVisible,onClose:this.hideEditIndex,onSubmit:this.submitEditIndex,actId:this.state.actId,entryTemplate:this.state.entryTemplate},l={visible:this.state.detailsVisible,details:this.state.details,onClose:this.hideDetails},s={visible:this.state.dateSelectVisible,onClose:this.onDateClose,onSubmit:this.onDateSubmit};return i.a.createElement("div",{className:"allActivities"},i.a.createElement(uu,a),i.a.createElement(mu,n),i.a.createElement(_u,r),i.a.createElement(gu,l),i.a.createElement(bu,s),i.a.createElement(_e.a,{size:"small",onClick:this.showNewAct},i.a.createElement(de,{type:"icon-plus-circle"}),"\u65b0\u589e\u6d3b\u52a8"),i.a.createElement(_e.a,{size:"small",style:{marginLeft:"15px"},onClick:this.showActivityModules},"\u6d3b\u52a8\u6a21\u677f\u793a\u4f8b(\u9996\u9875)"),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})))}}]),t}(n.Component),Cu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:Et,operation:vt})))}}]),t}(i.a.Component),ku=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5206\u7c7b",dataIndex:"category"},{title:"\u89c4\u683c",render:function(e,t){return t.open_specification?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){a.setState({recordSpecVisible:!0,provide_id:t.provide_id})}},"\u67e5\u770b\u89c4\u683c"):i.a.createElement("span",null,"\u65e0")}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price"},{title:"\u5e93\u5b58",dataIndex:"stock",render:function(e,t){return i.a.createElement("div",{className:"warning"},e,i.a.createElement("span",{style:{display:t.stock_alert?"block":"none"}},i.a.createElement(de,{type:"icon-info-circle-fill"}),"\u8b66\u6212"))}},{title:"\u5b9e\u9645\u9500\u91cf",dataIndex:"total_sales"},{title:"\u865a\u62df\u9500\u91cf",dataIndex:"virtual_sales",render:function(e,t){return i.a.createElement(ma.a,{className:"virtualSales",defaultValue:e,onBlur:function(e){e.target.value=e.target.value<0?0:e.target.value,e.target.value<=0||At({virtual_sales:e.target.value},t.provide_id).then(function(e){B.a.success(e.message)}).catch(function(e){})}})}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"30px"},onClick:function(){return a.showWarningStock(t)}},"\u8b66\u6212\u5e93\u5b58"))}}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",channel:a.channel,activity_id:a.props.location.state.id}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/goods/goodDetails",state:{id:e.product_id,path:"/activities",current:a.child.current.state.current}})},a.search=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:It,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({user_data:e})},a.closeRecordSpec=function(){a.setState({recordSpecVisible:!1})},a.setWarning=function(e){a.showWarningStock(e)},a.unSale=function(){var e=a.state.checkedAry,t=a.channel,n=a.refresh,r=a.state.actId,l=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){l.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){Tt({channel:t,product_ids:e,activity_id:r}).then(function(e){B.a.success(e.message),n()}).catch(function(e){})}})},a.showWarningStock=function(e){e.open_specification?a.setState({recordSpecVisible:!0,provide_id:e.provide_id}):a.setState({warningStockVisible:!0,stock_id:e.stock_id})},a.hideWarningStock=function(){a.setState({warningStockVisible:!1})},a.onSubmitWarningStock=function(e,t){Rt({warning_stock:e},t).then(function(e){B.a.success(e.message),a.hideWarningStock(),a.refresh()}).catch(function(e){})},a.showShelfGoods=function(){a.setState({shelfGoodsVisible:!0})},a.hideShelfGoods=function(){a.setState({shelfGoodsVisible:!1})},a.onSubmitShelfGoods=function(e){jt({channel:a.channel,product_params:e,activity_id:a.state.actId}).then(function(e){B.a.success(e.message),a.hideShelfGoods(),a.refresh()}).catch(function(e){})},a.inStock=function(){a.props.history.push({pathname:"/goods/inStock",state:{channel:a.channel,actId:a.state.actId}})},a.outStock=function(){a.props.history.push({pathname:"/goods/outStock",state:{channel:a.channel,actId:a.state.actId}})},a.backAct=function(){a.props.history.push({pathname:"/activities"})},a.cakeClassification=function(){a.props.history.push({pathname:"/activities/cakeClassification",state:{actId:a.state.actId}})},a.child=i.a.createRef(),a.channel="ACTIVITY",a.state={api:It,filterVisible:!1,shelfGoodsVisible:!1,stock_id:"",provide_id:"",user_data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",channel:a.channel,activity_id:""},columns:n,recordSpecVisible:!1,rangeId:"",current:1,actId:1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.setState({actId:this.props.location.state.id,paginationParams:Object(be.a)({},this.state.paginationParams,{activity_id:this.props.location.state.id})}),this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current})}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){console.log(t),e.setState({checkedAry:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return i.a.createElement("div",null,i.a.createElement(Cu,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh}),i.a.createElement(xa,{visible:this.state.recordSpecVisible,onCancel:this.closeRecordSpec,onSubmit:this.setWarning,provide_id:this.state.provide_id}),i.a.createElement(_a,{visible:this.state.warningStockVisible,onCancel:this.hideWarningStock,onSubmit:this.onSubmitWarningStock,id:this.state.stock_id}),i.a.createElement(wa,{visible:this.state.shelfGoodsVisible,onCancel:this.hideShelfGoods,onSubmit:this.onSubmitShelfGoods}),i.a.createElement("div",{className:"breakfast_header"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showShelfGoods},"\u4e0a\u67b6\u5546\u54c1"),i.a.createElement(_e.a,{size:"small",onClick:this.inStock},i.a.createElement(de,{type:"icon-download"}),"\u5546\u54c1\u5165\u5e93"),i.a.createElement(_e.a,{size:"small",onClick:this.outStock},i.a.createElement(de,{type:"icon-upload"}),"\u5546\u54c1\u51fa\u5e93"),i.a.createElement(_e.a,{size:"small",onClick:this.cakeClassification},"\u86cb\u7cd5\u5546\u54c1\u5206\u7c7b"),i.a.createElement(_e.a,{size:"small",className:"backActsManage",onClick:this.backAct},"\u8fd4\u56de\u86cb\u7cd5\u7ba1\u7406")),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small",disabled:0==this.state.checkedAry.length,onClick:this.unSale},"\u4e0b\u67b6"))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.user_data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),Su=Object(U.g)(ku),Ou=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:this.props.data,operation:Ya,slug:"order",api:{groups:ha,goodsOrder:!0}})))}}]),t}(i.a.Component);function Nu(e){return ne({url:"/api/backend/activities/all",method:"get",params:e})}function wu(e,t){return ne({url:"/api/backend/activities/".concat(t,"/banners"),method:"post",data:e})}function xu(e,t){return ne({url:"/api/backend/activities/banners/".concat(t),method:"put",data:e})}function Iu(e,t){return ne({url:"/api/backend/activities/".concat(t,"/orders"),method:"get",params:e})}function ju(e,t,a){return ne({url:"/api/backend/activities/".concat(t,"/orders/").concat(a,"/to_delivery"),method:"put",data:e})}function Tu(e,t,a){return ne({url:"/api/backend/activities/".concat(t,"/orders/").concat(a,"/to_manufacture"),method:"put",data:e})}function Ru(e,t){return ne({url:"/api/backend/activities/".concat(t,"/refunds"),method:"get",params:e})}var Au=function(e){function t(e){var a;Object(s.a)(this,t);var n=[{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)}},{title:"\u5546\u54c1",dataIndex:"category_desc",render:function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"user_nickname"},{title:"\u9884\u671f\u6536\u8d27\u65f6\u95f4",dataIndex:"expect_receive_date",render:function(e,t){return i.a.createElement("span",null,e," ",t.expect_receive_time_start,"-",t.expect_receive_time_end)}},{title:"\u652f\u4ed8\u65f6\u95f4",dataIndex:"paid_at"},{title:"\u8ba2\u5355\u72b6\u6001",dataIndex:"state_desc"}];return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ALL";a.setState({filterVisible:!1,checkedAry:[],paginationParams:{logic_conditions:[],searchJson:w({state_constant:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.jump=function(e){a.props.history.push({pathname:"/order/orderDetail",state:{id:e.id,path:"/order",current:a.child.current.state.current}})},a.search=function(e){a.setState({api:Iu,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,state_constant:a.state.activeTab})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Iu,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,state_constant:a.state.activeTab||"ALL"})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.reviewGoods=function(e){a.setState({reviewGoodsVisible:!0,items:e})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.setMessage=function(){a.props.history.push({pathname:"/order/setUserMessage",state:{mode:"user"}})},a.backAct=function(){a.props.history.push({pathname:"/activities"})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];console.log(e),e.forEach(function(e){cn.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}),"expect_receive_date"===r.dataIndex&&(r.render=function(e,t){return i.a.createElement("span",null,e," ",t.expect_receive_time_start,"-",t.expect_receive_time_end)}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)};var n=a.state.activeTab;t.push({title:"\u64cd\u4f5c",colSpan:"PAY_COMPLETED"===n||"WAIT_MANUFACTURE"===n?1:0,render:function(e,t){return"PAY_COMPLETED"===n?i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.start(t,"do")}},"\u5f00\u59cb\u5236\u4f5c"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return a.cancel(t)}},"\u53d6\u6d88")):"WAIT_MANUFACTURE"===n?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.start(t,"go")}},"\u5f00\u59cb\u914d\u9001"):void 0}}),a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.start=function(e,t){var n=a.refresh,r="do"===t?"\u5236\u4f5c":"\u914d\u9001",l="do"===t?Tu:ju,s=a.state,c=s.actId,o=s.activeTab,u=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){u.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5f00\u59cb",r,"\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){l({},c,e.id).then(function(e){B.a.success(e.message),n(o)}).catch(function(e){})}})},a.cancel=function(e){var t=a.refresh,n=a.state.activeTab,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u662f\u5426\u786e\u5b9a\u53d6\u6d88\u8ba2\u5355\u5e76\u9000\u6b3e?"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,i;(a={},i=e.id,ne({url:"/api/backend/orders/".concat(i,"/to_cancel"),method:"put",data:a})).then(function(e){B.a.success(e.message),t(n)}).catch(function(e){})}})},a.print=function(){var e=a.state,t=e.checkedAry,n=e.data,i=[];y.a.map(n,function(e){y.a.indexOf(t,e.id)>-1&&i.push(e)}),a.props.history.push({pathname:"/printSheet",state:{orders:i,title:"\u9752\u677e\u529f\u592b\u914d\u9001\u5355",isNeedItems:!0}})},a.export=function(){var e=w({strategy:"ACTIVITY_ORDER_CAKE",customize_columns:[],logic_conditions:[],order_ids:a.state.checkedAry});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(e,"&Authorization=").concat(k())},a.exportNew=function(e){var t=w({strategy:e,customize_columns:[],logic_conditions:[],order_ids:a.state.checkedAry});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(t,"&Authorization=").concat(k())},a.check=function(e){var t=a.refresh,n=a.state.checkedAry,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u624b\u52a8\u6838\u9500\u8be5\u8ba2\u5355\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){rn({order_ids:n}).then(function(e){B.a.success("\u624b\u52a8\u6838\u9500\u8ba2\u5355\u6210\u529f\uff01"),t("WAIT_CUSTOMER_VERIFY")})},onCancel:function(){}})},a.child=i.a.createRef(),a.state={api:Iu,filterVisible:!1,customVisible:!1,reviewGoodsVisible:!1,data:[],checkedAry:[],paginationParams:{searchJson:w({state_constant:"ALL"}),search:""},defaultItem:["trade_no","products","settlement_total_fee","user_nickname","expect_receive_date","paid_at","state_desc"],columns:n,activeTab:"ALL",items:[],conditions:{},current:1,actId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.setState({actId:this.props.location.state.id}),this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){var n=[];a.forEach(function(e){n.push(e.id)}),e.setState({checkedAry:n})}},a=this.state,n=a.activeTab,r=a.columns;return y.a.findIndex(r,function(e){return"\u64cd\u4f5c"===e.title})<0?r.push({title:"\u64cd\u4f5c",colSpan:"PAY_COMPLETED"===n||"WAIT_MANUFACTURE"===n?1:0,render:function(t,a){return"PAY_COMPLETED"===n?i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.start(a,"do")}},"\u5f00\u59cb\u5236\u4f5c"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return e.cancel(a)}},"\u53d6\u6d88")):"WAIT_MANUFACTURE"===n?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.start(a,"go")}},"\u5f00\u59cb\u914d\u9001"):void 0}}):(r.pop(),r.push({title:"\u64cd\u4f5c",colSpan:"PAY_COMPLETED"===n||"WAIT_MANUFACTURE"===n?1:0,render:function(t,a){return"PAY_COMPLETED"===n?i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.start(a,"do")}},"\u5f00\u59cb\u5236\u4f5c"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginLeft:"20px"},onClick:function(){return e.cancel(a)}},"\u53d6\u6d88")):"WAIT_MANUFACTURE"===n?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.start(a,"go")}},"\u5f00\u59cb\u914d\u9001"):void 0}})),i.a.createElement("div",{className:"order"},i.a.createElement(Ou,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:Wa}),i.a.createElement(Xa,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items,text:"\u5546\u54c1"}),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u59d3\u540d\u6216\u624b\u673a\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small",type:"primary",onClick:this.setMessage},"\u8bbe\u7f6e\u9ed8\u8ba4\u6a21\u677f\u6d88\u606f"),i.a.createElement(_e.a,{size:"small",onClick:this.print,disabled:!this.state.checkedAry.length},"\u6253\u5370\u8ba2\u5355"),i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.export,disabled:!this.state.checkedAry.length},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",disabled:!this.state.checkedAry.length,onClick:function(){return e.exportNew("ACTIVITY_ORDER_CAKE_2")}},"\u5bfc\u51fa\u65b0\u683c\u5f0f"),i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",disabled:!this.state.checkedAry.length,onClick:function(){return e.exportNew("ACTIVITY_ORDER_CAKE_3")}},"\u5bfc\u51fa\u65b0\u65b0\u683c\u5f0f"),i.a.createElement(_e.a,{size:"small",onClick:this.check,disabled:!this.state.checkedAry.length||"WAIT_CUSTOMER_VERIFY"!==this.state.activeTab},"\u6279\u91cf\u6838\u9500\u8ba2\u5355")),i.a.createElement(_e.a,{size:"small",style:{position:"absolute",right:"0px",zIndex:"999"},onClick:this.backAct},"\u8fd4\u56de\u86cb\u7cd5\u7ba1\u7406")),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:"ALL"},{name:"\u7b49\u5f85\u7528\u6237\u652f\u4ed8",key:"WAIT_PAY"},{name:"\u5df2\u652f\u4ed8",key:"PAY_COMPLETED"},{name:"\u5236\u4f5c\u4e2d",key:"WAIT_MANUFACTURE"},{name:"\u914d\u9001\u4e2d",key:"WAIT_CUSTOMER_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"},{name:"\u5e73\u53f0\u53d6\u6d88",key:"CANCEL_PLATFORM"},{name:"\u652f\u4ed8\u8d85\u65f6\u53d6\u6d88",key:"CANCEL_PAY_TIMEOUT"},{name:"\u7528\u6237\u53d6\u6d88",key:"CANCEL_MANUAL"},{name:"\u53d1\u8d77\u552e\u540e",key:"LAUNCH_AFTER_SALE"},{name:"\u552e\u540e\u5904\u7406\u4e2d",key:"ON_AFTER_SALE"},{name:"\u5df2\u9000\u6b3e",key:"REFUNDED"},{name:"\u5df2\u62d2\u7edd\u9000\u6b3e",key:"REFUSE_REFUND"},{name:"\u5df2\u5173\u95ed",key:"CLOSED"}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)},style:{padding:"0 10px"}},t.name)})),this.state.data.length?i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:sn,handleCustom:this.handleCustom,targetKeys:V(this.state.defaultItem),firstItem:"trade_no"}))):""),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.state.columns,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,text:"\u6761\u8ba2\u5355",ref:this.child,params:this.state.paginationParams,id:this.state.actId,current:this.state.current,valChange:this.paginationChange})))}}]),t}(i.a.Component),Du=Object(U.g)(Au),Pu=(a(612),Q.a.Option),Vu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onclose()},a.handleSubmit=function(){var e=a.banner.current.state.imgUrl||a.banner.current.state.imageUrl,t=a.state,n=t.canJump,i=t.jumpType,r=t.jumpUrl,l=t.selectedProduct;if(e){if(n){if(!i)return void B.a.error("\u8bf7\u9009\u62e9\u8f6e\u64ad\u56fe\u8df3\u8f6c\u7c7b\u578b");if("NET_ADDRESS"===i&&!r)return void B.a.error("\u8bf7\u586b\u5199\u8f6e\u64ad\u56fe\u8df3\u8f6c\u94fe\u63a5");if("PRODUCT_DETAIL"===i&&!l)return void B.a.error("\u8bf7\u9009\u62e9\u8f6e\u64ad\u8df3\u8f6c\u8be6\u60c5\u5546\u54c1")}var s="NET_ADDRESS"===i?r:l;a.operateBanner(e,n,i,s)}else B.a.error("\u8bf7\u5148\u4e0a\u4f20\u8f6e\u64ad\u56fe\u7247")},a.operateBanner=function(e,t,n,i){(a.props.banner.id?xu:wu)({image:e,can_jump:t,action_type:n,action_link:i},a.props.banner.id?a.props.banner.id:a.props.actId).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.changeCanJump=function(e){a.setState({canJump:e})},a.handleTypeChange=function(e){a.setState({jumpType:e})},a.handleChange=function(e){a.setState({selectedProduct:e})},a.getProducts=function(e,t){It({limit:100,page:1,channel:"ACTIVITY",activity_id:t}).then(function(e){a.setState({products:e.data})})},a.state={canJump:!1,jumpType:"NET_ADDRESS",jumpUrl:"",text:"\u65b0\u5efa",defaultImg:"",selectedProduct:"",products:[],scrollPage:1,status:"create"},a.banner=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.banner.id?this.setState({text:"\u7f16\u8f91",canJump:e.banner.can_jump,jumpType:e.banner.action_type,jumpUrl:e.banner.action_link,defaultImg:e.banner.image,status:"edit"}):this.setState({canJump:!1,jumpType:"",jumpUrl:"",defaultImg:"",status:"create"}),e.actId&&(this.state.products.length||this.getProducts(1,e.actId))}},{key:"render",value:function(){var e=this,t=this.props.banner&&this.props.banner.image||this.state.defaultImg,a=this.state.selectedProduct;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:this.state.text,width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"banner\u56fe\u7247"),i.a.createElement(ta,{ref:this.banner,defaultImg:t,status:this.state.status})),i.a.createElement("li",{className:"bannerSwitch"},i.a.createElement("span",{className:"left"},"\u662f\u5426\u53ef\u8df3\u8f6c"),i.a.createElement(ke.a,{checked:this.state.canJump,onChange:this.changeCanJump})),this.state.canJump&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8df3\u8f6c\u7c7b\u578b"),i.a.createElement(Q.a,{value:this.state.jumpType,onChange:this.handleTypeChange},i.a.createElement(Pu,{value:"NET_ADDRESS"},"\u7f51\u5740\uff0c\u94fe\u63a5"),i.a.createElement(Pu,{value:"PRODUCT_DETAIL"},"\u5546\u54c1\u8be6\u60c5"))),this.state.canJump&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"NET_ADDRESS"===this.state.jumpType?"\u8df3\u8f6c\u5730\u5740":"\u5546\u54c1\u540d\u79f0"),"NET_ADDRESS"===this.state.jumpType?i.a.createElement(Ne.a,{className:"liInput",value:this.state.jumpUrl,onChange:function(t){e.setState({jumpUrl:t.target.value})}}):i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:a,onChange:this.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_id+"",label:e.name,value:e.product_id+""},e.name)}))))))}}]),t}(n.Component),Lu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e,t;(e={},t=a.state.actId,ne({url:"/api/backend/activities/".concat(t,"/banners/all"),method:"get",params:e})).then(function(e){a.setState({banners:e.data})}).catch(function(e){})},a.paginationChange=function(e){a.setState({banners:e})},a.createNewBanner=function(){a.setState({settingVisible:!0,banner:{}})},a.editBanner=function(e){a.setState({settingVisible:!0,banner:e})},a.closeModal=function(){a.setState({settingVisible:!1})},a.backAct=function(){a.props.history.push({pathname:"/activities"})},a.deleteBanner=function(e){var t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u6d3b\u52a8banner\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,n;(a={},n=e,ne({url:"/api/backend/activities/banners/".concat(n),method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})}})},a.state={banners:[],settingVisible:!1,banner:{},actId:""},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({actId:this.props.location.state.id},function(){e.refresh()})}},{key:"render",value:function(){var e=this,t=[{title:"\u56fe\u7247",dataIndex:"image",render:function(e,t){return i.a.createElement("img",{src:e,className:"tableImage",alt:""})}},{title:"\u8df3\u8f6c\u7c7b\u578b",dataIndex:"action_type",render:function(e,t){return t.can_jump?"PRODUCT_DETAIL"===e?"\u5546\u54c1\u8be6\u60c5":"\u7f51\u5740\u94fe\u63a5":"\u65e0"}},{title:"\u8df3\u8f6c\u5730\u5740/\u5546\u54c1\u8be6\u60c5ID",dataIndex:"action_link",render:function(e,t){return t.can_jump?e:"\u65e0"}},{title:"\u4e0a\u4f20\u65f6\u95f4",dataIndex:"created_at"},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"10px"},onClick:function(){return e.editBanner(a)}},"\u7f16\u8f91"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.deleteBanner(a.id)}},"\u5220\u9664"))}}],a={visible:this.state.settingVisible,banner:this.state.banner,onclose:this.closeModal,actId:this.state.actId,refresh:this.refresh};return i.a.createElement("div",{className:"bannerSetting"},i.a.createElement(Vu,a),i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.createNewBanner},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589eBanner"),i.a.createElement(_e.a,{size:"small",style:{float:"right"},onClick:this.backAct},"\u8fd4\u56de\u86cb\u7cd5\u7ba1\u7406"),i.a.createElement(ve.a,{dataSource:this.state.banners,rowKey:function(e){return e.id},pagination:!1,columns:t,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}})))}}]),t}(n.Component);a(613);function Mu(e){return ne({url:"/api/backend/marketing/banners",method:"post",data:e})}function Uu(e,t){return ne({url:"/api/backend/marketing/banners/".concat(t),method:"put",data:e})}function Fu(e){return ne({url:"/api/backend/marketing/banners",method:"get",params:e})}function Gu(e,t){return ne({url:"/api/backend/marketing/banners/".concat(t,"/enable"),method:"get",params:e})}function Bu(e,t){return ne({url:"/api/backend/marketing/banners/".concat(t,"/disable"),method:"get",params:e})}for(var zu=Q.a.Option,Hu=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onclose()},a.handleSubmit=function(){var e=a.banner.current.state.imgUrl||a.banner.current.state.imageUrl,t=a.state,n=t.canJump,i=t.jumpType,r=t.jumpUrl,l=t.title,s=t.synopsis,c=t.sort,o=t.selectedProduct;if(l)if(l.length<5)B.a.error("\u8f6e\u64ad\u56fe\u6807\u9898\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e5");else if(s)if(e){if(n){if(!i)return void B.a.error("\u8bf7\u9009\u62e9\u8f6e\u64ad\u56fe\u8df3\u8f6c\u7c7b\u578b");if("PAGE_PATH_ONLY"===i&&!r)return void B.a.error("\u8bf7\u586b\u5199\u8f6e\u64ad\u56fe\u8df3\u8f6c\u94fe\u63a5");if("PRODUCT_DETAIL"===i&&!o)return void B.a.error("\u8bf7\u9009\u62e9\u8f6e\u64ad\u8df3\u8f6c\u8be6\u60c5\u5546\u54c1")}if(c){var u="PRODUCT_DETAIL"===i?{id:o}:{id:"-1"};a.operateBanner(l,s,e,n,r,c,i,u)}else B.a.error("\u8bf7\u5148\u586b\u5199\u8f6e\u64ad\u5e8f\u53f7")}else B.a.error("\u8bf7\u5148\u4e0a\u4f20\u8f6e\u64ad\u56fe\u7247");else B.a.error("\u8bf7\u5148\u586b\u5199\u8f6e\u64ad\u7b80\u4ecb");else B.a.error("\u8bf7\u5148\u586b\u5199\u8f6e\u64ad\u6807\u9898")},a.operateBanner=function(e,t,n,i,r,l,s,c){var o=a.props.banner.id?Uu:Mu,u=a.props.banner.id?a.props.banner.id:a.props.actId;o({title:e,synopsis:t,sort:l,scene:a.state.scene,action_type:s,is_active:a.state.isActive,image:n,can_jump:i,action_link:r,action_args:c},u).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.changeCanJump=function(e){a.setState({canJump:e})},a.changeIsActive=function(e){a.setState({isActive:e})},a.inputChange=function(e,t){a.setState(Object(Y.a)({},t,e.target.value))},a.handleSceneChange=function(e){a.setState({scene:e})},a.getProducts=function(e){It({limit:100,page:1,channel:"DISTRIBUTION_MALL"}).then(function(e){a.setState({products:e.data})})},a.handleTypeChange=function(e){a.setState({jumpType:e})},a.handleChange=function(e){a.setState({selectedProduct:e})},a.state={canJump:!1,isActive:!0,jumpUrl:"",text:"\u65b0\u5efa",jumpType:"PAGE_PATH_ONLY",defaultImg:"",title:"",synopsis:"",sort:"",selectedProduct:"",products:[],scrollPage:1,status:"create"},a.banner=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){console.log("----------update----------"),e.banner.id?(console.log(e),this.setState({text:"\u7f16\u8f91",title:e.banner.title,synopsis:e.banner.synopsis,canJump:e.banner.can_jump,jumpType:e.banner.action_type,jumpUrl:e.banner.action_link||"",defaultImg:e.banner.image,sort:e.banner.sort,scene:e.banner.scene,status:"edit",isActive:e.banner.is_active})):this.setState({text:"\u65b0\u589e",canJump:!1,jumpType:"",jumpUrl:"",defaultImg:"",title:"",synopsis:"",sort:"",isActive:!0,scene:"WECHAT_MINIPROGRAM_INDEX",status:"create"}),this.state.products.length||this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.props.banner&&this.props.banner.image||this.state.defaultImg;console.log(this.state.defaultImg,"============================>"),console.log(t);var a=this.state.selectedProduct;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:this.state.text,width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u6807\u9898"),i.a.createElement(Ne.a,{className:"liInput",type:"text",value:this.state.title,onChange:function(t){return e.inputChange(t,"title")}})),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left"},"\u4f7f\u7528\u573a\u666f"),i.a.createElement(Q.a,{value:this.state.scene,onChange:this.handleSceneChange,disabled:this.props.banner.id},i.a.createElement(zu,{value:"GENERAL_INDEX"},"\u901a\u7528\u9996\u9875"),i.a.createElement(zu,{value:"WECHAT_MINIPROGRAM_INDEX"},"\u5c0f\u7a0b\u5e8f\u9996\u9875"),i.a.createElement(zu,{value:"APP_INDEX_MERCHANT"},"APP\u5546\u6237\u9996\u9875"),i.a.createElement(zu,{value:"APP_INDEX_DISTRIBUTOR"},"APP\u5206\u9500\u5458\u9996\u9875"))),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u7b80\u4ecb"),i.a.createElement(Ne.a,{className:"liInput",type:"text",value:this.state.synopsis,onChange:function(t){return e.inputChange(t,"synopsis")}})),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"banner\u56fe\u7247"),i.a.createElement(ta,{ref:this.banner,defaultImg:t,status:this.state.status})),i.a.createElement("li",{className:"bannerSwitch"},i.a.createElement("span",{className:"left"},"\u662f\u5426\u53ef\u8df3\u8f6c"),i.a.createElement(ke.a,{checked:this.state.canJump,onChange:this.changeCanJump})),this.state.canJump&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8df3\u8f6c\u7c7b\u578b"),i.a.createElement(Q.a,{value:this.state.jumpType,onChange:this.handleTypeChange},i.a.createElement(zu,{value:"PAGE_PATH_ONLY"},"\u4ec5\u8df3\u8f6c\u9875\u9762"),i.a.createElement(zu,{value:"PRODUCT_DETAIL"},"\u5546\u54c1\u8be6\u60c5"))),this.state.canJump&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8df3\u8f6c\u5730\u5740"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.jumpUrl,onChange:function(t){e.setState({jumpUrl:t.target.value})}})),this.state.canJump&&"PRODUCT_DETAIL"===this.state.jumpType&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5546\u54c1\u540d\u79f0"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:a,onChange:this.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_id+"",label:e.name,value:e.product_id+""},e.name)}))),i.a.createElement("li",{className:"bannerSwitch"},i.a.createElement("span",{className:"left"},"\u662f\u5426\u4f7f\u7528"),i.a.createElement(ke.a,{checked:this.state.isActive,onChange:this.changeIsActive})),i.a.createElement("li",{className:"bannerSwitch"},i.a.createElement("span",{className:"left"},"\u6392\u5e8f"),i.a.createElement(Ne.a,{className:"liInput",type:"number",value:this.state.sort,onChange:function(t){return e.inputChange(t,"sort")}})))))}}]),t}(n.Component),Ku=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){Fu({}).then(function(e){a.setState({banners:e.data})}).catch(function(e){})},a.paginationChange=function(e){a.setState({banners:e})},a.createNewBanner=function(){a.setState({settingVisible:!0,banner:{}})},a.editBanner=function(e){a.setState({settingVisible:!0,banner:e})},a.closeModal=function(){a.setState({settingVisible:!1})},a.deleteBanner=function(e){var t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u6d3b\u52a8banner\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,n;(a={},n=e,ne({url:"/api/backend/marketing/banners/".concat(n),method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})}})},a.handleChange=function(e,t){a.setState(Object(Y.a)({},e,t),function(){console.log(t),console.log(a.state,"...")})},a.search=function(){var e=a.state,t=e.scene,n=e.state;Fu({searchJson:w(n||!1===n?t?{scene:t,is_active:n}:{is_active:n}:t?{scene:t}:{})}).then(function(e){a.setState({banners:e.data})}).catch(function(e){})},a.onSwitchChange=function(e,t){console.log(e),console.log(t);var n=e?"\u542f\u7528":"\u7981\u7528";(e?Gu:Bu)({},t.id).then(function(e){B.a.success("".concat(n,"Banner\u6210\u529f")),a.search()}).catch(function(e){})},a.state={banners:[],settingVisible:!1,banner:{},state:null,scene:null},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u6807\u9898",dataIndex:"title"},{title:"\u4f7f\u7528\u573a\u666f",dataIndex:"scene_desc"},{title:"\u7b80\u4ecb",dataIndex:"synopsis"},{title:"\u56fe\u7247",dataIndex:"image",render:function(e,t){return i.a.createElement("img",{src:e,className:"tableImage",alt:""})}},{title:"\u662f\u5426\u53ef\u8df3\u8f6c",dataIndex:"can_jump",render:function(e,t){return i.a.createElement("span",null,e?"\u662f":"\u5426")}},{title:"\u8df3\u8f6c\u7c7b\u578b",dataIndex:"action_type",render:function(e,t){return t.can_jump?"PRODUCT_DETAIL"===e?"\u5546\u54c1\u8be6\u60c5":"\u7f51\u5740\u94fe\u63a5":"\u65e0"}},{title:"\u8df3\u8f6c\u5730\u5740",dataIndex:"action_link",render:function(e,t){return t.can_jump?e:"\u65e0"}},{title:"\u5e8f\u53f7",dataIndex:"sort"},{title:"\u72b6\u6001",dataIndex:"is_active",render:function(e,t){return i.a.createElement("span",null,e?"\u5df2\u4f7f\u7528":"\u672a\u4f7f\u7528")}},{title:"\u5f00\u5173",render:function(t,a){return i.a.createElement(ke.a,{checked:a.is_active,onChange:function(t){return e.onSwitchChange(t,a)}})}},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"10px"},onClick:function(){return e.editBanner(a)}},"\u7f16\u8f91"),!a.is_active&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.deleteBanner(a.id)}},"\u5220\u9664"))}}],a={visible:this.state.settingVisible,banner:this.state.banner,onclose:this.closeModal,actId:this.state.actId,refresh:this.refresh};return i.a.createElement("div",{className:"bannerSetting"},i.a.createElement(Hu,a),i.a.createElement("div",{className:"chart"},i.a.createElement(_e.a,{className:"addNew",onClick:this.createNewBanner},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u589eBanner"),i.a.createElement("div",{className:"searchSelect"},i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:this.state.scene,onChange:function(t){return e.handleChange("scene",t)},optionLabelProp:"label",allowClear:!0,placeholder:"\u8bf7\u9009\u62e9\u4f7f\u7528\u573a\u666f"},[{name:"\u901a\u7528\u9996\u9875",value:"GENERAL_INDEX"},{name:"\u5c0f\u7a0b\u5e8f\u9996\u9875",value:"WECHAT_MINIPROGRAM_INDEX"},{name:"APP\u5546\u6237\u9996\u9875",value:"APP_INDEX_MERCHANT"},{name:"APP\u5206\u9500\u5458\u9996\u9875",value:"APP_INDEX_DISTRIBUTOR"}].map(function(e){return i.a.createElement(Q.a.Option,{key:e.value,label:e.name,value:e.value},e.name)})),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:this.state.state,onChange:function(t){return e.handleChange("state",t)},optionLabelProp:"label",allowClear:!0,placeholder:"\u8bf7\u9009\u62e9\u72b6\u6001"},[{name:"\u5df2\u4f7f\u7528",value:!0},{name:"\u672a\u4f7f\u7528",value:!1}].map(function(e){return i.a.createElement(Q.a.Option,{key:e.value,label:e.name,value:e.value},e.name)})),i.a.createElement("span",{style:{color:"#4f9863",fontSize:"12px",cursor:"pointer"},onClick:this.search},"\u7b5b\u9009")),i.a.createElement(ve.a,{dataSource:this.state.banners,rowKey:function(e){return e.id},pagination:!1,columns:t,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}})))}}]),t}(n.Component),Ju=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e,t=a.image.current.state.imgUrl;a.state.name?t?(e={name:a.state.name,image:t},ne({url:"/api/backend/activities",method:"post",data:e})).then(function(e){B.a.success(e.message),a.setState({name:""},function(){a.handleCancel(),a.props.refresh()})}).catch(function(e){}):B.a.error("\u8bf7\u4e0a\u4f20\u6d3b\u52a8\u56fe\u7247"):B.a.error("\u8bf7\u586b\u5199\u6d3b\u52a8\u540d\u79f0")},a.state={name:""},a.image=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u521b\u5efa\u6d3b\u52a8",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u6d3b\u52a8\u56fe\u7247"),i.a.createElement(ta,{ref:this.image,defaultImg:""})))))}}]),t}(n.Component),Wu=(a(1493),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){Nu({}).then(function(e){e.data.length?a.setState({data:e.data}):a.initActs()}).catch(function(e){})},a.initActs=function(){var e;(e={},ne({url:"/api/backend/activities/init_stock_channel",method:"get",params:e})).then(function(e){B.a.success(e.message)}).catch(function(e){})},a.createAct=function(){a.setState({createActVisible:!0})},a.closeCreateAct=function(){a.setState({createActVisible:!1})},a.productsManage=function(e){a.props.history.push({pathname:"/activities/productsManage",state:{id:e.id}})},a.orderManage=function(e){a.props.history.push({pathname:"/activities/orderManage",state:{id:e.id}})},a.marketing=function(e){a.props.history.push({pathname:"/activities/marketing",state:{id:e.id}})},a.refund=function(e){a.props.history.push({pathname:"/activities/refund",state:{id:e.id}})},a.state={data:[],api:Nu,current:1,createActVisible:!1},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u6d3b\u52a8\u540d\u79f0",dataIndex:"name",width:"200px",align:"center"},{title:"\u6d3b\u52a8\u56fe\u7247",dataIndex:"image",width:"400px",align:"center",render:function(e,t){return i.a.createElement("img",{src:e,alt:""})}},{title:"\u64cd\u4f5c",align:"center",render:function(t,a){return i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:function(){return e.productsManage(a)}},i.a.createElement(de,{type:"icon-all-fill"}),"\u5546\u54c1\u7ba1\u7406"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.orderManage(a)}},i.a.createElement(de,{type:"icon-tubiaozhizuomoban"}),"\u8ba2\u5355\u7ba1\u7406"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.refund(a)}},i.a.createElement(de,{type:"icon-tuikuan"}),"\u9000\u6b3e\u552e\u540e"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.marketing(a)}},i.a.createElement(de,{type:"icon-chart-relation"}),"\u8425\u9500"))}}],a={visible:this.state.createActVisible,onClose:this.closeCreateAct,refresh:this.refresh};return i.a.createElement("div",null,i.a.createElement(Ju,a),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})))}}]),t}(n.Component)),Yu=(a(1494),[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5e97\u94fa\u540d\u79f0",value:"shop_name",type:"equalCompare"},{label:"\u5e97\u94fa\u7f16\u53f7",value:"total_fee",type:"equalCompare"},{label:"\u6536\u8d27\u5730\u533a",value:"region",type:"detailAddress"},{label:"\u5e97\u94fa\u8be6\u7ec6\u5730\u5740",value:"shop_address",type:"absoluteCompare"},{label:"\u8ba2\u5355\u7c7b\u578b",value:"type",type:"summaryOrderType"},{label:"\u6c47\u603b\u65e5\u671f",value:"summary_date",type:"timeCompare"},{label:"\u914d\u9001\u65e5\u671f",value:"delivery_date",type:"dataCompare"}]}]),qu=Q.a.Option,Xu=[],$u=[],Qu=24,Zu=0;Zu<Qu;Zu++)Xu.push({label:"".concat(Zu,"\u70b9"),value:Zu}),$u.push({label:"".concat(Zu+1,"\u70b9"),value:Zu+1});for(var em=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={regions:[],position:[],groups:[],selectedItems:null,deliveryDate:J()(),deliveryStartTime:0,deliveryEndTime:24},a.onPositionChange=function(e){a.setState({position:e})},a.handleCancel=function(){a.props.onCancel()},a.handleChange=function(e){a.setState({selectedItems:e})},a.handleSubmit=function(){var e=a.state.position,t=y.a.findIndex(e,function(e){return"deliveryOrders"===a.props.type?"\u5168\u90e8"===e:!e}),n={};console.log("===============================");var i=["SHOP_SELF_PICK_SUMMARY_4","deliveryOrders"];t>-1?1===t&&e[t-1]?(n.key=i.indexOf(a.props.type)>-1?"province":"shop_province_code",n.opt=i.indexOf(a.props.type)>-1?"=":"like",n.value=e[t-1]):2===t&&e[t-1]&&(n.key=i.indexOf(a.props.type)>-1?"city":"shop_city_code",n.opt=i.indexOf(a.props.type)>-1?"=":"like",n.value=e[t-1]):e[e.length-1]&&(n.key=i.indexOf(a.props.type)>-1?"area":"shop_area_code",n.opt=i.indexOf(a.props.type)>-1?"=":"like",n.value=e[e.length-1]);var r,l=null;r=a.state.deliveryDate.format("YYYY-MM-DD"),a.props.deliveryTimeShow&&(l=["".concat(a.state.deliveryStartTime,":00:00"),"".concat(a.state.deliveryEndTime<Qu?a.state.deliveryEndTime+":00:00":"23:59:59")]),a.props.submit(n,a.props.type,a.state.selectedItems,r,l),a.handleCancel()},a.selectDate=function(e){console.log(e,"---------------"),a.setState({deliveryDate:e})},a.selectStartTime=function(e){a.setState({deliveryStartTime:e})},a.selectEndTime=function(e){a.setState({deliveryEndTime:e})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;xe({}).then(function(t){t.forEach(function(e){e.children.forEach(function(e){e.children.unshift({region_code:null,name:"\u5168\u90e8",children:[]})}),e.children.unshift({region_code:null,name:"\u5168\u90e8",children:[]})}),e.setState({regions:t})}).catch(function(e){}),ha({}).then(function(t){e.setState({groups:t.data})})}},{key:"render",value:function(){var e=this,t=this.state.selectedItems;return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u9009\u62e9\u67e5\u8be2\u6761\u4ef6",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u914d\u9001\u65e5\u671f:"),i.a.createElement(G.a,{defaultValue:this.state.deliveryDate,onChange:this.selectDate})),this.props.deliveryTimeShow?i.a.createElement("li",null,i.a.createElement("span",null,"\u914d\u9001\u65f6\u95f4:"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(Q.a,{style:{width:120},defaultValue:this.state.deliveryStartTime,onChange:this.selectStartTime},Xu.map(function(t,a){return e.state.deliveryEndTime<=t.value?"":i.a.createElement(qu,{key:a,value:t.value},t.label)})),i.a.createElement("span",{style:{margin:"6px"}},"\u5230"),i.a.createElement(Q.a,{style:{width:120},defaultValue:this.state.deliveryEndTime,onChange:this.selectEndTime},$u.map(function(t,a){return e.state.deliveryStartTime>=t.value?"":i.a.createElement(qu,{key:a,value:t.value},t.label)})))):"",i.a.createElement("li",null,i.a.createElement("span",null,"\u5730\u533a:")," ","deliveryOrders"===this.props.type?i.a.createElement(Oe.a,{options:this.state.regions,onChange:this.onPositionChange,placeholder:"\u8bf7\u9009\u62e9\u7701\u5e02\u533a",fieldNames:{label:"name",value:"name",children:"children"},className:"positionCascader"}):i.a.createElement(Oe.a,{options:this.state.regions,onChange:this.onPositionChange,placeholder:"\u8bf7\u9009\u62e9\u7701\u5e02\u533a",className:"positionCascader",fieldNames:{label:"name",value:"region_code",children:"children"}})),i.a.createElement("li",null,i.a.createElement("span",null,"\u5e97\u94fa\u7ec4:"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,className:"positionCascader",value:t,onChange:this.handleChange,optionLabelProp:"label",allowClear:!0,optionFilterProp:"children"},this.state.groups.map(function(e){return i.a.createElement(Q.a.Option,{key:e.name+"",label:e.name,value:e.name+""},e.name)}))))))}}]),t}(i.a.Component),tm=function(e){function t(e){var a;Object(s.a)(this,t);return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ALL";a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({state_constant:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.reviewGoods=function(e,t){a.setState({reviewGoodsVisible:!0,items:e,text:t})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.search=function(e){a.setState({api:nn,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:nn,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){Yu.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"damaged_items"===r.dataIndex&&(r.render=function(e,t){return t.damaged_items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.damaged_items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.damaged_items,"\u7834\u635f\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}),"deficient_items"===r.dataIndex&&(r.render=function(e,t){return t.deficient_items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.deficient_items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.deficient_items,"\u7f3a\u5c11\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.refundColumns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){console.log(e),a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,n){w({strategy:e,summary_order_id:a.state.checkedAry[0],customize_columns:t,logic_conditions:n})},a.exportConditions=function(e){var t="";switch(e){case"SHOP_SELF_PICK_SUMMARY_3":t="merchant_summary_order_";break;case"SHOP_SELF_PICK_SUMMARY_4":t="order_"}var n=a.state.position,i=[];if(n&&n.key&&n.value){var r={key:"".concat(t).concat(n.key),operation:n.opt,value:n.value};i.push(r)}if(a.state.deliveryDate){var l={key:"".concat(t,"delivery_date"),operation:"=",value:a.state.deliveryDate};i.push(l)}if(a.state.deliveryTime){var s={key:"".concat(t,"delivery_time_period"),operation:"between",value:a.state.deliveryTime};i.push(s)}return{conditions:i,logic:"and"}},a.exportToday=function(e){var t=w({strategy:e,customize_columns:[],logic_conditions:a.exportConditions(e)});window.open("".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(t,"&Authorization=").concat(k()),"target","")},a.print=function(){var e=a.state,t=e.checkedAry,n=e.data,i=[];y.a.map(n,function(e){y.a.indexOf(t,e.id)>-1&&i.push(e)}),a.props.history.push({pathname:"/printSummaryOrders",state:{orders:i,title:"\u6d88\u8d39\u8005\u6c47\u603b\u5355"}})},a.printShopOrder=function(){if(a.state.checkedAry.length>1)B.a.error("\u5f53\u524d\u6253\u5370\u53ea\u53ef\u9009\u62e9\u4e00\u9879\u8fdb\u884c\u6253\u5370");else{var e=a.state,t=e.checkedAry,n=e.data,i=[],r="";y.a.map(n,function(e){y.a.indexOf(t,e.id)>-1&&(r="".concat(e.shop_name,"\u7684\u8ba2\u5355"),i=e.relatedOrders.data)}),a.props.history.push({pathname:"/printSheet",state:{orders:i,title:r}})}},a.exportOrders=function(){a.state.checkedAry.length>1?B.a.error("\u5f53\u524d\u5bfc\u51fa\u53ea\u53ef\u9009\u62e9\u4e00\u9879\u8fdb\u884c\u5bfc\u51fa"):a.setState({exportVisible:!0,isToday:!0})},a.getSummaryConditions=function(e,t,a,n){var i=[];if(e&&e.key&&e.value){e.key="merchant_summary_order_"+e.key;var r={key:e.key,operation:e.opt,value:e.value};i.push(r)}if(t){var l={key:"merchant_summary_order_shop_group",operation:"=",value:t};i.push(l)}if(a){var s={key:"merchant_summary_order_delivery_date",operation:"=",value:a};i.push(s)}if(n){var c={key:"merchant_summary_order_delivery_time_period",operation:"between",value:n};i.push(c)}return{conditions:[{conditions:i,logic:"and"}],logic:"and"}},a.getTodayOrder=Object($.a)(X.a.mark(function e(){var t,n,i,r,l,s,c=arguments;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:1,n=c.length>1?c[1]:void 0,i=c.length>2?c[2]:void 0,e.next=5,nn({page:t,limit:10,searchJson:w({logic_conditions:n})});case 5:r=e.sent,l=r.data,s=r.meta,a.setState({todayOrders:a.state.todayOrders.concat(l)},function(){if(s.pagination.current_page<s.pagination.total_pages)a.getTodayOrder(s.pagination.current_page+1,n,i);else{a.setState({loadingOne:!1,loadingTwo:!1});var e=a.state.todayOrders;if("summary"===i){var t=[];e.length?(y.a.map(e,function(e){y.a.map(e.relatedOrders.data,function(e){t.push(e)})}),a.props.history.push({pathname:"/printSheet",state:{orders:t,title:""}})):B.a.error("\u4eca\u65e5\u6682\u65e0\u8ba2\u5355")}else"order"===i&&(e.length?a.props.history.push({pathname:"/printSummaryOrders",state:{orders:e,title:""}}):B.a.error("\u4eca\u65e5\u6682\u65e0\u8ba2\u5355"))}});case 9:case"end":return e.stop()}},e)})),a.printAllSummaryOrders=function(){var e=Object($.a)(X.a.mark(function e(t){var n,i,r,l;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,i=n.position,r=n.deliveryDate,l=n.deliveryTime,a.setState({loadingOne:!0}),e.next=4,a.getTodayOrder(1,a.getSummaryConditions(i,t,r,l),"order");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.printAllOrders=function(){var e=Object($.a)(X.a.mark(function e(t){var n,i,r,l;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,i=n.position,r=n.deliveryDate,l=n.deliveryTime,a.setState({loadingTwo:!0}),e.next=4,a.getTodayOrder(1,a.getSummaryConditions(i,t,r,l),"summary");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.showConditionSelector=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.setState({positionVisible:!0,type:e,deliveryTimeShow:t})},a.hideConditionSelector=function(){a.setState({positionVisible:!1})},a.submitCondition=function(e,t,n,i,r){a.setState({position:e,deliveryTime:r,deliveryDate:i},Object($.a)(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="deliveryOrders"===e.t0?3:"orders"===e.t0?6:"summaryOrders"===e.t0?9:"SHOP_SELF_PICK_SUMMARY_3"===e.t0?12:"SHOP_SELF_PICK_SUMMARY_4"===e.t0?12:14;break;case 3:return e.next=5,a.printDeliveryOrders();case 5:return e.abrupt("break",14);case 6:return e.next=8,a.printAllOrders(n);case 8:return e.abrupt("break",14);case 9:return e.next=11,a.printAllSummaryOrders(n);case 11:return e.abrupt("break",14);case 12:return a.exportToday(t),e.abrupt("break",14);case 14:case"end":return e.stop()}},e)})))},a.getConditions=function(e,t,a){var n=[];if(e&&e.key&&e.value){e.key="order_"+e.key;var i={key:e.key,operation:e.opt,value:e.value};n.push(i)}if(t){var r={key:"order_delivery_date",operation:"=",value:t};n.push(r)}if(a){var l={key:"order_delivery_time_period",operation:"between",value:a};n.push(l)}return n.push({key:"order_delivery_type",operation:"=",value:"HOME_DELIVERY"}),n.push({key:"order_state",operation:"=",value:"WAIT_CUSTOMER_VERIFY"}),{logic_conditions:{conditions:[{conditions:n,logic:"and"}],logic:"and"}}},a.printDeliveryOrders=Object($.a)(X.a.mark(function e(){var t,n,i,r,l,s,c,o,u=arguments;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:1,n=a.state,i=n.position,r=n.deliveryDate,l=n.deliveryTime,a.setState({loadingThree:!0}),e.next=5,Qa({page:t,limit:10,searchJson:w(a.getConditions(i,r,l))});case 5:s=e.sent,c=s.data,o=s.meta,a.setState({deliveryHomeOrders:a.state.deliveryHomeOrders.concat(c)},function(){o.pagination.current_page<o.pagination.total_pages?a.printDeliveryOrders(o.pagination.current_page+1):(a.setState({loadingThree:!1}),a.props.history.push({pathname:"/printSheet",state:{orders:a.state.deliveryHomeOrders,title:"delivery"}}))});case 9:case"end":return e.stop()}},e)})),a.confirmVerify=function(){var e=a.state.checkedAry,t=a.state.activeTab,n=Object(Ja.a)(a),r=(a.refresh,ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u6279\u91cf\u6838\u9500\u8fd9\u4e9b\u8ba2\u5355\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a;(a={order_ids:e},ne({url:"/api/backend/orders/agents/summary_orders/to_complete",method:"post",data:a})).then(function(e){B.a.success("\u6279\u91cf\u6838\u9500\u8ba2\u5355\u6210\u529f\uff01"),n.setState({api:nn,activeTab:t,paginationParams:Object(be.a)({},n.state.paginationParams,{searchJson:w({state_constant:t})})},function(){n.child.current.pagination(1)})})},onCancel:function(){}}))},a.child=i.a.createRef(),a.state={api:nn,filterVisible:!1,customVisible:!1,exportVisible:!1,refundVisible:!1,refuseVisible:!1,data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:"",searchJson:w({date:null})},activeTab:"ALL",reviewGoodsVisible:!1,record:{},items:[],refundItem:{},refuseItem:{},defaultItem:["user_nickname","trade_no","products","settlement_total_fee","refund_type","refund_apply_at","refund_state"],conditions:{},current:1,todayOrders:[],loadingOne:!1,loadingTwo:!1,positionVisible:!1,loadingThree:!1,deliveryHomeOrders:[],type:"summaryOrders",deliveryDate:null,deliveryTime:null,position:null,deliveryTimeShow:!0},a.refundColumns=[{title:"\u6536\u8d27\u5e97\u94fa",dataIndex:"shop_name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u5546\u54c1",render:function(e,t){return t.items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u7f3a\u5c11\u5546\u54c1",render:function(e,t){return t.deficient_items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.deficient_items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.deficient_items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u7834\u635f\u5546\u54c1",render:function(e,t){return t.damaged_items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.damaged_items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.damaged_items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u6c47\u603b\u65f6\u95f4",dataIndex:"summary_date"},{title:"\u72b6\u6001",dataIndex:"state_desc"}],a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={onChange:function(t,a){var n=[];y.a.map(a,function(e){n.push(e.id)}),e.setState({checkedAry:n})}},a={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"SHOP_SELF_PICK_SUMMARY",value:"\u81ea\u63d0\u6c47\u603b\u5355",showSelector:!1},{key:"SHOP_SELF_PICK_SUMMARY_2",value:"\u81ea\u63d0\u6c47\u603b\u5355\u5a49\u79cb\u5b9a\u5236\u7248"}],values:Yu,conditions:this.state.conditions,slug:"order_"},n={visible:this.state.positionVisible,onCancel:this.hideConditionSelector,submit:this.submitCondition,type:this.state.type,deliveryTimeShow:this.state.deliveryTimeShow};return i.a.createElement("div",{className:"refund"},i.a.createElement(dn,a),i.a.createElement(em,n),i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:Yu,export:this.showExport,slug:"merchant_summary_order"}),i.a.createElement(Xa,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items,text:this.state.text}),i.a.createElement("div",{className:"s_body_box"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u59d3\u540d\u6216\u624b\u673a\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.print,disabled:!this.state.checkedAry.length},"\u6253\u5370\u6c47\u603b\u5355"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.printShopOrder,disabled:!this.state.checkedAry.length},"\u6253\u5370\u8ba2\u5355"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:this.exportOrders,disabled:!this.state.checkedAry.length},"\u5bfc\u51fa"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showConditionSelector("summaryOrders")},loading:this.state.loadingOne},"\u6279\u91cf\u6253\u5370\u6c47\u603b\u5355"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showConditionSelector("orders")},loading:this.state.loadingTwo},"\u6279\u91cf\u6253\u5370\u8ba2\u5355"),window.hasPermission("order_management_printing")&&i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showConditionSelector("deliveryOrders")},loading:this.state.loadingThree},"\u6279\u91cf\u6253\u5370\u914d\u9001\u5355"))),i.a.createElement("div",{className:"",style:{marginTop:"20px"}},i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showConditionSelector("SHOP_SELF_PICK_SUMMARY_3")},loading:this.state.loadingThree},"\u6279\u91cf\u5bfc\u51fa\u81ea\u63d0\u70b9\u5730\u5740"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showConditionSelector("SHOP_SELF_PICK_SUMMARY_4")},loading:this.state.loadingThree,style:{marginLeft:"15px"}},"\u6279\u91cf\u5bfc\u51fa\u914d\u9001\u5355\u5730\u5740"),i.a.createElement(_e.a,{size:"small",onClick:this.confirmVerify,disabled:!this.state.checkedAry.length||"WAIT_AGENT_VERIFY"!==this.state.activeTab,style:{marginLeft:"15px"}},"\u786e\u8ba4\u6536\u8d27")),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:"ALL"},{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u6b63\u5e38\u5b8c\u6210\u6536\u8d27",key:"SUCCESS_COMPLETED"},{name:"\u5f02\u5e38\u5b8c\u6210\u6536\u8d27",key:"UNQUALIFIED_COMPLETED"}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:Yu,targetKeys:V(this.state.defaultItem),firstItem:"trade_no",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.refundColumns,rowKey:function(e,t){return t},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u6761\u8bb0\u5f55",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),am=Object(U.g)(tm),nm=(a(400),[{spec:"6\u540b",candle:1,hat:1,fork:5},{spec:"8\u540b",candle:1,hat:1,fork:10},{spec:"10\u540b",candle:1,hat:1,fork:10},{spec:"12\u540b",candle:1,hat:1,fork:10}]),im=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).candle=function(e,t){if(y.a.isEmpty(e))return 0;var a="";for(var n in e)"\u5c3a\u5bf8"===n&&(a=e[n]);var i={};return y.a.map(nm,function(e){a===e.spec&&(i=e)}),i[t]},a.state={orders:[],data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e={},t=[];y.a.map(this.props.orders,function(a){if(e[a.shop_name])y.a.map(t,function(e,t){e[0].shop_name===a.shop_name&&e.push(a)});else{var n=[];n.push(a),t.push(n),e[a.shop_name]=a}});var a=[].concat.apply([],t);this.setState({orders:a},function(){window.print()})}},{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",align:"center"},{title:"\u89c4\u683c",dataIndex:"spec_value",align:"center",render:function(e,t,a){if("\u5408\u8ba1"===t.name)return"--";var n="";if(e)for(var i in e)n="".concat(i,": ").concat(e[i]);else n="\u65e0";return n}},{title:"\u5355\u4f4d",dataIndex:"unit",align:"center",render:function(e,t,a){return"\u5408\u8ba1"===t.name?"--":e}},{title:"\u6570\u91cf",align:"center",dataIndex:"quantity"},{title:"\u5355\u4ef7(\u5143)",dataIndex:"price",align:"center"},{title:"\u5907\u6ce8",dataIndex:"remark",align:"center"},{title:"\u8721\u70db",dataIndex:"candle",align:"center",render:function(t,a){return t||("\u5408\u8ba1"===a.name?"--":e.candle(a.spec_value,"candle"))}},{title:"\u751f\u65e5\u5e3d",dataIndex:"hat",align:"center",render:function(t,a){return t||("\u5408\u8ba1"===a.name?"--":e.candle(a.spec_value,"hat"))}},{title:"\u76d8\u53c9",dataIndex:"fork",align:"center",render:function(t,a){return t||("\u5408\u8ba1"===a.name?"--":e.candle(a.spec_value,"fork"))}}],a=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",align:"center"},{title:"\u89c4\u683c(\u5355\u4f4d)",dataIndex:"unit",align:"center",render:function(e,t,a){return"\u5408\u8ba1"===t.name?"--":e}},{title:"\u6570\u91cf",align:"center",dataIndex:"quantity"},{title:"\u5355\u4ef7(\u5143)",dataIndex:"price",align:"center"}],n=this.state.orders;return i.a.createElement("div",{id:"printArea"},n.length?n.map(function(n){console.log(n);var r,l,s=0;n.items.data.length&&n.items.data.map(function(e){s+=e.quantity}),r=n.total_fee,l=n.settlement_total_fee;var c={id:String(Math.random()),name:"\u5408\u8ba1",quantity:s,price:r},o={quantity:"\u5b9e\u4ed8",price:l,candle:"--",hat:"--",fork:"--"};return n.items.data=[].concat(Object(Se.a)(n.items.data),[c,o]),i.a.createElement("div",{className:"printSheet",key:n.id},"delivery"===e.props.title?i.a.createElement("h4",{className:"shopInfo"},"\u6536\u8d27\u4eba\uff1a",n.shipping_info&&n.shipping_info.consignee_name):"",n.shop_name?i.a.createElement("h4",{className:"shopInfo"},n.shop_name,"(",n.shop_code,")"):"",i.a.createElement("h4",null,"\u7528\u6237\uff1a",n.user_nickname||n.name,"\xa0\xa0\xa0\xa0","delivery"===e.props.title?"":i.a.createElement("span",null,"\u6536\u8d27\u4eba\uff1a",n.shipping_info&&n.shipping_info.consignee_name)),i.a.createElement("h4",null,"\u8ba2\u5355\u53f7\uff1a",n.trade_no.slice(14,24)),n.shipping_info&&i.a.createElement("div",null,i.a.createElement("h4",null,"\u914d\u9001\u5730\u5740\uff1a",n.shipping_info.province,n.shipping_info.city,n.shipping_info.area,n.shipping_info.detail_address),i.a.createElement("h4",null,"\u5ba2\u6237 \u8054\u7cfb\u7535\u8bdd\uff1a",n.shipping_info.consignee_mobile_phone)),i.a.createElement("h4",null,"\u4e0b\u5355\u65f6\u95f4\uff1a",n.paid_at),i.a.createElement("h4",null,"\u9884\u7ea6\u9001\u8d27\u65f6\u95f4\uff1a",n.expect_receive_date," ",n.expect_receive_time_start,"-",n.expect_receive_time_end),n.shop_keeper_name?i.a.createElement("h4",null,"\u81ea\u63d0\u5546\u6237\u4e3b\u59d3\u540d:",n.shop_keeper_name):"",n.shop_keeper_mobile?i.a.createElement("h4",null,"\u81ea\u63d0\u5546\u6237\u4e3b\u624b\u673a\u53f7:",n.shop_keeper_mobile):"",n.shop_complete_address?i.a.createElement("h4",null,"\u81ea\u63d0\u5e97\u94fa\u5730\u5740:",n.shop_complete_address):"",i.a.createElement("h4",null,"\u5907\u6ce8:",n.remark||"\u65e0"),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:e.props.isNeedItems?t:a,bordered:!0,rowKey:function(e){return e.item_id},pagination:!1,dataSource:n.items.data})))}):"\u6682\u65e0\u8ba2\u5355")}}]),t}(n.Component),rm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={orders:[],data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({orders:this.props.orders},function(){window.print()})}},{key:"render",value:function(){var e=[{title:"\u5546\u54c1\u4fe1\u606f",dataIndex:"product_name",align:"center",render:function(e,t){return i.a.createElement("span",null,e||t.name)}},{title:"\u89c4\u683c\uff08\u5355\u4f4d\uff09",dataIndex:"unit",align:"center",render:function(e,t,a){return console.log(t,"===============>"),"\u5408\u8ba1"===t.name?"--":e}},{title:"\u6570\u91cf",align:"center",dataIndex:"quantity"},{title:"\u5355\u4ef7(\u5143)",dataIndex:"price",align:"center"},{title:"\u91d1\u989d(\u5143)",dataIndex:"total_fee",align:"center"}],t=this.state.orders;return i.a.createElement("div",{id:"printArea"},t.length?t.map(function(t,a){console.log(t);var n,r=0,l=t.items&&t.items.data?t.items.data:t.items;l.length&&l.map(function(e){r+=e.quantity}),n=t.total_fee,t.settlement_total_fee;var s={id:String(Math.random()),product_name:"\u5408\u8ba1",quantity:r,total_fee:n};return t.items=[].concat(Object(Se.a)(l),[s,{product_spec_value:"wholeRow",product_name:"\u53f8\u673a\u7b7e\u540d",quantity:"\u5ba2\u6237\u7b7e\u540d"}]),i.a.createElement("div",{className:"printSheet",key:t.id},t.shop_info?i.a.createElement("div",null,i.a.createElement("h4",{className:"shopInfo"},a+1,"\u53f7\u5e97\u94fa\uff1a",t.shop_info.name),i.a.createElement("h4",null,"\u7f16\u7801\uff1a",t.shop_info.code),i.a.createElement("h4",null,"\u5730\u5740\uff1a",t.shop_info.address),i.a.createElement("h4",null,"\u6536\u8d27\u4eba\uff1a",t.shop_info.keeper_name),i.a.createElement("h4",null,"\u8054\u7cfb\u7535\u8bdd\uff1a",t.shop_info.keeper_mobile)):"",t.shipping_info?i.a.createElement("div",null,i.a.createElement("h4",{className:"shopInfo"},"\u5e97\u94fa\u540d\u79f0\uff1a",t.name),i.a.createElement("h4",null,"\u5730\u5740\uff1a",t.shipping_info.province,t.shipping_info.city,t.shipping_info.area,t.shipping_info.detail_address),i.a.createElement("h4",null,"\u6536\u8d27\u4eba\uff1a",t.shipping_info.consignee_name),i.a.createElement("h4",null,"\u8054\u7cfb\u7535\u8bdd\uff1a",t.shipping_info.consignee_mobile_phone)):"",i.a.createElement("h4",null,"\u5355\u636e\u7f16\u53f7\uff1a"),i.a.createElement("h4",null,"\u7269\u6d41\u7535\u8bdd\uff1a"),i.a.createElement("h4",null,"\u914d\u9001\u5458\uff1a"),i.a.createElement("h4",null,"\u6c47\u603b\u65f6\u95f4\uff1a",t.summary_date),i.a.createElement("h4",null,"\u8f66\u7ebf\uff1a",t.shop_delivery_route&&t.shop_delivery_route.name),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:e,bordered:!0,rowKey:function(e){return e.item_id},pagination:!1,dataSource:t.items})))}):"\u6682\u65e0\u8ba2\u5355")}}]),t}(n.Component),lm=(a(1495),a(614),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={item:{},refund:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){a.state.refund?a.state.refund-2*a.state.item.refund_need_amount>0?B.a.error("\u9000\u6b3e\u91d1\u989d\u6700\u591a\u4e3a\u5546\u54c1\u91d1\u989d\u7684\u4e24\u500d"):tn({refund_amount:a.state.refund},a.props.item.refund_id).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){}):B.a.error("\u8bf7\u8f93\u5165\u9000\u6b3e\u91d1\u989d")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.item&&this.setState({item:e.item})}},{key:"render",value:function(){var e=this,t=this.state.item;return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u9000\u6b3e",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5f02\u5e38\u5546\u54c1\u603b\u91d1\u989d\uff1a"),i.a.createElement("h5",null,"\u7528\u6237\u7533\u8bf7\u552e\u540e"==t.refund_state_desc?"\u65e0":t.refund_need_amount)),i.a.createElement("li",null,i.a.createElement("span",null,"\u5b9e\u4ed8\u6b3e\uff1a"),i.a.createElement("h5",null,t.settlement_total_fee)),i.a.createElement("li",null,i.a.createElement("span",null,"\u9000\u6b3e\u91d1\u989d"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.refund,onChange:function(t){e.setState({refund:t.target.value})}})))))}}]),t}(i.a.Component)),sm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:"\u5546\u54c1\u4e0d\u5168"},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){an({reason:a.state.value},a.props.item.refund_id).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.onChange=function(e){console.log("radio checked",e.target.value),a.setState({value:e.target.value})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"refundMoney"},i.a.createElement(ge.a,{title:"\u62d2\u7edd\u9000\u6b3e",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u62d2\u7edd\u7406\u7531\uff1a"),i.a.createElement(mn.a.Group,{value:this.state.value,onChange:this.onChange},i.a.createElement(mn.a,{value:"\u5546\u54c1\u4e0d\u5168"},"\u5546\u54c1\u4e0d\u5168"),i.a.createElement(mn.a,{value:"\u5546\u54c1\u4e22\u5931"},"\u5546\u54c1\u4e22\u5931"),i.a.createElement(mn.a,{value:"\u5546\u54c1\u8fc7\u671f"},"\u5546\u54c1\u8fc7\u671f"))))))}}]),t}(i.a.Component),cm=function(e){function t(e){var a;Object(s.a)(this,t);return(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({refund_state:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.reviewGoods=function(e,t){a.setState({reviewGoodsVisible:!0,items:e,text:t})},a.closeReviewGoods=function(){a.setState({reviewGoodsVisible:!1})},a.jump=function(e){a.props.history.push({pathname:"/order/orderDetail",state:{id:e.order_id,path:"/order/refund",current:a.child.current.state.current}})},a.search=function(e){a.setState({api:Ru,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Ru,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){console.log(e,"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`");var t=[];e.forEach(function(e){wn.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"damaged_items"===r.dataIndex&&(r.render=function(e,t){return t.damaged_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.damaged_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.damaged_items,"\u7834\u635f\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items,"\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),"deficient_items"===r.dataIndex&&(r.render=function(e,t){return t.deficient_items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.deficient_items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.deficient_items,"\u7f3a\u5c11\u5546\u54c1")}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.refundColumns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){console.log(e),a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.showRefund=function(e){a.setState({refundVisible:!0,refundItem:e})},a.hideRefund=function(){a.setState({refundVisible:!1})},a.showRefuse=function(e){a.setState({refuseVisible:!0,refuseItem:e})},a.hideRefuse=function(){a.setState({refuseVisible:!1})},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){var n=w({strategy:e,customize_columns:t,logic_conditions:a});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.print=function(){var e=a.state,t=e.checkedAry,n=e.data,i=[];y.a.map(n,function(e){y.a.indexOf(t,e.order_id)>-1&&i.push(e)}),a.props.history.push({pathname:"/printSheet",state:{orders:i,title:"\u6d88\u8d39\u8005\u9000\u6b3e\u8ba2\u5355"}})},a.backAct=function(){a.props.history.push({pathname:"/activities"})},a.child=i.a.createRef(),a.state={api:Ru,filterVisible:!1,customVisible:!1,exportVisible:!1,refundVisible:!1,refuseVisible:!1,data:[],checkedAry:[],paginationParams:{logic_conditions:[],search:""},activeTab:-1,reviewGoodsVisible:!1,record:{},items:[],refundItem:{},refuseItem:{},defaultItem:["user_nickname","trade_no","products","settlement_total_fee","refund_type","refund_apply_at","refund_state"],conditions:{},current:1,actId:""},a.refundColumns=[{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no",render:function(e,t){return i.a.createElement("span",{onClick:function(){return a.jump(t)},style:{color:"#4F9863",cursor:"pointer"}},e)}},{title:"\u5546\u54c1",render:function(e,t){return t.items.data.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items.data[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u7528\u6237\u6635\u79f0",dataIndex:"nickname"},{title:"\u9000\u6b3e\u7c7b\u578b",dataIndex:"refund_type_desc"},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"applied_at"},{title:0===a.state.activeTab?"\u64cd\u4f5c":"\u9000\u6b3e\u72b6\u6001",dataIndex:"refund_state_desc",render:function(e,t){return 0===a.state.activeTab?i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"20px"},onClick:function(){return a.showRefund(t)}},"\u9000\u6b3e"),i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showRefuse(t)}},"\u62d2\u7edd\u9000\u6b3e")):i.a.createElement("span",null,e)}}],a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.setState({actId:this.props.location.state.id}),this.props.location.state&&this.props.location.state.current&&this.setState({current:this.props.location.state.current}),document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t=(this.state.activeTab,{onChange:function(t,a){e.setState({checkedAry:t})}}),a={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"USER_ORDER_CUSTOMIZE",value:"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"},{key:"USER_ORDER_PRODUCT",value:"\u5546\u54c1\u7ef4\u5ea6"},{key:"USER_ORDER_SHOP",value:"\u5e97\u94fa\u7ef4\u5ea6"}],values:wn,conditions:this.state.conditions,slug:"order_"};return i.a.createElement("div",{className:"refund"},i.a.createElement(dn,a),i.a.createElement(Ou,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:wn,export:this.showExport}),i.a.createElement(Xa,{visible:this.state.reviewGoodsVisible,onCancel:this.closeReviewGoods,items:this.state.items,text:this.state.text}),i.a.createElement(lm,{visible:this.state.refundVisible,onCancel:this.hideRefund,item:this.state.refundItem,refresh:function(){return e.refresh(0)}}),i.a.createElement(sm,{visible:this.state.refuseVisible,onCancel:this.hideRefuse,item:this.state.refuseItem,refresh:function(){return e.refresh(0)}}),i.a.createElement(_e.a,{size:"small",style:{position:"absolute",right:"280px",zIndex:"999"},onClick:this.backAct},"\u8fd4\u56de\u86cb\u7cd5\u7ba1\u7406"),i.a.createElement("div",{className:"s_body"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u59d3\u540d\u6216\u624b\u673a\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small",onClick:this.print,disabled:!this.state.checkedAry.length},"\u6253\u5370\u8ba2\u5355"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:-1},{name:"\u5f85\u5904\u7406",key:0},{name:"\u5904\u7406\u4e2d",key:1},{name:"\u5df2\u9000\u6b3e",key:2},{name:"\u62d2\u7edd\u9000\u6b3e",key:3}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:wn,targetKeys:V(this.state.defaultItem),firstItem:"trade_no",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{rowSelection:t,columns:this.refundColumns,rowKey:function(e){return e.order_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u6761\u8bb0\u5f55",params:this.state.paginationParams,id:this.state.actId,valChange:this.paginationChange,current:this.state.current})))}}]),t}(i.a.Component),om=Object(U.g)(cm),um=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={orders:[],data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.orders;console.log(e,"====>");var t=[];y.a.map(e,function(e){e.order.length&&e.order.map(function(t){t.village=e.village,t.mobile=e.mobile,t.nameBig=e.name,t.address=e.address}),t=t.concat(e.order)}),this.setState({orders:t},function(){window.print()})}},{key:"render",value:function(){var e=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"product_name",align:"center"},{title:"\u89c4\u683c(\u5355\u4f4d)",dataIndex:"unit",align:"center",render:function(e,t,a){return"\u5408\u8ba1"===t.name?"--":e}},{title:"\u6570\u91cf",align:"center",dataIndex:"quantity"},{title:"\u5355\u4ef7(\u5143)",dataIndex:"price",align:"center",render:function(e,t){return e?i.a.createElement("span",null,Number(e).toFixed(2)):""}},{title:"\u91d1\u989d(\u5143)",dataIndex:"total",align:"center"}],t=this.state.orders;return console.log(t,"MMMMMMMMMMMMMMMMMMMMM"),i.a.createElement("div",{id:"printArea"},t.length&&t.map(function(t){var a=0,n=0;t.products.length&&t.products.map(function(e){a+=e.quantity,e.price,n+=e.total});var r={unit:"\u5b9e\u4ed8",quantity:a,price:"",total:n.toFixed(2)};return t.products=[].concat(Object(Se.a)(t.products),[r]),i.a.createElement("div",{className:"printSheet",key:Math.random()},i.a.createElement("h4",{className:"shopInfo"},"\u5c0f\u533a\uff1a",t.village),i.a.createElement("h4",null,"\u7528\u6237\u6635\u79f0\uff1a",t.nickname,"\xa0\xa0\xa0\xa0",i.a.createElement("span",null,"\u6536\u8d27\u4eba\uff1a",t.name)),i.a.createElement("h4",null,"\u8ba2\u5355\u53f7\uff1a",t.trade_no.slice(14,24)),i.a.createElement("h4",null,"\u914d\u9001\u5730\u5740\uff1a",t.homeAddress),i.a.createElement("h4",null,"\u56ed\u533a\uff1a",t.area),i.a.createElement("h4",null,"\u5ba2\u6237 \u8054\u7cfb\u7535\u8bdd\uff1a",t.phone),i.a.createElement("h4",null,"\u4e0b\u5355\u65f6\u95f4\uff1a",t.paid_at),i.a.createElement("h4",null,"\u9884\u7ea6\u9001\u8d27\u65f6\u95f4\uff1a",t.expect_receive_date," ",t.expect_receive_time_start,"-",t.expect_receive_time_end),t.shop_keeper_name?i.a.createElement("h4",null,"\u81ea\u63d0\u5546\u6237\u4e3b\u59d3\u540d:",t.shop_keeper_name):"",t.shop_keeper_mobile?i.a.createElement("h4",null,"\u81ea\u63d0\u5546\u6237\u4e3b\u624b\u673a\u53f7:",t.shop_keeper_mobile):"",t.shop_complete_address?i.a.createElement("h4",null,"\u81ea\u63d0\u5e97\u94fa\u5730\u5740:",t.shop_complete_address):"",i.a.createElement("h4",null,"\u5c0f\u533a\u8054\u7cfb\u4eba\uff1a",t.nameBig),i.a.createElement("h4",null,"\u5c0f\u533a\u8054\u7cfb\u4eba\u624b\u673a\u53f7\uff1a",t.mobile),i.a.createElement("h4",null,"\u5c0f\u533a\u5730\u5740\uff1a",t.address),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:e,bordered:!0,rowKey:function(e){return Math.random()},pagination:!1,dataSource:t.products})))}))}}]),t}(n.Component),mm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={orders:[],data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.orders;y.a.map(e,function(e){var t=[];e.order.length&&e.order.map(function(e){e.products.length&&e.products.map(function(e){var a=y.a.findIndex(t,function(t){return t.product_name===e.product_name});a>-1?t[a].quantity=t[a].quantity+e.quantity:t.push(e)})}),e.products=t}),this.setState({orders:e},function(){window.print()})}},{key:"render",value:function(){var e=[{title:"\u5546\u54c1\u4fe1\u606f",dataIndex:"product_name",align:"center"},{title:"\u89c4\u683c\uff08\u5355\u4f4d\uff09",dataIndex:"unit",align:"center",render:function(e,t,a){return"\u5408\u8ba1"===t.name?"--":e}},{title:"\u6570\u91cf",align:"center",dataIndex:"quantity"},{title:"\u5355\u4ef7(\u5143)",dataIndex:"price",align:"center",render:function(e,t){return e?i.a.createElement("span",null,Number(e).toFixed(2)):""}},{title:"\u91d1\u989d(\u5143)",dataIndex:"total1",align:"center"}],t=this.state.orders;return i.a.createElement("div",{id:"printArea"},t.length&&t.map(function(t,a){var n=0;t.products.length&&t.products.map(function(e){n+=e.quantity}),t.total_fee;var r={id:String(Math.random()),product_name:"\u5408\u8ba1",quantity:n,total_fee:"",price:""};return t.products=[].concat(Object(Se.a)(t.products),[r,{product_spec_value:"wholeRow",product_name:"\u53f8\u673a\u7b7e\u540d",quantity:"\u5ba2\u6237\u7b7e\u540d",price:""}]),i.a.createElement("div",{className:"printSheet",key:Math.random()},i.a.createElement("h4",{className:"shopInfo"},"\u5c0f\u533a:",t.village),i.a.createElement("h4",null,"\u5730\u5740\uff1a",t.address),i.a.createElement("h4",null,"\u6536\u8d27\u4eba\uff1a",t.name),i.a.createElement("h4",null,"\u8054\u7cfb\u7535\u8bdd:",t.mobile),i.a.createElement("h4",null,"\u5355\u636e\u7f16\u53f7\uff1a"),i.a.createElement("h4",null,"\u7269\u6d41\u7535\u8bdd\uff1a"),i.a.createElement("h4",null,"\u914d\u9001\u5458\uff1a"),i.a.createElement("h4",null,"\u6c47\u603b\u65f6\u95f4\uff1a",R()),i.a.createElement("h4",null,"\u8f66\u7ebf\uff1a"),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:e,bordered:!0,rowKey:function(e){return Math.random()},pagination:!1,dataSource:t.products})))}))}}]),t}(n.Component),dm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:"add",bvValue:0,remark:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e=Number(a.state.bvValue);e?"sub"===a.state.value&&e-a.props.item.personal_bv>0?B.a.error("\u5f53\u524d\u4e2a\u4ebabv\u4e0d\u53ef\u51cf\u5c11\u90a3\u4e48\u591a"):(a.props.onSubmit(a.state.value,a.state.bvValue,a.state.remark,a.props.item),a.props.onCancel()):B.a.error("\u8bf7\u8f93\u5165\u8c03\u6574\u503c")},a.onChange=function(e){a.setState({value:e.target.value})},a.clearNoNum=function(e){var t=e.target.value;(t=(t=(t=(t=t.replace(/[^\d.]/g,"")).replace(/\.{2,}/g,".")).replace(".","$#$").replace(/\./g,"").replace("$#$",".")).replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")).indexOf(".")<0&&""!=t&&(t=parseFloat(t)),t<0?B.a.error("BV\u53d8\u52a8\u4e0d\u53ef\u5c0f\u4e8e0"):a.setState({bvValue:t})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.item.operation){var a="\u589e\u52a0"===e.item.operation?"add":"sub";this.setState({value:a,bvValue:e.item.operationValue,remark:e.item.remark})}else this.setState({value:"add",bvValue:0,remark:""})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9500\u552e\u989d\u8c03\u6574",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"operateBalance"},i.a.createElement(mn.a.Group,{onChange:this.onChange,value:this.state.value},i.a.createElement(mn.a,{value:"add"},"\u589e\u52a0"),i.a.createElement(mn.a,{value:"sub"},"\u51cf\u5c11")),i.a.createElement(Ne.a,{value:this.state.bvValue,type:"number",onChange:this.clearNoNum})),i.a.createElement("div",{className:"bvremark"},i.a.createElement("span",null,"\u5907\u6ce8"),i.a.createElement(Ne.a,{value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}}))))}}]),t}(n.Component),pm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={value:"add",bvValue:0,remark:""},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){var e=Number(a.state.bvValue);console.log(a.props.item,"====");var t="REWARD"===a.props.type?"add":"sub";e?"sub"===t&&e-a.props.item.amount>0?B.a.error("\u5f53\u524d\u4e0d\u53ef\u60e9\u7f5a\u8fd9\u4e48\u591a"):(a.props.onSubmit(t,a.state.bvValue,a.state.remark,a.props.item),a.props.onCancel()):B.a.error("\u8bf7\u8f93\u5165\u8c03\u6574\u503c")},a.onChange=function(e){a.setState({value:e.target.value})},a.clearNoNum=function(e){var t=e.target.value;(t=(t=(t=(t=t.replace(/[^\d.]/g,"")).replace(/\.{2,}/g,".")).replace(".","$#$").replace(/\./g,"").replace("$#$",".")).replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")).indexOf(".")<0&&""!=t&&(t=parseFloat(t)),t<0?B.a.error("BV\u53d8\u52a8\u4e0d\u53ef\u5c0f\u4e8e0"):a.setState({bvValue:t})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){if(e.item.operation){var a="\u589e\u52a0"===e.item.operation?"add":"sub";this.setState({value:a,bvValue:e.item.operationValue,remark:e.item.remark})}else this.setState({value:"add",bvValue:0,remark:""})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u5956\u60e9\u91d1\u989d\u8c03\u6574",width:520,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"bvremark"},i.a.createElement("span",null,"\u5956\u60e9\u91d1\u989d\u8c03\u6574"),i.a.createElement(Ne.a,{value:this.state.bvValue,type:"number",onChange:this.clearNoNum})),i.a.createElement("div",{className:"bvremark"},i.a.createElement("span",null,"\u5907\u6ce8"),i.a.createElement(Ne.a,{value:this.state.remark,onChange:function(t){e.setState({remark:t.target.value})}}))))}}]),t}(n.Component),hm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e=a.state.data,t=[],n="ADJUST_SALES_AMOUNT"===a.props.type?"sales_amount":"amount";y.a.map(e,function(e){var a={};a.record_id=e.id,a.adjust_data=[];var i={};i.column=n,i.opt="\u589e\u52a0"===e.operation?"add":"sub",i.value=e.operationValue,a.adjust_data.push(i),a.remark=e.remark,t.push(a)}),a.checkData(t)},a.checkData=function(e){var t,n;(t={adjust_type:a.props.type,adjust_items:e},n=a.props.id,ne({url:"/api/backend/distribution/sales/cashback/platform/summaries/".concat(n,"/records/adjust"),method:"post",data:t})).then(function(e){B.a.success(e.message),a.handleCancel()}).catch(function(e){})},a.onChange=function(e){a.setState({radioValue:e.target.value})},a.state={data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.adjusted.length&&this.setState({data:e.adjusted})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u786e\u5b9a\u5904\u7406",width:800,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",maskClosable:!1},"ADJUST_SALES_AMOUNT"!==this.props.type&&i.a.createElement("div",{style:{color:"red",fontWeight:"bold",marginBottom:"20px"}},"\u6ce8\u610f\uff1a\u8c03\u6574\u8fc7\u4f59\u989d\u540e\u5c06\u4e0d\u80fd\u518d\u8fdb\u884c\u9500\u552e\u989d\u8c03\u6574\uff01\uff01\uff01"),i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:[{title:"\u5e97\u94fa\u540d\u79f0",dataIndex:"shop_name"},{title:"\u5e97\u94fa\u7f16\u53f7",dataIndex:"shop_code"},{title:"\u4e2a\u4ebaBV",dataIndex:"personal_bv"},{title:"\u8c03\u6574\u7c7b\u578b",dataIndex:"operation"},{title:"\u8c03\u6574\u91d1\u989d",dataIndex:"operationValue"},{title:"\u5907\u6ce8",dataIndex:"remark"}],rowKey:function(e){return e.id},pagination:!1,dataSource:this.state.data}))))}}]),t}(n.Component),fm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.setState({type:e.target.value})},a.handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){a.props.typeSelect(a.state.type)},a.state={type:"REWARD"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t={display:"block",height:"30px",lineHeight:"30px"};return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9009\u62e9\u8c03\u6574\u7c7b\u578b",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u8fd4\u56de\u4e0a\u4e00\u9875",maskClosable:!1},i.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",marginBottom:"20px"}},i.a.createElement("span",null,"\u8c03\u6574\u7c7b\u578b"),i.a.createElement("div",{style:{marginLeft:"20px"}},i.a.createElement(mn.a.Group,{onChange:function(t){return e.onChange(t)},value:this.state.type},[{value:"REWARD",name:"\u5956\u52b1"},{value:"PUNISHMENT",name:"\u60e9\u7f5a"}].map(function(e){return i.a.createElement(mn.a,{style:t,value:e.value},e.name)}))))))}}]),t}(n.Component),Em=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.setState({filterVisible:!1,paginationParams:{searchJson:{}}},function(){a.child.current.pagination(a.child.current.state.current)})},a.search=function(e){a.setState({api:Wo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){var t=a.state.adjusted;y.a.map(t,function(t){var a=y.a.findIndex(e,function(e){return e.id===t.id});a>-1&&(e[a].operation=t.operation,e[a].operationValue=t.operationValue,e[a].remark=t.remark)}),a.setState({data:e})},a.showAdjust=function(e){"ADJUST_SALES_AMOUNT"===a.state.type?a.setState({adjustVisible:!0,adjustItem:e}):a.setState({adjustSalesVisible:!0,adjustItem:e})},a.hideAdjust=function(){a.setState({adjustVisible:!1,adjustSalesVisible:!1})},a.onSubmit=function(e,t,n,i){var r="add"===e?"\u589e\u52a0":"\u51cf\u5c11",l=a.state,s=l.adjusted,c=l.data;i.operation=r,i.operationValue=t,i.remark=n;var o=y.a.findIndex(c,function(e){return e.id===i.id}),u=y.a.findIndex(s,function(e){return e.id===i.id});u>-1?s[u]=i:s.push(i),o>-1&&(c[o]=i),a.setState({data:c,adjusted:s},function(){console.log(a.state.adjusted,".......................................")})},a.confirmHandle=function(){a.setState({confirmVisible:!0})},a.closeHandle=function(){a.setState({confirmVisible:!1})},a.back=function(){a.props.history.go(-1)},a.typeSelect=function(e){a.setState({type:e,typeVisible:!1})};var n=[{title:"\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u7f16\u53f7",dataIndex:"shop_name",render:function(e,t){return i.a.createElement("span",null,e,"/",t.shop_code)}},{title:"\u4e2a\u4ebaBV",dataIndex:"personal_bv"},{title:"\u5e02\u573a\u63a8\u5e7f\u670d\u52a1\u8d39\u2795\u9500\u552e\u8fd4\u4f63\u91d1\u989d",dataIndex:"amount"},{title:"\u64cd\u4f5c",render:function(e,t){return t.operation?i.a.createElement("span",{style:{color:"#fc3c2f",cursor:"pointer"},onClick:function(){return a.showAdjust(t)}},t.operation,t.operationValue):i.a.createElement("span",{style:{color:"#4f9863",cursor:"pointer"},onClick:function(){return a.showAdjust(t)}},"\u64cd\u4f5c")}},{title:"\u5907\u6ce8",dataIndex:"remark",render:function(e,t){return i.a.createElement("span",null,e||"\u65e0")}}];return a.state={api:Wo,id:"",data:[],paginationParams:{searchJson:{}},columns:n,adjustVisible:!1,adjustItem:{},adjusted:[],confirmVisible:!1,adjustSalesVisible:!1,type:"ADJUST_SALES_AMOUNT",typeVisible:!1},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.state.id;"Sales"===this.props.location.state.type&&this.setState({typeVisible:!0}),this.setState({id:e})}},{key:"render",value:function(){var e={visible:this.state.adjustVisible,item:this.state.adjustItem,onCancel:this.hideAdjust,onSubmit:this.onSubmit},t={visible:this.state.adjustSalesVisible,item:this.state.adjustItem,onCancel:this.hideAdjust,onSubmit:this.onSubmit,type:this.state.type},a={visible:this.state.confirmVisible,onClose:this.closeHandle,adjusted:this.state.adjusted,id:this.state.id,type:this.state.type},n={visible:this.state.typeVisible,onClose:this.back,typeSelect:this.typeSelect};return i.a.createElement("div",{className:"basic_statistics"},i.a.createElement(dm,e),i.a.createElement(hm,a),i.a.createElement(fm,n),i.a.createElement(pm,t),i.a.createElement("div",{className:"basic_statistics_header"},i.a.createElement("ul",{className:"header_left"},i.a.createElement("li",null,"\u5e97\u94fa\u540d/\u5e97\u94fa\u7f16\u53f7:",i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u7f16\u53f7/\u5e97\u94fa\u4e3b\u59d3\u540d/\u624b\u673a\u53f7\u7801"}))),i.a.createElement(_e.a,{onClick:this.confirmHandle,disabled:!this.state.adjusted.length},"\u786e\u5b9a\u5904\u7406")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{text:"\u6761\u6570\u636e",api:this.state.api,id:this.state.id,ref:this.child,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),vm=(a(615),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).create=function(){a.props.history.push({pathname:"/setting/editProtocol"})},a.state={versions:[],type:0,version:"",desc:"",platform:"IOS",appUrl:"",uploadType:"ID"},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=[{title:"\u7248\u672c\u53f7",dataIndex:"version"},{title:"\u8d44\u6e90\u5305\u5730\u5740",dataIndex:"resource_url"},{title:"\u7248\u672c\u5e73\u53f0",dataIndex:"platform",render:function(e,t){return i.a.createElement("span",null,"ANDROID"===e?"\u5b89\u5353":"IOS")}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created_at"}];return i.a.createElement("div",{className:"protocol_setting"},i.a.createElement(_e.a,{size:"small",onClick:this.create},"\u65b0\u5efa"),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:e,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.versions})))}}]),t}(i.a.Component)),_m=Object(U.g)(vm),gm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a.editor=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"protocol"},i.a.createElement("div",{className:"protocolHeader"},i.a.createElement(_e.a,{size:"small"},"\u4fdd\u5b58")),i.a.createElement(jr,{ref:this.editor,default:this.state.detail}))}}]),t}(n.Component),bm=(a(1496),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.state={shops:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.shops&&e.shops&&e.shops.length&&(console.log(e),this.setState({shops:e.shops}))}},{key:"render",value:function(){var e=this.state.shops;return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u4e0b\u7ebf\u5e97\u94fa",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"reviews"},e&&e.length&&e.map(function(e,t){return i.a.createElement("li",{key:t},e)}))))}}]),t}(i.a.Component)),ym=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.state={adjustments:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.adjustments&&(e.adjustments&&e.adjustments.length?(console.log(e),this.setState({adjustments:e.adjustments})):this.setState({adjustments:[]}))}},{key:"render",value:function(){var e=this.state.adjustments,t=[{title:"\u5b8c\u6210\u65f6\u95f4",dataIndex:"finished_time"},{title:"\u8c03\u6574",dataIndex:"sys_remark",render:function(e,t){return i.a.createElement("span",null,e,t.adjust_data[0].value)}},{title:"\u5907\u6ce8",dataIndex:"remark"}];return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u8c03\u6574\u8bb0\u5f55",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("div",{className:"chart",id:"s_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,dataSource:e}))))}}]),t}(i.a.Component),Cm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){},a.search=function(e){a.setState({api:Wo,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({tableData:e})},a.reviewShops=function(e){a.setState({shops:e,shopVisible:!0})},a.hideShops=function(){a.setState({shopVisible:!1})},a.showAdjustment=function(e){a.setState({adjustmentVisible:!0,adjustmentRecord:e.adjustments})},a.hideAdjustment=function(){a.setState({adjustmentVisible:!1})},a.state={tableData:[],id:"",api:Wo,paginationParams:{searchJson:{}},shops:[],shopsVisible:!1,adjustmentVisible:!1,adjustmentRecord:[]},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.state.id,t=this.props.location.state.type;this.setState({id:e}),"saleCashback"===t?this.setState({type:t}):this.setState({type:"other"})}},{key:"render",value:function(){var e=this,t=[{title:"\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u4e3b\u59d3\u540d/\u624b\u673a\u53f7\u7801",dataIndex:"shop_name",render:function(e,t){return i.a.createElement("span",null,e,"/",t.shop_keeper_name,"/",t.shop_keeper_mobile)}},{title:"\u4ecb\u7ecd\u4eba",dataIndex:"introducer_name"},{title:"\u4e0b\u7ebf\u6570\u91cf",dataIndex:"introduced_shops_count"},{title:"\u4e0b\u7ebf",dataIndex:"xx",render:function(t,a){return a.introduced_shops_count>0?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{style:{marginRight:"10px"}},"\u67e5\u770b"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return e.reviewShops(a.introduced_shops)}})):i.a.createElement("span",null,"\u65e0")}},{title:"\u4e2a\u4ebaBV",dataIndex:"personal_bv"},{title:"\u56e2\u961fPV",dataIndex:"personal_pv"},{title:"\u9500\u552e\u8fd4\u4f63",dataIndex:"sales_cashback"},{title:"\u5e02\u573a\u63a8\u5e7f\u670d\u52a1\u8d39",dataIndex:"market_promotion_fee"},{title:"\u603b\u4f63\u91d1",dataIndex:"amount"}],a=[{title:"\u5e97\u94fa\u540d\u79f0/\u5e97\u94fa\u7f16\u53f7",dataIndex:"shop_name",render:function(e,t){return i.a.createElement("span",null,e,"/",t.shop_code)}},{title:"\u4e2a\u4ebaBV",dataIndex:"personal_bv"},{title:"\u56e2\u961fPV",dataIndex:"personal_pv"},{title:"\u9500\u552e\u8fd4\u4f63",dataIndex:"sales_cashback"},{title:"\u5e02\u573a\u63a8\u5e7f\u670d\u52a1\u8d39",dataIndex:"market_promotion_fee"},{title:"\u603b\u4f63\u91d1",dataIndex:"amount"},{title:"\u662f\u5426\u53d1\u653e",dataIndex:"has_add_to_balance",render:function(e,t){return i.a.createElement("span",null,e?"\u662f":"\u5426")}},{title:"\u53d1\u653e\u65f6\u95f4",dataIndex:"add_to_balance_time"},{title:"\u8c03\u6574",dataIndex:"adjust_data",render:function(t,a){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.showAdjustment(a)}},"\u67e5\u770b\u8c03\u6574")}},{title:"\u5907\u6ce8",dataIndex:"remark"}],n=(this.state,"saleCashback"===this.state.type?"\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u6216\u5e97\u94fa\u7f16\u53f7":"\u8bf7\u8f93\u5165\u5e97\u94fa\u7f16\u53f7\u6216\u5e97\u94fa\u4e3b\u59d3\u540d\u6216\u5e97\u94fa\u4e3b\u624b\u673a\u53f7\u7801\u6216\u5e97\u94fa\u540d"),r={visible:this.state.shopVisible,shops:this.state.shops,onClose:this.hideShops},l={visible:this.state.adjustmentVisible,adjustments:this.state.adjustmentRecord,onClose:this.hideAdjustment};return i.a.createElement("div",{className:"cash_back_setting"},i.a.createElement(bm,r),i.a.createElement(ym,l),i.a.createElement(St,{getDatas:this.search,text:n}),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:"saleCashback"===this.state.type?a:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.tableData})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{text:"\u6761\u6570\u636e",api:this.state.api,ref:this.child,id:this.state.id,params:this.state.paginationParams,valChange:this.paginationChange})))}}]),t}(n.Component),km=(a(1497),function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,"ExclusiveProducts")}}]),t}(n.Component)),Sm=(a(616),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).operation=function(){a.props.onChange("TOP_BANNER")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"topBanner",onClick:this.operation},i.a.createElement(me.a,{type:"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u70b9\u51fb\u6dfb\u52a0\u6761\u5e45"))}}]),t}(n.Component)),Om=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).operation=function(){a.props.onChange("IMAGES")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"images",onClick:this.operation},i.a.createElement(me.a,{type:"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u70b9\u51fb\u4e0a\u4f20\u56fe\u7247"))}}]),t}(n.Component),Nm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).operation=function(){a.props.onChange("BANNERS")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"images"},i.a.createElement(me.a,{type:"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u70b9\u51fb\u4e0a\u4f20Banner")))}}]),t}(n.Component),wm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).operation=function(){a.props.onChange("PRODUCTS")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props,"......")}},{key:"render",value:function(){return i.a.createElement(n.Fragment,null,this.props.selectedProducts.length?i.a.createElement("div",{className:"actProductBox",onClick:this.operation},this.props.selectedProducts.map(function(e,t){return i.a.createElement("div",{className:"actProducts",key:t},e.product_entity.name)})):i.a.createElement("div",{className:"images",onClick:this.operation},i.a.createElement(me.a,{type:"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u70b9\u51fb\u9009\u62e9\u5546\u54c1")))}}]),t}(n.Component),xm=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"images"},i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u5361\u5238(\u5361\u5305)")))}}]),t}(n.Component),Im=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"images"},i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u5361\u5238(\u9886\u5238\u4e2d\u5fc3)"))}}]),t}(n.Component),jm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).operation=function(){a.props.onChange("RICH_TEXT")},a.state={details:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.details&&this.setState({details:e.details})}},{key:"render",value:function(){return i.a.createElement(n.Fragment,null,this.state.details?i.a.createElement("div",{onClick:this.operation,dangerouslySetInnerHTML:{__html:this.state.details}}):i.a.createElement("div",{className:"images",onClick:this.operation},i.a.createElement("i",{style:{color:"#4F9863",fontSize:"24px"},className:"iconfont"},"\ue7a0"),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u70b9\u51fb\u7f16\u5199\u5bcc\u6587\u672c")))}}]),t}(n.Component),Tm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).operation=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a.props.onChange("SHARE_BUTTON",e)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return console.log(this.props.image),i.a.createElement(n.Fragment,null,this.props.image?i.a.createElement("img",{onClick:function(){return e.operation(!1)},style:{width:"500px",height:"auto"},src:this.props.image,alt:""}):i.a.createElement("div",{className:"images",onClick:function(){return e.operation(!0)}},i.a.createElement(me.a,{type:"plus",style:{fontSize:"24px",color:"#999"}}),i.a.createElement("div",{className:"ant-upload-text",style:{fontSize:"12px"}},"\u70b9\u51fb\u6dfb\u52a0\u5206\u4eab\u64cd\u4f5c")))}}]),t}(n.Component),Rm=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,"NewUserOnly")}}]),t}(n.Component),Am=[{type:"TOP_BANNER",operation:"upload_image"},{type:"IMAGES",operation:"upload_image"},{type:"BANNERS",operation:"upload_many"},{type:"PRODUCTS",operation:"select_products"},{type:"RICH_TEXT",operation:"edit_rich_text"},{type:"SHARE_BUTTON",operation:"upload_image"}],Dm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e=a.editor.current?a.editor.current.state.outputHTML:a.state.detail;a.props.onSubmit(e),a.handleCancel()},a.state={detail:{}},a.editor=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7f16\u8f91\u5bcc\u6587\u672c",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(jr,{ref:this.editor,default:this.state.detail})))}}]),t}(n.Component),Pm=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(o.a)(this,Object(u.a)(t).call(this))).onProductChange=function(t){e.setState({selectedItem:t});var a=[];y.a.map(t,function(t){y.a.map(e.state.products,function(e){t==e.id&&a.push(e)})}),e.setState({selectedProducts:a})},e.selectModules=function(e){B.a.info("\u8be5\u529f\u80fd\u6682\u672a\u5f00\u653e\uff0c\u656c\u8bf7\u671f\u5f85")},e.editModule=function(t){var a;y.a.map(Am,function(e){t===e.type&&(a=e.operation)}),e.setState({operationType:a,type:t})},e.renderModules=function(t){var a=e.state,n=a.image,r=a.selectedProducts,l=a.richText,s={onChange:e.editModule,image:n,selectedProducts:r,details:l};switch(t){case"EXCLUSIVE_PRODUCTS":return i.a.createElement(km,s);case"TOP_BANNER":return i.a.createElement(Sm,s);case"IMAGES":return i.a.createElement(Om,s);case"BANNERS":return i.a.createElement(Nm,s);case"PRODUCTS":return i.a.createElement(wm,s);case"COUPON_CARD_PACKAGE":return i.a.createElement(xm,s);case"COUPON_RECEIVE_CENTER":return i.a.createElement(Im,s);case"RICH_TEXT":return i.a.createElement(jm,s);case"SHARE_BUTTON":return i.a.createElement(Tm,s);case"NEW_USER_ONLY":return i.a.createElement(Rm,s);default:return""}},e.back=function(){e.props.history.push({pathname:"/activities/all"})},e.successUpload=function(t,a){var n=e.state.templates;y.a.map(n,function(e){e.name===a&&(e.data=t)}),console.log(a);var i={};i.name=a,i.data=t,e.setState({templates:n,image:t})},e.save=function(){var t=e.state.templates;console.log(t,"123456"),y.a.map(t,function(t){"PRODUCTS"===t.name&&(t.data=e.state.selectedItem)}),console.log(t,"xxxxxxx"),e.setState({templates:t},function(){var a,n;(a={template:t},n=e.state.id,ne({url:"/api/backend/activities/".concat(n,"/set_page_template"),method:"put",data:a})).then(function(t){B.a.success(t.message),e.back()}).catch(function(e){})})},e.showRichText=function(){e.setState({richTextVisible:!0})},e.closeRichText=function(){e.setState({richTextVisible:!1})},e.saveRichText=function(t){e.setState({richText:t});var a=e.state.templates;y.a.map(a,function(e){"RICH_TEXT"===e.name&&(e.data=t)})},e.state={modules:["SHARE_BUTTON","RICH_TEXT","PRODUCTS"],operationType:"",products:[],image:"",id:"",type:"",richText:"",selectedItem:[],selectedProducts:[],richTextVisible:!1,templates:[{name:"SHARE_BUTTON"},{name:"RICH_TEXT"},{name:"PRODUCTS"}]},e.image=i.a.createRef(),e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.state.template.length&&this.props.location.state.template||this.state.templates;console.log(t),this.props.location.state.template.length&&y.a.map(t,function(t){console.log(t,"=="),"SHARE_BUTTON"===t.name?e.setState({image:t.data}):"PRODUCTS"===t.name?e.setState({selectedItem:t.data}):"RICH_TEXT"===t.name&&e.setState({richText:t.data})}),this.setState({id:this.props.location.state.actId,templates:t},function(){fu({page:1,limit:100},e.state.id).then(function(t){e.setState({products:t.data},function(){var a=[];y.a.map(e.state.selectedItem,function(e){y.a.map(t.data,function(t){e==t.id&&a.push(t)})}),e.setState({selectedProducts:a})})}).catch(function(e){})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.modules,n=(t.image,t.products),r={visible:this.state.richTextVisible,onClose:this.closeRichText,onSubmit:this.saveRichText};return i.a.createElement("div",null,i.a.createElement(Dm,r),i.a.createElement("div",{style:{paddingBottom:"16px",marginBottom:"16px",display:"flex",justifyContent:"space-between",borderBottom:"1px solid #e9e9e9"}},i.a.createElement(_e.a,{size:"small",onClick:this.save},"\u4fdd\u5b58"),i.a.createElement(_e.a,{size:"small",onClick:this.back},"\u8fd4\u56de\u6d3b\u52a8\u7ba1\u7406")),i.a.createElement("div",{className:"activityPage"},i.a.createElement("ul",{className:"modules"},i.a.createElement("li",null,i.a.createElement("h3",null,"\u81ea\u6709\u6a21\u5757"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("EXCLUSIVE_PRODUCTS")}},"\u4e13\u5c5e\u5546\u54c1")),i.a.createElement("li",null,i.a.createElement("h3",null,"\u516c\u5171\u6a21\u5757"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("TOP_BANNER")}},"\u6761\u5e45"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("IMAGES")}},"\u56fe\u7247"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("BANNERS")}},"banner"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("PRODUCTS")}},"\u5546\u54c1"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("COUPON_CARD_PACKAGE")}},"\u5361\u5238(\u5361\u5305)"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("COUPON_RECEIVE_CENTER")}},"\u5361\u5238(\u9886\u5238\u4e2d\u5fc3)"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("RICH_TEXT")}},"\u5bcc\u6587\u672c"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("SHARE_BUTTON")}},"\u5206\u4eab\u6309\u94ae")),i.a.createElement("li",null,i.a.createElement("h3",null,"\u6d3b\u52a8\u6a21\u5757"),i.a.createElement(_e.a,{type:"small",onClick:function(){return e.selectModules("NEW_USER_ONLY")}},"\u65b0\u4eba\u4e13\u4eab"))),i.a.createElement("div",{className:"views"},a.length?a.map(function(t){return e.renderModules(t)}):"\u8bf7\u5148\u9009\u62e9\u6a21\u677f"),i.a.createElement("div",{className:"operation"},"upload_image"===this.state.operationType&&i.a.createElement(ta,{conponentType:this.state.type,type:"activity",success:this.successUpload,ref:this.image}),"upload_many"===this.state.operationType&&i.a.createElement(Gr,null),"select_products"===this.state.operationType&&i.a.createElement(Q.a,{mode:"tags",defaultActiveFirstOption:!1,value:this.state.selectedItem,className:"selectedBox",onChange:this.onProductChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",value:e.id+"",label:e.product_entity.name},e.product_entity.name)})),",","edit_rich_text"===this.state.operationType&&i.a.createElement(_e.a,{size:"small",onClick:this.showRichText},"\u70b9\u51fb\u7f16\u8f91\u5bcc\u6587\u672c"))))}}]),t}(n.Component),Vm=(a(1498),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){a.props.onSubmit(),vu({user_limit_day:a.state.days,user_limit_num:a.state.num},a.props.id,a.props.record.id).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}).catch(function(e){})},a.onChange=function(e,t){a.setState(Object(Y.a)({},t,e.target.value))},a.state={days:0,num:0},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.record.id&&this.setState({days:e.record.user_limit_day,num:e.record.user_limit_num})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u7f16\u8f91\u5546\u54c1",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.handleSubmit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"productEdit"},i.a.createElement(Ne.a,{type:"number",value:this.state.days,onChange:function(t){return e.onChange(t,"days")}}),"\u5929\u9650\u8d2d ",i.a.createElement(Ne.a,{onChange:function(t){return e.onChange(t,"num")},value:this.state.num,type:"number"}),"\u4ef6")))}}]),t}(n.Component)),Lm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getDetails=function(){Eu({},a.state.id).then(function(e){a.setState({details:e.data})}).then(function(e){})},a.paginationChange=function(e){console.log(e),a.setState({data:e})},a.refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.showEditProduct=function(e){a.setState({editProductVisible:!0,record:e})},a.hideEditProduct=function(){a.setState({editProductVisible:!1})},a.submitEditProduct=function(e){console.log(e,"???????????????????")},a.back=function(){a.props.history.push({pathname:"/activities/all"})},a.jumpProduct=function(){a.props.history.push({pathname:"/activities/onShelvesProducts",state:{id:a.state.id,name:a.state.name}})},a.offShelves=function(e){console.log(e);var t=a.state.id,n=a.refresh,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u4e0b\u67b6\u8be5\u5546\u54c1\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,i;(a={entity_ids:[e.product_entity.id]},i=t,ne({url:"/api/backend/activities/".concat(i,"/products/get_off_shelves"),method:"post",data:a})).then(function(e){B.a.success(e.message),n()}).catch(function(e){})},onCancel:function(){}})},a.state={api:fu,id:"",data:[],shelfGoodsVisible:!1,editProductVisible:!1,record:{},details:{}},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({id:this.props.location.state.actId,name:this.props.location.state.name},function(){e.getDetails()})}},{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1",dataIndex:"name",align:"center",render:function(e,t){return t.product_entity.spec_value?i.a.createElement("span",null,t.product_entity.name," - ",t.product_entity.spec_value[Object.keys(t.product_entity.spec_value)[0]]):i.a.createElement("span",null,t.product_entity.name)}},{title:"\u4e0a\u67b6\u65f6\u95f4",dataIndex:"created_at",align:"center"},{title:"\u4fc3\u9500\u4ef7",dataIndex:"act_price",align:"center"},{title:"\u6bcf\u5929\u9650\u8d2d",dataIndex:"user_limit_day",align:"center",render:function(t,a){return e.state.details.user_limit_num&&e.state.details.user_limit_day?i.a.createElement("span",null,"\u8be5\u6d3b\u52a8\u4e0b\u6240\u6709\u5546\u54c1",t,"\u5929\u9650\u8d2d",a.user_limit_num,"\u4ef6"):0===t?"\u65e0":i.a.createElement("span",null,"\u6bcf\u4f4d\u7528\u6237",t,"\u5929\u9650\u8d2d",a.user_limit_num,"\u4ef6")}},{title:"\u6d3b\u52a8\u6570\u91cf\u9650\u5236",dataIndex:"has_sell_limit",align:"center",render:function(t,a){return t?i.a.createElement(ma.a,{className:"virtualSales",defaultValue:a.last_num,onBlur:function(t){t.target.value=t.target.value<0?0:t.target.value,vu({last_num:Number(t.target.value)},e.state.id,a.id).then(function(e){B.a.success(e.message)}).catch(function(e){})}}):"\u65e0"}},{title:"\u64cd\u4f5c",align:"center",render:function(t,a){return i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:function(){return e.offShelves(a)}},"\u4e0b\u67b6"),i.a.createElement(_e.a,{size:"small",onClick:function(){return e.showEditProduct(a)},disabled:e.state.details.user_limit_num&&e.state.details.user_limit_day},"\u7f16\u8f91"))}}];return i.a.createElement("div",{className:"activityProductsManage"},i.a.createElement(Vm,{visible:this.state.editProductVisible,onClose:this.hideEditProduct,onSubmit:this.submitEditProduct,record:this.state.record,id:this.state.id,refresh:this.refresh}),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},i.a.createElement(_e.a,{size:"small",onClick:this.jumpProduct},"\u4e0a\u67b6\u5546\u54c1"),i.a.createElement(_e.a,{size:"small",onClick:this.back},"\u8fd4\u56de\u6d3b\u52a8\u7ba1\u7406")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,id:this.state.id,valChange:this.paginationChange,text:"\u4e2a\u5546\u54c1"})))}}]),t}(n.Component),Mm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:""},a.handleCancel=function(){a.props.onClose()},a.submit=function(){a.state.name?a.props.onSubmit(a.state.name):B.a.error("\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0")},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u521b\u5efa\u86cb\u7cd5\u5206\u7c7b",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.submit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u5206\u7c7b\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})))))}}]),t}(n.Component),Um=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.submit=function(){a.props.onSubmit(a.state.products)},a.getProducts=function(e){It({limit:100,page:1,channel:"ACTIVITY",activity_id:a.state.actId}).then(function(e){a.setState({products:e.data})})},a.handleChange=function(e){a.setState({selectedProduct:e})},a.state={products:[],actId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;console.log(e),e.actId&&this.setState({actId:e.actId},function(){a.getProducts()})}},{key:"render",value:function(){var e=this.state.selectedProduct;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u6dfb\u52a0\u5546\u54c1",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,onOk:this.submit,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",null,i.a.createElement("span",null,"\u9009\u62e9\u5546\u54c1"),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"tags",value:e,onChange:this.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_id+"",label:e.name,value:e.product_id+""},e.name)}))))))}}]),t}(n.Component),Fm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e,t;(e={},t=a.state.actId,ne({url:"/api/backend/activities/".concat(t,"/categories/all"),method:"get",params:e})).then(function(e){a.setState({data:e.data})}).catch(function(e){})},a.delete=function(e){var t=a.refresh,n=a.state.actId,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u5220\u9664\u8be5\u5206\u7c7b\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,i,r,l=[];l.push(e.id),(a={},i=n,r=l,ne({url:"/api/backend/activities/".concat(i,"/categories/delete?category_ids[]=").concat(r),method:"delete",params:a})).then(function(e){B.a.success(e.message),t()}).catch(function(e){})},onCancel:function(){}})},a.createNewCate=function(){a.setState({createCateVisible:!0})},a.hideNewCate=function(){a.setState({createCateVisible:!1})},a.submitNewCate=function(e){var t,n;(t={name:e,sort:1},n=a.state.actId,ne({url:"/api/backend/activities/".concat(n,"/categories"),method:"post",data:t})).then(function(e){a.hideNewCate(),a.refresh()}).catch(function(e){})},a.add=function(e){a.setState({addCateVisible:!0,cateId:e.id})},a.hideCates=function(){a.setState({addCateVisible:!1})},a.submitCates=function(e){},a.state={columns:[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement("div",null,i.a.createElement("span",{onClick:function(){return a.delete(t)},style:{color:"#4f9863",cursor:"pointer",marginRight:"10px"}},"\u5220\u9664"))}}],data:[],createCateVisible:!1,addCateVisible:!1,cateId:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props),this.setState({actId:this.props.location.state.actId},function(){e.refresh()})}},{key:"render",value:function(){var e=this,t={visible:this.state.createCateVisible,onClose:this.hideNewCate,onSubmit:this.submitNewCate},a={visible:this.state.addCateVisible,onClose:this.hideCates,onSubmit:this.submitCates,cateId:this.state.cateId,actId:this.state.actId};return i.a.createElement("div",null,i.a.createElement(Mm,t),i.a.createElement(Um,a),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},i.a.createElement(_e.a,{size:"small",onClick:this.createNewCate},"\u65b0\u589e\u5206\u7c7b"),i.a.createElement(_e.a,{size:"small",onClick:function(){e.props.history.go(-1)}},"\u8fd4\u56de\u5546\u54c1\u7ba1\u7406")),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.state.columns,rowKey:function(e){return e.product_id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})))}}]),t}(n.Component),Gm=function(e){var t=e.leftColumns,a=e.rightColumns,n=Object(ga.a)(e,["leftColumns","rightColumns"]);return i.a.createElement(Ot.a,n,function(e){var n=e.direction,r=e.filteredItems,l=e.onItemSelectAll,s=e.onItemSelect,c=e.selectedKeys,o=e.disabled,u=(e.locale,e.titles,"left"===n?t:a),m="left"===n,d={onSelectAll:function(e,t){var a=t.filter(function(e){return!e.disabled}).map(function(e){return e.id}),n=e?ya()(a,c):ya()(c,a);l(n,e)},onSelect:function(e,t){s(e.id,t)},selectedRowKeys:c};return"left"===n?i.a.createElement("div",null,i.a.createElement(ve.a,{rowSelection:d,rowKey:function(e){return e.id},columns:u,showHeader:m,dataSource:r,size:"small",pagination:!1,onRow:function(e){var t=e.key;e.disabled;return{onClick:function(){s(t,!c.includes(t))}}}})):i.a.createElement(ve.a,{rowSelection:d,columns:u,rowKey:function(e){return e.id},showHeader:m,dataSource:r,size:"small",pagination:!1,style:{pointerEvents:o?"none":null},onRow:function(e){var t=e.key,a=e.disabled;return{onClick:function(){a||o||s(t,!c.includes(t))}}}})})},Bm=[],zm=0;zm<20;zm++)Bm.push({key:zm.toString(),title:"content".concat(zm+1)});var Hm=[{dataIndex:"name",title:"\u5546\u54c1\u540d\u79f0",render:function(e,t){return t.product_entity.spec_value?i.a.createElement("span",null,t.product_entity.name," - ",t.product_entity.spec_value[Object.keys(t.product_entity.spec_value)[0]]):i.a.createElement("span",null,t.product_entity.name)}}],Km=[{dataIndex:"name",title:"\u5546\u54c1\u540d\u79f0",render:function(e,t){return t.product_entity.spec_value?i.a.createElement("span",null,t.product_entity.name," - ",t.product_entity.spec_value[Object.keys(t.product_entity.spec_value)[0]]):i.a.createElement("span",null,t.product_entity.name)}}],Jm=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={targetKeys:[],data:[]},a.onChange=function(e){a.setState({targetKeys:e})},a.handleCancel=function(){a.props.onCancel()},a.handleSubmit=function(){if(a.state.targetKeys.length){var e=[];y.a.map(a.state.data,function(t){y.a.map(a.state.targetKeys,function(a){a===t.id&&e.push(t)})}),a.props.onSubmit(e)}else B.a.error("\u8bf7\u9009\u62e9\u4e0a\u67b6\u5546\u54c1")},a.handleTabs=function(){return["\u914d\u9001\u6279\u6b21","\u4fdd\u5b58\u65b9\u5f0f","\u5546\u54c1\u5c5e\u6027","\u5546\u54c1\u5206\u7c7b"].map(function(e,t){return i.a.createElement("span",{className:"headerTabs",key:t},e)})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var a=this;e.id&&hu({limit:100,page:1},e.id).then(function(e){a.setState({data:e.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this.state.targetKeys;return i.a.createElement("div",{className:"shelfGoods"},i.a.createElement(ge.a,{title:"\u4e0a\u67b6\u5546\u54c1",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleSubmit},i.a.createElement(Gm,{dataSource:this.state.data,targetKeys:e,showSearch:!0,rowKey:function(e){return e.id},onChange:this.onChange,locale:{itemUnit:"\u9879",itemsUnit:"\u9879",notFoundContent:"\u5217\u8868\u4e3a\u7a7a",searchPlaceholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"},leftColumns:Hm,rightColumns:Km,titles:["\u53ef\u9009\u5546\u54c1","\u5df2\u9009\u5546\u54c1"],filterOption:function(e,t){return-1!==t.product_entity.name.indexOf(e)}})))}}]),t}(i.a.Component),Wm=(a(1499),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).showShelfGoods=function(){a.setState({shelfGoodsVisible:!0})},a.hideShelfGoods=function(){a.setState({shelfGoodsVisible:!1})},a.onSubmitShelfGoods=function(e){var t=e,n=a.state.details;y.a.map(t,function(e){e.act_price=n.act_price,e.buy_max_num=n.buy_max_num,e.discount=n.discount,e.has_sell_limit=!1,e.sell_limit=0,e.user_limit_day=0,e.user_limit_num=n.buy_max_num}),a.setState({data:e},function(){a.hideShelfGoods()})},a.getDetails=function(){Eu({},a.state.id).then(function(e){a.setState({details:e.data})}).then(function(e){})},a.inputChange=function(e,t,n){var i=e.target.value,r=a.state.data;y.a.map(r,function(e){n.id===e.id&&(e[t]=i)}),a.setState({data:r})},a.switchChange=function(e,t,n){var i=a.state.data;y.a.map(i,function(a){n.id===a.id&&(a[t]=e)}),a.setState({data:i})},a.save=function(){var e,t,n=a.state.data,i=[];y.a.map(n,function(e){var t={};t.entity_id=e.product_entity_id,t.configurations={},t.configurations.act_price="NONE"===a.state.details.type?Number(e.act_price):Number(e.product_entity.retail_price),t.configurations.tags=[],t.configurations.tags[0]=a.state.name,t.configurations.buy_max_num=Number(e.buy_max_num),t.configurations.discount="DISCOUNT"===a.state.details.type?Number(e.discount):100,t.configurations.has_sell_limit=e.has_sell_limit,t.configurations.sell_limit=Number(e.sell_limit),t.configurations.user_limit_day=Number(e.user_limit_day),t.configurations.user_limit_num=Number(e.user_limit_num),i.push(t)}),console.log(i),(e={product_params:i},t=a.state.id,ne({url:"/api/backend/activities/".concat(t,"/products/put_on_shelves"),method:"post",data:e})).then(function(e){B.a.success(e.message),a.back()}).catch(function(e){})},a.back=function(){a.props.history.push({pathname:"/activities/activityProductsManage",state:{actId:a.state.id}})},a.state={id:"",data:[],details:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({id:this.props.location.state.id,name:this.props.location.state.name},function(){e.getDetails()})}},{key:"render",value:function(){var e=this,t=[{title:"\u5546\u54c1",dataIndex:"name",align:"center",render:function(e,t){return t.product_entity.spec_value?i.a.createElement("span",null,t.product_entity.name," - ",t.product_entity.spec_value[Object.keys(t.product_entity.spec_value)[0]]):i.a.createElement("span",null,t.product_entity.name)}},{title:"\u5e02\u573a\u4ef7",dataIndex:"market_price",align:"center",render:function(e,t){return i.a.createElement("span",null,t.product_entity.market_price)}},{title:"\u96f6\u552e\u4ef7",dataIndex:"retail_price",align:"center",render:function(e,t){return i.a.createElement("span",null,t.product_entity.retail_price)}},{title:"\u4fc3\u9500\u4ef7",dataIndex:"act_price",align:"center",render:function(t,a){return"NONE"!==e.state.details.type?i.a.createElement("span",null,a.product_entity.retail_price):i.a.createElement(Ne.a,{type:"number",style:{width:"80px"},value:t,onChange:function(t){return e.inputChange(t,"act_price",a)}})}},{title:"\u53c2\u4e0e\u6d3b\u52a8\u6700\u5927\u4f18\u60e0\u6570\u91cf",dataIndex:"buy_max_num",align:"center",render:function(t,a){return i.a.createElement(Ne.a,{type:"number",style:{width:"80px"},value:t,onChange:function(t){return e.inputChange(t,"buy_max_num",a)}})}},{title:"\u6298\u6263(0-100\u767e\u5206\u5236)",dataIndex:"discount",align:"center",render:function(t,a){return"DISCOUNT"===e.state.details.type?i.a.createElement(Ne.a,{type:"number",style:{width:"80px"},value:t,onChange:function(t){return e.inputChange(t,"discount",a)}}):i.a.createElement("span",null,"100")}},{title:"\u662f\u5426\u6709\u6d3b\u52a8\u6570\u91cf\u9650\u5236",dataIndex:"has_sell_limit",align:"center",render:function(t,a){return i.a.createElement(ke.a,{checked:t,onChange:function(t){return e.switchChange(t,"has_sell_limit",a)}})}},{title:"\u53c2\u4e0e\u6d3b\u52a8\u5546\u54c1\u6570\u91cf",dataIndex:"sell_limit",align:"center",render:function(t,a){return a.has_sell_limit?i.a.createElement(Ne.a,{type:"number",style:{width:"80px"},value:t,onChange:function(t){return e.inputChange(t,"sell_limit",a)}}):i.a.createElement("span",null,"\u6682\u65e0")}},{title:"\u9650\u8d2d\u5468\u671f(\u5929)",dataIndex:"user_limit_day",align:"center",render:function(t,a){return i.a.createElement(Ne.a,{disabled:e.state.details.user_limit_day,type:"number",style:{width:"80px"},value:t,onChange:function(t){return e.inputChange(t,"user_limit_day",a)}})}},{title:"\u7528\u6237\u9650\u8d2d\u6570\u91cf",dataIndex:"user_limit_num",align:"center",render:function(t,a){return i.a.createElement(Ne.a,{disabled:e.state.details.user_limit_num,type:"number",style:{width:"80px"},value:t,onChange:function(t){return e.inputChange(t,"user_limit_num",a)}})}}];return i.a.createElement("div",null,i.a.createElement(Jm,{visible:this.state.shelfGoodsVisible,onCancel:this.hideShelfGoods,onSubmit:this.onSubmitShelfGoods,id:this.state.id}),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},i.a.createElement(_e.a,{size:"small",onClick:this.showShelfGoods},"\u9009\u62e9\u5546\u54c1"),i.a.createElement(_e.a,{size:"small",onClick:this.back},"\u8fd4\u56de\u5546\u54c1\u7ba1\u7406")),i.a.createElement("div",{className:"chart u_chart shelfProducts"},i.a.createElement(ve.a,{columns:t,rowKey:function(e){return e.id},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",margin:"20px 0"}},i.a.createElement(_e.a,{onClick:this.save,size:"small",type:"primary",disabled:!this.state.data.length},"\u4fdd\u5b58\u8bbe\u7f6e")))}}]),t}(n.Component)),Ym=(a(1500),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={data:[]},a.valueChange=function(e,t){"MERCHANT_ORDER_PAID_TIME_THRESHOLD_HOUR"===e&&t>24||"MERCHANT_ORDER_PAID_TIME_THRESHOLD_MINUTE"===e&&t>59||(t="MERCHANT_ORDER_PAID_TIME_THRESHOLD_HOUR"===e||"MERCHANT_ORDER_PAID_TIME_THRESHOLD_MINUTE"===e?parseInt(t):parseFloat(t),a.setState(Object(Y.a)({},e,t)))},a.valueTextChange=function(e,t){a.setState(Object(Y.a)({},e,t))},a.submitSetting=function(e){Ie({type:"MERCHANT_ORDER",key:e,value:a.state[e]}).then(function(e){B.a.success(e.message)})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;je({searchJson:w({type:"MERCHANT_ORDER"})}).then(function(t){t.data.forEach(function(t){e.setState(Object(Y.a)({},t.key,t.value))}),e.setState({data:t.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state;return i.a.createElement("div",{className:"order_setting"},i.a.createElement("div",{className:"setting_header"},"\u622a\u5355\u65f6\u95f4"),i.a.createElement("div",{className:"setting_body"},t.data.length&&i.a.createElement("div",{className:"setting_item"},i.a.createElement("span",{className:"cancelSpan"},"\u6bcf\u5929  ",i.a.createElement(Ne.a,{type:"number",value:t.MERCHANT_ORDER_PAID_TIME_THRESHOLD_HOUR,onChange:function(t){return e.valueChange("MERCHANT_ORDER_PAID_TIME_THRESHOLD_HOUR",t.target.value)},onBlur:function(){return e.submitSetting("MERCHANT_ORDER_PAID_TIME_THRESHOLD_HOUR")}})," \u65f6 ",i.a.createElement(Ne.a,{type:"number",value:t.MERCHANT_ORDER_PAID_TIME_THRESHOLD_MINUTE,onChange:function(t){return e.valueChange("MERCHANT_ORDER_PAID_TIME_THRESHOLD_MINUTE",t.target.value)},onBlur:function(){return e.submitSetting("MERCHANT_ORDER_PAID_TIME_THRESHOLD_MINUTE")}})," \u5206\u4e4b\u524d"))),i.a.createElement("div",{className:"setting_header"},"\u8d77\u8ba2\u91d1\u989d\u8bbe\u7f6e"),i.a.createElement("div",{className:"setting_body"},i.a.createElement("div",{className:"setting_item"},"\u6ee1 ",i.a.createElement(Ne.a,{type:"number",value:t.MERCHANT_ORDER_PAID_THRESHOLD,onChange:function(t){return e.valueChange("MERCHANT_ORDER_PAID_THRESHOLD",t.target.value)},onBlur:function(){return e.submitSetting("MERCHANT_ORDER_PAID_THRESHOLD")}})," \u5143\u8d77\u9001")),i.a.createElement("div",{className:"setting_header"},"\u914d\u9001\u65f6\u95f4\u8bbe\u7f6e"),i.a.createElement("div",{className:"setting_body"},i.a.createElement("div",{className:"setting_item"},"\u6e29\u99a8\u63d0\u793a: ",i.a.createElement(Ne.a,{value:t.MERCHANT_ORDER_DELIVERY_TIME_DESC,onChange:function(t){return e.valueTextChange("MERCHANT_ORDER_DELIVERY_TIME_DESC",t.target.value)},onBlur:function(){return e.submitSetting("MERCHANT_ORDER_DELIVERY_TIME_DESC")}}))))}}]),t}(n.Component)),qm=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u6d3b\u52a8\u5f00\u59cb\u65f6\u95f4",value:"start_date",type:"detailTimeCompare"},{label:"\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4",value:"end_date",type:"detailTimeCompare"},{label:"\u6210\u56e2\u9650\u5236",value:"has_group_limit",type:"isTrue"},{label:"\u6210\u56e2\u91d1\u989d\u9650\u5236",value:"group_orders_total_fee_floor",type:"numCompare"},{label:"\u6210\u56e2\u8ba2\u5355\u6570\u9650\u5236",value:"group_orders_count_floor",type:"numCompare"},{label:"\u622a\u5355\u5468\u671f",value:"orderable_deadline_type",type:"deadlineType"},{label:"\u914d\u9001\u5468\u671f",value:"delivery_type",type:"deliveryType"},{label:"\u662f\u5426\u6253\u6298",value:"has_discount",type:"isTrue"},{label:"\u6253\u6298\u5e45\u5ea6",value:"discount",type:"numCompare"},{label:"\u662f\u5426\u6709\u8d60\u54c1",value:"has_gift",type:"isTrue"},{label:"\u8d77\u8d60\u91d1\u989d",value:"gift_floor",type:"numCompare"},{label:"\u62fc\u56e2\u72b6\u6001",value:"state",type:"grouponStatus"},{label:"\u5f00\u56e2\u6b21\u6570",value:"shop_shopping_groups_count",type:"numCompare"},{label:"\u5f00\u56e2\u5e97\u94fa\u6570",value:"shop_shopping_group_shops_count",type:"numCompare"},{label:"\u6210\u56e2\u6570",value:"shop_shopping_group_formed_count",type:"numCompare"},{label:"\u4e0b\u5355\u4eba\u6570",value:"order_placed_users_count",type:"numCompare"},{label:"\u4e0b\u5355\u6570",value:"order_placed_count",type:"numCompare"},{label:"\u70b9\u51fb\u6b21\u6570",value:"click_count",type:"numCompare"},{label:"\u6210\u56e2\u8ba2\u5355\u6570",value:"formed_orders_count",type:"numCompare"}]}],Xm={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],dataCompare:[{label:"\u7b49\u4e8e",value:"=",type:"times"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"times"},{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"dateRange"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],isTrue:[{label:"\u662f\u5426",value:"=",type:"boolean"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],deadlineType:[{label:"\u7b49\u4e8e",value:"=",type:"deadlineType"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"deadlineType"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"deadlineType"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTime"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"deliveryTime"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"deliveryTime"}],grouponStatus:[{label:"\u7b49\u4e8e",value:"=",type:"grouponStatus"}],detailTimeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"detailTime"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"detailTime"},{label:"\u665a\u4e8e",value:">",type:"detailTime"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"detailTime"},{label:"\u65e9\u4e8e",value:"<",type:"detailTime"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"detailTime"},{label:"\u533a\u95f4",value:"between",type:"periodDetailTime"}],timeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"timestamp"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"timestamp"},{label:"\u665a\u4e8e",value:">",type:"timestamp"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"timestamp"},{label:"\u65e9\u4e8e",value:"<",type:"timestamp"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"timestamp"},{label:"\u533a\u95f4",value:"between",type:"period"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},$m=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u62fc\u56e2\u540d\u79f0",value:"display_name"},{label:"\u6d3b\u52a8\u5f00\u59cb\u65f6\u95f4",value:"start_date"},{label:"\u6d3b\u52a8\u7ed3\u675f\u65f6\u95f4",value:"end_date"},{label:"\u53c2\u4e0e\u5546\u54c1",value:"group_products"},{label:"\u6210\u56e2\u9650\u5236",value:"group_limit_desc"},{label:"\u6210\u56e2\u91d1\u989d\u9650\u5236",value:"group_orders_total_fee_floor"},{label:"\u6210\u56e2\u8ba2\u5355\u6570\u9650\u5236",value:"group_orders_count_floor"},{label:"\u622a\u5355\u5468\u671f",value:"order_deadline_desc"},{label:"\u914d\u9001\u5468\u671f",value:"delivery_specified_type_desc",type:"deliveryType"},{label:"\u662f\u5426\u6253\u6298",value:"discount_desc"},{label:"\u6253\u6298\u5e45\u5ea6",value:"discount"},{label:"\u662f\u5426\u6709\u8d60\u54c1",value:"group_red_packet_levels_desc"},{label:"\u8d77\u8d60\u91d1\u989d",value:"gift_floor"},{label:"\u62fc\u56e2\u72b6\u6001",value:"state_desc"},{label:"\u5f00\u56e2\u6b21\u6570",value:"shop_shopping_groups_count"},{label:"\u5f00\u56e2\u5e97\u94fa\u6570",value:"shop_shopping_group_shops_count"},{label:"\u6210\u56e2\u6570",value:"shop_shopping_group_formed_count"},{label:"\u4e0b\u5355\u4eba\u6570",value:"order_placed_users_count"},{label:"\u4e0b\u5355\u6570",value:"order_placed_count"},{label:"\u70b9\u51fb\u6b21\u6570",value:"click_count"},{label:"\u6210\u56e2\u8ba2\u5355\u6570",value:"formed_orders_count"}]}],Qm=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onCancel()},a.onSubmit=function(){a.props.onSubmit(a.child.current.state.data),a.handleCancel()},a.clearFilter=function(){a.child.current.clearFilter()},a.export=function(){a.props.export(a.child.current.state.data)},a.print=function(){a.props.print(a.child.current.state.data)},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u9ad8\u7ea7\u7b5b\u9009",width:1e3,visible:this.props.visible,onCancel:this.handleCancel,onClose:this.closeAdd,className:"f_com",maskClosable:!1,footer:i.a.createElement("div",null,"shopping_group_order"===this.props.slug&&i.a.createElement(_e.a,{size:"small",type:"default",className:"e_btn",onClick:this.export},"\u5bfc\u51fa"),i.a.createElement(_e.a,{size:"small",className:"e_btn",onClick:this.clearFilter},"\u6e05\u7a7a\u7b5b\u9009\u6761\u4ef6"),i.a.createElement(_e.a,{size:"small",onClick:this.onSubmit,type:"primary"},"\u786e\u8ba4"))},i.a.createElement(ft,{ref:this.child,value:this.props.data,operation:this.props.operation,slug:this.props.slug})))}}]),t}(i.a.Component);function Zm(e){var t="";return"FIXED_TERM"===e.order_deadline_type?0===e.order_deadline_args.fixed_term?t="\u5f53\u65e5 ".concat(e.order_deadline_args.time):1===e.order_deadline_args.fixed_term&&(t="\u6b21\u65e5 ".concat(e.order_deadline_args.time)):"BEFORE_FIXED_DATE"===e.order_deadline_type?t="".concat(e.order_deadline_args.fixed_date,"\u524d ").concat(e.order_deadline_args.time):"FIXED_DATE"===e.order_deadline_type&&(t="".concat(e.order_deadline_args.fixed_date,"\u65e5 ").concat(e.order_deadline_args.time)),t}function ed(e){var t="";return"FIXED_TERM"===e.delivery_type?1===e.delivery_args.fixed_term?t="\u6b21\u65e5 ".concat(e.delivery_args.time_period_start," - ").concat(e.delivery_args.time_period_end," "):2===e.delivery_args.fixed_term?t="\u9694\u65e5 ".concat(e.delivery_args.time_period_start," - ").concat(e.delivery_args.time_period_end):0===e.delivery_args.fixed_term&&(t="\u5f53\u65e5 ".concat(e.delivery_args.time_period_start," - ").concat(e.delivery_args.time_period_end)):"FIXED_DATE"===e.delivery_type&&(t="".concat(e.delivery_args.fixed_date,"\u65e5 ").concat(e.delivery_args.time_period_start," - ").concat(e.delivery_args.time_period_end)),t}function td(e){return 100===e.discount?"\u65e0":"".concat(e.discount/10,"\u6298")}function ad(e){var t="";if(e.has_group_red_packet){var a=e.group_red_packet_levels;y.a.map(a,function(e){t+="\u6ee1".concat(e.gift_amount,"\u5143\uff0c\u8d60\u9001").concat(e.minimum_total_fee,"\u5143\n")})}else t="\u65e0\u7ea2\u5305";return t}function nd(e){var t="";return e.has_gift?(y.a.map(e.gift_products,function(e){t+="".concat(e.product_entity_info.name," * 1\u3001")}),t=(t="\u6ee1".concat(e.gift_floor,"\u5143\u8d60\u9001")+t).substring(0,t.length-1)):t="\u65e0\u8d60\u54c1",t}a(1501);var id=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleProducts=function(e){var t="";return y.a.map(e,function(e){t+="".concat(e.name,"\u3001")}),t=t.substring(0,t.length-1)},a.state={details:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.data.id&&this.setState({details:e.data})}},{key:"render",value:function(){var e=this.state.details;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u62fc\u56e2\u8be6\u60c5",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:null},i.a.createElement("ul",{className:"mainUl couponDetail"},i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u540d\u79f0:"),i.a.createElement("span",{className:"limit"},e.name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5c55\u793a\u540d\u79f0\uff08\u56e2\u8d2d\u4e3b\u9898\uff09:"),i.a.createElement("span",{className:"limit"},e.display_name)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6d3b\u52a8\u65f6\u95f4:"),i.a.createElement("span",{className:"limit"},e.start_date,"\u81f3",e.end_date)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53c2\u4e0e\u5546\u54c1:"),i.a.createElement("span",{className:"limit"},this.handleProducts(e.group_products))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6210\u56e2\u9650\u5236:"),i.a.createElement("span",{className:"limit"},e.group_limit_desc)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u622a\u5355\u5468\u671f:"),i.a.createElement("span",{className:"limit"},Zm(e))),e.consume_stock_args&&i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5f00\u59cb\u6d88\u8017\u5e93\u5b58\u65f6\u95f4:"),i.a.createElement("span",{className:"limit"},"\u622a\u5355\u524d",e.consume_stock_args.day_before_order_deadline,"\u5929 ",e.consume_stock_args.time)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u914d\u9001\u65f6\u95f4:"),i.a.createElement("span",{className:"limit"},ed(e))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6298\u6263:"),i.a.createElement("span",{className:"limit"},td(e))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u6210\u56e2\u7ea2\u5305:"),i.a.createElement("span",{className:"limit"},ad(e))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u8d60\u54c1:"),i.a.createElement("span",{className:"limit"},nd(e))),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u53ef\u89c1\u8303\u56f4:"),i.a.createElement("span",{className:"limit"},e.visible_scope_desc)),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u662f\u5426\u62fc\u56e2\u8bb0\u5f55\u751f\u6210\u56fe\u7247:"),i.a.createElement("span",{className:"limit"},e.auto_generate_shared_picture?"\u662f":"\u5426")),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u56fa\u5b9a\u5206\u4eab\u56fe\u7247:"),i.a.createElement("img",{style:{width:"100px",height:"100px"},src:e.fixed_shared_picture,alt:""})),i.a.createElement("li",null,i.a.createElement("span",{className:"left"},"\u5206\u4eab\u6587\u6848:"),i.a.createElement("span",{className:"limit"},e.share_text)))))}}]),t}(n.Component),rd=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.state={items:[],text:"\u5546\u54c1"},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.items.length&&this.setState({items:e.items})}},{key:"render",value:function(){var e=this.state.items;return i.a.createElement(n.Fragment,null,i.a.createElement(ge.a,{title:"\u5546\u54c1",width:520,centered:!0,visible:this.props.visible,onCancel:this.handleCancel,footer:null,maskClosable:!1},i.a.createElement("ul",{className:"reviews"},e&&e.length&&e.map(function(e){return i.a.createElement("li",{key:e.id},i.a.createElement("span",null,e.name))}))))}}]),t}(i.a.Component),ld=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).editGroupon=function(e){a.props.history.push({pathname:"/activities/editGroupon",state:{data:e}})},a.stopGroupon=function(e){var t=a.refresh,n=Object(Ja.a)(a),r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,maskClosable:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u7ed3\u675f\u8be5\u6d3b\u52a8\u4e48\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,i;(a={},i=e.id,ne({url:"/api/backend/group_shopping/shopping_groups/".concat(i,"/to_end"),method:"put",data:a})).then(function(e){B.a.success("\u5df2\u7ed3\u675f\u8be5\u6d3b\u52a8"),t(n.state.activeTab)}).catch(function(e){})},onCancel:function(){}})},a.showGroupDetails=function(e){a.setState({detailVisible:!0,groupon:e})},a.closeGroupDetails=function(){a.setState({detailVisible:!1})},a.showProductsReview=function(e){a.setState({productsVisible:!0,products:e})},a.closeProductsReview=function(){a.setState({productsVisible:!1})},a.refresh=function(e){var t=[];t=e<0?[]:{conditions:[{key:"shopping_group_state",operation:"=",value:e}],logic:"and"},a.setState({filterVisible:!1,paginationParams:{search:"",searchJson:w({state_constant:"",logic_conditions:t})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.createNewGroupon=function(){a.props.history.push({pathname:"/activities/newGroupon"})},a.search=function(e){a.setState({api:We,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:We,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){$m.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=e,"group_products"===r.dataIndex&&(r.render=function(e,t){return t.group_products.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.group_products[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.showProductsReview(t.group_products)}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),console.log(t,"_______ ggg ______"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.showGroupDetails(t)}},e)},a.columns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)};return a.state={api:We,data:[],filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({date:""})},activeTab:-1,detailVisible:!1,productsVisible:!1,groupon:{},products:[],defaultItem:["display_name","group_products","order_deadline_desc","delivery_specified_type_desc","shop_shopping_groups_count","order_placed_count","state_desc","id"]},a.columns=[{title:"\u62fc\u56e2\u540d\u79f0",dataIndex:"display_name",render:function(e,t){return i.a.createElement("span",{onClick:function(){return a.showGroupDetails(t)},style:{color:"#4f9863",cursor:"pointer"}},e)}},{title:"\u53c2\u4e0e\u5546\u54c1",dataIndex:"sh12op_name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.group_products[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.showProductsReview(t.group_products)}}))}},{title:"\u622a\u5355\u65f6\u95f4",dataIndex:"sh2op_name",render:function(e,t){return Zm(t)}},{title:"\u914d\u9001\u65e5\u671f",dataIndex:"sho1p1_name",render:function(e,t){return ed(t)}},{title:"\u5f00\u56e2\u6b21\u6570",dataIndex:"shop_shopping_groups_count"},{title:"\u4e0b\u5355\u6570",dataIndex:"shopping_group_orders_count"},{title:"\u72b6\u6001",dataIndex:"status",render:function(e,t){return function(e){var t="";switch(e){case 0:t="\u672a\u5f00\u59cb";break;case 1:t="\u8fdb\u884c\u4e2d";break;case 2:t="\u5df2\u7ed3\u675f";break;default:t="\u672a\u77e5"}return t}(t.state)}},{title:"\u64cd\u4f5c",render:function(e,t){return i.a.createElement(n.Fragment,null,i.a.createElement("span",{onClick:function(){return a.editGroupon(t)},style:{color:"#4f9863",cursor:"pointer",marginRight:"10px"}},"\u7f16\u8f91"),1===t.state&&i.a.createElement("span",{style:{color:"#4f9863",cursor:"pointer"},onClick:function(){return a.stopGroupon(t)}},"\u63d0\u524d\u7ed3\u675f"))}}],a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={visible:this.state.detailVisible,data:this.state.groupon,onClose:this.closeGroupDetails},a={visible:this.state.productsVisible,items:this.state.products,onClose:this.closeProductsReview};return i.a.createElement("div",{className:"grouponList"},i.a.createElement(Qm,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:qm,slug:"shopping_group",operation:Xm}),i.a.createElement(id,t),i.a.createElement(rd,a),i.a.createElement("div",{className:"s_body_box"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u62fc\u56e2\u540d\u79f0"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"),i.a.createElement(_e.a,{size:"small",onClick:this.createNewGroupon},"\u521b\u5efa\u62fc\u56e2"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:-1},{name:"\u672a\u5f00\u59cb",key:0},{name:"\u8fdb\u884c\u4e2d",key:1},{name:"\u5df2\u7ed3\u675f",key:2}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:$m,targetKeys:this.state.defaultItem,firstItem:"display_name",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.columns,rowKey:function(e,t){return t},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u4e2a\u62fc\u56e2",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(n.Component),sd=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u5f00\u56e2\u65f6\u95f4",value:"created_time",type:"detailTimeCompare"},{label:"\u622a\u5355\u65f6\u95f4",value:"orderable_deadline",type:"detailTimeCompare"},{label:"\u914d\u9001\u65e5\u671f",value:"delivery_date",type:"dataCompare"},{label:"\u5f00\u59cb\u6d88\u8017\u5e93\u5b58\u65f6\u95f4",value:"consume_stock_time",type:"detailTimeCompare"},{label:"\u62fc\u56e2\u72b6\u6001",value:"state",type:"grouponStatus"},{label:"\u5546\u54c1",value:"group_orders_count_floor",type:"numCompare"},{label:"\u70b9\u51fb\u6b21\u6570",value:"click_count",type:"numCompare"},{label:"\u4e0b\u5355\u6570",value:"order_placed_count",type:"deliveryType"},{label:"\u4e0b\u5355\u4eba\u6570",value:"orders_placed_users_count",type:"isTrue"},{label:"\u603b\u91d1\u989d",value:"orders_total_settlement_fee",type:"numCompare"},{label:"\u5f00\u56e2\u5e97\u94fa",value:"initiator_id",type:"equalShopCompare"},{label:"\u81ea\u63d0\u5e97\u94fa",value:"pickup_shop_id",type:"equalShopCompare"},{label:"\u9500\u552e\u8d21\u732e\u989d\u5ea6",value:"sales_amount",type:"numCompare"}]}],cd={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],isTrue:[{label:"\u662f\u5426",value:"=",type:"boolean"}],equalShopCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneGrouponBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedGrouponBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedGrouponBox"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedBox"}],deadlineType:[{label:"\u7b49\u4e8e",value:"=",type:"deadlineType"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"deadlineType"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"deadlineType"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTime"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"deliveryTime"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"deliveryTime"}],grouponStatus:[{label:"\u7b49\u4e8e",value:"=",type:"grouponListStatus"}],detailTimeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"detailTime"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"detailTime"},{label:"\u665a\u4e8e",value:">",type:"detailTime"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"detailTime"},{label:"\u65e9\u4e8e",value:"<",type:"detailTime"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"detailTime"},{label:"\u533a\u95f4",value:"between",type:"periodDetailTime"}],dataCompare:[{label:"\u7b49\u4e8e",value:"=",type:"times"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"times"},{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"dateRange"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}]},od=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u62fc\u56e2\u5355\u4e3b\u9898",value:"display_name"},{label:"\u62fc\u56e2\u540d\u79f0",value:"shopping_group_name"},{label:"\u5f00\u56e2\u65f6\u95f4",value:"create_time"},{label:"\u622a\u5355\u65f6\u95f4",value:"orderable_deadline"},{label:"\u914d\u9001\u65e5\u671f",value:"delivery_date"},{label:"\u914d\u9001\u65f6\u95f4",value:"delivery_time_period"},{label:"\u70b9\u51fb\u6b21\u6570",value:"click_count"},{label:"\u4e0b\u5355\u6570",value:"order_placed_count"},{label:"\u4e0b\u5355\u4eba\u6570",value:"order_placed_users_count"},{label:"\u603b\u91d1\u989d",value:"orders_total_settlement_fee"},{label:"\u5546\u54c1",value:"group_products"},{label:"\u5f00\u56e2\u5e97\u94fa\u540d\u79f0",value:"initiator_name"},{label:"\u5f00\u56e2\u5e97\u94fa\u7f16\u53f7",value:"initiator_code"},{label:"\u5f00\u56e2\u5e97\u94fa\u4e3b\u59d3\u540d",value:"initiator_keeper_name"},{label:"\u5f00\u56e2\u5e97\u94fa\u4e3b\u624b\u673a\u53f7",value:"initiator_keeper_mobile"},{label:"\u81ea\u63d0\u5e97\u94fa\u540d\u79f0",value:"pick_shop_name"},{label:"\u72b6\u6001",value:"state_desc"},{label:"\u9500\u552e\u8d21\u732e\u989d\u5ea6",value:"sales_amount",type:"numCompare"}]}],ud=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(e){var t=[];t="ALL"===e?[]:{conditions:[{key:"shop_shopping_group_state_constant",operation:"=",value:e}],logic:"and"},a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({logic_conditions:t})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.search=function(e){a.setState({api:Ye,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Ye,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){od.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=e,"group_products"===r.dataIndex&&(r.render=function(e,t){return t.group_products.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.group_products[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.showProductsReview(t.group_products)}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),a.columns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.showProductsReview=function(e){a.setState({productsVisible:!0,products:e})},a.closeProductsReview=function(){a.setState({productsVisible:!1})},a.print=function(e){a.setState({loading:!0},function(){a.getGrouponOrders(e,1)})},a.getGrouponOrders=function(){var e=Object($.a)(X.a.mark(function e(t){var n,i,r,l,s=arguments;return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:1,e.next=3,Ye({page:n,limit:10,searchJson:w({logic_conditions:t})});case 3:i=e.sent,r=i.data,l=i.meta,a.setState({orders:a.state.orders.concat(r)},function(){if(l.pagination.current_page<l.pagination.total_pages)a.getGrouponOrders(t,l.pagination.current_page+1);else{a.setState({loading:!1});var e=a.state.orders;e.length?(a.closeHigherFilter(),a.props.history.push({pathname:"/printGrouponOrders",state:{orders:e,title:"\u62fc\u56e2\u8ba2\u5355\u5217\u8868"}})):B.a.error("\u4eca\u65e5\u6682\u65e0\u8ba2\u5355")}});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return a.state={api:Ye,data:[],filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({date:""})},activeTab:-1,products:[],defaultItem:["display_name","shopping_group_name","create_time","orderable_deadline","delivery_date","order_placed_count","state_desc","id"],orders:[],loading:!1},a.columns=[{title:"\u62fc\u56e2\u5355\u4e3b\u9898",dataIndex:"display_name"},{title:"\u62fc\u56e2\u540d\u79f0",dataIndex:"shopping_group_name"},{title:"\u5f00\u56e2\u65f6\u95f4",dataIndex:"create_time"},{title:"\u622a\u5355\u65f6\u95f4",dataIndex:"orderable_deadline"},{title:"\u914d\u9001\u65e5\u671f",dataIndex:"delivery_date"},{title:"\u4e0b\u5355\u6570",dataIndex:"order_placed_count"},{title:"\u72b6\u6001",dataIndex:"state_desc"}],a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={visible:this.state.productsVisible,items:this.state.products,onClose:this.closeProductsReview};return i.a.createElement("div",{className:"grouponList"},i.a.createElement(Qm,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:sd,slug:"shop_shopping_group",operation:cd,print:this.print,loading:this.state.loading}),i.a.createElement(rd,t),i.a.createElement("div",{className:"s_body_box"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5e97\u94fa\u56db\u4ef6\u5957"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:"ALL"},{name:"\u5f85\u6210\u56e2",key:"WAIT_FORM"},{name:"\u5df2\u6210\u56e2",key:"FORMED_BEFORE_ORDERABLE_DEADLINE"},{name:"\u672a\u6210\u56e2",key:"FAIL_FORMED"},{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:od,targetKeys:this.state.defaultItem,firstItem:"display_name",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.columns,rowKey:function(e,t){return t},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u4e2a\u62fc\u56e2\u5355",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(n.Component),md=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u62fc\u56e2",value:"shopping_group_id",type:"equalGrouponCompare"},{label:"\u62fc\u56e2\u5355",value:"shop_shopping_group_id",type:"equalGrouponListCompare"},{label:"\u5f00\u56e2\u5e97\u94fa",value:"initiator_id",type:"equalShopCompare"},{label:"\u81ea\u63d0\u5e97\u94fa\u540d",value:"pick_shop_name",type:"like"},{label:"\u81ea\u63d0\u5e97\u94fa\u7f16\u53f7",value:"pick_shop_code",type:"like"},{label:"\u622a\u5355\u65f6\u95f4",value:"orderable_deadline",type:"detailTimeCompare"},{label:"\u914d\u9001\u65e5\u671f",value:"delivery_date",type:"dataCompare"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at",type:"detailTimeCompare"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at",type:"detailTimeCompare"},{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee",type:"numCompare"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee",type:"numCompare"},{label:"\u4f18\u60e0\u91d1\u989d",value:"total_preferential_fee",type:"numCompare"},{label:"\u8ba2\u5355\u72b6\u6001",value:"order_state",type:"orderStateCompare"}]}],dd={absoluteCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"}],numCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"input"},{label:"\u5c0f\u4e8e",value:"<",type:"input"},{label:"\u5c0f\u4e8e\u7b49\u4e8e",value:"<=",type:"input"},{label:"\u5927\u4e8e",value:">",type:"input"},{label:"\u5927\u4e8e\u7b49\u4e8e",value:">=",type:"input"},{label:"\u533a\u95f4",value:"between",type:"inputRange"}],contain:[{label:"\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"in",type:"selectedTagBox"},{label:"\u5305\u542b\u4ee5\u4e0b\u6240\u6709",value:"all",type:"selectedTagBox"},{label:"\u4e0d\u5305\u542b\u4ee5\u4e0b\u4efb\u610f",value:"not in",type:"selectedTagBox"}],isTrue:[{label:"\u662f\u5426",value:"=",type:"boolean"}],orderStateCompare:[{label:"\u7b49\u4e8e",value:"=",type:"grouponOrderStatus"}],group:[{label:"\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"in",type:"selectedGroupBox"},{label:"\u5728\u4ee5\u4e0b\u6240\u6709\u7fa4\u7ec4\u4e2d",value:"all",type:"selectedGroupBox"},{label:"\u4e0d\u5728\u4ee5\u4e0b\u4efb\u610f\u7fa4\u7ec4\u4e2d",value:"not in",type:"selectedGroupBox"}],equalShopCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneGrouponBox",advanceSearchKey:"name"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedGrouponBox",advanceSearchKey:"name"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedGrouponBox",advanceSearchKey:"name"}],equalGrouponCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneGrouponBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedGrouponBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedGrouponBox"}],equalGrouponListCompare:[{label:"\u7b49\u4e8e",value:"=",type:"selectedOneGrouponBox"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"selectedGrouponBox"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"selectedGrouponBox"}],deadlineType:[{label:"\u7b49\u4e8e",value:"=",type:"deadlineType"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"deadlineType"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"deadlineType"}],deliveryType:[{label:"\u7b49\u4e8e",value:"=",type:"deliveryTime"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"deliveryTime"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"deliveryTime"}],grouponStatus:[{label:"\u7b49\u4e8e",value:"=",type:"grouponListStatus"},{label:"\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"in",type:"grouponListStatus"},{label:"\u4e0d\u7b49\u4e8e\u5176\u4e2d\u4e4b\u4e00",value:"not in",type:"grouponListStatus"}],detailTimeCompare:[{label:"\u7b49\u4e8e",value:"=",type:"detailTime"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"detailTime"},{label:"\u665a\u4e8e",value:">",type:"detailTime"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"detailTime"},{label:"\u65e9\u4e8e",value:"<",type:"detailTime"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"detailTime"},{label:"\u533a\u95f4",value:"between",type:"periodDetailTime"}],dataCompare:[{label:"\u7b49\u4e8e",value:"=",type:"times"},{label:"\u4e0d\u7b49\u4e8e",value:"<>",type:"times"},{label:"\u665a\u4e8e",value:">",type:"times"},{label:"\u665a\u4e8e(\u542b)",value:">=",type:"times"},{label:"\u65e9\u4e8e",value:"<",type:"times"},{label:"\u65e9\u4e8e(\u542b)",value:"<=",type:"times"},{label:"\u533a\u95f4",value:"between",type:"dateRange"}],emptyCompare:[{label:"\u7b49\u4e8e",value:"=",type:"input"},{label:"\u4e3a\u7a7a",value:"is null",type:""},{label:"\u4e0d\u4e3a\u7a7a",value:"is not null",type:""}],like:{label:"\u7b49\u4e8e",value:"like",type:"input"}},pd=[{value:"base_attributes",label:"\u57fa\u672c\u5c5e\u6027",children:[{label:"\u7528\u6237\u6635\u79f0",value:"nickname"},{label:"\u8ba2\u5355\u53f7",value:"trade_no"},{label:"\u62fc\u56e2\u540d\u79f0",value:"group_name"},{label:"\u62fc\u56e2\u5355\u540d\u79f0",value:"display_name"},{label:"\u5f00\u56e2\u5e97\u94fa",value:"initiator_name"},{label:"\u4e0b\u5355\u65f6\u95f4",value:"created_at"},{label:"\u652f\u4ed8\u65f6\u95f4",value:"paid_at"},{label:"\u622a\u5355\u65f6\u95f4",value:"orderable_deadline"},{label:"\u914d\u9001\u65e5\u671f",value:"delivery_date"},{label:"\u914d\u9001\u65f6\u95f4",value:"delivery_time_period"},{label:"\u5546\u54c1",value:"items"},{label:"\u5e94\u4ed8\u6b3e",value:"total_fee"},{label:"\u5b9e\u4ed8\u6b3e",value:"settlement_total_fee"},{label:"\u4f18\u60e0\u91d1\u989d",value:"total_preferential_fee"},{label:"\u81ea\u63d0\u5e97\u94fa\u540d\u79f0",value:"pick_shop_name"},{label:"\u72b6\u6001",value:"state_desc"},{label:"\u6536\u8d27\u4eba",value:"consignee_name"},{label:"\u8054\u7cfb\u65b9\u5f0f",value:"consignee_mobile_phone"}]}],hd=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(e){var t=[];t=e?{conditions:[{key:"shopping_group_order_order_state",operation:"=",value:e}],logic:"and"}:[],a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({state_constant:"",logic_conditions:t})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.search=function(e){a.setState({api:qe,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showExport=function(e){a.setState({conditions:e,exportVisible:!0},function(){a.closeHigherFilter()})},a.hideExport=function(){a.setState({exportVisible:!1})},a.export=function(e,t,a){console.log(e,"--- type---"),console.log(a,">>>>>>>>>>>>>>>>>>>>>>>>>>");var n=w({strategy:e,customize_columns:t,logic_conditions:a});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(n,"&Authorization=").concat(k())},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:qe,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){pd.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=e,"items"===r.dataIndex&&(r.render=function(e,t){return t.items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.showProductsReview(t.items)}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),a.columns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key}),a.refresh(e.key)},a.showProductsReview=function(e){a.setState({productsVisible:!0,products:e})},a.closeProductsReview=function(){a.setState({productsVisible:!1})};return a.state={api:qe,data:[],filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({date:""})},activeTab:"",products:[],defaultItem:["nickname","trade_no","initiator_name","paid_at","delivery_date","items","settlement_total_fee","state_desc","id"],exportVisible:!1,orders:[],loading:!1},a.columns=[{title:"\u7528\u6237\u6635\u79f0",dataIndex:"nickname"},{title:"\u8ba2\u5355\u53f7",dataIndex:"trade_no"},{title:"\u5f00\u56e2\u5e97\u94fa",dataIndex:"initiator_name"},{title:"\u652f\u4ed8\u65f6\u95f4",dataIndex:"paid_at"},{title:"\u914d\u9001\u65e5\u671f",dataIndex:"delivery_date"},{title:"\u5546\u54c1",dataIndex:"sh12op_name",render:function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items[0].name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.showProductsReview(t.items)}}))}},{title:"\u5b9e\u4ed8\u6b3e",dataIndex:"settlement_total_fee"},{title:"\u72b6\u6001",dataIndex:"state_desc"}],a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={visible:this.state.productsVisible,items:this.state.products,onClose:this.closeProductsReview},a={visible:this.state.exportVisible,onCancel:this.hideExport,export:this.export,strategy:[{key:"GROUP_SHOPPING_ORDER_CUSTOMIZE",value:"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"},{key:"GROUP_SHOPPING_PRODUCT_DIMENSION",value:"\u5546\u54c1\u7ef4\u5ea6"},{key:"GROUP_SHOPPING_WULIU",value:"\u7269\u6d41\u8ba2\u5355\u6a21\u677f"}],values:pd,conditions:this.state.conditions,slug:"shopping_group_order_"};return i.a.createElement("div",{className:"grouponList"},i.a.createElement(Qm,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:md,operation:dd,slug:"shopping_group_order",export:this.showExport}),i.a.createElement(rd,t),i.a.createElement(dn,a),i.a.createElement("div",{className:"s_body_box"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u6216\u8ba2\u5355\u53f7"}),i.a.createElement("h4",{className:"higherFilter",onClick:this.higherFilter},"\u9ad8\u7ea7\u7b5b\u9009"))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5168\u90e8",key:""},{name:"\u5f85\u6210\u56e2",key:"PAY_COMPLETED"},{name:"\u5f85\u6536\u8d27",key:"WAIT_AGENT_VERIFY"},{name:"\u672a\u6210\u56e2",key:"CANCEL_AUTO"},{name:"\u5f85\u81ea\u63d0",key:"WAIT_CUSTOMER_VERIFY"},{name:"\u5df2\u5b8c\u6210",key:"COMPLETED"}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:pd,targetKeys:this.state.defaultItem,firstItem:"nickname",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.columns,rowKey:function(e,t){return t},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u7b14\u62fc\u56e2\u8ba2\u5355",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(n.Component),fd=(a(411),a(175)),Ed=(a(617),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){console.log(e),a.setState({selectedItems:e}),a.props.selectionChange(a.props.type,e)},a.state={selectedItems:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props.value,"xxxx"),this.setState({selectedItems:this.props.value})}},{key:"render",value:function(){var e=this.state.selectedItems,t=this.props.strategy;return i.a.createElement("div",{className:"selection"},i.a.createElement(Q.a,{defaultActiveFirstOption:!1,value:e,className:"selectedBox",onChange:this.handleChange,optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t&&t.length&&t.map(function(e,t){return i.a.createElement(Q.a.Option,{key:t,label:e.name,value:e.key},e.name)})))}}]),t}(n.Component)),vd={group_limit_type:[{name:"\u603b\u91d1\u989d",key:"ORDERS_TOTAL_FEE_LIMIT"},{name:"\u8ba2\u5355\u6570",key:"ORDERS_COUNT_LIMIT"}],order_deadline_type:[{name:"\u5f53\u65e5",key:"FIXED_TERM_0"},{name:"\u6b21\u65e5",key:"FIXED_TERM_1"},{name:"\u67d0\u65e5\u671f\u524d\u4e0d\u9650\u5236",key:"BEFORE_FIXED_DATE"},{name:"\u56fa\u5b9a\u65e5\u671f",key:"FIXED_DATE"}],delivery_type:[{name:"\u5f53\u65e5\u8fbe",key:"FIXED_TERM_0"},{name:"\u6b21\u65e5\u8fbe",key:"FIXED_TERM_1"},{name:"\u9694\u65e5\u8fbe",key:"FIXED_TERM_2"},{name:"\u56fa\u5b9a\u65e5\u671f",key:"FIXED_DATE"}]},_d=(a(1502),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).add=function(e){var t={full:"",send:"",id:e+1};a.setState({ary:[].concat(Object(Se.a)(a.state.ary),[t])})},a.delete=function(e){var t=a.state.ary;t=t.filter(function(t){return t.id!==e.id}),console.log(t),a.setState({ary:t})},a.change=function(e,t,n){e.target.value<0&&(e.target.value=0),t[n]=e.target.value;var i=a.state.ary;y.a.map(i,function(e){e.id===t.id&&(e=t)}),a.setState({ary:i})},a.state={ary:[{full:"",send:"",id:0}]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"redPacket"},i.a.createElement("ul",null,this.state.ary.map(function(t,a){return i.a.createElement("li",{key:a},i.a.createElement("div",null,"\u6ee1 ",i.a.createElement(Ne.a,{type:"number",value:t.full,onChange:function(a){return e.change(a,t,"full")}})," \u9001 ",i.a.createElement(Ne.a,{type:"number",value:t.send,onChange:function(a){return e.change(a,t,"send")}})),a===e.state.ary.length-1&&i.a.createElement("span",{className:"add",onClick:function(){return e.add(a)}},"\u6dfb\u52a0"),a>0&&i.a.createElement("span",{className:"delete",onClick:function(){return e.delete(t)}},"\u5220\u9664"))})))}}]),t}(n.Component)),gd=G.a.RangePicker,bd=Ne.a.TextArea,yd=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).selectorPopupScroll=function(){var e;console.log(a.state.loadProduct,"-----------------"),a.state.loadProduct||((e={limit:100,page:a.state.page},ne({url:"/api/backend/group_shopping/products/shelfable",method:"get",params:e})).then(function(e){var t=a.state.products,n=a.state.page;t=t.concat(e.data),console.log("======= ------- ",t,e.data),a.setState({products:t,page:e.meta.total_pages>n?n+1:n,loadProduct:!1},function(){console.log("======= ------- "),e.meta.total_pages>n&&a.selectorPopupScroll()}),console.log("======= ------- =====")}).catch(function(e){a.setState({loadProduct:!1})}),a.setState({loadProduct:!0}))},a.selectionChange=function(e,t){a.setState(Object(Y.a)({},e,t))},a.back=function(){a.props.history.go(-1)},a.onRadioChange=function(e,t){a.setState(Object(Y.a)({},t,e.target.value))},a.onInputChange=function(e,t){e.target.value<0&&(e.target.value=0);var n=parseInt(e.target.value)?Number(e.target.value):e.target.value;a.setState(Object(Y.a)({},t,n))},a.actDateChange=function(e,t){a.setState({start_date:t[0],end_date:t[1]})},a.onProductChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.onDatePicker=function(e,t){console.log(e),console.log(t),a.setState(Object(Y.a)({},t,e))},a.onShopGroupChange=function(e){a.setState({where:[]});("shop"===e?et:ha)({}).then(function(t){a.setState({type:e,data:t.data})})},a.onShopChange=function(e){a.setState({where:e})},a.onTypeChange=function(e){a.setState({opt:e})},a.tagScroll=function(e){e.persist();var t=e.target;if(t.scrollTop+t.offsetHeight===t.scrollHeight){var n=a.state.scrollPage+1;a.setState({scrollPage:n}),a.getList(n)}},a.getList=function(e){("shop"===a.state.type?et:ha)({limit:10,page:e}).then(function(e){e.data.length&&a.setState({data:a.state.data.concat(e.data)})})},a.onTimeChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.onTimeRangeChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.checkData=function(){var e=Object(Ja.a)(a).state,t=a.image.current?a.image.current.state.imgUrl||a.image.current.state.imageUrl:"",n=a.editor.current?a.editor.current.state.outputHTML:"";if(e.name)if(e.display_name)if(e.start_date)if(e.group_products.length)if(!e.has_group_limit||"ORDERS_COUNT_LIMIT"!==e.group_limit_type||e.group_orders_count_floor)if(!e.has_group_limit||"ORDERS_COUNT_LIMIT"!==e.group_limit_type||e.group_order_fee_floor)if(!e.has_group_limit||"ORDERS_TOTAL_FEE_LIMIT"!==e.group_limit_type||e.group_orders_total_fee_floor)if("BEFORE_FIXED_DATE"!==e.order_deadline_type||e.order_deadline_fixed_date)if("FIXED_DATE"!==e.order_deadline_type||e.order_deadline_fixed_date)if(e.order_deadline_time)if("FIXED_TERM_0"===e.order_deadline_type?(e.order_deadline_fixed_term=0,e.order_deadline_type="FIXED_TERM"):"FIXED_TERM_1"===e.order_deadline_type&&(e.order_deadline_fixed_term=1,e.order_deadline_type="FIXED_TERM"),"FIXED_DATE"!==e.delivery_type||e.delivery_fixed_date)if(e.delivery_time_period_start)if(e.delivery_time_period_end)if("FIXED_TERM_0"===e.delivery_type?(e.delivery_fixed_term=0,e.delivery_type="FIXED_TERM"):"FIXED_TERM_1"===e.delivery_type?(e.delivery_fixed_term=1,e.delivery_type="FIXED_TERM"):"FIXED_TERM_2"===e.delivery_type&&(e.delivery_fixed_term=2,e.delivery_type="FIXED_TERM"),!e.has_group_limit||"ORDERS_TOTAL_FEE_LIMIT"!==e.group_limit_type||e.group_orders_total_fee_floor)if(!e.has_discount||e.discount){if(e.discount=e.has_discount?e.discount:100,console.log(e,"=============<<<<<<<<<<<<<"),e.has_group_red_packet){var i=a.redPacket.current&&a.redPacket.current.state.ary;console.log(i,"redPacket");var r=[];if(y.a.map(i,function(e){var t=!0;for(var a in e)if("id"!==a&&!e[a]){t=!1;break}t&&r.push({minimum_total_fee:Number(e.full),gift_amount:Number(e.send)})}),console.log(r,"group_red_packet_levels"),r.length<i.length)return void B.a.error("\u8bf7\u6b63\u786e\u586b\u5199\u6210\u56e2\u7ea2\u5305");e.group_red_packet_levels=r}if(!e.has_gift||e.gift_floor)if(!e.has_gift||e.gift_products.length){var l=[];if(e.has_gift&&e.gift_products.length&&y.a.map(e.gift_products,function(e){var t={};t.product_entity_id=Number(e),t.gift_quantity=1,l.push(t)}),e.visible_scope){if(!e.opt)return void B.a.error("\u8bf7\u9009\u62e9\u53ef\u89c1\u7c7b\u578b");if(!e.where||!e.where.length)return void B.a.error("\u8bf7\u9009\u62e9\u5e97\u94fa\u6216\u5e97\u94fa\u7ec4");e.visible_scope={type:e.type,opt:e.opt,where:e.where}}t?(e.fixed_shared_picture=t,e.share_text?n?(e.detail=n,a.submit(e,l)):B.a.error("\u8bf7\u586b\u5199\u5bcc\u6587\u672c\u8be6\u60c5\u9875"):B.a.error("\u8bf7\u586b\u5199\u5206\u4eab\u6587\u6848")):B.a.error("\u8bf7\u4e0a\u4f20\u5206\u4eab\u56fe\u7247")}else B.a.error("\u8bf7\u9009\u62e9\u8d60\u54c1");else B.a.error("\u8bf7\u586b\u5199\u8d60\u54c1\u8d77\u9001\u91d1\u989d")}else B.a.error("\u8bf7\u586b\u5199\u6298\u6263");else B.a.error("\u8bf7\u586b\u5199\u8ba2\u5355\u603b\u91d1\u989d\u9650\u5236");else B.a.error("\u8bf7\u9009\u62e9\u914d\u9001\u7ed3\u675f\u65f6\u95f4");else B.a.error("\u8bf7\u9009\u62e9\u914d\u9001\u5f00\u59cb\u65f6\u95f4");else B.a.error("\u8bf7\u9009\u62e9\u914d\u9001\u5468\u671f");else B.a.error("\u8bf7\u9009\u62e9\u622a\u5355\u5177\u4f53\u65f6\u95f4");else B.a.error("\u8bf7\u9009\u62e9\u622a\u5355\u5468\u671f");else B.a.error("\u8bf7\u9009\u62e9\u622a\u5355\u5468\u671f");else B.a.error("\u8bf7\u586b\u5199\u8ba2\u5355\u603b\u91d1\u989d\u9650\u5236");else B.a.error("\u8bf7\u586b\u5199\u8ba2\u5355\u8d77\u8ba2\u91d1\u989d");else B.a.error("\u8bf7\u586b\u5199\u6210\u56e2\u8ba2\u5355\u6570\u9650\u5236");else B.a.error("\u8bf7\u9009\u62e9\u62fc\u56e2\u53c2\u4e0e\u5546\u54c1");else B.a.error("\u8bf7\u9009\u62e9\u62fc\u56e2\u65f6\u95f4");else B.a.error("\u8bf7\u586b\u5199\u5c55\u793a\u540d\u79f0");else B.a.error("\u8bf7\u586b\u5199\u62fc\u56e2\u540d\u79f0")},a.submit=function(e,t){var n;e.gift_products=t,(n=e,ne({url:"/api/backend/group_shopping/shopping_groups",method:"post",data:n})).then(function(e){B.a.success(e.message),a.back()}).catch(function(e){})},a.state={name:"",display_name:"",share_text:"",group_limit_type:"ORDERS_COUNT_LIMIT",group_order_fee_floor:"",group_orders_count_floor:"",group_orders_total_fee_floor:"",order_deadline_fixed_date:"",has_group_limit:!1,has_discount:!1,discount:"",has_group_red_packet:!1,has_gift:!1,gift_floor:"",products:[],gift_products:[],group_products:[],delivery_fixed_date:"",auto_generate_shared_picture:!1,is_join_sales_cashback:!1,order_deadline_time:"",delivery_time_period_start:"",delivery_time_period_end:"",consume_stock_day_before_deadline:"",visible_scope:null,data:[],type:"shop",scrollPage:1,page:1,loadProduct:!1},a.image=i.a.createRef(),a.redPacket=i.a.createRef(),a.editor=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.selectorPopupScroll(),et({limit:10,page:1}).then(function(t){e.setState({data:t.data})})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"newGroupon"},i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",onClick:this.checkData},"\u4fdd\u5b58"),i.a.createElement(_e.a,{onClick:this.back,size:"small"},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("ul",{className:"forms"},i.a.createElement("li",null,i.a.createElement("h4",null,"\u62fc\u56e2\u540d\u79f0"),i.a.createElement(Ne.a,{value:this.state.name,onChange:function(t){return e.onInputChange(t,"name")}})),i.a.createElement("li",null,i.a.createElement("h4",null,"\u5c55\u793a\u540d\u79f0\uff08\u56e2\u8d2d\u4e3b\u9898\uff09"),i.a.createElement(Ne.a,{value:this.state.display_name,onChange:function(t){return e.onInputChange(t,"display_name")}})),i.a.createElement("li",{className:"longDatePicker"},i.a.createElement("h4",null,"\u62fc\u56e2\u65f6\u95f4"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(gd,{showTime:!0,onChange:this.actDateChange}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u53c2\u4e0e\u5546\u54c1"),i.a.createElement(Q.a,{mode:"multiple",defaultActiveFirstOption:!1,value:this.state.group_products,className:"selectedBox",onChange:function(t){return e.onProductChange(t,"group_products")},optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_entity_id+"",value:e.product_entity_id+"",label:e.product_entity.name},e.product_entity.name)}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u6210\u56e2\u9650\u5236"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange(t,"has_group_limit")},value:this.state.has_group_limit},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),this.state.has_group_limit&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u6210\u56e2\u9650\u5236\u7c7b\u578b"),i.a.createElement(Ed,{strategy:vd.group_limit_type,type:"group_limit_type",selectionChange:this.selectionChange,value:this.state.group_limit_type})),this.state.has_group_limit&&"ORDERS_COUNT_LIMIT"===this.state.group_limit_type&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u8ba2\u5355\u6570\u9650\u5236"),i.a.createElement(Ne.a,{type:"number",value:this.state.group_orders_count_floor,onChange:function(t){return e.onInputChange(t,"group_orders_count_floor")}})),this.state.has_group_limit&&"ORDERS_COUNT_LIMIT"===this.state.group_limit_type&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u8ba2\u5355\u8d77\u8ba2\u91d1\u989d"),i.a.createElement(Ne.a,{type:"number",value:this.state.group_order_fee_floor,onChange:function(t){return e.onInputChange(t,"group_order_fee_floor")}})),this.state.has_group_limit&&"ORDERS_TOTAL_FEE_LIMIT"===this.state.group_limit_type&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u8ba2\u5355\u603b\u91d1\u989d\u9650\u5236"),i.a.createElement(Ne.a,{type:"number",value:this.state.group_orders_total_fee_floor,onChange:function(t){return e.onInputChange(t,"group_orders_total_fee_floor")}})),i.a.createElement("li",null,i.a.createElement("h4",null,"\u622a\u5355\u5468\u671f"),i.a.createElement(Ed,{strategy:vd.order_deadline_type,type:"order_deadline_type",selectionChange:this.selectionChange,value:this.state.order_deadline_type})),"BEFORE_FIXED_DATE"===this.state.order_deadline_type&&i.a.createElement("li",{className:"longDatePicker"},i.a.createElement("h4",null,"\u67d0\u65e5\u671f\u524d"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:function(t,a){return e.onDatePicker(a,"order_deadline_fixed_date")}}))),"FIXED_DATE"===this.state.order_deadline_type&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u56fa\u5b9a\u65e5\u671f"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:function(t,a){return e.onDatePicker(a,"order_deadline_fixed_date")}}))),i.a.createElement("li",{className:"time"},i.a.createElement("h4",null,"\u9009\u62e9\u622a\u5355\u5177\u4f53\u65f6\u95f4"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(fd.a,{format:"HH:mm",onChange:function(t,a){return e.onTimeChange(a,"order_deadline_time")}}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u5f00\u59cb\u6d88\u8017\u5e93\u5b58\u65f6\u95f4"),i.a.createElement("div",{className:"short"},"\u622a\u5355\u524d ",i.a.createElement(Ne.a,{type:"number",value:this.state.consume_stock_day_before_deadline,onChange:function(t){return e.onInputChange(t,"consume_stock_day_before_deadline")}}),"\u5929")),i.a.createElement("li",{className:"time"},i.a.createElement("h4",null,"\u5f00\u59cb\u6d88\u8017\u5e93\u5b58\u5177\u4f53\u65f6\u95f4"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(fd.a,{format:"HH:mm",onChange:function(t,a){return e.onTimeChange(a,"consume_stock_time")}}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u914d\u9001\u5468\u671f"),i.a.createElement(Ed,{strategy:vd.delivery_type,type:"delivery_type",selectionChange:this.selectionChange,value:this.state.delivery_type})),"FIXED_DATE"===this.state.delivery_type&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u56fa\u5b9a\u65e5\u671f"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(G.a,{onChange:function(t,a){return e.onDatePicker(a,"delivery_fixed_date")}}))),i.a.createElement("li",{className:"timeRange"},i.a.createElement("h4",null,"\u914d\u9001\u65f6\u95f4"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(fd.a,{format:"HH:mm",onChange:function(t,a){return e.onTimeRangeChange(a,"delivery_time_period_start")}}),i.a.createElement(fd.a,{format:"HH:mm",onChange:function(t,a){return e.onTimeRangeChange(a,"delivery_time_period_end")}}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u662f\u5426\u6253\u6298"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange(t,"has_discount")},value:this.state.has_discount},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),this.state.has_discount&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u6298\u6263"),i.a.createElement(Ne.a,{type:"number",value:this.state.discount,onChange:function(t){return e.onInputChange(t,"discount")}})),i.a.createElement("li",null,i.a.createElement("h4",null,"\u662f\u5426\u6709\u6210\u56e2\u7ea2\u5305"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange(t,"has_group_red_packet")},value:this.state.has_group_red_packet},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),this.state.has_group_red_packet&&i.a.createElement(_d,{ref:this.redPacket}),i.a.createElement("li",null,i.a.createElement("h4",null,"\u662f\u5426\u6709\u8d60\u54c1"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange(t,"has_gift")},value:this.state.has_gift},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),this.state.has_gift&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u8d77\u9001\u91d1\u989d"),i.a.createElement(Ne.a,{type:"number",value:this.state.gift_floor,onChange:function(t){return e.onInputChange(t,"gift_floor")}})),this.state.has_gift&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u8d60\u9001\u5546\u54c1"),i.a.createElement(Q.a,{mode:"multiple",defaultActiveFirstOption:!1,value:this.state.gift_products,className:"selectedBox",onChange:function(t){return e.onProductChange(t,"gift_products")},optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_entity_id+"",value:e.product_entity_id+"",label:e.product_entity.name},e.product_entity.name)}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u53ef\u89c1\u8303\u56f4"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange(t,"visible_scope")},value:this.state.visible_scope},i.a.createElement(mn.a,{value:null},"\u5168\u90e8"),i.a.createElement(mn.a,{value:1},"\u90e8\u5206"))),this.state.visible_scope&&i.a.createElement("div",{className:"scope"},i.a.createElement(Q.a,{defaultActiveFirstOption:!1,onChange:this.onShopGroupChange,value:this.state.type,className:"type",placeholder:"\u8bf7\u9009\u62e9\u53ef\u89c1\u8303\u56f4"},i.a.createElement(Q.a.Option,{value:"shop"},"\u5e97\u94fa"),i.a.createElement(Q.a.Option,{value:"group"},"\u5e97\u94fa\u7ec4")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,className:"opt",onChange:this.onTypeChange,placeholder:"\u8bf7\u9009\u62e9\u53ef\u89c1\u65b9\u5f0f"},i.a.createElement(Q.a.Option,{value:"in"},"\u53ef\u89c1"),i.a.createElement(Q.a.Option,{value:"not in"},"\u4e0d\u53ef\u89c1")),i.a.createElement(Q.a,{defaultActiveFirstOption:!1,mode:"multiple",value:this.state.where,placeholder:"\u8bf7\u9009\u62e9\u8303\u56f4",className:"value",onChange:this.onShopChange,onPopupScroll:this.tagScroll,allowClear:!0,optionFilterProp:"children",optionLabelProp:"label",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.data.map(function(e){return i.a.createElement(Q.a.Option,{key:e.id+"",label:e.name,value:e.id+""},e.name)}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u662f\u5426\u62fc\u56e2\u8bb0\u5f55\u751f\u6210\u56fe\u7247"),i.a.createElement(mn.a.Group,{onChange:function(t){return e.onRadioChange(t,"auto_generate_shared_picture")},value:this.state.auto_generate_shared_picture},i.a.createElement(mn.a,{value:!0},"\u662f"),i.a.createElement(mn.a,{value:!1},"\u5426"))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u56fa\u5b9a\u5206\u4eab\u56fe\u7247"),i.a.createElement(ta,{ref:this.image})),i.a.createElement("li",null,i.a.createElement("h4",null,"\u5206\u4eab\u6587\u6848"),i.a.createElement(bd,{rows:4,value:this.state.share_text,onChange:function(t){return e.onInputChange(t,"share_text")}})),i.a.createElement("li",{className:"richText"},i.a.createElement("h4",null,"\u62fc\u56e2\u9875\u5bcc\u6587\u672c\u7f16\u8f91"),i.a.createElement(jr,{ref:this.editor}))))}}]),t}(n.Component),Cd=G.a.RangePicker,kd=Ne.a.TextArea,Sd=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).selectionChange=function(e,t){a.setState(Object(Y.a)({},e,t))},a.back=function(){a.props.history.go(-1)},a.onRadioChange=function(e,t){a.setState(Object(Y.a)({},t,e.target.value))},a.onInputChange=function(e,t){e.target.value<0&&(e.target.value=0);var n=parseInt(e.target.value)?Number(e.target.value):e.target.value;a.setState(Object(Y.a)({},t,n))},a.actDateChange=function(e,t){a.setState({start_date:t[0],end_date:t[1],timeRange:e})},a.onProductChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.onDatePicker=function(e,t){a.setState(Object(Y.a)({},t,e))},a.onTimeChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.onTimeRangeChange=function(e,t){a.setState(Object(Y.a)({},t,e))},a.checkData=function(){var e=Object(Ja.a)(a).state,t=a.image.current?a.image.current.state.imgUrl||a.image.current.state.imageUrl:"",n=a.editor.current?a.editor.current.state.outputHTML:"";e.display_name?e.start_date?e.group_products.length?t?(e.fixed_shared_picture=t,e.share_text?n?(e.detail=n,a.submit(e)):B.a.error("\u8bf7\u586b\u5199\u5bcc\u6587\u672c\u8be6\u60c5\u9875"):B.a.error("\u8bf7\u586b\u5199\u5206\u4eab\u6587\u6848")):B.a.error("\u8bf7\u4e0a\u4f20\u5206\u4eab\u56fe\u7247"):B.a.error("\u8bf7\u9009\u62e9\u62fc\u56e2\u53c2\u4e0e\u5546\u54c1"):B.a.error("\u8bf7\u9009\u62e9\u62fc\u56e2\u65f6\u95f4"):B.a.error("\u8bf7\u586b\u5199\u5c55\u793a\u540d\u79f0")},a.submit=function(e){var t,n;(t=e,n=a.props.location.state.data.id,ne({url:"/api/backend/group_shopping/shopping_groups/".concat(n),method:"put",data:t})).then(function(e){B.a.success(e.message),a.back()}).catch(function(e){})},a.state={display_name:"",share_text:"",discount:"",products:[],gift_products:[],group_products:[],timeRange:[]},a.image=i.a.createRef(),a.editor=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.state,a=[];if(t&&t.data&&t.data.id){y.a.map(t.data.group_products,function(e){a.push(e.id)});var n=t.data.start_date,i=t.data.end_date,r=[J()(n,"YYYY-MM-DD HH:mm:ss"),J()(i,"YYYY-MM-DD HH:mm:ss")];this.setState(Object(be.a)({},t.data,{group_products:[],timeRange:r}))}hu({limit:100,page:1},13).then(function(t){e.setState({products:t.data,group_products:a})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state;return i.a.createElement("div",{className:"newGroupon"},i.a.createElement("div",{className:"header"},i.a.createElement(_e.a,{size:"small",onClick:this.checkData},"\u4fdd\u5b58"),i.a.createElement(_e.a,{onClick:this.back,size:"small"},"\u8fd4\u56de\u4e0a\u4e00\u9875")),i.a.createElement("ul",{className:"forms"},i.a.createElement("li",null,i.a.createElement("h4",null,"\u62fc\u56e2\u540d\u79f0"),i.a.createElement("h5",null,t.name)),i.a.createElement("li",null,i.a.createElement("h4",null,"\u5c55\u793a\u540d\u79f0\uff08\u56e2\u8d2d\u4e3b\u9898\uff091111"),i.a.createElement(Ne.a,{value:this.state.display_name,onChange:function(t){return e.onInputChange(t,"display_name")}})),i.a.createElement("li",null,i.a.createElement("h4",null,"\u62fc\u56e2\u65f6\u95f4"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(Cd,{showTime:!0,value:this.state.timeRange,onChange:this.actDateChange}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u53c2\u4e0e\u5546\u54c1"),i.a.createElement(Q.a,{mode:"multiple",defaultActiveFirstOption:!1,value:this.state.group_products,className:"selectedBox",onChange:function(t){return e.onProductChange(t,"group_products")},optionLabelProp:"label",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.products.map(function(e){return i.a.createElement(Q.a.Option,{key:e.product_entity_id,value:e.product_entity_id,label:e.product_entity.name},e.product_entity.name)}))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u6210\u56e2\u9650\u5236"),i.a.createElement("h5",null,this.state.group_limit_desc)),i.a.createElement("li",null,i.a.createElement("h4",null,"\u622a\u5355\u5468\u671f"),i.a.createElement("h5",null,Zm(this.state))),this.state.consume_stock_args&&i.a.createElement("li",null,i.a.createElement("h4",null,"\u5f00\u59cb\u6d88\u8017\u5e93\u5b58\u65f6\u95f4"),i.a.createElement("h5",null,"\u622a\u5355\u524d",this.state.consume_stock_args.day_before_order_deadline,"\u5929 ",this.state.consume_stock_args.time)),i.a.createElement("li",null,i.a.createElement("h4",null,"\u914d\u9001\u65f6\u95f4"),i.a.createElement("h5",null,ed(this.state))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u6298\u6263"),i.a.createElement("h5",null,td(this.state))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u6210\u56e2\u7ea2\u5305"),i.a.createElement("h5",null,ad(this.state))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u662f\u5426\u6709\u8d60\u54c1"),i.a.createElement("h5",null,nd(this.state))),i.a.createElement("li",null,i.a.createElement("h4",null,"\u53ef\u89c1\u8303\u56f4"),i.a.createElement("h5",null,this.state.visible_scope_desc)),i.a.createElement("li",null,i.a.createElement("h4",null,"\u662f\u5426\u62fc\u56e2\u8bb0\u5f55\u751f\u6210\u56fe\u7247"),i.a.createElement("h5",null,this.state.auto_generate_shared_picture?"\u662f":"\u5426")),i.a.createElement("li",null,i.a.createElement("h4",null,"\u56fa\u5b9a\u5206\u4eab\u56fe\u7247"),i.a.createElement(ta,{status:"edit",ref:this.image,defaultImg:this.state.fixed_shared_picture})),i.a.createElement("li",null,i.a.createElement("h4",null,"\u5206\u4eab\u6587\u6848"),i.a.createElement(kd,{rows:4,value:this.state.share_text,onChange:function(t){return e.onInputChange(t,"share_text")}})),this.state.detail&&i.a.createElement("li",{className:"richText"},i.a.createElement("h4",null,"\u62fc\u56e2\u9875\u5bcc\u6587\u672c\u7f16\u8f91"),i.a.createElement(jr,{ref:this.editor,default:this.state.detail}))))}}]),t}(n.Component),Od=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a.setState({filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({is_on_sale:e})}},function(){a.child.current.pagination(a.child.current.state.current)})},a.search=function(e){a.setState({api:Xe,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e,status:!0,is_on_sale:a.state.is_on_sale})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.higherFilter=function(){a.setState({filterVisible:!0})},a.closeHigherFilter=function(){a.setState({filterVisible:!1})},a.onSubmit=function(e){a.setState({api:Xe,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({logic_conditions:e,status:!0,is_on_sale:a.state.is_on_sale})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.showCustom=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({customVisible:!0})},a.closeCustom=function(){a.setState({customVisible:!1})},a.handleCustom=function(e){var t=[];e.forEach(function(e){Yu.forEach(function(n){n.children.forEach(function(n){if(e==n.value){var r={};r.title=n.label,r.dataIndex=L(e),"items"===r.dataIndex&&(r.render=function(e,t){return t.items.length?i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",display:"flex"},className:"i_span"},i.a.createElement("span",{className:"orderGoods"},t.items[0].product_name+"......"),i.a.createElement(de,{type:"icon-eye-fill",onClick:function(){return a.reviewGoods(t.items)}})):i.a.createElement("span",null,"\u65e0")}),t.push(r)}})})}),e.indexOf("id")<0&&e.push("id"),t[0].render=function(e,t){return i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return a.jump(t)}},e)},a.columns=t,a.setState({columns:t,paginationParams:Object(be.a)({},a.state.paginationParams,{only:e.join(",")})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({data:e})},a.onChangeTab=function(e){a.setState({activeTab:e.key,is_on_sale:e.key}),a.refresh(e.key)},a.showProductsReview=function(e){a.setState({productsVisible:!0,products:e})},a.closeProductsReview=function(){a.setState({productsVisible:!1})},a.state={api:Xe,data:[],filterVisible:!1,paginationParams:{logic_conditions:[],search:"",searchJson:w({is_on_sale:!0})},activeTab:!0,products:[],is_on_sale:!0},a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"product_entity_name"},{title:"\u62fc\u56e2\u6570",dataIndex:"shopping_group_count"},{title:"\u62fc\u56e2\u5355\u6570",dataIndex:"shop_shopping_groups_count"},{title:"\u5f85\u6536\u8d27\u6570\u91cf",dataIndex:"wait_pick_count"},{title:"\u5df2\u552e\u6570\u91cf",dataIndex:"sales_completed_count"}],a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.closeCustom)}},{key:"render",value:function(){var e=this,t={visible:this.state.productsVisible,items:this.state.products,onClose:this.closeProductsReview};return i.a.createElement("div",{className:"grouponList"},i.a.createElement(qa,{visible:this.state.filterVisible,onCancel:this.closeHigherFilter,onSubmit:this.onSubmit,refresh:this.refresh,data:Yu}),i.a.createElement(rd,t),i.a.createElement("div",{className:"s_body_box"},i.a.createElement("div",{className:"headerLeft"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u6216\u8ba2\u5355\u53f7"}))),i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u5728\u552e",key:!0},{name:"\u4e0d\u5728\u552e",key:!1}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)})),i.a.createElement("div",{className:"right"},i.a.createElement(_e.a,{type:"primary",size:"small",onClick:this.showCustom},"\u81ea\u5b9a\u4e49\u663e\u793a\u9879"),i.a.createElement("div",{style:{display:this.state.customVisible?"block":"none"},className:"custom",onClick:this.showCustom},i.a.createElement(Nt,{data:Yu,targetKeys:V(this.state.defaultItem),firstItem:"trade_no",handleCustom:this.handleCustom})))),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:this.columns,rowKey:function(e,t){return t},pagination:!1,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a},dataSource:this.state.data})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,ref:this.child,text:"\u4ef6\u5546\u54c1",params:this.state.paginationParams,id:this.state.id,valChange:this.paginationChange,current:this.state.current})))}}]),t}(n.Component),Nd=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={orders:[],data:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({orders:this.props.orders},function(){window.print()})}},{key:"render",value:function(){var e=[{title:"\u5546\u54c1\u4fe1\u606f",dataIndex:"name",align:"center"},{title:"\u89c4\u683c\uff08\u5355\u4f4d\uff09",dataIndex:"unit",align:"center",render:function(e,t,a){return"\u5408\u8ba1"===t.name?"--":e}},{title:"\u6570\u91cf",align:"center",dataIndex:"quantity"},{title:"\u5355\u4ef7(\u5143)",dataIndex:"price",align:"center"},{title:"\u91d1\u989d(\u5143)",dataIndex:"total_fee",align:"center"}],t=this.state.orders;return i.a.createElement("div",{id:"printArea"},t.length?t.map(function(t,a){console.log(t);var n,r=0;t.group_products.length&&t.group_products.map(function(e){r+=e.quantity}),n=t.total_fee,t.settlement_total_fee;var l={id:String(Math.random()),product_name:"\u5408\u8ba1",quantity:r,total_fee:n};return t.items=[].concat(Object(Se.a)(t.group_products),[l,{product_spec_value:"wholeRow",product_name:"\u53f8\u673a\u7b7e\u540d",quantity:"\u5ba2\u6237\u7b7e\u540d"}]),i.a.createElement("div",{className:"printSheet",key:t.id},i.a.createElement("h4",{className:"shopInfo"},"\u5e97\u94fa\u540d\u79f0\uff1a",t.initiator_name),i.a.createElement("h4",null,"\u6536\u8d27\u4eba\u59d3\u540d\uff1a",t.initiator_keeper_name),i.a.createElement("h4",null,"\u8054\u7cfb\u7535\u8bdd\uff1a",t.initiator_keeper_mobile),i.a.createElement("h4",null,"\u5355\u636e\u7f16\u53f7\uff1a",t.trade_no),i.a.createElement("h4",null,"\u7269\u6d41\u7535\u8bdd\uff1a"),i.a.createElement("h4",null,"\u914d\u9001\u5458\uff1a"),i.a.createElement("h4",null,"\u6c47\u603b\u65f6\u95f4\uff1a",t.summary_date),i.a.createElement("h4",null,"\u8f66\u7ebf\uff1a",t.shop_delivery_route&&t.shop_delivery_route.name),i.a.createElement("div",{className:"chart u_chart"},i.a.createElement(ve.a,{columns:e,bordered:!0,rowKey:function(e){return e.item_id},pagination:!1,dataSource:t.items})))}):"\u6682\u65e0\u8ba2\u5355")}}]),t}(n.Component);a(618);function wd(e){return ne({url:"/api/backend/consume_cards",method:"get",params:e})}function xd(e,t){return ne({url:"/api/backend/consume_cards/".concat(t,"/exchange_codes"),method:"get",params:e})}var Id=G.a.RangePicker,jd=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){a.props.onClose()},a.handleSubmit=function(){var e,t=a.state,n=t.name,i=t.amount,r=t.total_quantity,l=t.start_time,s=t.end_time;n?i?r?l&&s?(e=a.state,ne({url:"/api/backend/consume_cards",method:"post",data:e})).then(function(e){B.a.success(e.message),a.handleCancel(),a.props.refresh()}):B.a.error("\u8bf7\u9009\u62e9\u5145\u503c\u5361\u6709\u6548\u671f"):B.a.error("\u8bf7\u586b\u5199\u5145\u503c\u5361\u6570\u91cf"):B.a.error("\u8bf7\u586b\u5199\u5145\u503c\u5361\u91d1\u989d"):B.a.error("\u8bf7\u586b\u5199\u5145\u503c\u5361\u540d\u79f0")},a.actDateChange=function(e,t){a.setState({start_time:t[0],end_time:t[1]})},a.inputChange=function(e,t){a.setState(Object(Y.a)({},t,e.target.value))},a.inputNumChange=function(e,t){a.setState(Object(Y.a)({},t,parseInt(e.target.value)))},a.state={name:"",amount:"",total_quantity:"",start_time:"",end_time:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ge.a,{title:"\u65b0\u5efa\u5145\u503c\u5361",width:520,visible:this.props.visible,onCancel:this.handleCancel,maskClosable:!1,footer:i.a.createElement("div",null,i.a.createElement(_e.a,{size:"small",onClick:this.handleCancel,type:"default"},"\u53d6\u6d88"),i.a.createElement(_e.a,{size:"small",onClick:this.handleSubmit,type:"primary"},"\u4fdd\u5b58"))},i.a.createElement("ul",{className:"mainUl"},i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u5145\u503c\u5361\u540d\u79f0"),i.a.createElement(Ne.a,{className:"liInput",type:"text",value:this.state.name,onChange:function(t){return e.inputChange(t,"name")}})),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u5145\u503c\u5361\u91d1\u989d"),i.a.createElement(Ne.a,{className:"liInput",type:"number",value:this.state.amount,onChange:function(t){return e.inputNumChange(t,"amount")}})),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u6570\u91cf"),i.a.createElement(Ne.a,{className:"liInput",type:"number",value:this.state.total_quantity,onChange:function(t){return e.inputNumChange(t,"total_quantity")}})),i.a.createElement("li",{className:"normalLi imgLi"},i.a.createElement("span",{className:"left c_left"},"\u6709\u6548\u671f"),i.a.createElement(F.a,{locale:H.a},i.a.createElement(Id,{format:"YYYY-MM-DD HH:mm",style:{width:"300px"},showTime:!0,onChange:this.actDateChange}))))))}}]),t}(n.Component),Td=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).refresh=function(){a.child.current.pagination(a.child.current.state.current)},a.search=function(e){a.setState({api:wd,paginationParams:Object(be.a)({},a.state.paginationParams,{searchJson:w({search:e})})},function(){a.child.current.pagination(a.child.current.state.current)})},a.paginationChange=function(e){a.setState({cards:e})},a.exchangeDetails=function(e){a.props.history.push({pathname:"/marketing/rechargeDetails",state:{id:e}})},a.stopExchange=function(e){var t=a.refresh,n=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){n.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u505c\u7528\u8be5\u6d88\u8d39\u5361\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var a,n;(a={},n=e,ne({url:"/api/backend/consume_cards/".concat(n,"/manual_stop"),method:"put",data:a})).then(function(e){B.a.success(e.message),t()})}})},a.createNewCard=function(){a.setState({newCardVisible:!0})},a.closeCreateNewCard=function(){a.setState({newCardVisible:!1})},a.export=function(e){var t=w({strategy:"CONSUME_CARD_EXCHANGE_CODE",customize_columns:[],logic_conditions:[],consume_card_id:e});window.location.href="".concat(v.apiUrl,"/api/backend/export?searchJson=").concat(t,"&Authorization=").concat(k())},a.state={api:wd,paginationParams:{},current:1,cards:[],newCardVisible:!1},a.child=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this,t=[{title:"\u5145\u503c\u5361\u540d\u79f0",dataIndex:"name"},{title:"\u91d1\u989d",dataIndex:"amount"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time"},{title:"\u6709\u6548\u671f",dataIndex:"start_time",render:function(e,t){return i.a.createElement("span",null,e,"-",t.end_time)}},{title:"\u603b\u6570\u91cf",dataIndex:"total_quantity"},{title:"\u5df2\u5151\u6362\u6570\u91cf",dataIndex:"exchange_quantity"},{title:"\u72b6\u6001",dataIndex:"state",render:function(e,t){switch(e){case 0:return"\u5f85\u6fc0\u6d3b";case 1:return"\u5df2\u6fc0\u6d3b";case 2:return"\u5df2\u505c\u7528";default:return"\u5df2\u8fc7\u671f"}}},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"10px"},onClick:function(){return e.exchangeDetails(a.id)}},"\u5151\u6362\u8be6\u60c5"),(0===a.state||1===a.state)&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"10px"},onClick:function(){return e.stopExchange(a.id)}},"\u505c\u7528"),a.exchange_code_ready&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer"},onClick:function(){return e.export(a.id)}},"\u5bfc\u51fa"))}}],a={visible:this.state.newCardVisible,onClose:this.closeCreateNewCard,refresh:this.refresh};return i.a.createElement("div",{className:"bannerSetting"},i.a.createElement(jd,a),i.a.createElement("div",{className:"chart"},i.a.createElement("div",{className:"headerLeft rechargeCards"},i.a.createElement(St,{getDatas:this.search,text:"\u8bf7\u8f93\u5165\u5145\u503c\u5361\u540d\u79f0"}),i.a.createElement(_e.a,{className:"addNew addNewCard",onClick:this.createNewCard},i.a.createElement("i",{className:"iconfont"},"\ue7e0"),"\u65b0\u5efa\u5145\u503c\u5361")),i.a.createElement(ve.a,{dataSource:this.state.cards,rowKey:function(e){return e.id},pagination:!1,columns:t,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,text:"\u4e2a\u5145\u503c\u5361",ref:this.child,params:this.state.paginationParams,current:this.state.current,valChange:this.paginationChange})))}}]),t}(n.Component),Rd=(a(1503),{conditions:[{key:"consume_card_exchange_code_state",operation:"=",value:0}],logic:"and"}),Ad=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(o.a)(this,Object(u.a)(t).call(this))).refresh=function(t){var a={conditions:[{key:"consume_card_exchange_code_state",operation:"=",value:t}],logic:"and"};e.setState({filterVisible:!1,paginationParams:{search:"",searchJson:w({logic_conditions:a})}},function(){e.child.current.pagination(e.child.current.state.current)})},e.stopExchange=function(t){var a=e.refresh,n=e.state.activeTab,r=ge.a.confirm({title:i.a.createElement("div",{className:"u_confirm_header"},"\u63d0\u793a",i.a.createElement("i",{className:"iconfont",style:{cursor:"pointer"},onClick:function(){r.destroy()}},"\ue82a")),icon:null,width:"280px",closable:!0,centered:!0,content:i.a.createElement("div",{className:"U_confirm"},"\u786e\u5b9a\u505c\u7528\u8be5\u5151\u6362\u7801\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},onOk:function(){var e,i;(e={},i=t,ne({url:"/api/backend/consume_cards/exchange_codes/".concat(i,"/manual_stop"),method:"put",data:e})).then(function(e){B.a.success(e.message),a(n)})}})},e.paginationChange=function(t){e.setState({data:t})},e.onChangeTab=function(t){e.setState({activeTab:t.key}),e.refresh(t.key)},e.state={api:xd,activeTab:0,paginationParams:{logic_conditions:[],search:"",searchJson:w({logic_conditions:Rd})},current:1,id:null,data:[]},e.child=i.a.createRef(),e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({id:this.props.location.state.id})}},{key:"render",value:function(){var e=this,t=[{title:"\u5151\u6362\u7801",dataIndex:"exchange_code"},{title:"\u5151\u6362\u4eba\u6635\u79f0",dataIndex:"user_nickname",render:function(e,t){return i.a.createElement("span",null,e||"\u65e0")}},{title:"\u5151\u6362\u4eba\u624b\u673a\u53f7",dataIndex:"user_mobile",render:function(e,t){return i.a.createElement("span",null,e||"\u65e0")}},{title:"\u5151\u6362\u65f6\u95f4",dataIndex:"exchange_time",render:function(e,t){return i.a.createElement("span",null,e||"\u65e0")}},{title:"\u72b6\u6001",dataIndex:"state",render:function(e,t){switch(e){case 0:return"\u672a\u5151\u6362";case 1:return"\u5df2\u5151\u6362";case 2:return"\u5df2\u505c\u7528";default:return"\u5df2\u8fc7\u671f"}}},{title:"\u64cd\u4f5c",render:function(t,a){return i.a.createElement("div",null,0===a.state&&i.a.createElement("span",{style:{color:"#4F9863",cursor:"pointer",marginRight:"10px"},onClick:function(){return e.stopExchange(a.id)}},"\u505c\u7528"))}}];return i.a.createElement("div",{className:"cardDetails"},i.a.createElement("div",{className:"tabs"},i.a.createElement("ul",{className:"left"},[{name:"\u672a\u5151\u6362",key:0},{name:"\u5df2\u5151\u6362",key:1},{name:"\u5df2\u505c\u7528",key:2},{name:"\u5df2\u8fc7\u671f",key:3}].map(function(t,a){return i.a.createElement("li",{key:a,className:e.state.activeTab==t.key?"active":"",onClick:function(){return e.onChangeTab(t)}},t.name)}))),i.a.createElement("div",{className:"chart"},i.a.createElement(ve.a,{dataSource:this.state.data,rowKey:function(e){return e.id},pagination:!1,columns:t,rowClassName:function(e,t){var a="";return t%2&&(a="dark-row"),a}})),i.a.createElement("div",{className:"pagination"},i.a.createElement(xt,{api:this.state.api,text:"\u6761\u5145\u503c\u7801",id:this.state.id,ref:this.child,params:this.state.paginationParams,current:this.state.current,valChange:this.paginationChange})))}}]),t}(n.Component);function Dd(e,t){return k()?i.a.createElement(e,t):i.a.createElement(U.a,{to:"/login"})}var Pd=function(){return i.a.createElement(U.d,null,i.a.createElement(U.b,{exact:!0,path:"/home",render:function(e){return Dd(he,e)}}),i.a.createElement(U.b,{exact:!0,path:"/login",component:js}),"} />",i.a.createElement(U.b,{exact:!0,path:"/login/resetPassword",component:Rs}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/productsManage",component:Su}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/cakeClassification",component:Fm}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities",component:Wu}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/orderManage",component:Du}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/marketing",component:Lu}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/refund",component:om}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/all",component:yu}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/editActivityPage",component:Pm}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/activityProductsManage",component:Lm}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/onShelvesProducts",component:Wm}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/grouponList",component:ld}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/grouponManage",component:ud}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/grouponOrderManage",component:hd}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/newGroupon",component:yd}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/editGroupon",component:Sd}),"} />",i.a.createElement(U.b,{exact:!0,path:"/activities/grouponProductsManage",component:Od}),"} />",i.a.createElement(U.b,{exact:!0,path:"/data",render:function(e){return Dd(Ee,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance",render:function(e){return Dd(Wc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance/balanceDetails",render:function(e){return Dd(so,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance/refundDetails",render:function(e){return Dd(go,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance/withdrawDetails",render:function(e){return Dd(No,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance/incomeDetails",render:function(e){return Dd(xo,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance/refundApplication",render:function(e){return Dd(Ro,e)}}),i.a.createElement(U.b,{exact:!0,path:"/finance/withdrawApplication",render:function(e){return Dd(Vo,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods",render:function(e){return Dd(Yt,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/groups",render:function(e){return Dd(ua,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/obtainedGoods",render:function(e){return Dd($t,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/classification",render:function(e){return Dd(ra,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/breakfastOrder",render:function(e){return Dd(ja,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/clientOrder",render:function(e){return Dd(Da,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/activities",render:function(e){return Dd(Ma,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/distributionMall",render:function(e){return Dd(Ba,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/goodDetails",render:function(e){return Dd(Ha,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/releaseGoods",render:function(e){return Dd(Kr,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/specification",render:function(e){return Dd(Xr,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/inStock",render:function(e){return Dd(Qr,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/outStock",render:function(e){return Dd(nl,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/inStockNew",render:function(e){return Dd(tl,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/outStockNew",render:function(e){return Dd(ll,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/inStockDetail",render:function(e){return Dd(Ka,e)}}),i.a.createElement(U.b,{exact:!0,path:"/goods/outStockDetail",render:function(e){return Dd(sl,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order",render:function(e){return Dd(yn,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/goodsOrder",render:function(e){return Dd(Nn,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/refund",render:function(e){return Dd(Tn,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/orderDetail",render:function(e){return Dd(Rn,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/setUserMessage",render:function(e){return Dd(Qn,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/setting",render:function(e){return Dd(Zn,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/summaryOrders",render:function(e){return Dd(am,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/orderTransformer",render:function(e){return Dd(ri,e)}}),i.a.createElement(U.b,{exact:!0,path:"/order/productsOrderSetting",render:function(e){return Dd(Ym,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing",render:function(e){return Dd(qs,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/integralMall",render:function(e){return Dd(sc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/message",render:function(e){return Dd(Ec,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/userStore",render:function(e){return Dd(Nc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/newCoupon",render:function(e){return Dd(Rc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/newCouponShop",render:function(e){return Dd(Lc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/storeRecord",render:function(e){return Dd(Uc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/sendOutRecord",render:function(e){return Dd(Fc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/customWeChatMessage",render:function(e){return Dd(Bo,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/editWeChatMessage",render:function(e){return Dd(Ho,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/setMarketingMessage",render:function(e){return Dd(Kc,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/banners",render:function(e){return Dd(Ku,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/recharge",render:function(e){return Dd(Td,e)}}),i.a.createElement(U.b,{exact:!0,path:"/marketing/rechargeDetails",render:function(e){return Dd(Ad,e)}}),i.a.createElement(U.b,{exact:!0,path:"/shops",render:function(e){return Dd(Ri,e)}}),i.a.createElement(U.b,{exact:!0,path:"/shops/groups",render:function(e){return Dd(Bi,e)}}),i.a.createElement(U.b,{exact:!0,path:"/shops/frozen",render:function(e){return Dd(fr,e)}}),i.a.createElement(U.b,{exact:!0,path:"/shops/channel",render:function(e){return Dd(_r,e)}}),i.a.createElement(U.b,{exact:!0,path:"/shops/shopDetails",render:function(e){return Dd(Or,e)}}),i.a.createElement(U.b,{exact:!0,path:"/shops/logisticsRoutes",render:function(e){return Dd(Li,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user",render:function(e){return Dd(Fl,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user/integralRules",render:function(e){return Dd(Pl,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user/tagManage",render:function(e){return Dd(ds,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user/membership",render:function(e){return Dd(hs,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user/consumerBehavior",render:function(e){return Dd(fs,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user/groupManage",render:function(e){return Dd(ys,e)}}),i.a.createElement(U.b,{exact:!0,path:"/user/UserDetails",render:function(e){return Dd(ws,e)}}),i.a.createElement(U.b,{exact:!0,path:"/setting",render:function(e){return Dd(jl,e)}}),i.a.createElement(U.b,{exact:!0,path:"/setting/warningSetting",render:function(e){return Dd(Al,e)}}),i.a.createElement(U.b,{exact:!0,path:"/setting/logs",render:function(e){return Dd(ou,e)}}),i.a.createElement(U.b,{exact:!0,path:"/setting/protocolSetting",render:function(e){return Dd(_m,e)}}),i.a.createElement(U.b,{exact:!0,path:"/setting/editProtocol",render:function(e){return Dd(gm,e)}}),i.a.createElement(U.b,{exact:!0,path:"/distribution/distributionStatistics",render:function(e){return Dd(Xo,e)}}),i.a.createElement(U.b,{exact:!0,path:"/distribution/distributionStatistics/handleStatistics",render:function(e){return Dd(Em,e)}}),i.a.createElement(U.b,{exact:!0,path:"/distribution",render:function(e){return Dd(lu,e)}}),i.a.createElement(U.b,{exact:!0,path:"/distribution/cashbackSetting",render:function(e){return Dd(cu,e)}}),i.a.createElement(U.b,{exact:!0,path:"/distribution/cashbackDetails",render:function(e){return Dd(Cm,e)}}),i.a.createElement(U.a,{to:"/home"}),i.a.createElement(U.b,{exact:!0,path:"/printSheet",render:function(e){return Dd(im,e)}}),i.a.createElement(U.b,{exact:!0,path:"/printSummaryOrders",render:function(e){return Dd(rm,e)}}),i.a.createElement(U.b,{exact:!0,path:"/printCustomOrders",render:function(e){return Dd(um,e)}}),i.a.createElement(U.b,{exact:!0,path:"/printCustomSummaryOrders",render:function(e){return Dd(mm,e)}}),i.a.createElement(U.b,{exact:!0,path:"/printGrouponOrders",render:function(e){return Dd(Nd,e)}}))},Vd=(a(109),a(43));a(110);function Ld(e){if(y.a.isEmpty(h.a.get(v.storageUserKey)))return!1;var t=JSON.parse(h.a.get(v.storageUserKey)),a=!1;return y.a.map(t,function(t){return!a&&t.slug===e&&void(a=!0)}),a}var Md=[{path:"/user",icon:"icon-userplus-fill",text:"\u7528\u6237\u7ba1\u7406",name:"nav-user-manage",slug:"menu_user_management"},{path:"/user/tagManage",icon:"icon-tag-fill",text:"\u6807\u7b7e\u7ba1\u7406",name:"nav-user-taps",slug:"menu_tag_management"},{path:"/user/groupManage",icon:"icon-user-group-fill",text:"\u7fa4\u7ec4\u7ba1\u7406",name:"nav-user-groups",slug:"menu_user_group"},{path:"/user/integralRules",icon:"icon-YUAN-circle-fill",text:"\u79ef\u5206\u89c4\u5219",name:"nav-user-integralRules",slug:"menu_user_score_rule"},{path:"/user/membership",icon:"icon-crown-fill",text:"\u4f1a\u5458\u7b49\u7ea7",name:"nav-user-membership",slug:"user_member_grade"}];Md=Md.filter(function(e){return Ld(e.slug)});var Ud=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Md.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},Fd=(Vd.a.SubMenu,[{path:"/finance",icon:"icon-accountbook-fill",text:"\u8d44\u4ea7\u6982\u89c8",slug:"menu_assets_overview"},{path:"/finance/incomeDetails",icon:"icon-qianbao1",text:"\u6536\u5165\u660e\u7ec6",slug:"menu_income_detailed"},{path:"/finance/balanceDetails",icon:"icon-YUAN-circle-fill",text:"\u4f59\u989d\u660e\u7ec6",slug:"menu_balance_detailed"},{path:"/finance/refundDetails",icon:"icon-tuikuan",text:"\u9000\u6b3e\u8be6\u60c5",slug:"menu_refund_detailed"},{path:"/finance/withdrawDetails",icon:"icon-tixian1",text:"\u63d0\u73b0\u8be6\u60c5",slug:"menu_withdraw_detailed"}]);Fd=Fd.filter(function(e){return Ld(e.slug)});var Gd=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Fd.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},Bd=(Vd.a.SubMenu,[{path:"/goods",icon:"icon-resource",text:"\u5546\u54c1\u5e93\u7ba1\u7406",slug:"menu_product_management"},{path:"/goods/obtainedGoods",icon:"icon-inboxin-fill",text:"\u4e0b\u67b6\u5546\u54c1",slug:"menu_product_off_shelves"},{path:"/goods/classification",icon:"icon-all-fill",text:"\u5546\u54c1\u5206\u7c7b",slug:"menu_product_category"},{path:"/goods/specification",icon:"icon-box-fill",text:"\u5546\u54c1\u89c4\u683c",slug:"menu_product_spec"},{path:"/goods/groups",icon:"icon-database-fill",text:"\u5546\u54c1\u7ec4",slug:"menu_product_group"},{path:"/goods/breakfastOrder",icon:"icon-shopping-cart-fill",text:"\u65e9\u9910\u8f66\u8ba2\u8d27",slug:"menu_product_breakfast_book"},{path:"/goods/clientOrder",icon:"icon-arraive",text:"\u5546\u6237\u8ba2\u8d27",slug:"menu_product_merchant_book"},{path:"/goods/distributionMall",icon:"icon-fenxiao",text:"\u5206\u9500\u5546\u57ce",slug:"menu_product_distribution_mall_book"}]);Bd=Bd.filter(function(e){return Ld(e.slug)});var zd=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Bd.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},Hd=(Vd.a.SubMenu,[{path:"/distribution",icon:"icon-dingdanjilu-kongbaiye",text:"\u8fd4\u73b0\u8bb0\u5f55",slug:"menu_cashback_record"},{path:"/distribution/distributionStatistics",icon:"icon-dingdan",text:"\u5206\u9500\u6570\u636e",slug:"menu_cashback_record"},{path:"/distribution/cashbackSetting",icon:"icon-tubiaozhizuomoban",text:"\u8fd4\u73b0\u8bbe\u7f6e",slug:"menu_cashback_setting"}]);Hd=Hd.filter(function(e){return Ld(e.slug)});var Kd=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"inline"},Hd.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},Jd=(Vd.a.SubMenu,function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"inline"},i.a.createElement(Vd.a.Item,{key:"/data"},i.a.createElement(p.b,{to:"/data"},i.a.createElement(me.a,{type:"home"}),i.a.createElement("span",null,"\u6570\u636e")))))}),Wd=(Vd.a.SubMenu,Vd.a.SubMenu,[{path:"/shops",icon:"icon-arraive",text:"\u5e97\u94fa\u7ba1\u7406",slug:"menu_shop_management"},{path:"/shops/groups",icon:"icon-process",text:"\u5e97\u94fa\u7ec4",slug:"menu_shop_group"},{path:"/shops/frozen",icon:"icon-lock-fill",text:"\u5df2\u51bb\u7ed3",slug:"menu_shop_frozen"},{path:"/shops/channel",icon:"icon-qudao1",text:"\u5e97\u94fa\u6e20\u9053",slug:"menu_shop_channel"},{path:"/shops/logisticsRoutes",icon:"icon-qudao1",text:"\u7269\u6d41\u8def\u7ebf",slug:"menu_shop_channel"}]);Wd=Wd.filter(function(e){return Ld(e.slug)}),console.log(Ld("menu_shop_management"));var Yd=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Wd.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},qd=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Ld("menu_user_setting")&&i.a.createElement(Vd.a.Item,{key:"/setting"},i.a.createElement(p.b,{to:"/setting"},i.a.createElement(de,{type:"icon-userplus-fill"}),i.a.createElement("span",null,"\u4eba\u5458\u914d\u7f6e"))),i.a.createElement(Vd.a.Item,{key:"/setting/logs"},i.a.createElement(p.b,{to:"/setting/logs"},i.a.createElement(de,{type:"icon-dingdanjilu-kongbaiye"}),i.a.createElement("span",null,"\u64cd\u4f5c\u8bbe\u7f6e"))),i.a.createElement(Vd.a.Item,{key:"/setting/warningSetting"},i.a.createElement(p.b,{to:"/setting/warningSetting"},i.a.createElement(de,{type:"icon-calendar-alt"}),i.a.createElement("span",null,"APP\u7248\u672c\u8bbe\u7f6e"))),i.a.createElement(Vd.a.Item,{key:"/setting/protocolSetting"},i.a.createElement(p.b,{to:"/setting/protocolSetting"},i.a.createElement(de,{type:"icon-tubiaozhizuomoban"}),i.a.createElement("span",null,"\u534f\u8bae\u8bbe\u7f6e")))))},Xd=(Vd.a.SubMenu,[{path:"/order",icon:"icon-dingdan",text:"\u8ba2\u5355\u7ba1\u7406",slug:"menu_order_management"},{path:"/order/setting",icon:"icon-resource",text:"\u8ba2\u5355\u8bbe\u7f6e",slug:"menu_order_setting"},{path:"/order/refund",icon:"icon-tuikuan",text:"\u9000\u6b3e\u552e\u540e",slug:"menu_order_after_service"},{path:"/order/goodsOrder",icon:"icon-box-fill",text:"\u8ba2\u8d27\u7ba1\u7406",slug:"menu_order_agent"},{path:"/order/productsOrderSetting",icon:"icon-resource",text:"\u8ba2\u8d27\u8bbe\u7f6e",slug:"menu_order_setting"},{path:"/order/summaryOrders",icon:"icon-box-fill",text:"\u6d88\u8d39\u8005\u6c47\u603b\u5355",slug:"menu_order_user_summary"},{path:"/order/orderTransformer",icon:"icon-box-fill",text:"\u8ba2\u5355\u8f6c\u6362",slug:"menu_order_management"}]);Xd=Xd.filter(function(e){return Ld(e.slug)});var $d=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Xd.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},Qd=(Vd.a.SubMenu,[{path:"/activities",icon:"icon-dangao-shi",text:"\u86cb\u7cd5\u7ba1\u7406",slug:"menu_order_management"},{path:"/activities/all",icon:"icon-huodong3",text:"\u6d3b\u52a8\u7ba1\u7406"},{path:"",icon:"icon-pintuanzhuanqu",text:"\u62fc\u56e2\u7ba1\u7406"},{text:"\u62fc\u56e2",path:"/activities/grouponList"},{text:"\u62fc\u56e2\u5355\u7ba1\u7406",path:"/activities/grouponManage"},{text:"\u62fc\u56e2\u8ba2\u5355\u7ba1\u7406",path:"/activities/grouponOrderManage"},{text:"\u5546\u54c1\u7ba1\u7406",path:"/activities/grouponProductsManage"}]),Zd=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},Qd.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},"\u62fc\u56e2\u7ba1\u7406"===e.text?i.a.createElement("a",null,i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,"\u62fc\u56e2\u7ba1\u7406")):i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},ep=(Vd.a.SubMenu,[{path:"/marketing",icon:"icon-coupon",text:"\u4f18\u60e0\u5238",slug:"menu_marketing_coupon"},{path:"/marketing/integralMall",icon:"icon-YUAN-circle-fill",text:"\u79ef\u5206\u5546\u57ce",slug:"menu_marketing_integral_mall"},{path:"/marketing/userStore",icon:"icon-box-fill",text:"\u7528\u6237\u50a8\u503c",slug:"menu_marketing_deposit"},{path:"/marketing/message",icon:"icon-commentdots-fill",text:"\u6a21\u677f\u6d88\u606f",slug:"menu_marketing_msg_template"},{path:"/marketing/banners",icon:"icon-shuffling-banner",text:"Banner\u8bbe\u7f6e",slug:"menu_marketing_msg_template"},{path:"/marketing/recharge",icon:"icon-chongzhiqia",text:"\u5145\u503c\u5361",slug:"menu_marketing_msg_template"}]);ep=ep.filter(function(e){return Ld(e.slug)});var tp=function(e){var t=e.match;return i.a.createElement("div",{style:{paddingBottom:"120px",width:"216px"}},i.a.createElement(Vd.a,{theme:"light",defaultSelectedKeys:[t.url],selectedKeys:[t.url],defaultOpenKeys:["sub4"],mode:"vertical"},ep.map(function(e){return i.a.createElement(Vd.a.Item,{key:e.path},i.a.createElement(p.b,{to:e.path},i.a.createElement(de,{type:e.icon}),i.a.createElement("span",null,e.text)))})))},ap=(a(1505),a(1506),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).logout=function(){var e;(e={},ne({url:"/api/backend/auth/logout",method:"get",data:e})).then(function(e){B.a.success("\u9000\u51fa\u767b\u5f55\u6210\u529f"),S(),h.a.remove(v.storageUserKey),setTimeout(function(){a.props.history.replace("/")},1e3)}).catch(function(e){})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"topBar"},i.a.createElement("div",{className:"user"},i.a.createElement(me.a,{type:"user"}),i.a.createElement("span",{style:{cursor:"pointer"},onClick:this.logout},"\u9000\u51fa\u767b\u5f55")))}}]),t}(i.a.Component)),np=Object(U.g)(ap),ip=["integralRules","tagManage","userDetails","shopDetails","goodDetails","releaseGoods","inStock","outStock","inStockNew","outStockNew","inStockDetail","outStockDetail","orderDetail","newCoupon","newCouponShop","userStore","storeRecord","message","sendOutRecord","balanceDetails","overview","incomeDetails","withdrawDetails","withdrawApplication","customWeChatMessage","editWeChatMessage","cashbackSetting","setUserMessage","setting","productsOrderSetting","setMarketingMessage","warningSetting","logs","newGroupon","editGroupon"],rp=["finance","home"],lp=(Vd.a.SubMenu,[{path:"/activities/productsManage",icon:"icon-dingdan",text:"\u5546\u54c1\u7ba1\u7406",slug:"menu_order_management"},{path:"/activities/orderManage",icon:"icon-resource",text:"\u8ba2\u5355\u7ba1\u7406",slug:"menu_order_setting"},{path:"/activities/marketing",icon:"icon-tuikuan",text:"\u8425\u9500",slug:"menu_order_after_service"}]);lp=lp.filter(function(e){return Ld(e.slug)});var sp=d.a.Header,cp=d.a.Sider,op=d.a.Content,up=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSider=function(){switch(a.props.location.pathname.split("/")[1]){case"user":return i.a.createElement(Ud,{match:{url:a.props.location.pathname}});case"goods":return i.a.createElement(zd,{match:{url:a.props.location.pathname}});case"shops":return i.a.createElement(Yd,{match:{url:a.props.location.pathname}});case"finance":return i.a.createElement(Gd,{match:{url:a.props.location.pathname}});case"data":return i.a.createElement(Jd,{match:{url:a.props.location.pathname}});case"marketing":return i.a.createElement(tp,{match:{url:a.props.location.pathname}});case"order":return i.a.createElement($d,{match:{url:a.props.location.pathname}});case"setting":return i.a.createElement(qd,{match:{url:a.props.location.pathname}});case"distribution":return i.a.createElement(Kd,{match:{url:a.props.location.pathname}});case"activities":return i.a.createElement(Zd,{match:{url:a.props.location.pathname}});default:return""}},a.routeClassName=function(){var e=a.props.location.pathname.split("/");return!e[2]&&rp.indexOf(e[1])>-1||!!(e[2]&&ip.indexOf(e[2])>-1)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return"/login"===this.props.location.pathname?i.a.createElement(js,null):"/login/resetPassword"===this.props.location.pathname?i.a.createElement(Rs,null):"/printSheet"===this.props.location.pathname?i.a.createElement(im,{orders:this.props.location.state.orders,title:this.props.location.state.title,isNeedItems:this.props.location.state.isNeedItems}):"/printSummaryOrders"===this.props.location.pathname?i.a.createElement(rm,{orders:this.props.location.state.orders,title:this.props.location.state.title}):"/printCustomSummaryOrders"===this.props.location.pathname?i.a.createElement(mm,{orders:this.props.location.state.orders}):"/printCustomOrders"===this.props.location.pathname?i.a.createElement(um,{orders:this.props.location.state.orders}):"/printGrouponOrders"===this.props.location.pathname?i.a.createElement(Nd,{orders:this.props.location.state.orders}):i.a.createElement(d.a,{style:{minHeight:"100vh"}},i.a.createElement(np,null),i.a.createElement("div",{className:"lay_out_header"},i.a.createElement(sp,{style:{background:"#fff",height:"80px"}},i.a.createElement(M,null))),i.a.createElement(d.a,{style:{display:"flex",justifyContent:"center",width:"100%"}},i.a.createElement("div",{className:"main-content app"},"/home"!==this.props.location.pathname&&i.a.createElement(cp,{width:300,style:{background:"#fff",flex:1},className:"fixed"},this.handleSider()),i.a.createElement(op,{className:this.routeClassName()?"container no-padding-container":"container"},i.a.createElement(Pd,null)))))}}]),t}(i.a.Component),mp=Object(U.g)(up);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var dp=a(639),pp=a(174);var hp=Object(pp.c)(function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&arguments[1]},pp.a.apply(void 0,[]));window._store=hp;var fp=hp;window.hasPermission=Ld,l.a.render(i.a.createElement(p.a,{children:[]},i.a.createElement(dp.a,{store:fp},i.a.createElement(mp,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},189:function(e,t,a){},227:function(e,t,a){},251:function(e,t,a){},252:function(e,t,a){},253:function(e,t,a){},267:function(e,t,a){},272:function(e,t,a){},360:function(e,t,a){},361:function(e,t,a){},362:function(e,t,a){},365:function(e,t,a){},380:function(e,t,a){},381:function(e,t,a){},382:function(e,t,a){},400:function(e,t,a){},410:function(e,t,a){},478:function(e,t,a){},488:function(e,t,a){},530:function(e,t,a){},532:function(e,t,a){},533:function(e,t,a){},534:function(e,t,a){},535:function(e,t,a){},537:function(e,t){},538:function(e,t,a){},568:function(e,t,a){},575:function(e,t,a){},577:function(e,t,a){},578:function(e,t,a){},579:function(e,t,a){},580:function(e,t,a){},581:function(e,t,a){},582:function(e,t,a){},583:function(e,t,a){},585:function(e,t,a){},611:function(e,t,a){},612:function(e,t,a){},613:function(e,t,a){},614:function(e,t,a){},615:function(e,t,a){},616:function(e,t,a){},617:function(e,t,a){},618:function(e,t,a){},645:function(e,t,a){e.exports=a(1507)},650:function(e,t,a){},653:function(e,t,a){},654:function(e,t,a){},659:function(e,t,a){},667:function(e,t,a){},846:function(e,t,a){},854:function(e,t,a){},856:function(e,t,a){},956:function(e,t,a){},958:function(e,t,a){},959:function(e,t,a){},963:function(e,t,a){}},[[645,1,2]]]);
//# sourceMappingURL=main.5642e26c.chunk.js.map